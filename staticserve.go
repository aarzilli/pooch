package main

var FILES map[string]string = map[string]string{
	"advanced.html": "PCFET0NUWVBFIGh0bWw+CjxodG1sPgogIDxoZWFkPgogICAgPHRpdGxlPkFkdmFuY2VkIE9wZXJhdGlvbnM8L3RpdGxlPgogIDwvaGVhZD4KICA8Ym9keT4KICAgIDxmb3JtIG1ldGhvZD0iZ2V0IiBhY3Rpb249Ii9yZW50YWciPgogICAgICA8aDI+UmVuYW1lIFRhZzwvaDI+CiAgICAgIEZyb206IDxpbnB1dCBuYW1lPSdmcm9tJyB0eXBlPSd0ZXh0JyBzaXplPScyMCcvPjxicj4KICAgICAgVG86IDxpbnB1dCBuYW1lPSd0bycgdHlwZT0ndGV4dCcgc2l6ZT0nMjAnLz48YnI+CiAgICAgIDxpbnB1dCB0eXBlPSdzdWJtaXQnIHZhbHVlPSdyZW5hbWUnLz4KICAgIDwvZm9ybT4KICA8L2JvZHk+CjwvaHRtbD4K",
	"cal.css": "LyoKIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgR1BMdjMKIENvcHlyaWdodCAyMDEwLCBBbGVzc2FuZHJvIEFyemlsbGkKICovCgouYWx0MSwgLmZjLWFnZW5kYSAuYWx0MSwgLmZjLWV2ZW50LXRpbWUsIC5hbHQxIGEgewogICAgYmFja2dyb3VuZC1jb2xvcjogbWFyb29uOwogICAgYm9yZGVyLWNvbG9yOiBtYXJvb247Cn0KCi5hbHQyLCAuZmMtYWdlbmRhIC5hbHQyLCAuZmMtZXZlbnQtdGltZSwgLmFsdDIgYSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBuYXZ5OwogICAgYm9yZGVyLWNvbG9yOiBuYXZ5Owp9CgouYWx0MywgLmZjLWFnZW5kYSAuYWx0MywgLmZjLWV2ZW50LXRpbWUsIC5hbHQzIGEgewogICAgYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47CiAgICBib3JkZXItY29sb3I6IGdyZWVuOwp9CgouYWx0NCwgLmZjLWFnZW5kYSAuYWx0NCwgLmZjLWV2ZW50LXRpbWUsIC5hbHQ0IGEgewogICAgYmFja2dyb3VuZC1jb2xvcjogZnVjaHNpYTsKICAgIGJvcmRlci1jb2xvcjogZnVjaHNpYTsKfQoKLmFsdDUsIC5mYy1hZ2VuZGEgLmFsdDUsIC5mYy1ldmVudC10aW1lLCAuYWx0NSBhIHsKICAgIGJhY2tncm91bmQtY29sb3I6IHB1cnBsZTsKICAgIGJvcmRlci1jb2xvcjogcHVycGxlOwp9CgoucG9wdXAgewogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7CiAgICBwYWRkaW5nOiA4cHg7CiAgICBib3JkZXI6IHRoaW4gc29saWQgYmxhY2s7Cn0K",
	"calendar.css": "LmNhbGVuZGFyLWJveCB7CglkaXNwbGF5Om5vbmU7CgliYWNrZ3JvdW5kLWNvbG9yOiNmZmY7Cglib3JkZXI6MXB4IHNvbGlkICM0NDQ7Cglwb3NpdGlvbjphYnNvbHV0ZTsKCXdpZHRoOjI1MHB4OwoJcGFkZGluZzogMCA1cHg7Cn0KLmNhbGVuZGFyLWJveCBzZWxlY3QuY2FsZW5kYXItbW9udGggewoJd2lkdGg6OTBweDsKfQouY2FsZW5kYXItYm94IHNlbGVjdC5jYWxlbmRhci15ZWFyIHsKCXdpZHRoOjcwcHg7Cn0KLmNhbGVuZGFyLWJveCAuY2FsZW5kYXItY2FuY2VsIHsKCXdpZHRoOjEwMCU7Cn0KLmNhbGVuZGFyLWJveCB0YWJsZSB0ZCB7Cgl3aWR0aDoxNCU7Cn0KLmNhbGVuZGFyLWJveCAuY2FsZW5kYXItdGl0bGUgewoJdGV4dC1hbGlnbjpjZW50ZXI7Cn0KLmNhbGVuZGFyLWJveCBhIHsKCXRleHQtZGVjb3JhdGlvbjpub25lOwp9Ci5jYWxlbmRhci1ib3ggLnRvZGF5IGEgewoJcGFkZGluZzowIDVweDsKCW1hcmdpbi1sZWZ0Oi01cHg7CgliYWNrZ3JvdW5kLWNvbG9yOiNmZmU5YzY7Cn0gCi5jYWxlbmRhci1ib3ggLnNlbGVjdGVkIGEgewoJcGFkZGluZzowIDVweDsKCW1hcmdpbi1sZWZ0Oi01cHg7CgliYWNrZ3JvdW5kLWNvbG9yOiNjOWZmOGI7Cn0K",
	"calendar.js": "LyoqCiAqIENhbGVuZGFyIFNjcmlwdAogKiBDcmVhdGVzIGEgY2FsZW5kYXIgd2lkZ2V0IHdoaWNoIGNhbiBiZSB1c2VkIHRvIHNlbGVjdCB0aGUgZGF0ZSBtb3JlIGVhc2lseSB0aGFuIHVzaW5nIGp1c3QgYSB0ZXh0IGJveAogKiBodHRwOi8vd3d3Lm9wZW5qcy5jb20vc2NyaXB0cy91aS9jYWxlbmRhci8KICoKICogRXhhbXBsZToKICogPGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImRhdGUiIGlkPSJkYXRlIiAvPgogKiA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAqIAkJY2FsZW5kYXIuc2V0KCJkYXRlIik7CiAqIDwvc2NyaXB0PgogKi8KY2FsZW5kYXIgPSB7Cgltb250aF9uYW1lczogWyJKYW51YXJ5IiwiRmVicnVhcnkiLCJNYXJjaCIsIkFwcmlsIiwiTWF5IiwiSnVuZSIsIkp1bHkiLCJBdWdlc3QiLCJTZXB0ZW1iZXIiLCJPY3RvYmVyIiwiTm92ZW1iZXIiLCJEZWNlbWJlciJdLAoJd2Vla2RheXM6IFsiU3VuIiwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0Il0sCgltb250aF9kYXlzOiBbMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLAoJLy9HZXQgdG9kYXkncyBkYXRlIC0geWVhciwgbW9udGgsIGRheSBhbmQgZGF0ZQoJdG9kYXkgOiBuZXcgRGF0ZSgpLAoJb3B0IDoge30sCglkYXRhOiBbXSwKCgkvL0Z1bmN0aW9ucwoJLy8vIFVzZWQgdG8gY3JlYXRlIEhUTUwgaW4gYSBvcHRpbWl6ZWQgd2F5LgoJd3J0OmZ1bmN0aW9uKHR4dCkgewoJCXRoaXMuZGF0YS5wdXNoKHR4dCk7Cgl9LAoJCgkvKiBJbnNwaXJlZCBieSBodHRwOi8vd3d3LnF1aXJrc21vZGUub3JnL2RvbS9nZXRzdHlsZXMuaHRtbCAqLwoJZ2V0U3R5bGU6IGZ1bmN0aW9uKGVsZSwgcHJvcGVydHkpewoJCWlmIChlbGUuY3VycmVudFN0eWxlKSB7CgkJCXZhciBhbHRfcHJvcGVydHlfbmFtZSA9IHByb3BlcnR5LnJlcGxhY2UoL1wtKFx3KS9nLGZ1bmN0aW9uKG0sYyl7cmV0dXJuIGMudG9VcHBlckNhc2UoKTt9KTsvL2JhY2tncm91bmQtY29sb3IgYmVjb21lcyBiYWNrZ3JvdW5kQ29sb3IKCQkJdmFyIHZhbHVlID0gZWxlLmN1cnJlbnRTdHlsZVtwcm9wZXJ0eV18fGVsZS5jdXJyZW50U3R5bGVbYWx0X3Byb3BlcnR5X25hbWVdOwoJCQoJCX0gZWxzZSBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHsKCQkJcHJvcGVydHkgPSBwcm9wZXJ0eS5yZXBsYWNlKC8oW0EtWl0pL2csIi0kMSIpLnRvTG93ZXJDYXNlKCk7Ly9iYWNrZ3JvdW5kQ29sb3IgYmVjb21lcyBiYWNrZ3JvdW5kLWNvbG9yCgoJCQl2YXIgdmFsdWUgPSBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZSxudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKHByb3BlcnR5KTsKCQl9CgkJCgkJLy9Tb21lIHByb3BlcnRpZXMgYXJlIHNwZWNpYWwgY2FzZXMKCQlpZihwcm9wZXJ0eSA9PSAib3BhY2l0eSIgJiYgZWxlLmZpbHRlcikgdmFsdWUgPSAocGFyc2VGbG9hdCggZWxlLmZpbHRlci5tYXRjaCgvb3BhY2l0eVw9KFteKV0qKS8pWzFdICkgLyAxMDApOwoJCWVsc2UgaWYocHJvcGVydHkgPT0gIndpZHRoIiAmJiBpc05hTih2YWx1ZSkpIHZhbHVlID0gZWxlLmNsaWVudFdpZHRoIHx8IGVsZS5vZmZzZXRXaWR0aDsKCQllbHNlIGlmKHByb3BlcnR5ID09ICJoZWlnaHQiICYmIGlzTmFOKHZhbHVlKSkgdmFsdWUgPSBlbGUuY2xpZW50SGVpZ2h0IHx8IGVsZS5vZmZzZXRIZWlnaHQ7CgkJcmV0dXJuIHZhbHVlOwoJfSwKCWdldFBvc2l0aW9uOmZ1bmN0aW9uKGVsZSkgewoJCXZhciB4ID0gMDsKCQl2YXIgeSA9IDA7CgkJd2hpbGUgKGVsZSkgewoJCQl4ICs9IGVsZS5vZmZzZXRMZWZ0OwoJCQl5ICs9IGVsZS5vZmZzZXRUb3A7CgkJCWVsZSA9IGVsZS5vZmZzZXRQYXJlbnQ7CgkJfQoJCWlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk1hYyIpICE9IC0xICYmIHR5cGVvZiBkb2N1bWVudC5ib2R5LmxlZnRNYXJnaW4gIT0gInVuZGVmaW5lZCIpIHsKCQkJeCArPSBkb2N1bWVudC5ib2R5LmxlZnRNYXJnaW47CgkJCW9mZnNldFRvcCArPSBkb2N1bWVudC5ib2R5LnRvcE1hcmdpbjsKCQl9CgkKCQl2YXIgeHkgPSBuZXcgQXJyYXkoeCx5KTsKCQlyZXR1cm4geHk7Cgl9LAoJLy8vIENhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyBvbiBhIGRhdGUgaW4gdGhlIGNhbGVuZGFyLgoJc2VsZWN0RGF0ZTpmdW5jdGlvbih5ZWFyLG1vbnRoLGRheSkgewoJCXZhciB0aHMgPSBfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlOwoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRocy5vcHRbImlucHV0Il0pLnZhbHVlID0geWVhciArICItIiArIG1vbnRoICsgIi0iICsgZGF5OyAvLyBEYXRlIGZvcm1hdCBpcyA6SEFSRENPREU6CgkJdGhzLmhpZGVDYWxlbmRhcigpOwoJfSwKCS8vLyBDcmVhdGVzIGEgY2FsZW5kYXIgd2l0aCB0aGUgZGF0ZSBnaXZlbiBpbiB0aGUgYXJndW1lbnQgYXMgdGhlIHNlbGVjdGVkIGRhdGUuCgltYWtlQ2FsZW5kYXI6ZnVuY3Rpb24oeWVhciwgbW9udGgsIGRheSkgewoJCXllYXIgPSBwYXJzZUludCh5ZWFyKTsKCQltb250aD0gcGFyc2VJbnQobW9udGgpOwoJCWRheQkgPSBwYXJzZUludChkYXkpOwoJCQoJCS8vRGlzcGxheSB0aGUgdGFibGUKCQl2YXIgbmV4dF9tb250aCA9IG1vbnRoKzE7CgkJdmFyIG5leHRfbW9udGhfeWVhciA9IHllYXI7CgkJaWYobmV4dF9tb250aD49MTIpIHsKCQkJbmV4dF9tb250aCA9IDA7CgkJCW5leHRfbW9udGhfeWVhcisrOwoJCX0KCQkKCQl2YXIgcHJldmlvdXNfbW9udGggPSBtb250aC0xOwoJCXZhciBwcmV2aW91c19tb250aF95ZWFyID0geWVhcjsKCQlpZihwcmV2aW91c19tb250aDwgMCkgewoJCQlwcmV2aW91c19tb250aCA9IDExOwoJCQlwcmV2aW91c19tb250aF95ZWFyLS07CgkJfQoJCQoJCXRoaXMud3J0KCI8dGFibGU+Iik7CgkJdGhpcy53cnQoIjx0cj48dGg+PGEgaHJlZj0namF2YXNjcmlwdDpjYWxlbmRhci5tYWtlQ2FsZW5kYXIoIisocHJldmlvdXNfbW9udGhfeWVhcikrIiwiKyhwcmV2aW91c19tb250aCkrIik7JyB0aXRsZT0nIit0aGlzLm1vbnRoX25hbWVzW3ByZXZpb3VzX21vbnRoXSsiICIrKHByZXZpb3VzX21vbnRoX3llYXIpKyInPiZsdDs8L2E+PC90aD4iKTsKCQl0aGlzLndydCgiPHRoIGNvbHNwYW49JzUnIGNsYXNzPSdjYWxlbmRhci10aXRsZSc+PHNlbGVjdCBuYW1lPSdjYWxlbmRhci1tb250aCcgY2xhc3M9J2NhbGVuZGFyLW1vbnRoJyBvbkNoYW5nZT0nY2FsZW5kYXIubWFrZUNhbGVuZGFyKCIreWVhcisiLHRoaXMudmFsdWUpOyc+Iik7CgkJZm9yKHZhciBpIGluIHRoaXMubW9udGhfbmFtZXMpIHsKCQkJdGhpcy53cnQoIjxvcHRpb24gdmFsdWU9JyIraSsiJyIpOwoJCQlpZihpID09IG1vbnRoKSB0aGlzLndydCgiIHNlbGVjdGVkPSdzZWxlY3RlZCciKTsKCQkJdGhpcy53cnQoIj4iK3RoaXMubW9udGhfbmFtZXNbaV0rIjwvb3B0aW9uPiIpOwoJCX0KCQl0aGlzLndydCgiPC9zZWxlY3Q+Iik7CgkJdGhpcy53cnQoIjxzZWxlY3QgbmFtZT0nY2FsZW5kYXIteWVhcicgY2xhc3M9J2NhbGVuZGFyLXllYXInIG9uQ2hhbmdlPSdjYWxlbmRhci5tYWtlQ2FsZW5kYXIodGhpcy52YWx1ZSwgIittb250aCsiKTsnPiIpOwoJCXZhciBjdXJyZW50X3llYXIgPSB0aGlzLnRvZGF5LmdldFllYXIoKTsKCQlpZihjdXJyZW50X3llYXIgPCAxOTAwKSBjdXJyZW50X3llYXIgKz0gMTkwMDsKCQkKCQlmb3IodmFyIGk9Y3VycmVudF95ZWFyLTcwOyBpPGN1cnJlbnRfeWVhcisxMDsgaSsrKSB7CgkJCXRoaXMud3J0KCI8b3B0aW9uIHZhbHVlPSciK2krIiciKQoJCQlpZihpID09IHllYXIpIHRoaXMud3J0KCIgc2VsZWN0ZWQ9J3NlbGVjdGVkJyIpOwoJCQl0aGlzLndydCgiPiIraSsiPC9vcHRpb24+Iik7CgkJfQoJCXRoaXMud3J0KCI8L3NlbGVjdD48L3RoPiIpOwoJCXRoaXMud3J0KCI8dGg+PGEgaHJlZj0namF2YXNjcmlwdDpjYWxlbmRhci5tYWtlQ2FsZW5kYXIoIisobmV4dF9tb250aF95ZWFyKSsiLCIrKG5leHRfbW9udGgpKyIpOycgdGl0bGU9JyIrdGhpcy5tb250aF9uYW1lc1tuZXh0X21vbnRoXSsiICIrKG5leHRfbW9udGhfeWVhcikrIic+Jmd0OzwvYT48L3RoPjwvdHI+Iik7CgkJdGhpcy53cnQoIjx0ciBjbGFzcz0naGVhZGVyJz4iKTsKCQlmb3IodmFyIHdlZWtkYXk9MDsgd2Vla2RheTw3OyB3ZWVrZGF5KyspIHRoaXMud3J0KCI8dGQ+Iit0aGlzLndlZWtkYXlzW3dlZWtkYXldKyI8L3RkPiIpOwoJCXRoaXMud3J0KCI8L3RyPiIpOwoJCQoJCS8vR2V0IHRoZSBmaXJzdCBkYXkgb2YgdGhpcyBtb250aAoJCXZhciBmaXJzdF9kYXkgPSBuZXcgRGF0ZSh5ZWFyLG1vbnRoLDEpOwoJCXZhciBzdGFydF9kYXkgPSBmaXJzdF9kYXkuZ2V0RGF5KCk7CgkJCgkJdmFyIGQgPSAxOwoJCXZhciBmbGFnID0gMDsKCQkKCQkvL0xlYXAgeWVhciBzdXBwb3J0CgkJaWYoeWVhciAlIDQgPT0gMCkgdGhpcy5tb250aF9kYXlzWzFdID0gMjk7CgkJZWxzZSB0aGlzLm1vbnRoX2RheXNbMV0gPSAyODsKCQkKCQl2YXIgZGF5c19pbl90aGlzX21vbnRoID0gdGhpcy5tb250aF9kYXlzW21vbnRoXTsKCgkJLy9DcmVhdGUgdGhlIGNhbGVuZGVyCgkJZm9yKHZhciBpPTA7aTw9NTtpKyspIHsKCQkJaWYodyA+PSBkYXlzX2luX3RoaXNfbW9udGgpIGJyZWFrOwoJCQl0aGlzLndydCgiPHRyPiIpOwoJCQlmb3IodmFyIGo9MDtqPDc7aisrKSB7CgkJCQlpZihkID4gZGF5c19pbl90aGlzX21vbnRoKSBmbGFnPTA7IC8vSWYgdGhlIGRheXMgaGFzIG92ZXJzaG9vdGVkIHRoZSBudW1iZXIgb2YgZGF5cyBpbiB0aGlzIG1vbnRoLCBzdG9wIHdyaXRpbmcKCQkJCWVsc2UgaWYoaiA+PSBzdGFydF9kYXkgJiYgIWZsYWcpIGZsYWc9MTsvL0lmIHRoZSBmaXJzdCBkYXkgb2YgdGhpcyBtb250aCBoYXMgY29tZSwgc3RhcnQgdGhlIGRhdGUgd3JpdGluZwoKCQkJCWlmKGZsYWcpIHsKCQkJCQl2YXIgdyA9IGQsIG1vbiA9IG1vbnRoKzE7CgkJCQkJaWYodyA8IDEwKQl3CT0gIjAiICsgdzsKCQkJCQlpZihtb24gPCAxMCltb24gPSAiMCIgKyBtb247CgoJCQkJCS8vSXMgaXQgdG9kYXk/CgkJCQkJdmFyIGNsYXNzX25hbWUgPSAnJzsKCQkJCQl2YXIgeWVhID0gdGhpcy50b2RheS5nZXRZZWFyKCk7CgkJCQkJaWYoeWVhIDwgMTkwMCkgeWVhICs9IDE5MDA7CgoJCQkJCWlmKHllYSA9PSB5ZWFyICYmIHRoaXMudG9kYXkuZ2V0TW9udGgoKSA9PSBtb250aCAmJiB0aGlzLnRvZGF5LmdldERhdGUoKSA9PSBkKSBjbGFzc19uYW1lID0gIiB0b2RheSI7CgkJCQkJaWYoZGF5ID09IGQpIGNsYXNzX25hbWUgKz0gIiBzZWxlY3RlZCI7CgkJCQkJCgkJCQkJY2xhc3NfbmFtZSArPSAiICIgKyB0aGlzLndlZWtkYXlzW2pdLnRvTG93ZXJDYXNlKCk7CgoJCQkJCXRoaXMud3J0KCI8dGQgY2xhc3M9J2RheXMiK2NsYXNzX25hbWUrIic+PGEgaHJlZj0namF2YXNjcmlwdDpjYWxlbmRhci5zZWxlY3REYXRlKFwiIit5ZWFyKyJcIixcIiIrbW9uKyJcIixcIiIrdysiXCIpJz4iK3crIjwvYT48L3RkPiIpOwoJCQkJCWQrKzsKCQkJCX0gZWxzZSB7CgkJCQkJdGhpcy53cnQoIjx0ZCBjbGFzcz0nZGF5cyc+Jm5ic3A7PC90ZD4iKTsKCQkJCX0KCQkJfQoJCQl0aGlzLndydCgiPC90cj4iKTsKCQl9CgkJdGhpcy53cnQoIjwvdGFibGU+Iik7CgkJdGhpcy53cnQoIjxpbnB1dCB0eXBlPSdidXR0b24nIHZhbHVlPSdDYW5jZWwnIGNsYXNzPSdjYWxlbmRhci1jYW5jZWwnIG9uY2xpY2s9J2NhbGVuZGFyLmhpZGVDYWxlbmRhcigpOycgLz4iKTsKCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5vcHRbJ2NhbGVuZGFyJ10pLmlubmVySFRNTCA9IHRoaXMuZGF0YS5qb2luKCIiKTsKCQl0aGlzLmRhdGEgPSBbXTsKCX0sCgkKCS8vLyBEaXNwbGF5IHRoZSBjYWxlbmRhciAtIGlmIGEgZGF0ZSBleGlzdHMgaW4gdGhlIGlucHV0IGJveCwgdGhhdCB3aWxsIGJlIHNlbGVjdGVkIGluIHRoZSBjYWxlbmRhci4KCXNob3dDYWxlbmRhcjogZnVuY3Rpb24oKSB7CgkJdmFyIGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5vcHRbJ2lucHV0J10pOwoJCQoJCS8vUG9zaXRpb24gdGhlIGRpdiBpbiB0aGUgY29ycmVjdCBsb2NhdGlvbi4uLgoJCXZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLm9wdFsnY2FsZW5kYXInXSk7CgkJdmFyIHh5ID0gdGhpcy5nZXRQb3NpdGlvbihpbnB1dCk7CgkJdmFyIHdpZHRoID0gcGFyc2VJbnQodGhpcy5nZXRTdHlsZShpbnB1dCwnd2lkdGgnKSk7CgkJZGl2LnN0eWxlLmxlZnQ9KHh5WzBdK3dpZHRoKzEwKSsicHgiOwoJCWRpdi5zdHlsZS50b3A9eHlbMV0rInB4IjsKCgkJLy8gU2hvdyB0aGUgY2FsZW5kYXIgd2l0aCB0aGUgZGF0ZSBpbiB0aGUgaW5wdXQgYXMgdGhlIHNlbGVjdGVkIGRhdGUKCQl2YXIgZXhpc3RpbmdfZGF0ZSA9IG5ldyBEYXRlKCk7CgkJdmFyIGRhdGVfaW5faW5wdXQgPSBpbnB1dC52YWx1ZTsKCQlpZihkYXRlX2luX2lucHV0KSB7CgkJCXZhciBzZWxlY3RlZF9kYXRlID0gZmFsc2U7CgkJCXZhciBkYXRlX3BhcnRzID0gZGF0ZV9pbl9pbnB1dC5zcGxpdCgiLSIpOwoJCQlpZihkYXRlX3BhcnRzLmxlbmd0aCA9PSAzKSB7CgkJCQlkYXRlX3BhcnRzWzFdLS07IC8vTW9udGggc3RhcnRzIHdpdGggMAoJCQkJc2VsZWN0ZWRfZGF0ZSA9IG5ldyBEYXRlKGRhdGVfcGFydHNbMF0sIGRhdGVfcGFydHNbMV0sIGRhdGVfcGFydHNbMl0pOwoJCQl9CgkJCWlmKHNlbGVjdGVkX2RhdGUgJiYgIWlzTmFOKHNlbGVjdGVkX2RhdGUuZ2V0WWVhcigpKSkgeyAvL1ZhbGlkIGRhdGUuCgkJCQlleGlzdGluZ19kYXRlID0gc2VsZWN0ZWRfZGF0ZTsKCQkJfQoJCX0KCQkKCQl2YXIgdGhlX3llYXIgPSBleGlzdGluZ19kYXRlLmdldFllYXIoKTsKCQlpZih0aGVfeWVhciA8IDE5MDApIHRoZV95ZWFyICs9IDE5MDA7CgkJdGhpcy5tYWtlQ2FsZW5kYXIodGhlX3llYXIsIGV4aXN0aW5nX2RhdGUuZ2V0TW9udGgoKSwgZXhpc3RpbmdfZGF0ZS5nZXREYXRlKCkpOwoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMub3B0WydjYWxlbmRhciddKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQlfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlID0gdGhpczsKCX0sCgkKCS8vLyBIaWRlcyB0aGUgY3VycmVudGx5IHNob3cgY2FsZW5kYXIuCgloaWRlQ2FsZW5kYXI6IGZ1bmN0aW9uKGluc3RhbmNlKSB7CgkJdmFyIGFjdGl2ZV9jYWxlbmRhcl9pZCA9ICIiOwoJCWlmKGluc3RhbmNlKSBhY3RpdmVfY2FsZW5kYXJfaWQgPSBpbnN0YW5jZS5vcHRbJ2NhbGVuZGFyJ107CgkJZWxzZSBhY3RpdmVfY2FsZW5kYXJfaWQgPSBfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlLm9wdFsnY2FsZW5kYXInXTsKCQkKCQlpZihhY3RpdmVfY2FsZW5kYXJfaWQpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFjdGl2ZV9jYWxlbmRhcl9pZCkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQlfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlID0ge307Cgl9LAoJCgkvLy8gU2V0dXAgYSB0ZXh0IGlucHV0IGJveCB0byBiZSBhIGNhbGVuZGFyIGJveC4KCXNldDogZnVuY3Rpb24oaW5wdXRfaWQpIHsKCQl2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpbnB1dF9pZCk7CgkJaWYoIWlucHV0KSByZXR1cm47IC8vSWYgdGhlIGlucHV0IGZpZWxkIGlzIG5vdCB0aGVyZSwgZXhpdC4KCQkKCQlpZighdGhpcy5vcHRbJ2NhbGVuZGFyJ10pIHRoaXMuaW5pdCgpOwoJCQoJCXZhciB0aHMgPSB0aGlzOwoJCWlucHV0Lm9uY2xpY2s9ZnVuY3Rpb24oKXsKCQkJdGhzLm9wdFsnaW5wdXQnXSA9IHRoaXMuaWQ7CgkJCXRocy5zaG93Q2FsZW5kYXIoKTsKCQl9OwoJfSwKCQoJLy8vIFdpbGwgYmUgY2FsbGVkIG9uY2Ugd2hlbiB0aGUgZmlyc3QgaW5wdXQgaXMgc2V0LgoJaW5pdDogZnVuY3Rpb24oKSB7CgkJaWYoIXRoaXMub3B0WydjYWxlbmRhciddIHx8ICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLm9wdFsnY2FsZW5kYXInXSkpIHsKCQkJdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCQlpZighdGhpcy5vcHRbJ2NhbGVuZGFyJ10pIHRoaXMub3B0WydjYWxlbmRhciddID0gJ2NhbGVuZGVyX2Rpdl8nKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAxMDApOwoKCQkJZGl2LnNldEF0dHJpYnV0ZSgnaWQnLHRoaXMub3B0WydjYWxlbmRhciddKTsKCQkJZGl2LmNsYXNzTmFtZT0iY2FsZW5kYXItYm94IjsKCgkJCWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF0uaW5zZXJ0QmVmb3JlKGRpdixkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdLmZpcnN0Q2hpbGQpOwoJCX0KCX0KfQo=",
	"cint.js": "LyoKIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgR1BMdjMKIENvcHlyaWdodCAyMDEwLCBBbGVzc2FuZHJvIEFyemlsbGkKICovCgokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHsKICAgICQoJyNjYWxlbmRhcicpLmZ1bGxDYWxlbmRhcih7CiAgICAgIGZpcnN0RGF5OiAxLCAvLyBzdGFydCB3aXRoIG1vbmRheQoJICBlZGl0YWJsZTogZmFsc2UsCiAgICAgIGV2ZW50czogIi9jYWxldmVudHM/cT0iK2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSksCgkgIGhlYWRlcjogewoJbGVmdDogJ3ByZXYsbmV4dCB0b2RheScsCgkgICAgY2VudGVyOiAndGl0bGUnLAoJICAgIHJpZ2h0OiAnbW9udGgsYmFzaWNXZWVrJwoJfQogICAgICB9KQogICAgICB9KTsKCg==",
	"dlist.css": "LyoKIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgR1BMdjMKIENvcHlyaWdodCAyMDEwLCBBbGVzc2FuZHJvIEFyemlsbGkKICovCgoqIHsKICAgIGZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOwp9CgphIHsKICAgIGNvbG9yOiBjeWFuOwp9Cgpib2R5IHsKICAgIGJhY2tncm91bmQtY29sb3I6ICMyRDI4Mjg7CiAgICBjb2xvcjogI0VBRThFOTsKICAgIGZvbnQtc2l6ZTogOHB0Owp9CgoucG9wdXAgewogICAgYmFja2dyb3VuZC1jb2xvcjogIzJEMjgyODsKfQoKdGFibGUgewogICAgZm9udC1zaXplOiA4cHQ7Cn0KCi5wcmNoYW5nZSA+IHRkIHsKICAgIHBhZGRpbmctdG9wOiAxMHB4OwogICAgZm9udC1zaXplOiBsYXJnZTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwp9CgouZW50cnkgewogICAgYmFja2dyb3VuZDogbm9uZSByZXBlYXQgc2Nyb2xsIDAgMCAjNTU1NTU1OwogICAgYm9yZGVyOiAxcHggc29saWQgIzQ0NDQ0NDsKfQoKLmVudHJ5ID4gdGQgewogICAgcGFkZGluZzogNHB4Owp9CgouZXRpdGxlIHsKICAgIHdpZHRoOiA2NSU7CiAgICBmb250LXdlaWdodDogYm9sZDsKfQoKLmV0aXRsZSA+IGEgewogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgY29sb3I6ICNFQUU4RTkKfQoKLnByaW9yaXR5YnV0dG9uIHsKICAgIHdpZHRoOiA2MHB4OwogICAgY29sb3I6IGJsYWNrOwogICAgZm9udC1zaXplOiB4eC1zbWFsbDsKfQoKLnByaW9yaXR5Y2xhc3NfTk9XIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGdyZWVuOwp9Ci5wcmlvcml0eWNsYXNzX0xBVEVSIHsKICAgIGJhY2tncm91bmQtY29sb3I6IHllbGxvdzsKfQoucHJpb3JpdHljbGFzc19USU1FRCB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBvcmFuZ2U7Cn0KLnByaW9yaXR5Y2xhc3NfRE9ORSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyYXk7Cn0KLnByaW9yaXR5Y2xhc3NfU1RJQ0tZIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Ymx1ZTsKfQoucHJpb3JpdHljbGFzc19OT1RFUyB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGJsdWU7Cn0KCi5zY3JlcnJvciB7CiAgICBjb2xvcjogcmVkOwogICAgZm9udC13ZWlnaHQ6IGJvbGQ7Cn0=",
	"fullcalendar.css": "LyoKICogRnVsbENhbGVuZGFyIHYxLjQuOSBTdHlsZXNoZWV0CiAqCiAqIEZlZWwgZnJlZSB0byBlZGl0IHRoaXMgZmlsZSB0byBjdXN0b21pemUgdGhlIGxvb2sgb2YgRnVsbENhbGVuZGFyLgogKiBXaGVuIHVwZ3JhZGluZyB0byBuZXdlciB2ZXJzaW9ucywgcGxlYXNlIHVwZ3JhZGUgdGhpcyBmaWxlIGFzIHdlbGwsCiAqIHBvcnRpbmcgb3ZlciBhbnkgY3VzdG9taXphdGlvbnMgYWZ0ZXJ3YXJkcy4KICoKICogRGF0ZTogRnJpIE5vdiAxOSAyMjo0NTo0NCAyMDEwIC0wODAwCiAqCiAqLwogCiAKLyogVE9ETzogbWFrZSBmb250IHNpemVzIGxvb2sgdGhlIHNhbWUgaW4gYWxsIGRvY3R5cGVzICovCgoKLmZjLAouZmMgLmZjLWhlYWRlciwKLmZjIC5mYy1jb250ZW50IHsKCWZvbnQtc2l6ZTogMWVtOwoJfQoJCi5mYyB7CglkaXJlY3Rpb246IGx0cjsKCXRleHQtYWxpZ246IGxlZnQ7Cgl9CgkKLmZjIHRhYmxlIHsKCWJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7Cglib3JkZXItc3BhY2luZzogMDsKCX0KCQouZmMgdGQsIC5mYyB0aCB7CglwYWRkaW5nOiAwOwoJdmVydGljYWwtYWxpZ246IHRvcDsKCX0KCgoKLyogSGVhZGVyCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKdGFibGUuZmMtaGVhZGVyIHsKCXdpZHRoOiAxMDAlOwoJfQoJCi5mYy1oZWFkZXItbGVmdCB7Cgl3aWR0aDogMjUlOwoJfQoJCi5mYy1oZWFkZXItbGVmdCB0YWJsZSB7CglmbG9hdDogbGVmdDsKCX0KCQouZmMtaGVhZGVyLWNlbnRlciB7Cgl3aWR0aDogNTAlOwoJdGV4dC1hbGlnbjogY2VudGVyOwoJfQoJCi5mYy1oZWFkZXItY2VudGVyIHRhYmxlIHsKCW1hcmdpbjogMCBhdXRvOwoJfQoJCi5mYy1oZWFkZXItcmlnaHQgewoJd2lkdGg6IDI1JTsKCX0KCQouZmMtaGVhZGVyLXJpZ2h0IHRhYmxlIHsKCWZsb2F0OiByaWdodDsKCX0KCQouZmMtaGVhZGVyLXRpdGxlIHsKCW1hcmdpbi10b3A6IDA7Cgl3aGl0ZS1zcGFjZTogbm93cmFwOwoJfQoJCi5mYy1oZWFkZXItc3BhY2UgewoJcGFkZGluZy1sZWZ0OiAxMHB4OwoJfQoJCi8qIHJpZ2h0LXRvLWxlZnQgKi8KCi5mYy1ydGwgLmZjLWhlYWRlci10aXRsZSB7CglkaXJlY3Rpb246IHJ0bDsKCX0KCgoKLyogQnV0dG9ucwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCwKLmZjLWhlYWRlciAudWktc3RhdGUtZGVmYXVsdCB7CgltYXJnaW4tYm90dG9tOiAxZW07CgljdXJzb3I6IHBvaW50ZXI7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCB7Cglib3JkZXItd2lkdGg6IDFweCAwOwoJcGFkZGluZzogMCAxcHg7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCwKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBhIHsKCWJvcmRlci1zdHlsZTogc29saWQ7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBhIHsKCWRpc3BsYXk6IGJsb2NrOwoJYm9yZGVyLXdpZHRoOiAwIDFweDsKCW1hcmdpbjogMCAtMXB4OwoJd2lkdGg6IDEwMCU7Cgl0ZXh0LWRlY29yYXRpb246IG5vbmU7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBzcGFuIHsKCWRpc3BsYXk6IGJsb2NrOwoJYm9yZGVyLXN0eWxlOiBzb2xpZDsKCWJvcmRlci13aWR0aDogMXB4IDAgMXB4IDFweDsKCXBhZGRpbmc6IDNweCA1cHg7Cgl9CgkKLmZjLWhlYWRlciAudWktc3RhdGUtZGVmYXVsdCB7CglwYWRkaW5nOiA0cHggNnB4OwoJfQoJCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRlZmF1bHQgc3BhbiwKLmZjLWhlYWRlciAudWktc3RhdGUtZGVmYXVsdCBzcGFuIHsKCXdoaXRlLXNwYWNlOiBub3dyYXA7Cgl9CgkKLyogZm9yIGFkamFjZW50IGJ1dHRvbnMgKi8KCQouZmMtaGVhZGVyIC5mYy1uby1yaWdodCB7CglwYWRkaW5nLXJpZ2h0OiAwOwoJfQoJCi5mYy1oZWFkZXIgLmZjLW5vLXJpZ2h0IGEgewoJbWFyZ2luLXJpZ2h0OiAwOwoJYm9yZGVyLXJpZ2h0OiAwOwoJfQoJCi5mYy1oZWFkZXIgLnVpLW5vLXJpZ2h0IHsKCWJvcmRlci1yaWdodDogMDsKCX0KCQovKiBmb3IgZmFrZSByb3VuZGVkIGNvcm5lcnMgKi8KCQouZmMtaGVhZGVyIC5mYy1jb3JuZXItbGVmdCB7CgltYXJnaW4tbGVmdDogMXB4OwoJcGFkZGluZy1sZWZ0OiAwOwoJfQoJCi5mYy1oZWFkZXIgLmZjLWNvcm5lci1yaWdodCB7CgltYXJnaW4tcmlnaHQ6IDFweDsKCXBhZGRpbmctcmlnaHQ6IDA7Cgl9CgkKLyogREVGQVVMVCBidXR0b24gQ09MT1JTICovCgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCwKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBhIHsKCWJvcmRlci1jb2xvcjogIzc3NzsgLyogb3V0ZXIgYm9yZGVyICovCgljb2xvcjogIzMzMzsKCX0KCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRlZmF1bHQgc3BhbiB7Cglib3JkZXItY29sb3I6ICNmZmYgI2ZmZiAjZDFkMWQxOyAvKiBpbm5lciBib3JkZXIgKi8KCWJhY2tncm91bmQ6ICNlOGU4ZTg7Cgl9CgkKLyogUFJFU1NFRCBidXR0b24gQ09MT1JTIChkb3duIGFuZCBhY3RpdmUpICovCgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtYWN0aXZlIGEgewoJY29sb3I6ICNmZmY7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZG93biBzcGFuLAouZmMtaGVhZGVyIC5mYy1zdGF0ZS1hY3RpdmUgc3BhbiB7CgliYWNrZ3JvdW5kOiAjODg4OwoJYm9yZGVyLWNvbG9yOiAjODA4MDgwICM4MDgwODAgIzkwOTA5MDsgLyogaW5uZXIgYm9yZGVyICovCgl9CgkKLyogRElTQUJMRUQgYnV0dG9uIENPTE9SUyAqLwoJCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRpc2FibGVkIGEgewoJY29sb3I6ICM5OTk7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGlzYWJsZWQsCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRpc2FibGVkIGEgewoJYm9yZGVyLWNvbG9yOiAjY2NjOyAvKiBvdXRlciBib3JkZXIgKi8KCX0KCQouZmMtaGVhZGVyIC5mYy1zdGF0ZS1kaXNhYmxlZCBzcGFuIHsKCWJvcmRlci1jb2xvcjogI2ZmZiAjZmZmICNmMGYwZjA7IC8qIGlubmVyIGJvcmRlciAqLwoJYmFja2dyb3VuZDogI2YwZjBmMDsKCX0KCQoJCgkKLyogQ29udGVudCBBcmVhICYgR2xvYmFsIENlbGwgU3R5bGVzCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKLmZjLXdpZGdldC1jb250ZW50IHsKCWJvcmRlcjogMXB4IHNvbGlkICNjY2M7IC8qIG91dGVyIGJvcmRlciBjb2xvciAqLwoJfQoJCi5mYy1jb250ZW50IHsKCWNsZWFyOiBib3RoOwoJfQoJCi5mYy1jb250ZW50IC5mYy1zdGF0ZS1kZWZhdWx0IHsKCWJvcmRlci1zdHlsZTogc29saWQ7Cglib3JkZXItY29sb3I6ICNjY2M7IC8qIGlubmVyIGJvcmRlciBjb2xvciAqLwoJfQoJCi5mYy1jb250ZW50IC5mYy1zdGF0ZS1oaWdobGlnaHQgeyAvKiB0b2RheSAqLwoJYmFja2dyb3VuZDogI2ZmYzsKCX0KCQouZmMtY29udGVudCAuZmMtbm90LXRvZGF5IHsgLyogb3ZlcnJpZGUganEtdWkgaGlnaGxpZ2h0IChUT0RPOiB1aS13aWRnZXQtY29udGVudCkgKi8KCWJhY2tncm91bmQ6IG5vbmU7Cgl9CgkKLmZjLWNlbGwtb3ZlcmxheSB7IC8qIHNlbWktdHJhbnNwYXJlbnQgcmVjdGFuZ2xlIHdoaWxlIGRyYWdnaW5nICovCgliYWNrZ3JvdW5kOiAjOWNmOwoJb3BhY2l0eTogLjI7CglmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MjApOyAvKiBmb3IgSUUgKi8KCX0KCQouZmMtdmlldyB7IC8qIHByZXZlbnRzIGRyYWdnaW5nIG91dHNpZGUgb2Ygd2lkZ2V0ICovCgl3aWR0aDogMTAwJTsKCW92ZXJmbG93OiBoaWRkZW47Cgl9CgkKCQoJCgoKLyogR2xvYmFsIEV2ZW50IFN0eWxlcwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKLmZjLWV2ZW50LAouZmMtYWdlbmRhIC5mYy1ldmVudC10aW1lLAouZmMtZXZlbnQgYSB7Cglib3JkZXItc3R5bGU6IHNvbGlkOyAKCWJvcmRlci1jb2xvcjogIzM2YzsgICAgIC8qIGRlZmF1bHQgQk9SREVSIGNvbG9yIChwcm9iYWJseSB0aGUgc2FtZSBhcyBiYWNrZ3JvdW5kLWNvbG9yKSAqLwoJYmFja2dyb3VuZC1jb2xvcjogIzM2YzsgLyogZGVmYXVsdCBCQUNLR1JPVU5EIGNvbG9yICovCgljb2xvcjogI2ZmZjsgICAgICAgICAgICAvKiBkZWZhdWx0IFRFWFQgY29sb3IgKi8KCX0KCQoJLyogVXNlIHRoZSAnY2xhc3NOYW1lJyBDYWxFdmVudCBwcm9wZXJ0eSBhbmQgdGhlIGZvbGxvd2luZwoJICogZXhhbXBsZSBDU1MgdG8gY2hhbmdlIGV2ZW50IGNvbG9yIG9uIGEgcGVyLWV2ZW50IGJhc2lzOgoJICoKCSAqIC5teWNsYXNzLAoJICogLmZjLWFnZW5kYSAubXljbGFzcyAuZmMtZXZlbnQtdGltZSwKCSAqIC5teWNsYXNzIGEgewoJICogICAgIGJhY2tncm91bmQtY29sb3I6IGJsYWNrOwoJICogICAgIGJvcmRlci1jb2xvcjogYmxhY2s7CgkgKiAgICAgY29sb3I6IHJlZDsKCSAqICAgICB9CgkgKi8KCSAKLmZjLWV2ZW50IHsKCXRleHQtYWxpZ246IGxlZnQ7Cgl9CgkKLmZjLWV2ZW50IGEgewoJb3ZlcmZsb3c6IGhpZGRlbjsKCWZvbnQtc2l6ZTogLjg1ZW07Cgl0ZXh0LWRlY29yYXRpb246IG5vbmU7CgljdXJzb3I6IHBvaW50ZXI7Cgl9CgkKLmZjLWV2ZW50LWVkaXRhYmxlIHsKCWN1cnNvcjogcG9pbnRlcjsKCX0KCQouZmMtZXZlbnQtdGltZSwKLmZjLWV2ZW50LXRpdGxlIHsKCXBhZGRpbmc6IDAgMXB4OwoJfQoJCi8qIGZvciBmYWtlIHJvdW5kZWQgY29ybmVycyAqLwoKLmZjLWV2ZW50IGEgewoJZGlzcGxheTogYmxvY2s7Cglwb3NpdGlvbjogcmVsYXRpdmU7Cgl3aWR0aDogMTAwJTsKCWhlaWdodDogMTAwJTsKCX0KCQovKiByaWdodC10by1sZWZ0ICovCgouZmMtcnRsIC5mYy1ldmVudCBhIHsKCXRleHQtYWxpZ246IHJpZ2h0OwoJfQoJCi8qIHJlc2l6YWJsZSAqLwoJCi5mYyAudWktcmVzaXphYmxlLWhhbmRsZSB7IC8qKiogVE9ETzogZG9uJ3QgdXNlIHVpLXJlc2l6YWJsZSBhbm95bW9yZSwgY2hhbmdlIGNsYXNzICoqKi8KCWRpc3BsYXk6IGJsb2NrOwoJcG9zaXRpb246IGFic29sdXRlOwoJei1pbmRleDogOTk5OTk7Cglib3JkZXI6IDAgIWltcG9ydGFudDsgLyogaW1wb3J0YW50IG92ZXJyaWRlcyBwcmUganF1ZXJ5IHVpIDEuNyBzdHlsZXMgKi8KCWJhY2tncm91bmQ6IHVybChkYXRhOmltYWdlL2dpZjtiYXNlNjQsQUFBQSkgIWltcG9ydGFudDsgLyogaG92ZXIgZml4IGZvciBJRSAqLwoJfQoJCgkKCQovKiBIb3Jpem9udGFsIEV2ZW50cwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKLmZjLWV2ZW50LWhvcmkgewoJYm9yZGVyLXdpZHRoOiAxcHggMDsKCW1hcmdpbi1ib3R0b206IDFweDsKCX0KCQouZmMtZXZlbnQtaG9yaSBhIHsKCWJvcmRlci13aWR0aDogMDsKCX0KCQovKiBmb3IgZmFrZSByb3VuZGVkIGNvcm5lcnMgKi8KCQouZmMtY29udGVudCAuZmMtY29ybmVyLWxlZnQgewoJbWFyZ2luLWxlZnQ6IDFweDsKCX0KCQouZmMtY29udGVudCAuZmMtY29ybmVyLWxlZnQgYSB7CgltYXJnaW4tbGVmdDogLTFweDsKCWJvcmRlci1sZWZ0LXdpZHRoOiAxcHg7Cgl9CgkKLmZjLWNvbnRlbnQgLmZjLWNvcm5lci1yaWdodCB7CgltYXJnaW4tcmlnaHQ6IDFweDsKCX0KCQouZmMtY29udGVudCAuZmMtY29ybmVyLXJpZ2h0IGEgewoJbWFyZ2luLXJpZ2h0OiAtMXB4OwoJYm9yZGVyLXJpZ2h0LXdpZHRoOiAxcHg7Cgl9CgkKLyogcmVzaXphYmxlICovCgkKLmZjLWV2ZW50LWhvcmkgLnVpLXJlc2l6YWJsZS1lIHsKCXRvcDogMCAgICAgICAgICAgIWltcG9ydGFudDsgLyogaW1wb3J0YW50cyBvdmVycmlkZSBwcmUganF1ZXJ5IHVpIDEuNyBzdHlsZXMgKi8KCXJpZ2h0OiAtM3B4ICAgICAgIWltcG9ydGFudDsKCXdpZHRoOiA3cHggICAgICAgIWltcG9ydGFudDsKCWhlaWdodDogMTAwJSAgICAgIWltcG9ydGFudDsKCWN1cnNvcjogZS1yZXNpemU7Cgl9CgkKLmZjLWV2ZW50LWhvcmkgLnVpLXJlc2l6YWJsZS13IHsKCXRvcDogMCAgICAgICAgICAgIWltcG9ydGFudDsKCWxlZnQ6IC0zcHggICAgICAgIWltcG9ydGFudDsKCXdpZHRoOiA3cHggICAgICAgIWltcG9ydGFudDsKCWhlaWdodDogMTAwJSAgICAgIWltcG9ydGFudDsKCWN1cnNvcjogdy1yZXNpemU7Cgl9CgkKLmZjLWV2ZW50LWhvcmkgLnVpLXJlc2l6YWJsZS1oYW5kbGUgewoJX3BhZGRpbmctYm90dG9tOiAxNHB4OyAvKiBJRTYgaGFkIDAgaGVpZ2h0ICovCgl9CgkKCQoJCgovKiBNb250aCBWaWV3LCBCYXNpYyBXZWVrIFZpZXcsIEJhc2ljIERheSBWaWV3Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgouZmMtZ3JpZCB0YWJsZSB7Cgl3aWR0aDogMTAwJTsKCX0KCQouZmMgLmZjLWdyaWQgdGggewoJYm9yZGVyLXdpZHRoOiAwIDAgMCAxcHg7Cgl0ZXh0LWFsaWduOiBjZW50ZXI7Cgl9CgkKLmZjIC5mYy1ncmlkIHRkIHsKCWJvcmRlci13aWR0aDogMXB4IDAgMCAxcHg7Cgl9CgkKLmZjLWdyaWQgdGguZmMtbGVmdG1vc3QsCi5mYy1ncmlkIHRkLmZjLWxlZnRtb3N0IHsKCWJvcmRlci1sZWZ0OiAwOwoJfQoJCi5mYy1ncmlkIC5mYy1kYXktbnVtYmVyIHsKCWZsb2F0OiByaWdodDsKCXBhZGRpbmc6IDAgMnB4OwoJfQoJCi5mYy1ncmlkIC5mYy1vdGhlci1tb250aCAuZmMtZGF5LW51bWJlciB7CglvcGFjaXR5OiAwLjM7CglmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MzApOyAvKiBmb3IgSUUgKi8KCS8qIG9wYWNpdHkgd2l0aCBzbWFsbCBmb250IGNhbiBzb21ldGltZXMgbG9vayB0b28gZmFkZWQKCSAgIG1pZ2h0IHdhbnQgdG8gc2V0IHRoZSAnY29sb3InIHByb3BlcnR5IGluc3RlYWQKCSAgIG1ha2luZyBkYXktbnVtYmVycyBib2xkIGFsc28gZml4ZXMgdGhlIHByb2JsZW0gKi8KCX0KCQouZmMtZ3JpZCAuZmMtZGF5LWNvbnRlbnQgewoJY2xlYXI6IGJvdGg7CglwYWRkaW5nOiAycHggMnB4IDA7IC8qIGRpc3RhbmNlIGJldHdlZW4gZXZlbnRzIGFuZCBkYXkgZWRnZXMgKi8KCX0KCQovKiBldmVudCBzdHlsZXMgKi8KCQouZmMtZ3JpZCAuZmMtZXZlbnQtdGltZSB7Cglmb250LXdlaWdodDogYm9sZDsKCX0KCQovKiByaWdodC10by1sZWZ0ICovCgouZmMtcnRsIC5mYy1ncmlkIHsKCWRpcmVjdGlvbjogcnRsOwoJfQoJCi5mYy1ydGwgLmZjLWdyaWQgLmZjLWRheS1udW1iZXIgewoJZmxvYXQ6IGxlZnQ7Cgl9CgkKLmZjLXJ0bCAuZmMtZ3JpZCAuZmMtZXZlbnQtdGltZSB7CglmbG9hdDogcmlnaHQ7Cgl9CgkKLyogQWdlbmRhIFdlZWsgVmlldywgQWdlbmRhIERheSBWaWV3Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgouZmMgLmZjLWFnZW5kYSB0aCwKLmZjIC5mYy1hZ2VuZGEgdGQgewoJYm9yZGVyLXdpZHRoOiAxcHggMCAwIDFweDsKCX0KCQouZmMgLmZjLWFnZW5kYSAuZmMtbGVmdG1vc3QgewoJYm9yZGVyLWxlZnQ6IDA7Cgl9CgkKLmZjLWFnZW5kYSB0ci5mYy1maXJzdCB0aCwKLmZjLWFnZW5kYSB0ci5mYy1maXJzdCB0ZCB7Cglib3JkZXItdG9wOiAwOwoJfQoJCi5mYy1hZ2VuZGEtaGVhZCB0ci5mYy1sYXN0IHRoIHsKCWJvcmRlci1ib3R0b20td2lkdGg6IDFweDsKCX0KCQouZmMgLmZjLWFnZW5kYS1oZWFkIHRkLAouZmMgLmZjLWFnZW5kYS1ib2R5IHRkIHsKCWJhY2tncm91bmQ6IG5vbmU7Cgl9CgkKLmZjLWFnZW5kYS1oZWFkIHRoIHsKCXRleHQtYWxpZ246IGNlbnRlcjsKCX0KCQovKiB0aGUgdGltZSBheGlzIHJ1bm5pbmcgZG93biB0aGUgbGVmdCBzaWRlICovCgkKLmZjLWFnZW5kYSAuZmMtYXhpcyB7Cgl3aWR0aDogNTBweDsKCXBhZGRpbmc6IDAgNHB4OwoJdmVydGljYWwtYWxpZ246IG1pZGRsZTsKCXdoaXRlLXNwYWNlOiBub3dyYXA7Cgl0ZXh0LWFsaWduOiByaWdodDsKCWZvbnQtd2VpZ2h0OiBub3JtYWw7Cgl9CgkKLyogYWxsLWRheSBldmVudCBjZWxscyBhdCB0b3AgKi8KCQouZmMtYWdlbmRhLWhlYWQgdHIuZmMtYWxsLWRheSB0aCB7CgloZWlnaHQ6IDM1cHg7Cgl9CgkKLmZjLWFnZW5kYS1oZWFkIHRkIHsKCXBhZGRpbmctYm90dG9tOiAxMHB4OwoJfQoJCi5mYyAuZmMtZGl2aWRlciBkaXYgewoJZm9udC1zaXplOiAxcHg7IC8qIGZvciBJRTYvNyAqLwoJaGVpZ2h0OiAycHg7Cgl9CgkKLmZjIC5mYy1kaXZpZGVyIC5mYy1zdGF0ZS1kZWZhdWx0IHsKCWJhY2tncm91bmQ6ICNlZWU7IC8qIGNvbG9yIGZvciBkaXZpZGVyIGJldHdlZW4gYWxsLWRheSBhbmQgdGltZS1zbG90IGV2ZW50cyAqLwoJfQoKLyogYm9keSBzdHlsZXMgKi8KCQouZmMgLmZjLWFnZW5kYS1ib2R5IHRkIGRpdiB7CgloZWlnaHQ6IDIwcHg7IC8qIHNsb3QgaGVpZ2h0ICovCgl9CgkKLmZjIC5mYy1hZ2VuZGEtYm9keSB0ci5mYy1taW5vciB0aCwKLmZjIC5mYy1hZ2VuZGEtYm9keSB0ci5mYy1taW5vciB0ZCB7Cglib3JkZXItdG9wLXN0eWxlOiBkb3R0ZWQ7Cgl9CgkKLmZjLWFnZW5kYSAuZmMtZGF5LWNvbnRlbnQgewoJcGFkZGluZzogMnB4IDJweCAwOyAvKiBkaXN0YW5jZSBiZXR3ZWVuIGV2ZW50cyBhbmQgZGF5IGVkZ2VzICovCgl9CgkKLyogdmVydGljYWwgYmFja2dyb3VuZCBjb2x1bW5zICovCgouZmMgLmZjLWFnZW5kYS1iZyAudWktc3RhdGUtaGlnaGxpZ2h0IHsKCWJhY2tncm91bmQtaW1hZ2U6IG5vbmU7IC8qIHRhbGwgY29sdW1uLCBkb24ndCB3YW50IHJlcGVhdGluZyBiYWNrZ3JvdW5kIGltYWdlICovCgl9CgkKCgovKiBWZXJ0aWNhbCBFdmVudHMKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCi5mYy1ldmVudC12ZXJ0IHsKCWJvcmRlci13aWR0aDogMCAxcHg7Cgl9CgkKLmZjLWV2ZW50LXZlcnQgYSB7Cglib3JkZXItd2lkdGg6IDA7Cgl9CgkKLyogZm9yIGZha2Ugcm91bmRlZCBjb3JuZXJzICovCgkKLmZjLWNvbnRlbnQgLmZjLWNvcm5lci10b3AgewoJbWFyZ2luLXRvcDogMXB4OwoJfQoJCi5mYy1jb250ZW50IC5mYy1jb3JuZXItdG9wIGEgewoJbWFyZ2luLXRvcDogLTFweDsKCWJvcmRlci10b3Atd2lkdGg6IDFweDsKCX0KCQouZmMtY29udGVudCAuZmMtY29ybmVyLWJvdHRvbSB7CgltYXJnaW4tYm90dG9tOiAxcHg7Cgl9CgkKLmZjLWNvbnRlbnQgLmZjLWNvcm5lci1ib3R0b20gYSB7CgltYXJnaW4tYm90dG9tOiAtMXB4OwoJYm9yZGVyLWJvdHRvbS13aWR0aDogMXB4OwoJfQoJCi8qIGV2ZW50IGNvbnRlbnQgKi8KCQouZmMtZXZlbnQtdmVydCBzcGFuIHsKCWRpc3BsYXk6IGJsb2NrOwoJcG9zaXRpb246IHJlbGF0aXZlOwoJei1pbmRleDogMjsKCX0KCQouZmMtZXZlbnQtdmVydCBzcGFuLmZjLWV2ZW50LXRpbWUgewoJd2hpdGUtc3BhY2U6IG5vd3JhcDsKCV93aGl0ZS1zcGFjZTogbm9ybWFsOwoJb3ZlcmZsb3c6IGhpZGRlbjsKCWJvcmRlcjogMDsKCWZvbnQtc2l6ZTogMTBweDsKCX0KCQouZmMtZXZlbnQtdmVydCBzcGFuLmZjLWV2ZW50LXRpdGxlIHsKCWxpbmUtaGVpZ2h0OiAxM3B4OwoJfQoJCi5mYy1ldmVudC12ZXJ0IHNwYW4uZmMtZXZlbnQtYmcgeyAvKiBtYWtlcyB0aGUgZXZlbnQgbGlnaHRlciB3LyBhIHNlbWktdHJhbnNwYXJlbnQgb3ZlcmxheSAgKi8KCXBvc2l0aW9uOiBhYnNvbHV0ZTsKCXotaW5kZXg6IDE7Cgl0b3A6IDA7CglsZWZ0OiAwOwoJd2lkdGg6IDEwMCU7CgloZWlnaHQ6IDEwMCU7CgliYWNrZ3JvdW5kOiAjZmZmOwoJb3BhY2l0eTogLjM7CglmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MzApOyAvKiBmb3IgSUUgKi8KCX0KCQovKiByZXNpemFibGUgKi8KCQouZmMtZXZlbnQtdmVydCAudWktcmVzaXphYmxlLXMgewoJYm90dG9tOiAwICAgICAgICAhaW1wb3J0YW50OyAvKiBpbXBvcnRhbnRzIG92ZXJyaWRlIHByZSBqcXVlcnkgdWkgMS43IHN0eWxlcyAqLwoJd2lkdGg6IDEwMCUgICAgICAhaW1wb3J0YW50OwoJaGVpZ2h0OiA4cHggICAgICAhaW1wb3J0YW50OwoJbGluZS1oZWlnaHQ6IDhweCAhaW1wb3J0YW50OwoJZm9udC1zaXplOiAxMXB4ICAhaW1wb3J0YW50OwoJZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsKCXRleHQtYWxpZ246IGNlbnRlcjsKCWN1cnNvcjogcy1yZXNpemU7Cgl9CgkKCQo=",
	"fullcalendar.js": "LyoqCiAqIEBwcmVzZXJ2ZQogKiBGdWxsQ2FsZW5kYXIgdjEuNC45CiAqIGh0dHA6Ly9hcnNoYXcuY29tL2Z1bGxjYWxlbmRhci8KICoKICogVXNlIGZ1bGxjYWxlbmRhci5jc3MgZm9yIGJhc2ljIHN0eWxpbmcuCiAqIEZvciBldmVudCBkcmFnICYgZHJvcCwgcmVxdWlyZXMgalF1ZXJ5IFVJIGRyYWdnYWJsZS4KICogRm9yIGV2ZW50IHJlc2l6aW5nLCByZXF1aXJlcyBqUXVlcnkgVUkgcmVzaXphYmxlLgogKgogKiBDb3B5cmlnaHQgKGMpIDIwMTAgQWRhbSBTaGF3CiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzLCBsb2NhdGVkIGluCiAqIE1JVC1MSUNFTlNFLnR4dCBhbmQgR1BMLUxJQ0VOU0UudHh0IHJlc3BlY3RpdmVseS4KICoKICogRGF0ZTogRnJpIE5vdiAxOSAyMjo0NTo0NCAyMDEwIC0wODAwCiAqCiAqLwogCihmdW5jdGlvbigkLCB1bmRlZmluZWQpIHsKCgp2YXIgZGVmYXVsdHMgPSB7CgoJLy8gZGlzcGxheQoJZGVmYXVsdFZpZXc6ICdtb250aCcsCglhc3BlY3RSYXRpbzogMS4zNSwKCWhlYWRlcjogewoJCWxlZnQ6ICd0aXRsZScsCgkJY2VudGVyOiAnJywKCQlyaWdodDogJ3RvZGF5IHByZXYsbmV4dCcKCX0sCgl3ZWVrZW5kczogdHJ1ZSwKCQoJLy8gZWRpdGluZwoJLy9lZGl0YWJsZTogZmFsc2UsCgkvL2Rpc2FibGVEcmFnZ2luZzogZmFsc2UsCgkvL2Rpc2FibGVSZXNpemluZzogZmFsc2UsCgkKCWFsbERheURlZmF1bHQ6IHRydWUsCglpZ25vcmVUaW1lem9uZTogdHJ1ZSwKCQoJLy8gZXZlbnQgYWpheAoJbGF6eUZldGNoaW5nOiB0cnVlLAoJc3RhcnRQYXJhbTogJ3N0YXJ0JywKCWVuZFBhcmFtOiAnZW5kJywKCQoJLy8gdGltZSBmb3JtYXRzCgl0aXRsZUZvcm1hdDogewoJCW1vbnRoOiAnTU1NTSB5eXl5JywKCQl3ZWVrOiAiTU1NIGRbIHl5eXldeyAnJiM4MjEyOydbIE1NTV0gZCB5eXl5fSIsCgkJZGF5OiAnZGRkZCwgTU1NIGQsIHl5eXknCgl9LAoJY29sdW1uRm9ybWF0OiB7CgkJbW9udGg6ICdkZGQnLAoJCXdlZWs6ICdkZGQgTS9kJywKCQlkYXk6ICdkZGRkIE0vZCcKCX0sCgl0aW1lRm9ybWF0OiB7IC8vIGZvciBldmVudCBlbGVtZW50cwoJCScnOiAnaCg6bW0pdCcgLy8gZGVmYXVsdAoJfSwKCQoJLy8gbG9jYWxlCglpc1JUTDogZmFsc2UsCglmaXJzdERheTogMCwKCW1vbnRoTmFtZXM6IFsnSmFudWFyeScsJ0ZlYnJ1YXJ5JywnTWFyY2gnLCdBcHJpbCcsJ01heScsJ0p1bmUnLCdKdWx5JywnQXVndXN0JywnU2VwdGVtYmVyJywnT2N0b2JlcicsJ05vdmVtYmVyJywnRGVjZW1iZXInXSwKCW1vbnRoTmFtZXNTaG9ydDogWydKYW4nLCdGZWInLCdNYXInLCdBcHInLCdNYXknLCdKdW4nLCdKdWwnLCdBdWcnLCdTZXAnLCdPY3QnLCdOb3YnLCdEZWMnXSwKCWRheU5hbWVzOiBbJ1N1bmRheScsJ01vbmRheScsJ1R1ZXNkYXknLCdXZWRuZXNkYXknLCdUaHVyc2RheScsJ0ZyaWRheScsJ1NhdHVyZGF5J10sCglkYXlOYW1lc1Nob3J0OiBbJ1N1bicsJ01vbicsJ1R1ZScsJ1dlZCcsJ1RodScsJ0ZyaScsJ1NhdCddLAoJYnV0dG9uVGV4dDogewoJCXByZXY6ICcmbmJzcDsmIzk2Njg7Jm5ic3A7JywKCQluZXh0OiAnJm5ic3A7JiM5NjU4OyZuYnNwOycsCgkJcHJldlllYXI6ICcmbmJzcDsmbHQ7Jmx0OyZuYnNwOycsCgkJbmV4dFllYXI6ICcmbmJzcDsmZ3Q7Jmd0OyZuYnNwOycsCgkJdG9kYXk6ICd0b2RheScsCgkJbW9udGg6ICdtb250aCcsCgkJd2VlazogJ3dlZWsnLAoJCWRheTogJ2RheScKCX0sCgkKCS8vIGpxdWVyeS11aSB0aGVtaW5nCgl0aGVtZTogZmFsc2UsCglidXR0b25JY29uczogewoJCXByZXY6ICdjaXJjbGUtdHJpYW5nbGUtdycsCgkJbmV4dDogJ2NpcmNsZS10cmlhbmdsZS1lJwoJfSwKCQoJLy9zZWxlY3RhYmxlOiBmYWxzZSwKCXVuc2VsZWN0QXV0bzogdHJ1ZSwKCQoJZHJvcEFjY2VwdDogJyonCgkKfTsKCi8vIHJpZ2h0LXRvLWxlZnQgZGVmYXVsdHMKdmFyIHJ0bERlZmF1bHRzID0gewoJaGVhZGVyOiB7CgkJbGVmdDogJ25leHQscHJldiB0b2RheScsCgkJY2VudGVyOiAnJywKCQlyaWdodDogJ3RpdGxlJwoJfSwKCWJ1dHRvblRleHQ6IHsKCQlwcmV2OiAnJm5ic3A7JiM5NjU4OyZuYnNwOycsCgkJbmV4dDogJyZuYnNwOyYjOTY2ODsmbmJzcDsnLAoJCXByZXZZZWFyOiAnJm5ic3A7Jmd0OyZndDsmbmJzcDsnLAoJCW5leHRZZWFyOiAnJm5ic3A7Jmx0OyZsdDsmbmJzcDsnCgl9LAoJYnV0dG9uSWNvbnM6IHsKCQlwcmV2OiAnY2lyY2xlLXRyaWFuZ2xlLWUnLAoJCW5leHQ6ICdjaXJjbGUtdHJpYW5nbGUtdycKCX0KfTsKCgoKdmFyIGZjID0gJC5mdWxsQ2FsZW5kYXIgPSB7IHZlcnNpb246ICIxLjQuOSIgfTsKdmFyIGZjVmlld3MgPSBmYy52aWV3cyA9IHt9OwoKCiQuZm4uZnVsbENhbGVuZGFyID0gZnVuY3Rpb24ob3B0aW9ucykgewoKCgkvLyBtZXRob2QgY2FsbGluZwoJaWYgKHR5cGVvZiBvcHRpb25zID09ICdzdHJpbmcnKSB7CgkJdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwoJCXZhciByZXM7CgkJdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQl2YXIgY2FsZW5kYXIgPSAkLmRhdGEodGhpcywgJ2Z1bGxDYWxlbmRhcicpOwoJCQlpZiAoY2FsZW5kYXIgJiYgJC5pc0Z1bmN0aW9uKGNhbGVuZGFyW29wdGlvbnNdKSkgewoJCQkJdmFyIHIgPSBjYWxlbmRhcltvcHRpb25zXS5hcHBseShjYWxlbmRhciwgYXJncyk7CgkJCQlpZiAocmVzID09PSB1bmRlZmluZWQpIHsKCQkJCQlyZXMgPSByOwoJCQkJfQoJCQkJaWYgKG9wdGlvbnMgPT0gJ2Rlc3Ryb3knKSB7CgkJCQkJJC5yZW1vdmVEYXRhKHRoaXMsICdmdWxsQ2FsZW5kYXInKTsKCQkJCX0KCQkJfQoJCX0pOwoJCWlmIChyZXMgIT09IHVuZGVmaW5lZCkgewoJCQlyZXR1cm4gcmVzOwoJCX0KCQlyZXR1cm4gdGhpczsKCX0KCQoJCgkvLyB3b3VsZCBsaWtlIHRvIGhhdmUgdGhpcyBsb2dpYyBpbiBFdmVudE1hbmFnZXIsIGJ1dCBuZWVkcyB0byBoYXBwZW4gYmVmb3JlIG9wdGlvbnMgYXJlIHJlY3Vyc2l2ZWx5IGV4dGVuZGVkCgl2YXIgZXZlbnRTb3VyY2VzID0gb3B0aW9ucy5ldmVudFNvdXJjZXMgfHwgW107CglkZWxldGUgb3B0aW9ucy5ldmVudFNvdXJjZXM7CglpZiAob3B0aW9ucy5ldmVudHMpIHsKCQlldmVudFNvdXJjZXMucHVzaChvcHRpb25zLmV2ZW50cyk7CgkJZGVsZXRlIG9wdGlvbnMuZXZlbnRzOwoJfQoJCgoJb3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LAoJCWRlZmF1bHRzLAoJCShvcHRpb25zLmlzUlRMIHx8IG9wdGlvbnMuaXNSVEw9PT11bmRlZmluZWQgJiYgZGVmYXVsdHMuaXNSVEwpID8gcnRsRGVmYXVsdHMgOiB7fSwKCQlvcHRpb25zCgkpOwoJCgkKCXRoaXMuZWFjaChmdW5jdGlvbihpLCBfZWxlbWVudCkgewoJCXZhciBlbGVtZW50ID0gJChfZWxlbWVudCk7CgkJdmFyIGNhbGVuZGFyID0gbmV3IENhbGVuZGFyKGVsZW1lbnQsIG9wdGlvbnMsIGV2ZW50U291cmNlcyk7CgkJZWxlbWVudC5kYXRhKCdmdWxsQ2FsZW5kYXInLCBjYWxlbmRhcik7IC8vIFRPRE86IGxvb2sgaW50byBtZW1vcnkgbGVhayBpbXBsaWNhdGlvbnMKCQljYWxlbmRhci5yZW5kZXIoKTsKCX0pOwoJCgkKCXJldHVybiB0aGlzOwoJCn07CgoKLy8gZnVuY3Rpb24gZm9yIGFkZGluZy9vdmVycmlkaW5nIGRlZmF1bHRzCmZ1bmN0aW9uIHNldERlZmF1bHRzKGQpIHsKCSQuZXh0ZW5kKHRydWUsIGRlZmF1bHRzLCBkKTsKfQoKCgogCmZ1bmN0aW9uIENhbGVuZGFyKGVsZW1lbnQsIG9wdGlvbnMsIGV2ZW50U291cmNlcykgewoJdmFyIHQgPSB0aGlzOwoJCgkKCS8vIGV4cG9ydHMKCXQub3B0aW9ucyA9IG9wdGlvbnM7Cgl0LnJlbmRlciA9IHJlbmRlcjsKCXQuZGVzdHJveSA9IGRlc3Ryb3k7Cgl0LnJlZmV0Y2hFdmVudHMgPSByZWZldGNoRXZlbnRzOwoJdC5yZXBvcnRFdmVudHMgPSByZXBvcnRFdmVudHM7Cgl0LnJlcG9ydEV2ZW50Q2hhbmdlID0gcmVwb3J0RXZlbnRDaGFuZ2U7Cgl0LmNoYW5nZVZpZXcgPSBjaGFuZ2VWaWV3OwoJdC5zZWxlY3QgPSBzZWxlY3Q7Cgl0LnVuc2VsZWN0ID0gdW5zZWxlY3Q7Cgl0LnByZXYgPSBwcmV2OwoJdC5uZXh0ID0gbmV4dDsKCXQucHJldlllYXIgPSBwcmV2WWVhcjsKCXQubmV4dFllYXIgPSBuZXh0WWVhcjsKCXQudG9kYXkgPSB0b2RheTsKCXQuZ290b0RhdGUgPSBnb3RvRGF0ZTsKCXQuaW5jcmVtZW50RGF0ZSA9IGluY3JlbWVudERhdGU7Cgl0LmZvcm1hdERhdGUgPSBmdW5jdGlvbihmb3JtYXQsIGRhdGUpIHsgcmV0dXJuIGZvcm1hdERhdGUoZm9ybWF0LCBkYXRlLCBvcHRpb25zKSB9OwoJdC5mb3JtYXREYXRlcyA9IGZ1bmN0aW9uKGZvcm1hdCwgZGF0ZTEsIGRhdGUyKSB7IHJldHVybiBmb3JtYXREYXRlcyhmb3JtYXQsIGRhdGUxLCBkYXRlMiwgb3B0aW9ucykgfTsKCXQuZ2V0RGF0ZSA9IGdldERhdGU7Cgl0LmdldFZpZXcgPSBnZXRWaWV3OwoJdC5vcHRpb24gPSBvcHRpb247Cgl0LnRyaWdnZXIgPSB0cmlnZ2VyOwoJCgkKCS8vIGltcG9ydHMKCUV2ZW50TWFuYWdlci5jYWxsKHQsIG9wdGlvbnMsIGV2ZW50U291cmNlcyk7Cgl2YXIgaXNGZXRjaE5lZWRlZCA9IHQuaXNGZXRjaE5lZWRlZDsKCXZhciBmZXRjaEV2ZW50cyA9IHQuZmV0Y2hFdmVudHM7CgkKCQoJLy8gbG9jYWxzCgl2YXIgX2VsZW1lbnQgPSBlbGVtZW50WzBdOwoJdmFyIGhlYWRlcjsKCXZhciBoZWFkZXJFbGVtZW50OwoJdmFyIGNvbnRlbnQ7Cgl2YXIgdG07IC8vIGZvciBtYWtpbmcgdGhlbWUgY2xhc3NlcwoJdmFyIGN1cnJlbnRWaWV3OwoJdmFyIHZpZXdJbnN0YW5jZXMgPSB7fTsKCXZhciBlbGVtZW50T3V0ZXJXaWR0aDsKCXZhciBzdWdnZXN0ZWRWaWV3SGVpZ2h0OwoJdmFyIGFic29sdXRlVmlld0VsZW1lbnQ7Cgl2YXIgcmVzaXplVUlEID0gMDsKCXZhciBpZ25vcmVXaW5kb3dSZXNpemUgPSAwOwoJdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwoJdmFyIGV2ZW50cyA9IFtdOwoJdmFyIF9kcmFnRWxlbWVudDsKCQoJCgkKCS8qIE1haW4gUmVuZGVyaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJc2V0WU1EKGRhdGUsIG9wdGlvbnMueWVhciwgb3B0aW9ucy5tb250aCwgb3B0aW9ucy5kYXRlKTsKCQoJCglmdW5jdGlvbiByZW5kZXIoaW5jKSB7CgkJaWYgKCFjb250ZW50KSB7CgkJCWluaXRpYWxSZW5kZXIoKTsKCQl9ZWxzZXsKCQkJY2FsY1NpemUoKTsKCQkJbWFya1NpemVzRGlydHkoKTsKCQkJbWFya0V2ZW50c0RpcnR5KCk7CgkJCXJlbmRlclZpZXcoaW5jKTsKCQl9Cgl9CgkKCQoJZnVuY3Rpb24gaW5pdGlhbFJlbmRlcigpIHsKCQl0bSA9IG9wdGlvbnMudGhlbWUgPyAndWknIDogJ2ZjJzsKCQllbGVtZW50LmFkZENsYXNzKCdmYycpOwoJCWlmIChvcHRpb25zLmlzUlRMKSB7CgkJCWVsZW1lbnQuYWRkQ2xhc3MoJ2ZjLXJ0bCcpOwoJCX0KCQlpZiAob3B0aW9ucy50aGVtZSkgewoJCQllbGVtZW50LmFkZENsYXNzKCd1aS13aWRnZXQnKTsKCQl9CgkJY29udGVudCA9ICQoIjxkaXYgY2xhc3M9J2ZjLWNvbnRlbnQgIiArIHRtICsgIi13aWRnZXQtY29udGVudCcgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlJy8+IikKCQkJLnByZXBlbmRUbyhlbGVtZW50KTsKCQloZWFkZXIgPSBuZXcgSGVhZGVyKHQsIG9wdGlvbnMpOwoJCWhlYWRlckVsZW1lbnQgPSBoZWFkZXIucmVuZGVyKCk7CgkJaWYgKGhlYWRlckVsZW1lbnQpIHsKCQkJZWxlbWVudC5wcmVwZW5kKGhlYWRlckVsZW1lbnQpOwoJCX0KCQljaGFuZ2VWaWV3KG9wdGlvbnMuZGVmYXVsdFZpZXcpOwoJCSQod2luZG93KS5yZXNpemUod2luZG93UmVzaXplKTsKCQkvLyBuZWVkZWQgZm9yIElFIGluIGEgMHgwIGlmcmFtZSwgYi9jIHdoZW4gaXQgaXMgcmVzaXplZCwgbmV2ZXIgdHJpZ2dlcnMgYSB3aW5kb3dSZXNpemUKCQlpZiAoIWJvZHlWaXNpYmxlKCkpIHsKCQkJbGF0ZVJlbmRlcigpOwoJCX0KCX0KCQoJCgkvLyBjYWxsZWQgd2hlbiB3ZSBrbm93IHRoZSBjYWxlbmRhciBjb3VsZG4ndCBiZSByZW5kZXJlZCB3aGVuIGl0IHdhcyBpbml0aWFsaXplZCwKCS8vIGJ1dCB3ZSB0aGluayBpdCdzIHJlYWR5IG5vdwoJZnVuY3Rpb24gbGF0ZVJlbmRlcigpIHsKCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyAvLyBJRTcgbmVlZHMgdGhpcyBzbyBkaW1lbnNpb25zIGFyZSBjYWxjdWxhdGVkIGNvcnJlY3RseQoJCQlpZiAoIWN1cnJlbnRWaWV3LnN0YXJ0ICYmIGJvZHlWaXNpYmxlKCkpIHsgLy8gIWN1cnJlbnRWaWV3LnN0YXJ0IG1ha2VzIHN1cmUgdGhpcyBuZXZlciBoYXBwZW5zIG1vcmUgdGhhbiBvbmNlCgkJCQlyZW5kZXJWaWV3KCk7CgkJCX0KCQl9LDApOwoJfQoJCgkKCWZ1bmN0aW9uIGRlc3Ryb3koKSB7CgkJJCh3aW5kb3cpLnVuYmluZCgncmVzaXplJywgd2luZG93UmVzaXplKTsKCQloZWFkZXIuZGVzdHJveSgpOwoJCWNvbnRlbnQucmVtb3ZlKCk7CgkJZWxlbWVudC5yZW1vdmVDbGFzcygnZmMgZmMtcnRsIGZjLXVpLXdpZGdldCcpOwoJfQoJCgkKCQoJZnVuY3Rpb24gZWxlbWVudFZpc2libGUoKSB7CgkJcmV0dXJuIF9lbGVtZW50Lm9mZnNldFdpZHRoICE9PSAwOwoJfQoJCgkKCWZ1bmN0aW9uIGJvZHlWaXNpYmxlKCkgewoJCXJldHVybiAkKCdib2R5JylbMF0ub2Zmc2V0V2lkdGggIT09IDA7Cgl9CgkKCQoJCgkvKiBWaWV3IFJlbmRlcmluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIGNoYW5nZVZpZXcobmV3Vmlld05hbWUpIHsKCQlpZiAoIWN1cnJlbnRWaWV3IHx8IG5ld1ZpZXdOYW1lICE9IGN1cnJlbnRWaWV3Lm5hbWUpIHsKCQkJaWdub3JlV2luZG93UmVzaXplKys7IC8vIGJlY2F1c2Ugc2V0TWluSGVpZ2h0IG1pZ2h0IGNoYW5nZSB0aGUgaGVpZ2h0IGJlZm9yZSByZW5kZXIgKGFuZCBzdWJzZXF1ZW50bHkgc2V0U2l6ZSkgaXMgcmVhY2hlZAoKCQkJdW5zZWxlY3QoKTsKCQkJCgkJCXZhciBvbGRWaWV3ID0gY3VycmVudFZpZXc7CgkJCXZhciBuZXdWaWV3RWxlbWVudDsKCQkJCQoJCQlpZiAob2xkVmlldykgewoJCQkJKG9sZFZpZXcuYmVmb3JlSGlkZSB8fCBub29wKSgpOyAvLyBjYWxsZWQgYmVmb3JlIGNoYW5naW5nIG1pbi1oZWlnaHQuIGlmIGNhbGxlZCBhZnRlciwgc2Nyb2xsIHN0YXRlIGlzIHJlc2V0IChpbiBPcGVyYSkKCQkJCXNldE1pbkhlaWdodChjb250ZW50LCBjb250ZW50LmhlaWdodCgpKTsKCQkJCW9sZFZpZXcuZWxlbWVudC5oaWRlKCk7CgkJCX1lbHNlewoJCQkJc2V0TWluSGVpZ2h0KGNvbnRlbnQsIDEpOyAvLyBuZWVkcyB0byBiZSAxIChub3QgMCkgZm9yIElFNywgb3IgZWxzZSB2aWV3IGRpbWVuc2lvbnMgbWlzY2FsY3VsYXRlZAoJCQl9CgkJCWNvbnRlbnQuY3NzKCdvdmVyZmxvdycsICdoaWRkZW4nKTsKCQkJCgkJCWN1cnJlbnRWaWV3ID0gdmlld0luc3RhbmNlc1tuZXdWaWV3TmFtZV07CgkJCWlmIChjdXJyZW50VmlldykgewoJCQkJY3VycmVudFZpZXcuZWxlbWVudC5zaG93KCk7CgkJCX1lbHNlewoJCQkJY3VycmVudFZpZXcgPSB2aWV3SW5zdGFuY2VzW25ld1ZpZXdOYW1lXSA9IG5ldyBmY1ZpZXdzW25ld1ZpZXdOYW1lXSgKCQkJCQluZXdWaWV3RWxlbWVudCA9IGFic29sdXRlVmlld0VsZW1lbnQgPQoJCQkJCQkkKCI8ZGl2IGNsYXNzPSdmYy12aWV3IGZjLXZpZXctIiArIG5ld1ZpZXdOYW1lICsgIicgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlJy8+IikKCQkJCQkJCS5hcHBlbmRUbyhjb250ZW50KSwKCQkJCQl0IC8vIHRoZSBjYWxlbmRhciBvYmplY3QKCQkJCSk7CgkJCX0KCQkJCgkJCWlmIChvbGRWaWV3KSB7CgkJCQloZWFkZXIuZGVhY3RpdmF0ZUJ1dHRvbihvbGRWaWV3Lm5hbWUpOwoJCQl9CgkJCWhlYWRlci5hY3RpdmF0ZUJ1dHRvbihuZXdWaWV3TmFtZSk7CgkJCQoJCQlyZW5kZXJWaWV3KCk7IC8vIGFmdGVyIGhlaWdodCBoYXMgYmVlbiBzZXQsIHdpbGwgbWFrZSBhYnNvbHV0ZVZpZXdFbGVtZW50J3MgcG9zaXRpb249cmVsYXRpdmUsIHRoZW4gc2V0IHRvIG51bGwKCQkJCgkJCWNvbnRlbnQuY3NzKCdvdmVyZmxvdycsICcnKTsKCQkJaWYgKG9sZFZpZXcpIHsKCQkJCXNldE1pbkhlaWdodChjb250ZW50LCAxKTsKCQkJfQoJCQkKCQkJaWYgKCFuZXdWaWV3RWxlbWVudCkgewoJCQkJKGN1cnJlbnRWaWV3LmFmdGVyU2hvdyB8fCBub29wKSgpOyAvLyBjYWxsZWQgYWZ0ZXIgc2V0dGluZyBtaW4taGVpZ2h0L292ZXJmbG93LCBzbyBpbiBmaW5hbCBzY3JvbGwgc3RhdGUgKGZvciBPcGVyYSkKCQkJfQoJCQkKCQkJaWdub3JlV2luZG93UmVzaXplLS07CgkJfQoJfQoJCgkKCQoJZnVuY3Rpb24gcmVuZGVyVmlldyhpbmMpIHsKCQlpZiAoZWxlbWVudFZpc2libGUoKSkgewoJCQlpZ25vcmVXaW5kb3dSZXNpemUrKzsgLy8gYmVjYXVzZSByZW5kZXJFdmVudHMgbWlnaHQgdGVtcG9yYXJpbHkgY2hhbmdlIHRoZSBoZWlnaHQgYmVmb3JlIHNldFNpemUgaXMgcmVhY2hlZAoKCQkJdW5zZWxlY3QoKTsKCQkJCgkJCWlmIChzdWdnZXN0ZWRWaWV3SGVpZ2h0ID09PSB1bmRlZmluZWQpIHsKCQkJCWNhbGNTaXplKCk7CgkJCX0KCQkJCgkJCXZhciBmb3JjZUV2ZW50UmVuZGVyID0gZmFsc2U7CgkJCWlmICghY3VycmVudFZpZXcuc3RhcnQgfHwgaW5jIHx8IGRhdGUgPCBjdXJyZW50Vmlldy5zdGFydCB8fCBkYXRlID49IGN1cnJlbnRWaWV3LmVuZCkgewoJCQkJLy8gdmlldyBtdXN0IHJlbmRlciBhbiBlbnRpcmUgbmV3IGRhdGUgcmFuZ2UgKGFuZCByZWZldGNoL3JlbmRlciBldmVudHMpCgkJCQljdXJyZW50Vmlldy5yZW5kZXIoZGF0ZSwgaW5jIHx8IDApOyAvLyByZXNwb25zaWJsZSBmb3IgY2xlYXJpbmcgZXZlbnRzCgkJCQlzZXRTaXplKHRydWUpOwoJCQkJZm9yY2VFdmVudFJlbmRlciA9IHRydWU7CgkJCX0KCQkJZWxzZSBpZiAoY3VycmVudFZpZXcuc2l6ZURpcnR5KSB7CgkJCQkvLyB2aWV3IG11c3QgcmVzaXplIChhbmQgcmVyZW5kZXIgZXZlbnRzKQoJCQkJY3VycmVudFZpZXcuY2xlYXJFdmVudHMoKTsKCQkJCXNldFNpemUoKTsKCQkJCWZvcmNlRXZlbnRSZW5kZXIgPSB0cnVlOwoJCQl9CgkJCWVsc2UgaWYgKGN1cnJlbnRWaWV3LmV2ZW50c0RpcnR5KSB7CgkJCQljdXJyZW50Vmlldy5jbGVhckV2ZW50cygpOwoJCQkJZm9yY2VFdmVudFJlbmRlciA9IHRydWU7CgkJCX0KCQkJY3VycmVudFZpZXcuc2l6ZURpcnR5ID0gZmFsc2U7CgkJCWN1cnJlbnRWaWV3LmV2ZW50c0RpcnR5ID0gZmFsc2U7CgkJCXVwZGF0ZUV2ZW50cyhmb3JjZUV2ZW50UmVuZGVyKTsKCQkJCgkJCWVsZW1lbnRPdXRlcldpZHRoID0gZWxlbWVudC5vdXRlcldpZHRoKCk7CgkJCQoJCQloZWFkZXIudXBkYXRlVGl0bGUoY3VycmVudFZpZXcudGl0bGUpOwoJCQl2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOwoJCQlpZiAodG9kYXkgPj0gY3VycmVudFZpZXcuc3RhcnQgJiYgdG9kYXkgPCBjdXJyZW50Vmlldy5lbmQpIHsKCQkJCWhlYWRlci5kaXNhYmxlQnV0dG9uKCd0b2RheScpOwoJCQl9ZWxzZXsKCQkJCWhlYWRlci5lbmFibGVCdXR0b24oJ3RvZGF5Jyk7CgkJCX0KCQkJCgkJCWlnbm9yZVdpbmRvd1Jlc2l6ZS0tOwoJCQljdXJyZW50Vmlldy50cmlnZ2VyKCd2aWV3RGlzcGxheScsIF9lbGVtZW50KTsKCQl9Cgl9CgkKCQoJCgkvKiBSZXNpemluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIHVwZGF0ZVNpemUoKSB7CgkJbWFya1NpemVzRGlydHkoKTsKCQlpZiAoZWxlbWVudFZpc2libGUoKSkgewoJCQljYWxjU2l6ZSgpOwoJCQlzZXRTaXplKCk7CgkJCXVuc2VsZWN0KCk7CgkJCWN1cnJlbnRWaWV3LmNsZWFyRXZlbnRzKCk7CgkJCWN1cnJlbnRWaWV3LnJlbmRlckV2ZW50cyhldmVudHMpOwoJCQljdXJyZW50Vmlldy5zaXplRGlydHkgPSBmYWxzZTsKCQl9Cgl9CgkKCQoJZnVuY3Rpb24gbWFya1NpemVzRGlydHkoKSB7CgkJJC5lYWNoKHZpZXdJbnN0YW5jZXMsIGZ1bmN0aW9uKGksIGluc3QpIHsKCQkJaW5zdC5zaXplRGlydHkgPSB0cnVlOwoJCX0pOwoJfQoJCgkKCWZ1bmN0aW9uIGNhbGNTaXplKCkgewoJCWlmIChvcHRpb25zLmNvbnRlbnRIZWlnaHQpIHsKCQkJc3VnZ2VzdGVkVmlld0hlaWdodCA9IG9wdGlvbnMuY29udGVudEhlaWdodDsKCQl9CgkJZWxzZSBpZiAob3B0aW9ucy5oZWlnaHQpIHsKCQkJc3VnZ2VzdGVkVmlld0hlaWdodCA9IG9wdGlvbnMuaGVpZ2h0IC0gKGhlYWRlckVsZW1lbnQgPyBoZWFkZXJFbGVtZW50LmhlaWdodCgpIDogMCkgLSB2c2lkZXMoY29udGVudFswXSk7CgkJfQoJCWVsc2UgewoJCQlzdWdnZXN0ZWRWaWV3SGVpZ2h0ID0gTWF0aC5yb3VuZChjb250ZW50LndpZHRoKCkgLyBNYXRoLm1heChvcHRpb25zLmFzcGVjdFJhdGlvLCAuNSkpOwoJCX0KCX0KCQoJCglmdW5jdGlvbiBzZXRTaXplKGRhdGVDaGFuZ2VkKSB7IC8vIHRvZG86IGRhdGVDaGFuZ2VkPwoJCWlnbm9yZVdpbmRvd1Jlc2l6ZSsrOwoJCWN1cnJlbnRWaWV3LnNldEhlaWdodChzdWdnZXN0ZWRWaWV3SGVpZ2h0LCBkYXRlQ2hhbmdlZCk7CgkJaWYgKGFic29sdXRlVmlld0VsZW1lbnQpIHsKCQkJYWJzb2x1dGVWaWV3RWxlbWVudC5jc3MoJ3Bvc2l0aW9uJywgJ3JlbGF0aXZlJyk7CgkJCWFic29sdXRlVmlld0VsZW1lbnQgPSBudWxsOwoJCX0KCQljdXJyZW50Vmlldy5zZXRXaWR0aChjb250ZW50LndpZHRoKCksIGRhdGVDaGFuZ2VkKTsKCQlpZ25vcmVXaW5kb3dSZXNpemUtLTsKCX0KCQoJCglmdW5jdGlvbiB3aW5kb3dSZXNpemUoKSB7CgkJaWYgKCFpZ25vcmVXaW5kb3dSZXNpemUpIHsKCQkJaWYgKGN1cnJlbnRWaWV3LnN0YXJ0KSB7IC8vIHZpZXcgaGFzIGFscmVhZHkgYmVlbiByZW5kZXJlZAoJCQkJdmFyIHVpZCA9ICsrcmVzaXplVUlEOwoJCQkJc2V0VGltZW91dChmdW5jdGlvbigpIHsgLy8gYWRkIGEgZGVsYXkKCQkJCQlpZiAodWlkID09IHJlc2l6ZVVJRCAmJiAhaWdub3JlV2luZG93UmVzaXplICYmIGVsZW1lbnRWaXNpYmxlKCkpIHsKCQkJCQkJaWYgKGVsZW1lbnRPdXRlcldpZHRoICE9IChlbGVtZW50T3V0ZXJXaWR0aCA9IGVsZW1lbnQub3V0ZXJXaWR0aCgpKSkgewoJCQkJCQkJaWdub3JlV2luZG93UmVzaXplKys7IC8vIGluIGNhc2UgdGhlIHdpbmRvd1Jlc2l6ZSBjYWxsYmFjayBjaGFuZ2VzIHRoZSBoZWlnaHQKCQkJCQkJCXVwZGF0ZVNpemUoKTsKCQkJCQkJCWN1cnJlbnRWaWV3LnRyaWdnZXIoJ3dpbmRvd1Jlc2l6ZScsIF9lbGVtZW50KTsKCQkJCQkJCWlnbm9yZVdpbmRvd1Jlc2l6ZS0tOwoJCQkJCQl9CgkJCQkJfQoJCQkJfSwgMjAwKTsKCQkJfWVsc2V7CgkJCQkvLyBjYWxlbmRhciBtdXN0IGhhdmUgYmVlbiBpbml0aWFsaXplZCBpbiBhIDB4MCBpZnJhbWUgdGhhdCBoYXMganVzdCBiZWVuIHJlc2l6ZWQKCQkJCWxhdGVSZW5kZXIoKTsKCQkJfQoJCX0KCX0KCQoJCgkKCS8qIEV2ZW50IEZldGNoaW5nL1JlbmRlcmluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCS8vIGZldGNoZXMgZXZlbnRzIGlmIG5lY2Vzc2FyeSwgcmVyZW5kZXJzIGV2ZW50cyBpZiBuZWNlc3NhcnkgKG9yIGlmIGZvcmNlZCkKCWZ1bmN0aW9uIHVwZGF0ZUV2ZW50cyhmb3JjZVJlbmRlcikgewoJCWlmICghb3B0aW9ucy5sYXp5RmV0Y2hpbmcgfHwgaXNGZXRjaE5lZWRlZChjdXJyZW50Vmlldy52aXNTdGFydCwgY3VycmVudFZpZXcudmlzRW5kKSkgewoJCQlyZWZldGNoRXZlbnRzKCk7CgkJfQoJCWVsc2UgaWYgKGZvcmNlUmVuZGVyKSB7CgkJCXJlcmVuZGVyRXZlbnRzKCk7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIHJlZmV0Y2hFdmVudHMoKSB7CgkJZmV0Y2hFdmVudHMoY3VycmVudFZpZXcudmlzU3RhcnQsIGN1cnJlbnRWaWV3LnZpc0VuZCk7IC8vIHdpbGwgY2FsbCByZXBvcnRFdmVudHMKCX0KCQoJCgkvLyBjYWxsZWQgd2hlbiBldmVudCBkYXRhIGFycml2ZXMKCWZ1bmN0aW9uIHJlcG9ydEV2ZW50cyhfZXZlbnRzKSB7CgkJZXZlbnRzID0gX2V2ZW50czsKCQlyZXJlbmRlckV2ZW50cygpOwoJfQoJCgkKCS8vIGNhbGxlZCB3aGVuIGEgc2luZ2xlIGV2ZW50J3MgZGF0YSBoYXMgYmVlbiBjaGFuZ2VkCglmdW5jdGlvbiByZXBvcnRFdmVudENoYW5nZShldmVudElEKSB7CgkJcmVyZW5kZXJFdmVudHMoZXZlbnRJRCk7Cgl9CgkKCQoJLy8gYXR0ZW1wdHMgdG8gcmVyZW5kZXJFdmVudHMKCWZ1bmN0aW9uIHJlcmVuZGVyRXZlbnRzKG1vZGlmaWVkRXZlbnRJRCkgewoJCW1hcmtFdmVudHNEaXJ0eSgpOwoJCWlmIChlbGVtZW50VmlzaWJsZSgpKSB7CgkJCWN1cnJlbnRWaWV3LmNsZWFyRXZlbnRzKCk7CgkJCWN1cnJlbnRWaWV3LnJlbmRlckV2ZW50cyhldmVudHMsIG1vZGlmaWVkRXZlbnRJRCk7CgkJCWN1cnJlbnRWaWV3LmV2ZW50c0RpcnR5ID0gZmFsc2U7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIG1hcmtFdmVudHNEaXJ0eSgpIHsKCQkkLmVhY2godmlld0luc3RhbmNlcywgZnVuY3Rpb24oaSwgaW5zdCkgewoJCQlpbnN0LmV2ZW50c0RpcnR5ID0gdHJ1ZTsKCQl9KTsKCX0KCQoKCgkvKiBTZWxlY3Rpb24KCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoKCWZ1bmN0aW9uIHNlbGVjdChzdGFydCwgZW5kLCBhbGxEYXkpIHsKCQljdXJyZW50Vmlldy5zZWxlY3Qoc3RhcnQsIGVuZCwgYWxsRGF5PT09dW5kZWZpbmVkID8gdHJ1ZSA6IGFsbERheSk7Cgl9CgkKCglmdW5jdGlvbiB1bnNlbGVjdCgpIHsgLy8gc2FmZSB0byBiZSBjYWxsZWQgYmVmb3JlIHJlbmRlclZpZXcKCQlpZiAoY3VycmVudFZpZXcpIHsKCQkJY3VycmVudFZpZXcudW5zZWxlY3QoKTsKCQl9Cgl9CgkKCQoJCgkvKiBEYXRlCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gcHJldigpIHsKCQlyZW5kZXJWaWV3KC0xKTsKCX0KCQoJCglmdW5jdGlvbiBuZXh0KCkgewoJCXJlbmRlclZpZXcoMSk7Cgl9CgkKCQoJZnVuY3Rpb24gcHJldlllYXIoKSB7CgkJYWRkWWVhcnMoZGF0ZSwgLTEpOwoJCXJlbmRlclZpZXcoKTsKCX0KCQoJCglmdW5jdGlvbiBuZXh0WWVhcigpIHsKCQlhZGRZZWFycyhkYXRlLCAxKTsKCQlyZW5kZXJWaWV3KCk7Cgl9CgkKCQoJZnVuY3Rpb24gdG9kYXkoKSB7CgkJZGF0ZSA9IG5ldyBEYXRlKCk7CgkJcmVuZGVyVmlldygpOwoJfQoJCgkKCWZ1bmN0aW9uIGdvdG9EYXRlKHllYXIsIG1vbnRoLCBkYXRlT2ZNb250aCkgewoJCWlmICh5ZWFyIGluc3RhbmNlb2YgRGF0ZSkgewoJCQlkYXRlID0gY2xvbmVEYXRlKHllYXIpOyAvLyBwcm92aWRlZCAxIGFyZ3VtZW50LCBhIERhdGUKCQl9ZWxzZXsKCQkJc2V0WU1EKGRhdGUsIHllYXIsIG1vbnRoLCBkYXRlT2ZNb250aCk7CgkJfQoJCXJlbmRlclZpZXcoKTsKCX0KCQoJCglmdW5jdGlvbiBpbmNyZW1lbnREYXRlKHllYXJzLCBtb250aHMsIGRheXMpIHsKCQlpZiAoeWVhcnMgIT09IHVuZGVmaW5lZCkgewoJCQlhZGRZZWFycyhkYXRlLCB5ZWFycyk7CgkJfQoJCWlmIChtb250aHMgIT09IHVuZGVmaW5lZCkgewoJCQlhZGRNb250aHMoZGF0ZSwgbW9udGhzKTsKCQl9CgkJaWYgKGRheXMgIT09IHVuZGVmaW5lZCkgewoJCQlhZGREYXlzKGRhdGUsIGRheXMpOwoJCX0KCQlyZW5kZXJWaWV3KCk7Cgl9CgkKCQoJZnVuY3Rpb24gZ2V0RGF0ZSgpIHsKCQlyZXR1cm4gY2xvbmVEYXRlKGRhdGUpOwoJfQoJCgkKCQoJLyogTWlzYwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIGdldFZpZXcoKSB7CgkJcmV0dXJuIGN1cnJlbnRWaWV3OwoJfQoJCgkKCWZ1bmN0aW9uIG9wdGlvbihuYW1lLCB2YWx1ZSkgewoJCWlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CgkJCXJldHVybiBvcHRpb25zW25hbWVdOwoJCX0KCQlpZiAobmFtZSA9PSAnaGVpZ2h0JyB8fCBuYW1lID09ICdjb250ZW50SGVpZ2h0JyB8fCBuYW1lID09ICdhc3BlY3RSYXRpbycpIHsKCQkJb3B0aW9uc1tuYW1lXSA9IHZhbHVlOwoJCQl1cGRhdGVTaXplKCk7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIHRyaWdnZXIobmFtZSwgdGhpc09iaikgewoJCWlmIChvcHRpb25zW25hbWVdKSB7CgkJCXJldHVybiBvcHRpb25zW25hbWVdLmFwcGx5KAoJCQkJdGhpc09iaiB8fCBfZWxlbWVudCwKCQkJCUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMikKCQkJKTsKCQl9Cgl9CgkKCQoJCgkvKiBFeHRlcm5hbCBEcmFnZ2luZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJaWYgKG9wdGlvbnMuZHJvcHBhYmxlKSB7CgkJJChkb2N1bWVudCkKCQkJLmJpbmQoJ2RyYWdzdGFydCcsIGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJdmFyIF9lID0gZXYudGFyZ2V0OwoJCQkJdmFyIGUgPSAkKF9lKTsKCQkJCWlmICghZS5wYXJlbnRzKCcuZmMnKS5sZW5ndGgpIHsgLy8gbm90IGFscmVhZHkgaW5zaWRlIGEgY2FsZW5kYXIKCQkJCQl2YXIgYWNjZXB0ID0gb3B0aW9ucy5kcm9wQWNjZXB0OwoJCQkJCWlmICgkLmlzRnVuY3Rpb24oYWNjZXB0KSA/IGFjY2VwdC5jYWxsKF9lLCBlKSA6IGUuaXMoYWNjZXB0KSkgewoJCQkJCQlfZHJhZ0VsZW1lbnQgPSBfZTsKCQkJCQkJY3VycmVudFZpZXcuZHJhZ1N0YXJ0KF9kcmFnRWxlbWVudCwgZXYsIHVpKTsKCQkJCQl9CgkJCQl9CgkJCX0pCgkJCS5iaW5kKCdkcmFnc3RvcCcsIGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJaWYgKF9kcmFnRWxlbWVudCkgewoJCQkJCWN1cnJlbnRWaWV3LmRyYWdTdG9wKF9kcmFnRWxlbWVudCwgZXYsIHVpKTsKCQkJCQlfZHJhZ0VsZW1lbnQgPSBudWxsOwoJCQkJfQoJCQl9KTsKCX0KCQoKfQoKZnVuY3Rpb24gSGVhZGVyKGNhbGVuZGFyLCBvcHRpb25zKSB7Cgl2YXIgdCA9IHRoaXM7CgkKCQoJLy8gZXhwb3J0cwoJdC5yZW5kZXIgPSByZW5kZXI7Cgl0LmRlc3Ryb3kgPSBkZXN0cm95OwoJdC51cGRhdGVUaXRsZSA9IHVwZGF0ZVRpdGxlOwoJdC5hY3RpdmF0ZUJ1dHRvbiA9IGFjdGl2YXRlQnV0dG9uOwoJdC5kZWFjdGl2YXRlQnV0dG9uID0gZGVhY3RpdmF0ZUJ1dHRvbjsKCXQuZGlzYWJsZUJ1dHRvbiA9IGRpc2FibGVCdXR0b247Cgl0LmVuYWJsZUJ1dHRvbiA9IGVuYWJsZUJ1dHRvbjsKCQoJCgkvLyBsb2NhbHMKCXZhciBlbGVtZW50ID0gJChbXSk7Cgl2YXIgdG07CgkKCgoJZnVuY3Rpb24gcmVuZGVyKCkgewoJCXRtID0gb3B0aW9ucy50aGVtZSA/ICd1aScgOiAnZmMnOwoJCXZhciBzZWN0aW9ucyA9IG9wdGlvbnMuaGVhZGVyOwoJCWlmIChzZWN0aW9ucykgewoJCQllbGVtZW50ID0gJCgiPHRhYmxlIGNsYXNzPSdmYy1oZWFkZXInLz4iKQoJCQkJLmFwcGVuZCgkKCI8dHIvPiIpCgkJCQkJLmFwcGVuZCgkKCI8dGQgY2xhc3M9J2ZjLWhlYWRlci1sZWZ0Jy8+IikKCQkJCQkJLmFwcGVuZChyZW5kZXJTZWN0aW9uKHNlY3Rpb25zLmxlZnQpKSkKCQkJCQkuYXBwZW5kKCQoIjx0ZCBjbGFzcz0nZmMtaGVhZGVyLWNlbnRlcicvPiIpCgkJCQkJCS5hcHBlbmQocmVuZGVyU2VjdGlvbihzZWN0aW9ucy5jZW50ZXIpKSkKCQkJCQkuYXBwZW5kKCQoIjx0ZCBjbGFzcz0nZmMtaGVhZGVyLXJpZ2h0Jy8+IikKCQkJCQkJLmFwcGVuZChyZW5kZXJTZWN0aW9uKHNlY3Rpb25zLnJpZ2h0KSkpKTsKCQkJcmV0dXJuIGVsZW1lbnQ7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIGRlc3Ryb3koKSB7CgkJZWxlbWVudC5yZW1vdmUoKTsKCX0KCQoJCglmdW5jdGlvbiByZW5kZXJTZWN0aW9uKGJ1dHRvblN0cikgewoJCWlmIChidXR0b25TdHIpIHsKCQkJdmFyIHRyID0gJCgiPHRyLz4iKTsKCQkJJC5lYWNoKGJ1dHRvblN0ci5zcGxpdCgnICcpLCBmdW5jdGlvbihpKSB7CgkJCQlpZiAoaSA+IDApIHsKCQkJCQl0ci5hcHBlbmQoIjx0ZD48c3BhbiBjbGFzcz0nZmMtaGVhZGVyLXNwYWNlJy8+PC90ZD4iKTsKCQkJCX0KCQkJCXZhciBwcmV2QnV0dG9uOwoJCQkJJC5lYWNoKHRoaXMuc3BsaXQoJywnKSwgZnVuY3Rpb24oaiwgYnV0dG9uTmFtZSkgewoJCQkJCWlmIChidXR0b25OYW1lID09ICd0aXRsZScpIHsKCQkJCQkJdHIuYXBwZW5kKCI8dGQ+PGgyIGNsYXNzPSdmYy1oZWFkZXItdGl0bGUnPiZuYnNwOzwvaDI+PC90ZD4iKTsKCQkJCQkJaWYgKHByZXZCdXR0b24pIHsKCQkJCQkJCXByZXZCdXR0b24uYWRkQ2xhc3ModG0gKyAnLWNvcm5lci1yaWdodCcpOwoJCQkJCQl9CgkJCQkJCXByZXZCdXR0b24gPSBudWxsOwoJCQkJCX1lbHNlewoJCQkJCQl2YXIgYnV0dG9uQ2xpY2s7CgkJCQkJCWlmIChjYWxlbmRhcltidXR0b25OYW1lXSkgewoJCQkJCQkJYnV0dG9uQ2xpY2sgPSBjYWxlbmRhcltidXR0b25OYW1lXTsgLy8gY2FsZW5kYXIgbWV0aG9kCgkJCQkJCX0KCQkJCQkJZWxzZSBpZiAoZmNWaWV3c1tidXR0b25OYW1lXSkgewoJCQkJCQkJYnV0dG9uQ2xpY2sgPSBmdW5jdGlvbigpIHsKCQkJCQkJCQlidXR0b24ucmVtb3ZlQ2xhc3ModG0gKyAnLXN0YXRlLWhvdmVyJyk7IC8vIGZvcmdldCB3aHkKCQkJCQkJCQljYWxlbmRhci5jaGFuZ2VWaWV3KGJ1dHRvbk5hbWUpOwoJCQkJCQkJfTsKCQkJCQkJfQoJCQkJCQlpZiAoYnV0dG9uQ2xpY2spIHsKCQkJCQkJCWlmIChwcmV2QnV0dG9uKSB7CgkJCQkJCQkJcHJldkJ1dHRvbi5hZGRDbGFzcyh0bSArICctbm8tcmlnaHQnKTsKCQkJCQkJCX0KCQkJCQkJCXZhciBidXR0b247CgkJCQkJCQl2YXIgaWNvbiA9IG9wdGlvbnMudGhlbWUgPyBzbWFydFByb3BlcnR5KG9wdGlvbnMuYnV0dG9uSWNvbnMsIGJ1dHRvbk5hbWUpIDogbnVsbDsKCQkJCQkJCXZhciB0ZXh0ID0gc21hcnRQcm9wZXJ0eShvcHRpb25zLmJ1dHRvblRleHQsIGJ1dHRvbk5hbWUpOwoJCQkJCQkJaWYgKGljb24pIHsKCQkJCQkJCQlidXR0b24gPSAkKCI8ZGl2IGNsYXNzPSdmYy1idXR0b24tIiArIGJ1dHRvbk5hbWUgKyAiIHVpLXN0YXRlLWRlZmF1bHQnPiIgKwoJCQkJCQkJCQkiPGE+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi0iICsgaWNvbiArICInLz48L2E+PC9kaXY+Iik7CgkJCQkJCQl9CgkJCQkJCQllbHNlIGlmICh0ZXh0KSB7CgkJCQkJCQkJYnV0dG9uID0gJCgiPGRpdiBjbGFzcz0nZmMtYnV0dG9uLSIgKyBidXR0b25OYW1lICsgIiAiICsgdG0gKyAiLXN0YXRlLWRlZmF1bHQnPiIgKwoJCQkJCQkJCQkiPGE+PHNwYW4+IiArIHRleHQgKyAiPC9zcGFuPjwvYT48L2Rpdj4iKTsKCQkJCQkJCX0KCQkJCQkJCWlmIChidXR0b24pIHsKCQkJCQkJCQlidXR0b24KCQkJCQkJCQkJLmNsaWNrKGZ1bmN0aW9uKCkgewoJCQkJCQkJCQkJaWYgKCFidXR0b24uaGFzQ2xhc3ModG0gKyAnLXN0YXRlLWRpc2FibGVkJykpIHsKCQkJCQkJCQkJCQlidXR0b25DbGljaygpOwoJCQkJCQkJCQkJfQoJCQkJCQkJCQl9KQoJCQkJCQkJCQkubW91c2Vkb3duKGZ1bmN0aW9uKCkgewoJCQkJCQkJCQkJYnV0dG9uCgkJCQkJCQkJCQkJLm5vdCgnLicgKyB0bSArICctc3RhdGUtYWN0aXZlJykKCQkJCQkJCQkJCQkubm90KCcuJyArIHRtICsgJy1zdGF0ZS1kaXNhYmxlZCcpCgkJCQkJCQkJCQkJLmFkZENsYXNzKHRtICsgJy1zdGF0ZS1kb3duJyk7CgkJCQkJCQkJCX0pCgkJCQkJCQkJCS5tb3VzZXVwKGZ1bmN0aW9uKCkgewoJCQkJCQkJCQkJYnV0dG9uLnJlbW92ZUNsYXNzKHRtICsgJy1zdGF0ZS1kb3duJyk7CgkJCQkJCQkJCX0pCgkJCQkJCQkJCS5ob3ZlcigKCQkJCQkJCQkJCWZ1bmN0aW9uKCkgewoJCQkJCQkJCQkJCWJ1dHRvbgoJCQkJCQkJCQkJCQkubm90KCcuJyArIHRtICsgJy1zdGF0ZS1hY3RpdmUnKQoJCQkJCQkJCQkJCQkubm90KCcuJyArIHRtICsgJy1zdGF0ZS1kaXNhYmxlZCcpCgkJCQkJCQkJCQkJCS5hZGRDbGFzcyh0bSArICctc3RhdGUtaG92ZXInKTsKCQkJCQkJCQkJCX0sCgkJCQkJCQkJCQlmdW5jdGlvbigpIHsKCQkJCQkJCQkJCQlidXR0b24KCQkJCQkJCQkJCQkJLnJlbW92ZUNsYXNzKHRtICsgJy1zdGF0ZS1ob3ZlcicpCgkJCQkJCQkJCQkJCS5yZW1vdmVDbGFzcyh0bSArICctc3RhdGUtZG93bicpOwoJCQkJCQkJCQkJfQoJCQkJCQkJCQkpCgkJCQkJCQkJCS5hcHBlbmRUbygkKCI8dGQvPiIpLmFwcGVuZFRvKHRyKSk7CgkJCQkJCQkJaWYgKHByZXZCdXR0b24pIHsKCQkJCQkJCQkJcHJldkJ1dHRvbi5hZGRDbGFzcyh0bSArICctbm8tcmlnaHQnKTsKCQkJCQkJCQl9ZWxzZXsKCQkJCQkJCQkJYnV0dG9uLmFkZENsYXNzKHRtICsgJy1jb3JuZXItbGVmdCcpOwoJCQkJCQkJCX0KCQkJCQkJCQlwcmV2QnV0dG9uID0gYnV0dG9uOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfSk7CgkJCQlpZiAocHJldkJ1dHRvbikgewoJCQkJCXByZXZCdXR0b24uYWRkQ2xhc3ModG0gKyAnLWNvcm5lci1yaWdodCcpOwoJCQkJfQoJCQl9KTsKCQkJcmV0dXJuICQoIjx0YWJsZS8+IikuYXBwZW5kKHRyKTsKCQl9Cgl9CgkKCQoJZnVuY3Rpb24gdXBkYXRlVGl0bGUoaHRtbCkgewoJCWVsZW1lbnQuZmluZCgnaDIuZmMtaGVhZGVyLXRpdGxlJykKCQkJLmh0bWwoaHRtbCk7Cgl9CgkKCQoJZnVuY3Rpb24gYWN0aXZhdGVCdXR0b24oYnV0dG9uTmFtZSkgewoJCWVsZW1lbnQuZmluZCgnZGl2LmZjLWJ1dHRvbi0nICsgYnV0dG9uTmFtZSkKCQkJLmFkZENsYXNzKHRtICsgJy1zdGF0ZS1hY3RpdmUnKTsKCX0KCQoJCglmdW5jdGlvbiBkZWFjdGl2YXRlQnV0dG9uKGJ1dHRvbk5hbWUpIHsKCQllbGVtZW50LmZpbmQoJ2Rpdi5mYy1idXR0b24tJyArIGJ1dHRvbk5hbWUpCgkJCS5yZW1vdmVDbGFzcyh0bSArICctc3RhdGUtYWN0aXZlJyk7Cgl9CgkKCQoJZnVuY3Rpb24gZGlzYWJsZUJ1dHRvbihidXR0b25OYW1lKSB7CgkJZWxlbWVudC5maW5kKCdkaXYuZmMtYnV0dG9uLScgKyBidXR0b25OYW1lKQoJCQkuYWRkQ2xhc3ModG0gKyAnLXN0YXRlLWRpc2FibGVkJyk7Cgl9CgkKCQoJZnVuY3Rpb24gZW5hYmxlQnV0dG9uKGJ1dHRvbk5hbWUpIHsKCQllbGVtZW50LmZpbmQoJ2Rpdi5mYy1idXR0b24tJyArIGJ1dHRvbk5hbWUpCgkJCS5yZW1vdmVDbGFzcyh0bSArICctc3RhdGUtZGlzYWJsZWQnKTsKCX0KCgp9Cgp2YXIgZXZlbnRHVUlEID0gMTsKCmZ1bmN0aW9uIEV2ZW50TWFuYWdlcihvcHRpb25zLCBzb3VyY2VzKSB7Cgl2YXIgdCA9IHRoaXM7CgkKCQoJLy8gZXhwb3J0cwoJdC5pc0ZldGNoTmVlZGVkID0gaXNGZXRjaE5lZWRlZDsKCXQuZmV0Y2hFdmVudHMgPSBmZXRjaEV2ZW50czsKCXQuYWRkRXZlbnRTb3VyY2UgPSBhZGRFdmVudFNvdXJjZTsKCXQucmVtb3ZlRXZlbnRTb3VyY2UgPSByZW1vdmVFdmVudFNvdXJjZTsKCXQudXBkYXRlRXZlbnQgPSB1cGRhdGVFdmVudDsKCXQucmVuZGVyRXZlbnQgPSByZW5kZXJFdmVudDsKCXQucmVtb3ZlRXZlbnRzID0gcmVtb3ZlRXZlbnRzOwoJdC5jbGllbnRFdmVudHMgPSBjbGllbnRFdmVudHM7Cgl0Lm5vcm1hbGl6ZUV2ZW50ID0gbm9ybWFsaXplRXZlbnQ7CgkKCQoJLy8gaW1wb3J0cwoJdmFyIHRyaWdnZXIgPSB0LnRyaWdnZXI7Cgl2YXIgZ2V0VmlldyA9IHQuZ2V0VmlldzsKCXZhciByZXBvcnRFdmVudHMgPSB0LnJlcG9ydEV2ZW50czsKCQoJCgkvLyBsb2NhbHMKCXZhciByYW5nZVN0YXJ0LCByYW5nZUVuZDsKCXZhciBjdXJyZW50RmV0Y2hJRCA9IDA7Cgl2YXIgcGVuZGluZ1NvdXJjZUNudCA9IDA7Cgl2YXIgbG9hZGluZ0xldmVsID0gMDsKCXZhciBkeW5hbWljRXZlbnRTb3VyY2UgPSBbXTsKCXZhciBjYWNoZSA9IFtdOwoJCgkKCQoJLyogRmV0Y2hpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglmdW5jdGlvbiBpc0ZldGNoTmVlZGVkKHN0YXJ0LCBlbmQpIHsKCQlyZXR1cm4gIXJhbmdlU3RhcnQgfHwgc3RhcnQgPCByYW5nZVN0YXJ0IHx8IGVuZCA+IHJhbmdlRW5kOwoJfQoJCgkKCWZ1bmN0aW9uIGZldGNoRXZlbnRzKHN0YXJ0LCBlbmQpIHsKCQlyYW5nZVN0YXJ0ID0gc3RhcnQ7CgkJcmFuZ2VFbmQgPSBlbmQ7CgkJY2FjaGUgPSBbXTsKCQl2YXIgZmV0Y2hJRCA9ICsrY3VycmVudEZldGNoSUQ7CgkJdmFyIGxlbiA9IHNvdXJjZXMubGVuZ3RoOwoJCXBlbmRpbmdTb3VyY2VDbnQgPSBsZW47CgkJZm9yICh2YXIgaT0wOyBpPGxlbjsgaSsrKSB7CgkJCWZldGNoRXZlbnRTb3VyY2Uoc291cmNlc1tpXSwgZmV0Y2hJRCk7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIGZldGNoRXZlbnRTb3VyY2Uoc291cmNlLCBmZXRjaElEKSB7CgkJX2ZldGNoRXZlbnRTb3VyY2Uoc291cmNlLCBmdW5jdGlvbihldmVudHMpIHsKCQkJaWYgKGZldGNoSUQgPT0gY3VycmVudEZldGNoSUQpIHsKCQkJCWZvciAodmFyIGk9MDsgaTxldmVudHMubGVuZ3RoOyBpKyspIHsKCQkJCQlub3JtYWxpemVFdmVudChldmVudHNbaV0pOwoJCQkJCWV2ZW50c1tpXS5zb3VyY2UgPSBzb3VyY2U7CgkJCQl9CgkJCQljYWNoZSA9IGNhY2hlLmNvbmNhdChldmVudHMpOwoJCQkJcGVuZGluZ1NvdXJjZUNudC0tOwoJCQkJaWYgKCFwZW5kaW5nU291cmNlQ250KSB7CgkJCQkJcmVwb3J0RXZlbnRzKGNhY2hlKTsKCQkJCX0KCQkJfQoJCX0pOwoJfQoJCgkKCWZ1bmN0aW9uIF9mZXRjaEV2ZW50U291cmNlKHNvdXJjZSwgY2FsbGJhY2spIHsKCQlpZiAodHlwZW9mIHNvdXJjZSA9PSAnc3RyaW5nJykgewoJCQl2YXIgcGFyYW1zID0ge307CgkJCXBhcmFtc1tvcHRpb25zLnN0YXJ0UGFyYW1dID0gTWF0aC5yb3VuZChyYW5nZVN0YXJ0LmdldFRpbWUoKSAvIDEwMDApOwoJCQlwYXJhbXNbb3B0aW9ucy5lbmRQYXJhbV0gPSBNYXRoLnJvdW5kKHJhbmdlRW5kLmdldFRpbWUoKSAvIDEwMDApOwoJCQlpZiAob3B0aW9ucy5jYWNoZVBhcmFtKSB7CgkJCQlwYXJhbXNbb3B0aW9ucy5jYWNoZVBhcmFtXSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7IC8vIFRPRE86IGRlcHJlY2F0ZSBjYWNoZVBhcmFtCgkJCX0KCQkJcHVzaExvYWRpbmcoKTsKCQkJLy8gVE9ETzogcmVzcGVjdCBjYWNoZSBwYXJhbSBpbiBhamF4U2V0dXAKCQkJJC5hamF4KHsKCQkJCXVybDogc291cmNlLAoJCQkJZGF0YVR5cGU6ICdqc29uJywKCQkJCWRhdGE6IHBhcmFtcywKCQkJCWNhY2hlOiBvcHRpb25zLmNhY2hlUGFyYW0gfHwgZmFsc2UsIC8vIGRvbid0IGxldCBqcXVlcnkgcHJldmVudCBjYWNoaW5nIGlmIGNhY2hlUGFyYW0gaXMgYmVpbmcgdXNlZAoJCQkJc3VjY2VzczogZnVuY3Rpb24oZXZlbnRzKSB7CgkJCQkJcG9wTG9hZGluZygpOwoJCQkJCWNhbGxiYWNrKGV2ZW50cyk7CgkJCQl9CgkJCX0pOwoJCX0KCQllbHNlIGlmICgkLmlzRnVuY3Rpb24oc291cmNlKSkgewoJCQlwdXNoTG9hZGluZygpOwoJCQlzb3VyY2UoY2xvbmVEYXRlKHJhbmdlU3RhcnQpLCBjbG9uZURhdGUocmFuZ2VFbmQpLCBmdW5jdGlvbihldmVudHMpIHsKCQkJCXBvcExvYWRpbmcoKTsKCQkJCWNhbGxiYWNrKGV2ZW50cyk7CgkJCX0pOwoJCX0KCQllbHNlIHsKCQkJY2FsbGJhY2soc291cmNlKTsgLy8gc3JjIGlzIGFuIGFycmF5CgkJfQoJfQoJCgkKCQoJLyogU291cmNlcwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCXNvdXJjZXMucHVzaChkeW5hbWljRXZlbnRTb3VyY2UpOwoJCgoJZnVuY3Rpb24gYWRkRXZlbnRTb3VyY2Uoc291cmNlKSB7CgkJc291cmNlcy5wdXNoKHNvdXJjZSk7CgkJcGVuZGluZ1NvdXJjZUNudCsrOwoJCWZldGNoRXZlbnRTb3VyY2Uoc291cmNlLCBjdXJyZW50RmV0Y2hJRCk7IC8vIHdpbGwgZXZlbnR1YWxseSBjYWxsIHJlcG9ydEV2ZW50cwoJfQoJCgoJZnVuY3Rpb24gcmVtb3ZlRXZlbnRTb3VyY2Uoc291cmNlKSB7CgkJc291cmNlcyA9ICQuZ3JlcChzb3VyY2VzLCBmdW5jdGlvbihzcmMpIHsKCQkJcmV0dXJuIHNyYyAhPSBzb3VyY2U7CgkJfSk7CgkJLy8gcmVtb3ZlIGFsbCBjbGllbnQgZXZlbnRzIGZyb20gdGhhdCBzb3VyY2UKCQljYWNoZSA9ICQuZ3JlcChjYWNoZSwgZnVuY3Rpb24oZSkgewoJCQlyZXR1cm4gZS5zb3VyY2UgIT0gc291cmNlOwoJCX0pOwoJCXJlcG9ydEV2ZW50cyhjYWNoZSk7Cgl9CgkKCQoJCgkvKiBNYW5pcHVsYXRpb24KCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglmdW5jdGlvbiB1cGRhdGVFdmVudChldmVudCkgeyAvLyB1cGRhdGUgYW4gZXhpc3RpbmcgZXZlbnQKCQl2YXIgaSwgbGVuID0gY2FjaGUubGVuZ3RoLCBlLAoJCQlkZWZhdWx0RXZlbnRFbmQgPSBnZXRWaWV3KCkuZGVmYXVsdEV2ZW50RW5kLCAvLyBnZXRWaWV3Pz8/CgkJCXN0YXJ0RGVsdGEgPSBldmVudC5zdGFydCAtIGV2ZW50Ll9zdGFydCwKCQkJZW5kRGVsdGEgPSBldmVudC5lbmQgPwoJCQkJKGV2ZW50LmVuZCAtIChldmVudC5fZW5kIHx8IGRlZmF1bHRFdmVudEVuZChldmVudCkpKSAvLyBldmVudC5fZW5kIHdvdWxkIGJlIG51bGwgaWYgZXZlbnQuZW5kCgkJCQk6IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2FzIG51bGwgYW5kIGV2ZW50IHdhcyBqdXN0IHJlc2l6ZWQKCQlmb3IgKGk9MDsgaTxsZW47IGkrKykgewoJCQllID0gY2FjaGVbaV07CgkJCWlmIChlLl9pZCA9PSBldmVudC5faWQgJiYgZSAhPSBldmVudCkgewoJCQkJZS5zdGFydCA9IG5ldyBEYXRlKCtlLnN0YXJ0ICsgc3RhcnREZWx0YSk7CgkJCQlpZiAoZXZlbnQuZW5kKSB7CgkJCQkJaWYgKGUuZW5kKSB7CgkJCQkJCWUuZW5kID0gbmV3IERhdGUoK2UuZW5kICsgZW5kRGVsdGEpOwoJCQkJCX1lbHNlewoJCQkJCQllLmVuZCA9IG5ldyBEYXRlKCtkZWZhdWx0RXZlbnRFbmQoZSkgKyBlbmREZWx0YSk7CgkJCQkJfQoJCQkJfWVsc2V7CgkJCQkJZS5lbmQgPSBudWxsOwoJCQkJfQoJCQkJZS50aXRsZSA9IGV2ZW50LnRpdGxlOwoJCQkJZS51cmwgPSBldmVudC51cmw7CgkJCQllLmFsbERheSA9IGV2ZW50LmFsbERheTsKCQkJCWUuY2xhc3NOYW1lID0gZXZlbnQuY2xhc3NOYW1lOwoJCQkJZS5lZGl0YWJsZSA9IGV2ZW50LmVkaXRhYmxlOwoJCQkJbm9ybWFsaXplRXZlbnQoZSk7CgkJCX0KCQl9CgkJbm9ybWFsaXplRXZlbnQoZXZlbnQpOwoJCXJlcG9ydEV2ZW50cyhjYWNoZSk7Cgl9CgkKCQoJZnVuY3Rpb24gcmVuZGVyRXZlbnQoZXZlbnQsIHN0aWNrKSB7CgkJbm9ybWFsaXplRXZlbnQoZXZlbnQpOwoJCWlmICghZXZlbnQuc291cmNlKSB7CgkJCWlmIChzdGljaykgewoJCQkJZHluYW1pY0V2ZW50U291cmNlLnB1c2goZXZlbnQpOwoJCQkJZXZlbnQuc291cmNlID0gZHluYW1pY0V2ZW50U291cmNlOwoJCQl9CgkJCWNhY2hlLnB1c2goZXZlbnQpOwoJCX0KCQlyZXBvcnRFdmVudHMoY2FjaGUpOwoJfQoJCgkKCWZ1bmN0aW9uIHJlbW92ZUV2ZW50cyhmaWx0ZXIpIHsKCQlpZiAoIWZpbHRlcikgeyAvLyByZW1vdmUgYWxsCgkJCWNhY2hlID0gW107CgkJCS8vIGNsZWFyIGFsbCBhcnJheSBzb3VyY2VzCgkJCWZvciAodmFyIGk9MDsgaTxzb3VyY2VzLmxlbmd0aDsgaSsrKSB7CgkJCQlpZiAodHlwZW9mIHNvdXJjZXNbaV0gPT0gJ29iamVjdCcpIHsKCQkJCQlzb3VyY2VzW2ldID0gW107CgkJCQl9CgkJCX0KCQl9ZWxzZXsKCQkJaWYgKCEkLmlzRnVuY3Rpb24oZmlsdGVyKSkgeyAvLyBhbiBldmVudCBJRAoJCQkJdmFyIGlkID0gZmlsdGVyICsgJyc7CgkJCQlmaWx0ZXIgPSBmdW5jdGlvbihlKSB7CgkJCQkJcmV0dXJuIGUuX2lkID09IGlkOwoJCQkJfTsKCQkJfQoJCQljYWNoZSA9ICQuZ3JlcChjYWNoZSwgZmlsdGVyLCB0cnVlKTsKCQkJLy8gcmVtb3ZlIGV2ZW50cyBmcm9tIGFycmF5IHNvdXJjZXMKCQkJZm9yICh2YXIgaT0wOyBpPHNvdXJjZXMubGVuZ3RoOyBpKyspIHsKCQkJCWlmICh0eXBlb2Ygc291cmNlc1tpXSA9PSAnb2JqZWN0JykgewoJCQkJCXNvdXJjZXNbaV0gPSAkLmdyZXAoc291cmNlc1tpXSwgZmlsdGVyLCB0cnVlKTsKCQkJCX0KCQkJfQoJCX0KCQlyZXBvcnRFdmVudHMoY2FjaGUpOwoJfQoJCgkKCWZ1bmN0aW9uIGNsaWVudEV2ZW50cyhmaWx0ZXIpIHsKCQlpZiAoJC5pc0Z1bmN0aW9uKGZpbHRlcikpIHsKCQkJcmV0dXJuICQuZ3JlcChjYWNoZSwgZmlsdGVyKTsKCQl9CgkJZWxzZSBpZiAoZmlsdGVyKSB7IC8vIGFuIGV2ZW50IElECgkJCWZpbHRlciArPSAnJzsKCQkJcmV0dXJuICQuZ3JlcChjYWNoZSwgZnVuY3Rpb24oZSkgewoJCQkJcmV0dXJuIGUuX2lkID09IGZpbHRlcjsKCQkJfSk7CgkJfQoJCXJldHVybiBjYWNoZTsgLy8gZWxzZSwgcmV0dXJuIGFsbAoJfQoJCgkKCQoJLyogTG9hZGluZyBTdGF0ZQoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIHB1c2hMb2FkaW5nKCkgewoJCWlmICghbG9hZGluZ0xldmVsKyspIHsKCQkJdHJpZ2dlcignbG9hZGluZycsIG51bGwsIHRydWUpOwoJCX0KCX0KCQoJCglmdW5jdGlvbiBwb3BMb2FkaW5nKCkgewoJCWlmICghLS1sb2FkaW5nTGV2ZWwpIHsKCQkJdHJpZ2dlcignbG9hZGluZycsIG51bGwsIGZhbHNlKTsKCQl9Cgl9CgkKCQoJCgkvKiBFdmVudCBOb3JtYWxpemF0aW9uCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gbm9ybWFsaXplRXZlbnQoZXZlbnQpIHsKCQlldmVudC5faWQgPSBldmVudC5faWQgfHwgKGV2ZW50LmlkID09PSB1bmRlZmluZWQgPyAnX2ZjJyArIGV2ZW50R1VJRCsrIDogZXZlbnQuaWQgKyAnJyk7CgkJaWYgKGV2ZW50LmRhdGUpIHsKCQkJaWYgKCFldmVudC5zdGFydCkgewoJCQkJZXZlbnQuc3RhcnQgPSBldmVudC5kYXRlOwoJCQl9CgkJCWRlbGV0ZSBldmVudC5kYXRlOwoJCX0KCQlldmVudC5fc3RhcnQgPSBjbG9uZURhdGUoZXZlbnQuc3RhcnQgPSBwYXJzZURhdGUoZXZlbnQuc3RhcnQsIG9wdGlvbnMuaWdub3JlVGltZXpvbmUpKTsKCQlldmVudC5lbmQgPSBwYXJzZURhdGUoZXZlbnQuZW5kLCBvcHRpb25zLmlnbm9yZVRpbWV6b25lKTsKCQlpZiAoZXZlbnQuZW5kICYmIGV2ZW50LmVuZCA8PSBldmVudC5zdGFydCkgewoJCQlldmVudC5lbmQgPSBudWxsOwoJCX0KCQlldmVudC5fZW5kID0gZXZlbnQuZW5kID8gY2xvbmVEYXRlKGV2ZW50LmVuZCkgOiBudWxsOwoJCWlmIChldmVudC5hbGxEYXkgPT09IHVuZGVmaW5lZCkgewoJCQlldmVudC5hbGxEYXkgPSBvcHRpb25zLmFsbERheURlZmF1bHQ7CgkJfQoJCWlmIChldmVudC5jbGFzc05hbWUpIHsKCQkJaWYgKHR5cGVvZiBldmVudC5jbGFzc05hbWUgPT0gJ3N0cmluZycpIHsKCQkJCWV2ZW50LmNsYXNzTmFtZSA9IGV2ZW50LmNsYXNzTmFtZS5zcGxpdCgvXHMrLyk7CgkJCX0KCQl9ZWxzZXsKCQkJZXZlbnQuY2xhc3NOYW1lID0gW107CgkJfQoJCS8vIFRPRE86IGlmIHRoZXJlIGlzIG5vIHN0YXJ0IGRhdGUsIHJldHVybiBmYWxzZSB0byBpbmRpY2F0ZSBhbiBpbnZhbGlkIGV2ZW50Cgl9CgoKfQoKZmNWaWV3cy5tb250aCA9IE1vbnRoVmlldzsKCmZ1bmN0aW9uIE1vbnRoVmlldyhlbGVtZW50LCBjYWxlbmRhcikgewoJdmFyIHQgPSB0aGlzOwoJCgkKCS8vIGV4cG9ydHMKCXQucmVuZGVyID0gcmVuZGVyOwoJCgkKCS8vIGltcG9ydHMKCUJhc2ljVmlldy5jYWxsKHQsIGVsZW1lbnQsIGNhbGVuZGFyLCAnbW9udGgnKTsKCXZhciBvcHQgPSB0Lm9wdDsKCXZhciByZW5kZXJCYXNpYyA9IHQucmVuZGVyQmFzaWM7Cgl2YXIgZm9ybWF0RGF0ZSA9IGNhbGVuZGFyLmZvcm1hdERhdGU7CgkKCQoJCglmdW5jdGlvbiByZW5kZXIoZGF0ZSwgZGVsdGEpIHsKCQlpZiAoZGVsdGEpIHsKCQkJYWRkTW9udGhzKGRhdGUsIGRlbHRhKTsKCQkJZGF0ZS5zZXREYXRlKDEpOwoJCX0KCQl2YXIgc3RhcnQgPSBjbG9uZURhdGUoZGF0ZSwgdHJ1ZSk7CgkJc3RhcnQuc2V0RGF0ZSgxKTsKCQl2YXIgZW5kID0gYWRkTW9udGhzKGNsb25lRGF0ZShzdGFydCksIDEpOwoJCXZhciB2aXNTdGFydCA9IGNsb25lRGF0ZShzdGFydCk7CgkJdmFyIHZpc0VuZCA9IGNsb25lRGF0ZShlbmQpOwoJCXZhciBmaXJzdERheSA9IG9wdCgnZmlyc3REYXknKTsKCQl2YXIgbndlID0gb3B0KCd3ZWVrZW5kcycpID8gMCA6IDE7CgkJaWYgKG53ZSkgewoJCQlza2lwV2Vla2VuZCh2aXNTdGFydCk7CgkJCXNraXBXZWVrZW5kKHZpc0VuZCwgLTEsIHRydWUpOwoJCX0KCQlhZGREYXlzKHZpc1N0YXJ0LCAtKCh2aXNTdGFydC5nZXREYXkoKSAtIE1hdGgubWF4KGZpcnN0RGF5LCBud2UpICsgNykgJSA3KSk7CgkJYWRkRGF5cyh2aXNFbmQsICg3IC0gdmlzRW5kLmdldERheSgpICsgTWF0aC5tYXgoZmlyc3REYXksIG53ZSkpICUgNyk7CgkJdmFyIHJvd0NudCA9IE1hdGgucm91bmQoKHZpc0VuZCAtIHZpc1N0YXJ0KSAvIChEQVlfTVMgKiA3KSk7CgkJaWYgKG9wdCgnd2Vla01vZGUnKSA9PSAnZml4ZWQnKSB7CgkJCWFkZERheXModmlzRW5kLCAoNiAtIHJvd0NudCkgKiA3KTsKCQkJcm93Q250ID0gNjsKCQl9CgkJdC50aXRsZSA9IGZvcm1hdERhdGUoc3RhcnQsIG9wdCgndGl0bGVGb3JtYXQnKSk7CgkJdC5zdGFydCA9IHN0YXJ0OwoJCXQuZW5kID0gZW5kOwoJCXQudmlzU3RhcnQgPSB2aXNTdGFydDsKCQl0LnZpc0VuZCA9IHZpc0VuZDsKCQlyZW5kZXJCYXNpYyhyb3dDbnQsIG53ZSA/IDUgOiA3LCB0cnVlKTsKCX0KCQoJCn0KCmZjVmlld3MuYmFzaWNXZWVrID0gQmFzaWNXZWVrVmlldzsKCmZ1bmN0aW9uIEJhc2ljV2Vla1ZpZXcoZWxlbWVudCwgY2FsZW5kYXIpIHsKCXZhciB0ID0gdGhpczsKCQoJCgkvLyBleHBvcnRzCgl0LnJlbmRlciA9IHJlbmRlcjsKCQoJCgkvLyBpbXBvcnRzCglCYXNpY1ZpZXcuY2FsbCh0LCBlbGVtZW50LCBjYWxlbmRhciwgJ2Jhc2ljV2VlaycpOwoJdmFyIG9wdCA9IHQub3B0OwoJdmFyIHJlbmRlckJhc2ljID0gdC5yZW5kZXJCYXNpYzsKCXZhciBmb3JtYXREYXRlcyA9IGNhbGVuZGFyLmZvcm1hdERhdGVzOwoJCgkKCQoJZnVuY3Rpb24gcmVuZGVyKGRhdGUsIGRlbHRhKSB7CgkJaWYgKGRlbHRhKSB7CgkJCWFkZERheXMoZGF0ZSwgZGVsdGEgKiA3KTsKCQl9CgkJdmFyIHN0YXJ0ID0gYWRkRGF5cyhjbG9uZURhdGUoZGF0ZSksIC0oKGRhdGUuZ2V0RGF5KCkgLSBvcHQoJ2ZpcnN0RGF5JykgKyA3KSAlIDcpKTsKCQl2YXIgZW5kID0gYWRkRGF5cyhjbG9uZURhdGUoc3RhcnQpLCA3KTsKCQl2YXIgdmlzU3RhcnQgPSBjbG9uZURhdGUoc3RhcnQpOwoJCXZhciB2aXNFbmQgPSBjbG9uZURhdGUoZW5kKTsKCQl2YXIgd2Vla2VuZHMgPSBvcHQoJ3dlZWtlbmRzJyk7CgkJaWYgKCF3ZWVrZW5kcykgewoJCQlza2lwV2Vla2VuZCh2aXNTdGFydCk7CgkJCXNraXBXZWVrZW5kKHZpc0VuZCwgLTEsIHRydWUpOwoJCX0KCQl0LnRpdGxlID0gZm9ybWF0RGF0ZXMoCgkJCXZpc1N0YXJ0LAoJCQlhZGREYXlzKGNsb25lRGF0ZSh2aXNFbmQpLCAtMSksCgkJCW9wdCgndGl0bGVGb3JtYXQnKQoJCSk7CgkJdC5zdGFydCA9IHN0YXJ0OwoJCXQuZW5kID0gZW5kOwoJCXQudmlzU3RhcnQgPSB2aXNTdGFydDsKCQl0LnZpc0VuZCA9IHZpc0VuZDsKCQlyZW5kZXJCYXNpYygxLCB3ZWVrZW5kcyA/IDcgOiA1LCBmYWxzZSk7Cgl9CgkKCQp9CgpmY1ZpZXdzLmJhc2ljRGF5ID0gQmFzaWNEYXlWaWV3OwoKLy9UT0RPOiB3aGVuIGNhbGVuZGFyJ3MgZGF0ZSBzdGFydHMgb3V0IG9uIGEgd2Vla2VuZCwgc2hvdWxkbid0IGhhcHBlbgoKCmZ1bmN0aW9uIEJhc2ljRGF5VmlldyhlbGVtZW50LCBjYWxlbmRhcikgewoJdmFyIHQgPSB0aGlzOwoJCgkKCS8vIGV4cG9ydHMKCXQucmVuZGVyID0gcmVuZGVyOwoJCgkKCS8vIGltcG9ydHMKCUJhc2ljVmlldy5jYWxsKHQsIGVsZW1lbnQsIGNhbGVuZGFyLCAnYmFzaWNEYXknKTsKCXZhciBvcHQgPSB0Lm9wdDsKCXZhciByZW5kZXJCYXNpYyA9IHQucmVuZGVyQmFzaWM7Cgl2YXIgZm9ybWF0RGF0ZSA9IGNhbGVuZGFyLmZvcm1hdERhdGU7CgkKCQoJCglmdW5jdGlvbiByZW5kZXIoZGF0ZSwgZGVsdGEpIHsKCQlpZiAoZGVsdGEpIHsKCQkJYWRkRGF5cyhkYXRlLCBkZWx0YSk7CgkJCWlmICghb3B0KCd3ZWVrZW5kcycpKSB7CgkJCQlza2lwV2Vla2VuZChkYXRlLCBkZWx0YSA8IDAgPyAtMSA6IDEpOwoJCQl9CgkJfQoJCXQudGl0bGUgPSBmb3JtYXREYXRlKGRhdGUsIG9wdCgndGl0bGVGb3JtYXQnKSk7CgkJdC5zdGFydCA9IHQudmlzU3RhcnQgPSBjbG9uZURhdGUoZGF0ZSwgdHJ1ZSk7CgkJdC5lbmQgPSB0LnZpc0VuZCA9IGFkZERheXMoY2xvbmVEYXRlKHQuc3RhcnQpLCAxKTsKCQlyZW5kZXJCYXNpYygxLCAxLCBmYWxzZSk7Cgl9CgkKCQp9Cgp2YXIgdGRIZWlnaHRCdWc7CgpzZXREZWZhdWx0cyh7Cgl3ZWVrTW9kZTogJ2ZpeGVkJwp9KTsKCgpmdW5jdGlvbiBCYXNpY1ZpZXcoZWxlbWVudCwgY2FsZW5kYXIsIHZpZXdOYW1lKSB7Cgl2YXIgdCA9IHRoaXM7CgkKCQoJLy8gZXhwb3J0cwoJdC5yZW5kZXJCYXNpYyA9IHJlbmRlckJhc2ljOwoJdC5zZXRIZWlnaHQgPSBzZXRIZWlnaHQ7Cgl0LnNldFdpZHRoID0gc2V0V2lkdGg7Cgl0LnJlbmRlckRheU92ZXJsYXkgPSByZW5kZXJEYXlPdmVybGF5OwoJdC5kZWZhdWx0U2VsZWN0aW9uRW5kID0gZGVmYXVsdFNlbGVjdGlvbkVuZDsKCXQucmVuZGVyU2VsZWN0aW9uID0gcmVuZGVyU2VsZWN0aW9uOwoJdC5jbGVhclNlbGVjdGlvbiA9IGNsZWFyU2VsZWN0aW9uOwoJdC5kcmFnU3RhcnQgPSBkcmFnU3RhcnQ7Cgl0LmRyYWdTdG9wID0gZHJhZ1N0b3A7Cgl0LmRlZmF1bHRFdmVudEVuZCA9IGRlZmF1bHRFdmVudEVuZDsKCXQuZ2V0SG92ZXJMaXN0ZW5lciA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gaG92ZXJMaXN0ZW5lciB9OwoJdC5jb2xDb250ZW50TGVmdCA9IGNvbENvbnRlbnRMZWZ0OwoJdC5jb2xDb250ZW50UmlnaHQgPSBjb2xDb250ZW50UmlnaHQ7Cgl0LmRheU9mV2Vla0NvbCA9IGRheU9mV2Vla0NvbDsKCXQuZGF0ZUNlbGwgPSBkYXRlQ2VsbDsKCXQuY2VsbERhdGUgPSBjZWxsRGF0ZTsKCXQuY2VsbElzQWxsRGF5ID0gZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlIH07Cgl0LmFsbERheVRSID0gYWxsRGF5VFI7Cgl0LmFsbERheUJvdW5kcyA9IGFsbERheUJvdW5kczsKCXQuZ2V0Um93Q250ID0gZnVuY3Rpb24oKSB7IHJldHVybiByb3dDbnQgfTsKCXQuZ2V0Q29sQ250ID0gZnVuY3Rpb24oKSB7IHJldHVybiBjb2xDbnQgfTsKCXQuZ2V0Q29sV2lkdGggPSBmdW5jdGlvbigpIHsgcmV0dXJuIGNvbFdpZHRoIH07Cgl0LmdldERheVNlZ21lbnRDb250YWluZXIgPSBmdW5jdGlvbigpIHsgcmV0dXJuIGRheVNlZ21lbnRDb250YWluZXIgfTsKCQoJCgkvLyBpbXBvcnRzCglWaWV3LmNhbGwodCwgZWxlbWVudCwgY2FsZW5kYXIsIHZpZXdOYW1lKTsKCU92ZXJsYXlNYW5hZ2VyLmNhbGwodCk7CglTZWxlY3Rpb25NYW5hZ2VyLmNhbGwodCk7CglCYXNpY0V2ZW50UmVuZGVyZXIuY2FsbCh0KTsKCXZhciBvcHQgPSB0Lm9wdDsKCXZhciB0cmlnZ2VyID0gdC50cmlnZ2VyOwoJdmFyIGNsZWFyRXZlbnRzID0gdC5jbGVhckV2ZW50czsKCXZhciByZW5kZXJPdmVybGF5ID0gdC5yZW5kZXJPdmVybGF5OwoJdmFyIGNsZWFyT3ZlcmxheXMgPSB0LmNsZWFyT3ZlcmxheXM7Cgl2YXIgZGF5U2VsZWN0aW9uTW91c2Vkb3duID0gdC5kYXlTZWxlY3Rpb25Nb3VzZWRvd247Cgl2YXIgZm9ybWF0RGF0ZSA9IGNhbGVuZGFyLmZvcm1hdERhdGU7CgkKCQoJLy8gbG9jYWxzCgl2YXIgcnRsLCBkaXMsIGRpdDsKCXZhciBmaXJzdERheTsKCXZhciBud2U7Cgl2YXIgcm93Q250LCBjb2xDbnQ7Cgl2YXIgY29sV2lkdGg7Cgl2YXIgdmlld1dpZHRoLCB2aWV3SGVpZ2h0OwoJdmFyIHRoZWFkLCB0Ym9keTsKCXZhciBkYXlTZWdtZW50Q29udGFpbmVyOwoJdmFyIGNvb3JkaW5hdGVHcmlkOwoJdmFyIGhvdmVyTGlzdGVuZXI7Cgl2YXIgY29sQ29udGVudFBvc2l0aW9uczsKCQoJCgkKCS8qIFJlbmRlcmluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglkaXNhYmxlVGV4dFNlbGVjdGlvbihlbGVtZW50LmFkZENsYXNzKCdmYy1ncmlkJykpOwoJCgkKCWZ1bmN0aW9uIHJlbmRlckJhc2ljKHIsIGMsIHNob3dOdW1iZXJzKSB7CgkKCQlyb3dDbnQgPSByOwoJCWNvbENudCA9IGM7CgkJcnRsID0gb3B0KCdpc1JUTCcpOwoJCWlmIChydGwpIHsKCQkJZGlzID0gLTE7CgkJCWRpdCA9IGNvbENudCAtIDE7CgkJfWVsc2V7CgkJCWRpcyA9IDE7CgkJCWRpdCA9IDA7CgkJfQoJCWZpcnN0RGF5ID0gb3B0KCdmaXJzdERheScpOwoJCW53ZSA9IG9wdCgnd2Vla2VuZHMnKSA/IDAgOiAxOwoJCQoJCXZhciB0bSA9IG9wdCgndGhlbWUnKSA/ICd1aScgOiAnZmMnOwoJCXZhciBjb2xGb3JtYXQgPSBvcHQoJ2NvbHVtbkZvcm1hdCcpOwoJCXZhciBtb250aCA9IHQuc3RhcnQuZ2V0TW9udGgoKTsKCQl2YXIgdG9kYXkgPSBjbGVhclRpbWUobmV3IERhdGUoKSk7CgkJdmFyIHMsIGksIGosIGQgPSBjbG9uZURhdGUodC52aXNTdGFydCk7CgkJCgkJaWYgKCF0Ym9keSkgeyAvLyBmaXJzdCB0aW1lLCBidWlsZCBhbGwgY2VsbHMgZnJvbSBzY3JhdGNoCgkJCgkJCXZhciB0YWJsZSA9ICQoIjx0YWJsZS8+IikuYXBwZW5kVG8oZWxlbWVudCk7CgkJCQoJCQlzID0gIjx0aGVhZD48dHI+IjsKCQkJZm9yIChpPTA7IGk8Y29sQ250OyBpKyspIHsKCQkJCXMgKz0gIjx0aCBjbGFzcz0nZmMtIiArCgkJCQkJZGF5SURzW2QuZ2V0RGF5KCldICsgJyAnICsgLy8gbmVlZHMgdG8gYmUgZmlyc3QKCQkJCQl0bSArICctc3RhdGUtZGVmYXVsdCcgKwoJCQkJCShpPT1kaXQgPyAnIGZjLWxlZnRtb3N0JyA6ICcnKSArCgkJCQkJIic+IiArIGZvcm1hdERhdGUoZCwgY29sRm9ybWF0KSArICI8L3RoPiI7CgkJCQlhZGREYXlzKGQsIDEpOwoJCQkJaWYgKG53ZSkgewoJCQkJCXNraXBXZWVrZW5kKGQpOwoJCQkJfQoJCQl9CgkJCXRoZWFkID0gJChzICsgIjwvdHI+PC90aGVhZD4iKS5hcHBlbmRUbyh0YWJsZSk7CgkJCQoJCQlzID0gIjx0Ym9keT4iOwoJCQlkID0gY2xvbmVEYXRlKHQudmlzU3RhcnQpOwoJCQlmb3IgKGk9MDsgaTxyb3dDbnQ7IGkrKykgewoJCQkJcyArPSAiPHRyIGNsYXNzPSdmYy13ZWVrIiArIGkgKyAiJz4iOwoJCQkJZm9yIChqPTA7IGo8Y29sQ250OyBqKyspIHsKCQkJCQlzICs9ICI8dGQgY2xhc3M9J2ZjLSIgKwoJCQkJCQlkYXlJRHNbZC5nZXREYXkoKV0gKyAnICcgKyAvLyBuZWVkcyB0byBiZSBmaXJzdAoJCQkJCQl0bSArICctc3RhdGUtZGVmYXVsdCBmYy1kYXknICsgKGkqY29sQ250K2opICsKCQkJCQkJKGo9PWRpdCA/ICcgZmMtbGVmdG1vc3QnIDogJycpICsKCQkJCQkJKHJvd0NudD4xICYmIGQuZ2V0TW9udGgoKSAhPSBtb250aCA/ICcgZmMtb3RoZXItbW9udGgnIDogJycpICsKCQkJCQkJKCtkID09ICt0b2RheSA/CgkJCQkJCScgZmMtdG9kYXkgJyt0bSsnLXN0YXRlLWhpZ2hsaWdodCcgOgoJCQkJCQknIGZjLW5vdC10b2RheScpICsgIic+IiArCgkJCQkJCShzaG93TnVtYmVycyA/ICI8ZGl2IGNsYXNzPSdmYy1kYXktbnVtYmVyJz4iICsgZC5nZXREYXRlKCkgKyAiPC9kaXY+IiA6ICcnKSArCgkJCQkJCSI8ZGl2IGNsYXNzPSdmYy1kYXktY29udGVudCc+PGRpdiBzdHlsZT0ncG9zaXRpb246cmVsYXRpdmUnPiZuYnNwOzwvZGl2PjwvZGl2PjwvdGQ+IjsKCQkJCQlhZGREYXlzKGQsIDEpOwoJCQkJCWlmIChud2UpIHsKCQkJCQkJc2tpcFdlZWtlbmQoZCk7CgkJCQkJfQoJCQkJfQoJCQkJcyArPSAiPC90cj4iOwoJCQl9CgkJCXRib2R5ID0gJChzICsgIjwvdGJvZHk+IikuYXBwZW5kVG8odGFibGUpOwoJCQlkYXlCaW5kKHRib2R5LmZpbmQoJ3RkJykpOwoJCQkKCQkJZGF5U2VnbWVudENvbnRhaW5lciA9ICQoIjxkaXYgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6ODt0b3A6MDtsZWZ0OjAnLz4iKS5hcHBlbmRUbyhlbGVtZW50KTsKCQkKCQl9ZWxzZXsgLy8gTk9UIGZpcnN0IHRpbWUsIHJldXNlIGFzIG1hbnkgY2VsbHMgYXMgcG9zc2libGUKCQkKCQkJY2xlYXJFdmVudHMoKTsKCQkKCQkJdmFyIHByZXZSb3dDbnQgPSB0Ym9keS5maW5kKCd0cicpLmxlbmd0aDsKCQkJaWYgKHJvd0NudCA8IHByZXZSb3dDbnQpIHsKCQkJCXRib2R5LmZpbmQoJ3RyOmd0KCcgKyAocm93Q250LTEpICsgJyknKS5yZW1vdmUoKTsgLy8gcmVtb3ZlIGV4dHJhIHJvd3MKCQkJfQoJCQllbHNlIGlmIChyb3dDbnQgPiBwcmV2Um93Q250KSB7IC8vIG5lZWRzIHRvIGNyZWF0ZSBuZXcgcm93cy4uLgoJCQkJcyA9ICcnOwoJCQkJZm9yIChpPXByZXZSb3dDbnQ7IGk8cm93Q250OyBpKyspIHsKCQkJCQlzICs9ICI8dHIgY2xhc3M9J2ZjLXdlZWsiICsgaSArICInPiI7CgkJCQkJZm9yIChqPTA7IGo8Y29sQ250OyBqKyspIHsKCQkJCQkJcyArPSAiPHRkIGNsYXNzPSdmYy0iICsKCQkJCQkJCWRheUlEc1tkLmdldERheSgpXSArICcgJyArIC8vIG5lZWRzIHRvIGJlIGZpcnN0CgkJCQkJCQl0bSArICctc3RhdGUtZGVmYXVsdCBmYy1uZXcgZmMtZGF5JyArIChpKmNvbENudCtqKSArCgkJCQkJCQkoaj09ZGl0ID8gJyBmYy1sZWZ0bW9zdCcgOiAnJykgKyAiJz4iICsKCQkJCQkJCShzaG93TnVtYmVycyA/ICI8ZGl2IGNsYXNzPSdmYy1kYXktbnVtYmVyJz48L2Rpdj4iIDogJycpICsKCQkJCQkJCSI8ZGl2IGNsYXNzPSdmYy1kYXktY29udGVudCc+PGRpdiBzdHlsZT0ncG9zaXRpb246cmVsYXRpdmUnPiZuYnNwOzwvZGl2PjwvZGl2PiIgKwoJCQkJCQkJIjwvdGQ+IjsKCQkJCQkJYWRkRGF5cyhkLCAxKTsKCQkJCQkJaWYgKG53ZSkgewoJCQkJCQkJc2tpcFdlZWtlbmQoZCk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcyArPSAiPC90cj4iOwoJCQkJfQoJCQkJdGJvZHkuYXBwZW5kKHMpOwoJCQl9CgkJCWRheUJpbmQodGJvZHkuZmluZCgndGQuZmMtbmV3JykucmVtb3ZlQ2xhc3MoJ2ZjLW5ldycpKTsKCQkJCgkJCS8vIHJlLWxhYmVsIGFuZCByZS1jbGFzcyBleGlzdGluZyBjZWxscwoJCQlkID0gY2xvbmVEYXRlKHQudmlzU3RhcnQpOwoJCQl0Ym9keS5maW5kKCd0ZCcpLmVhY2goZnVuY3Rpb24oKSB7CgkJCQl2YXIgdGQgPSAkKHRoaXMpOwoJCQkJaWYgKHJvd0NudCA+IDEpIHsKCQkJCQlpZiAoZC5nZXRNb250aCgpID09IG1vbnRoKSB7CgkJCQkJCXRkLnJlbW92ZUNsYXNzKCdmYy1vdGhlci1tb250aCcpOwoJCQkJCX1lbHNlewoJCQkJCQl0ZC5hZGRDbGFzcygnZmMtb3RoZXItbW9udGgnKTsKCQkJCQl9CgkJCQl9CgkJCQlpZiAoK2QgPT0gK3RvZGF5KSB7CgkJCQkJdGQucmVtb3ZlQ2xhc3MoJ2ZjLW5vdC10b2RheScpCgkJCQkJCS5hZGRDbGFzcygnZmMtdG9kYXknKQoJCQkJCQkuYWRkQ2xhc3ModG0gKyAnLXN0YXRlLWhpZ2hsaWdodCcpOwoJCQkJfWVsc2V7CgkJCQkJdGQuYWRkQ2xhc3MoJ2ZjLW5vdC10b2RheScpCgkJCQkJCS5yZW1vdmVDbGFzcygnZmMtdG9kYXknKQoJCQkJCQkucmVtb3ZlQ2xhc3ModG0gKyAnLXN0YXRlLWhpZ2hsaWdodCcpOwoJCQkJfQoJCQkJdGQuZmluZCgnZGl2LmZjLWRheS1udW1iZXInKS50ZXh0KGQuZ2V0RGF0ZSgpKTsKCQkJCWFkZERheXMoZCwgMSk7CgkJCQlpZiAobndlKSB7CgkJCQkJc2tpcFdlZWtlbmQoZCk7CgkJCQl9CgkJCX0pOwoJCQkKCQkJaWYgKHJvd0NudCA9PSAxKSB7IC8vIG1vcmUgY2hhbmdlcyBsaWtlbHkgKHdlZWsgb3IgZGF5IHZpZXcpCgkJCQoJCQkJLy8gcmVkbyBjb2x1bW4gaGVhZGVyIHRleHQgYW5kIGNsYXNzCgkJCQlkID0gY2xvbmVEYXRlKHQudmlzU3RhcnQpOwoJCQkJdGhlYWQuZmluZCgndGgnKS5lYWNoKGZ1bmN0aW9uKGksIHRoKSB7CgkJCQkJJCh0aCkudGV4dChmb3JtYXREYXRlKGQsIGNvbEZvcm1hdCkpOwoJCQkJCXRoLmNsYXNzTmFtZSA9IHRoLmNsYXNzTmFtZS5yZXBsYWNlKC9eZmMtXHcrKD89ICkvLCAnZmMtJyArIGRheUlEc1tkLmdldERheSgpXSk7CgkJCQkJYWRkRGF5cyhkLCAxKTsKCQkJCQlpZiAobndlKSB7CgkJCQkJCXNraXBXZWVrZW5kKGQpOwoJCQkJCX0KCQkJCX0pOwoJCQkJCgkJCQkvLyByZWRvIGNlbGwgZGF5LW9mLXdlZWtzCgkJCQlkID0gY2xvbmVEYXRlKHQudmlzU3RhcnQpOwoJCQkJdGJvZHkuZmluZCgndGQnKS5lYWNoKGZ1bmN0aW9uKGksIHRkKSB7CgkJCQkJdGQuY2xhc3NOYW1lID0gdGQuY2xhc3NOYW1lLnJlcGxhY2UoL15mYy1cdysoPz0gKS8sICdmYy0nICsgZGF5SURzW2QuZ2V0RGF5KCldKTsKCQkJCQlhZGREYXlzKGQsIDEpOwoJCQkJCWlmIChud2UpIHsKCQkJCQkJc2tpcFdlZWtlbmQoZCk7CgkJCQkJfQoJCQkJfSk7CgkJCQkKCQkJfQoJCQoJCX0KCQkKCX0KCQoJCglmdW5jdGlvbiBzZXRIZWlnaHQoaGVpZ2h0KSB7CgkJdmlld0hlaWdodCA9IGhlaWdodDsKCQl2YXIgbGVmdFREcyA9IHRib2R5LmZpbmQoJ3RyIHRkOmZpcnN0LWNoaWxkJyksCgkJCXRib2R5SGVpZ2h0ID0gdmlld0hlaWdodCAtIHRoZWFkLmhlaWdodCgpLAoJCQlyb3dIZWlnaHQxLCByb3dIZWlnaHQyOwoJCWlmIChvcHQoJ3dlZWtNb2RlJykgPT0gJ3ZhcmlhYmxlJykgewoJCQlyb3dIZWlnaHQxID0gcm93SGVpZ2h0MiA9IE1hdGguZmxvb3IodGJvZHlIZWlnaHQgLyAocm93Q250PT0xID8gMiA6IDYpKTsKCQl9ZWxzZXsKCQkJcm93SGVpZ2h0MSA9IE1hdGguZmxvb3IodGJvZHlIZWlnaHQgLyByb3dDbnQpOwoJCQlyb3dIZWlnaHQyID0gdGJvZHlIZWlnaHQgLSByb3dIZWlnaHQxKihyb3dDbnQtMSk7CgkJfQoJCWlmICh0ZEhlaWdodEJ1ZyA9PT0gdW5kZWZpbmVkKSB7CgkJCS8vIGJ1ZyBpbiBmaXJlZm94IHdoZXJlIGNlbGwgaGVpZ2h0IGluY2x1ZGVzIHBhZGRpbmcKCQkJdmFyIHRyID0gdGJvZHkuZmluZCgndHI6Zmlyc3QnKSwKCQkJCXRkID0gdHIuZmluZCgndGQ6Zmlyc3QnKTsKCQkJdGQuaGVpZ2h0KHJvd0hlaWdodDEpOwoJCQl0ZEhlaWdodEJ1ZyA9IHJvd0hlaWdodDEgIT0gdGQuaGVpZ2h0KCk7CgkJfQoJCWlmICh0ZEhlaWdodEJ1ZykgewoJCQlsZWZ0VERzLnNsaWNlKDAsIC0xKS5oZWlnaHQocm93SGVpZ2h0MSk7CgkJCWxlZnRURHMuc2xpY2UoLTEpLmhlaWdodChyb3dIZWlnaHQyKTsKCQl9ZWxzZXsKCQkJc2V0T3V0ZXJIZWlnaHQobGVmdFREcy5zbGljZSgwLCAtMSksIHJvd0hlaWdodDEpOwoJCQlzZXRPdXRlckhlaWdodChsZWZ0VERzLnNsaWNlKC0xKSwgcm93SGVpZ2h0Mik7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIHNldFdpZHRoKHdpZHRoKSB7CgkJdmlld1dpZHRoID0gd2lkdGg7CgkJY29sQ29udGVudFBvc2l0aW9ucy5jbGVhcigpOwoJCWNvbFdpZHRoID0gTWF0aC5mbG9vcih2aWV3V2lkdGggLyBjb2xDbnQpOwoJCXNldE91dGVyV2lkdGgodGhlYWQuZmluZCgndGgnKS5zbGljZSgwLCAtMSksIGNvbFdpZHRoKTsKCX0KCQoJCgkKCS8qIERheSBjbGlja2luZyBhbmQgYmluZGluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIGRheUJpbmQoZGF5cykgewoJCWRheXMuY2xpY2soZGF5Q2xpY2spCgkJCS5tb3VzZWRvd24oZGF5U2VsZWN0aW9uTW91c2Vkb3duKTsKCX0KCQoJCglmdW5jdGlvbiBkYXlDbGljayhldikgewoJCWlmICghb3B0KCdzZWxlY3RhYmxlJykpIHsgLy8gU2VsZWN0aW9uTWFuYWdlciB3aWxsIHdvcnJ5IGFib3V0IGRheUNsaWNrCgkJCXZhciBuID0gcGFyc2VJbnQodGhpcy5jbGFzc05hbWUubWF0Y2goL2ZjXC1kYXkoXGQrKS8pWzFdKSwKCQkJCWRhdGUgPSBhZGREYXlzKAoJCQkJCWNsb25lRGF0ZSh0LnZpc1N0YXJ0KSwKCQkJCQlNYXRoLmZsb29yKG4vY29sQ250KSAqIDcgKyBuICUgY29sQ250CgkJCQkpOwoJCQkvLyBUT0RPOiB3aGF0IGFib3V0IHdlZWtlbmRzIGluIG1pZGRsZSBvZiB3ZWVrPwoJCQl0cmlnZ2VyKCdkYXlDbGljaycsIHRoaXMsIGRhdGUsIHRydWUsIGV2KTsKCQl9Cgl9CgkKCQoJCgkvKiBTZW1pLXRyYW5zcGFyZW50IE92ZXJsYXkgSGVscGVycwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglmdW5jdGlvbiByZW5kZXJEYXlPdmVybGF5KG92ZXJsYXlTdGFydCwgb3ZlcmxheUVuZCwgcmVmcmVzaENvb3JkaW5hdGVHcmlkKSB7IC8vIG92ZXJsYXlFbmQgaXMgZXhjbHVzaXZlCgkJaWYgKHJlZnJlc2hDb29yZGluYXRlR3JpZCkgewoJCQljb29yZGluYXRlR3JpZC5idWlsZCgpOwoJCX0KCQl2YXIgcm93U3RhcnQgPSBjbG9uZURhdGUodC52aXNTdGFydCk7CgkJdmFyIHJvd0VuZCA9IGFkZERheXMoY2xvbmVEYXRlKHJvd1N0YXJ0KSwgY29sQ250KTsKCQlmb3IgKHZhciBpPTA7IGk8cm93Q250OyBpKyspIHsKCQkJdmFyIHN0cmV0Y2hTdGFydCA9IG5ldyBEYXRlKE1hdGgubWF4KHJvd1N0YXJ0LCBvdmVybGF5U3RhcnQpKTsKCQkJdmFyIHN0cmV0Y2hFbmQgPSBuZXcgRGF0ZShNYXRoLm1pbihyb3dFbmQsIG92ZXJsYXlFbmQpKTsKCQkJaWYgKHN0cmV0Y2hTdGFydCA8IHN0cmV0Y2hFbmQpIHsKCQkJCXZhciBjb2xTdGFydCwgY29sRW5kOwoJCQkJaWYgKHJ0bCkgewoJCQkJCWNvbFN0YXJ0ID0gZGF5RGlmZihzdHJldGNoRW5kLCByb3dTdGFydCkqZGlzK2RpdCsxOwoJCQkJCWNvbEVuZCA9IGRheURpZmYoc3RyZXRjaFN0YXJ0LCByb3dTdGFydCkqZGlzK2RpdCsxOwoJCQkJfWVsc2V7CgkJCQkJY29sU3RhcnQgPSBkYXlEaWZmKHN0cmV0Y2hTdGFydCwgcm93U3RhcnQpOwoJCQkJCWNvbEVuZCA9IGRheURpZmYoc3RyZXRjaEVuZCwgcm93U3RhcnQpOwoJCQkJfQoJCQkJZGF5QmluZCgKCQkJCQlyZW5kZXJDZWxsT3ZlcmxheShpLCBjb2xTdGFydCwgaSwgY29sRW5kLTEpCgkJCQkpOwoJCQl9CgkJCWFkZERheXMocm93U3RhcnQsIDcpOwoJCQlhZGREYXlzKHJvd0VuZCwgNyk7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIHJlbmRlckNlbGxPdmVybGF5KHJvdzAsIGNvbDAsIHJvdzEsIGNvbDEpIHsgLy8gcm93MSxjb2wxIGlzIGluY2x1c2l2ZQoJCXZhciByZWN0ID0gY29vcmRpbmF0ZUdyaWQucmVjdChyb3cwLCBjb2wwLCByb3cxLCBjb2wxLCBlbGVtZW50KTsKCQlyZXR1cm4gcmVuZGVyT3ZlcmxheShyZWN0LCBlbGVtZW50KTsKCX0KCQoJCgkKCS8qIFNlbGVjdGlvbgoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIGRlZmF1bHRTZWxlY3Rpb25FbmQoc3RhcnREYXRlLCBhbGxEYXkpIHsKCQlyZXR1cm4gY2xvbmVEYXRlKHN0YXJ0RGF0ZSk7Cgl9CgkKCQoJZnVuY3Rpb24gcmVuZGVyU2VsZWN0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgYWxsRGF5KSB7CgkJcmVuZGVyRGF5T3ZlcmxheShzdGFydERhdGUsIGFkZERheXMoY2xvbmVEYXRlKGVuZERhdGUpLCAxKSwgdHJ1ZSk7IC8vIHJlYnVpbGQgZXZlcnkgdGltZT8/PwoJfQoJCgkKCWZ1bmN0aW9uIGNsZWFyU2VsZWN0aW9uKCkgewoJCWNsZWFyT3ZlcmxheXMoKTsKCX0KCQoJCgkKCS8qIEV4dGVybmFsIERyYWdnaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gZHJhZ1N0YXJ0KF9kcmFnRWxlbWVudCwgZXYsIHVpKSB7CgkJaG92ZXJMaXN0ZW5lci5zdGFydChmdW5jdGlvbihjZWxsKSB7CgkJCWNsZWFyT3ZlcmxheXMoKTsKCQkJaWYgKGNlbGwpIHsKCQkJCXJlbmRlckNlbGxPdmVybGF5KGNlbGwucm93LCBjZWxsLmNvbCwgY2VsbC5yb3csIGNlbGwuY29sKTsKCQkJfQoJCX0sIGV2KTsKCX0KCQoJCglmdW5jdGlvbiBkcmFnU3RvcChfZHJhZ0VsZW1lbnQsIGV2LCB1aSkgewoJCXZhciBjZWxsID0gaG92ZXJMaXN0ZW5lci5zdG9wKCk7CgkJY2xlYXJPdmVybGF5cygpOwoJCWlmIChjZWxsKSB7CgkJCXZhciBkID0gY2VsbERhdGUoY2VsbCk7CgkJCXRyaWdnZXIoJ2Ryb3AnLCBfZHJhZ0VsZW1lbnQsIGQsIHRydWUsIGV2LCB1aSk7CgkJfQoJfQoJCgkKCQoJLyogVXRpbGl0aWVzCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gZGVmYXVsdEV2ZW50RW5kKGV2ZW50KSB7CgkJcmV0dXJuIGNsb25lRGF0ZShldmVudC5zdGFydCk7Cgl9CgkKCQoJY29vcmRpbmF0ZUdyaWQgPSBuZXcgQ29vcmRpbmF0ZUdyaWQoZnVuY3Rpb24ocm93cywgY29scykgewoJCXZhciBlLCBuLCBwOwoJCXZhciB0ZHMgPSB0Ym9keS5maW5kKCd0cjpmaXJzdCB0ZCcpOwoJCWlmIChydGwpIHsKCQkJdGRzID0gJCh0ZHMuZ2V0KCkucmV2ZXJzZSgpKTsKCQl9CgkJdGRzLmVhY2goZnVuY3Rpb24oaSwgX2UpIHsKCQkJZSA9ICQoX2UpOwoJCQluID0gZS5vZmZzZXQoKS5sZWZ0OwoJCQlpZiAoaSkgewoJCQkJcFsxXSA9IG47CgkJCX0KCQkJcCA9IFtuXTsKCQkJY29sc1tpXSA9IHA7CgkJfSk7CgkJcFsxXSA9IG4gKyBlLm91dGVyV2lkdGgoKTsKCQl0Ym9keS5maW5kKCd0cicpLmVhY2goZnVuY3Rpb24oaSwgX2UpIHsKCQkJZSA9ICQoX2UpOwoJCQluID0gZS5vZmZzZXQoKS50b3A7CgkJCWlmIChpKSB7CgkJCQlwWzFdID0gbjsKCQkJfQoJCQlwID0gW25dOwoJCQlyb3dzW2ldID0gcDsKCQl9KTsKCQlwWzFdID0gbiArIGUub3V0ZXJIZWlnaHQoKTsKCX0pOwoJCgkKCWhvdmVyTGlzdGVuZXIgPSBuZXcgSG92ZXJMaXN0ZW5lcihjb29yZGluYXRlR3JpZCk7CgkKCQoJY29sQ29udGVudFBvc2l0aW9ucyA9IG5ldyBIb3Jpem9udGFsUG9zaXRpb25DYWNoZShmdW5jdGlvbihjb2wpIHsKCQlyZXR1cm4gdGJvZHkuZmluZCgndGQ6ZXEoJyArIGNvbCArICcpIGRpdiBkaXYnKTsKCX0pOwoJCgkKCWZ1bmN0aW9uIGNvbENvbnRlbnRMZWZ0KGNvbCkgewoJCXJldHVybiBjb2xDb250ZW50UG9zaXRpb25zLmxlZnQoY29sKTsKCX0KCQoJCglmdW5jdGlvbiBjb2xDb250ZW50UmlnaHQoY29sKSB7CgkJcmV0dXJuIGNvbENvbnRlbnRQb3NpdGlvbnMucmlnaHQoY29sKTsKCX0KCQoJCglmdW5jdGlvbiBkYXlPZldlZWtDb2woZGF5T2ZXZWVrKSB7CgkJcmV0dXJuIChkYXlPZldlZWsgLSBNYXRoLm1heChmaXJzdERheSwgbndlKSArIGNvbENudCkgJSBjb2xDbnQ7Cgl9CgkKCQoJZnVuY3Rpb24gZGF0ZUNlbGwoZGF0ZSkgewoJCXJldHVybiB7CgkJCXJvdzogTWF0aC5mbG9vcihkYXlEaWZmKGRhdGUsIHQudmlzU3RhcnQpIC8gNyksCgkJCWNvbDogZGF5T2ZXZWVrQ29sKGRhdGUuZ2V0RGF5KCkpKmRpcyArIGRpdAoJCX07Cgl9CgkKCQoJZnVuY3Rpb24gY2VsbERhdGUoY2VsbCkgewoJCXJldHVybiBhZGREYXlzKGNsb25lRGF0ZSh0LnZpc1N0YXJ0KSwgY2VsbC5yb3cqNyArIGNlbGwuY29sKmRpcytkaXQpOwoJCS8vIFRPRE86IHdoYXQgYWJvdXQgd2Vla2VuZHMgaW4gbWlkZGxlIG9mIHdlZWs/Cgl9CgkKCQoJZnVuY3Rpb24gYWxsRGF5VFIoaSkgewoJCXJldHVybiB0Ym9keS5maW5kKCd0cjplcSgnK2krJyknKTsKCX0KCQoJCglmdW5jdGlvbiBhbGxEYXlCb3VuZHMoaSkgewoJCXJldHVybiB7CgkJCWxlZnQ6IDAsCgkJCXJpZ2h0OiB2aWV3V2lkdGgKCQl9OwoJfQoJCgkKfQoKZnVuY3Rpb24gQmFzaWNFdmVudFJlbmRlcmVyKCkgewoJdmFyIHQgPSB0aGlzOwoJCgkKCS8vIGV4cG9ydHMKCXQucmVuZGVyRXZlbnRzID0gcmVuZGVyRXZlbnRzOwoJdC5jb21waWxlRGF5U2VncyA9IGNvbXBpbGVTZWdzOyAvLyBmb3IgRGF5RXZlbnRSZW5kZXJlcgoJdC5jbGVhckV2ZW50cyA9IGNsZWFyRXZlbnRzOwoJdC5iaW5kRGF5U2VnID0gYmluZERheVNlZzsKCQoJCgkvLyBpbXBvcnRzCglEYXlFdmVudFJlbmRlcmVyLmNhbGwodCk7Cgl2YXIgb3B0ID0gdC5vcHQ7Cgl2YXIgdHJpZ2dlciA9IHQudHJpZ2dlcjsKCXZhciByZXBvcnRFdmVudHMgPSB0LnJlcG9ydEV2ZW50czsKCXZhciByZXBvcnRFdmVudENsZWFyID0gdC5yZXBvcnRFdmVudENsZWFyOwoJdmFyIGV2ZW50RWxlbWVudEhhbmRsZXJzID0gdC5ldmVudEVsZW1lbnRIYW5kbGVyczsKCXZhciBzaG93RXZlbnRzID0gdC5zaG93RXZlbnRzOwoJdmFyIGhpZGVFdmVudHMgPSB0LmhpZGVFdmVudHM7Cgl2YXIgZXZlbnREcm9wID0gdC5ldmVudERyb3A7Cgl2YXIgZ2V0RGF5U2VnbWVudENvbnRhaW5lciA9IHQuZ2V0RGF5U2VnbWVudENvbnRhaW5lcjsKCXZhciBnZXRIb3Zlckxpc3RlbmVyID0gdC5nZXRIb3Zlckxpc3RlbmVyOwoJdmFyIHJlbmRlckRheU92ZXJsYXkgPSB0LnJlbmRlckRheU92ZXJsYXk7Cgl2YXIgY2xlYXJPdmVybGF5cyA9IHQuY2xlYXJPdmVybGF5czsKCXZhciBnZXRSb3dDbnQgPSB0LmdldFJvd0NudDsKCXZhciBnZXRDb2xDbnQgPSB0LmdldENvbENudDsKCXZhciByZW5kZXJEYXlTZWdzID0gdC5yZW5kZXJEYXlTZWdzOwoJdmFyIHJlc2l6YWJsZURheUV2ZW50ID0gdC5yZXNpemFibGVEYXlFdmVudDsKCQoJCgkKCS8qIFJlbmRlcmluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIHJlbmRlckV2ZW50cyhldmVudHMsIG1vZGlmaWVkRXZlbnRJZCkgewoJCXJlcG9ydEV2ZW50cyhldmVudHMpOwoJCXJlbmRlckRheVNlZ3MoY29tcGlsZVNlZ3MoZXZlbnRzKSwgbW9kaWZpZWRFdmVudElkKTsKCX0KCQoJCglmdW5jdGlvbiBjbGVhckV2ZW50cygpIHsKCQlyZXBvcnRFdmVudENsZWFyKCk7CgkJZ2V0RGF5U2VnbWVudENvbnRhaW5lcigpLmVtcHR5KCk7Cgl9CgkKCQoJZnVuY3Rpb24gY29tcGlsZVNlZ3MoZXZlbnRzKSB7CgkJdmFyIHJvd0NudCA9IGdldFJvd0NudCgpLAoJCQljb2xDbnQgPSBnZXRDb2xDbnQoKSwKCQkJZDEgPSBjbG9uZURhdGUodC52aXNTdGFydCksCgkJCWQyID0gYWRkRGF5cyhjbG9uZURhdGUoZDEpLCBjb2xDbnQpLAoJCQl2aXNFdmVudHNFbmRzID0gJC5tYXAoZXZlbnRzLCBleGNsRW5kRGF5KSwKCQkJaSwgcm93LAoJCQlqLCBsZXZlbCwKCQkJaywgc2VnLAoJCQlzZWdzPVtdOwoJCWZvciAoaT0wOyBpPHJvd0NudDsgaSsrKSB7CgkJCXJvdyA9IHN0YWNrU2VncyhzbGljZVNlZ3MoZXZlbnRzLCB2aXNFdmVudHNFbmRzLCBkMSwgZDIpKTsKCQkJZm9yIChqPTA7IGo8cm93Lmxlbmd0aDsgaisrKSB7CgkJCQlsZXZlbCA9IHJvd1tqXTsKCQkJCWZvciAoaz0wOyBrPGxldmVsLmxlbmd0aDsgaysrKSB7CgkJCQkJc2VnID0gbGV2ZWxba107CgkJCQkJc2VnLnJvdyA9IGk7CgkJCQkJc2VnLmxldmVsID0gajsgLy8gbm90IG5lZWRlZCBhbnltb3JlCgkJCQkJc2Vncy5wdXNoKHNlZyk7CgkJCQl9CgkJCX0KCQkJYWRkRGF5cyhkMSwgNyk7CgkJCWFkZERheXMoZDIsIDcpOwoJCX0KCQlyZXR1cm4gc2VnczsKCX0KCQoJCglmdW5jdGlvbiBiaW5kRGF5U2VnKGV2ZW50LCBldmVudEVsZW1lbnQsIHNlZykgewoJCWV2ZW50RWxlbWVudEhhbmRsZXJzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCWlmIChldmVudC5lZGl0YWJsZSB8fCBldmVudC5lZGl0YWJsZSA9PT0gdW5kZWZpbmVkICYmIG9wdCgnZWRpdGFibGUnKSkgewoJCQlkcmFnZ2FibGVEYXlFdmVudChldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJaWYgKHNlZy5pc0VuZCkgewoJCQkJcmVzaXphYmxlRGF5RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgc2VnKTsKCQkJfQoJCX0KCX0KCQoJCgkKCS8qIERyYWdnaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglmdW5jdGlvbiBkcmFnZ2FibGVEYXlFdmVudChldmVudCwgZXZlbnRFbGVtZW50KSB7CgkJaWYgKCFvcHQoJ2Rpc2FibGVEcmFnZ2luZycpICYmIGV2ZW50RWxlbWVudC5kcmFnZ2FibGUpIHsKCQkJdmFyIGhvdmVyTGlzdGVuZXIgPSBnZXRIb3Zlckxpc3RlbmVyKCk7CgkJCXZhciBkYXlEZWx0YTsKCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSh7CgkJCQl6SW5kZXg6IDksCgkJCQlkZWxheTogNTAsCgkJCQlvcGFjaXR5OiBvcHQoJ2RyYWdPcGFjaXR5JyksCgkJCQlyZXZlcnREdXJhdGlvbjogb3B0KCdkcmFnUmV2ZXJ0RHVyYXRpb24nKSwKCQkJCXN0YXJ0OiBmdW5jdGlvbihldiwgdWkpIHsKCQkJCQl0cmlnZ2VyKCdldmVudERyYWdTdGFydCcsIGV2ZW50RWxlbWVudCwgZXZlbnQsIGV2LCB1aSk7CgkJCQkJaGlkZUV2ZW50cyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJCQlob3Zlckxpc3RlbmVyLnN0YXJ0KGZ1bmN0aW9uKGNlbGwsIG9yaWdDZWxsLCByb3dEZWx0YSwgY29sRGVsdGEpIHsKCQkJCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSgnb3B0aW9uJywgJ3JldmVydCcsICFjZWxsIHx8ICFyb3dEZWx0YSAmJiAhY29sRGVsdGEpOwoJCQkJCQljbGVhck92ZXJsYXlzKCk7CgkJCQkJCWlmIChjZWxsKSB7CgkJCQkJCQlkYXlEZWx0YSA9IHJvd0RlbHRhKjcgKyBjb2xEZWx0YSAqIChvcHQoJ2lzUlRMJykgPyAtMSA6IDEpOwoJCQkJCQkJcmVuZGVyRGF5T3ZlcmxheSgKCQkJCQkJCQlhZGREYXlzKGNsb25lRGF0ZShldmVudC5zdGFydCksIGRheURlbHRhKSwKCQkJCQkJCQlhZGREYXlzKGV4Y2xFbmREYXkoZXZlbnQpLCBkYXlEZWx0YSkKCQkJCQkJCSk7CgkJCQkJCX1lbHNlewoJCQkJCQkJZGF5RGVsdGEgPSAwOwoJCQkJCQl9CgkJCQkJfSwgZXYsICdkcmFnJyk7CgkJCQl9LAoJCQkJc3RvcDogZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJaG92ZXJMaXN0ZW5lci5zdG9wKCk7CgkJCQkJY2xlYXJPdmVybGF5cygpOwoJCQkJCXRyaWdnZXIoJ2V2ZW50RHJhZ1N0b3AnLCBldmVudEVsZW1lbnQsIGV2ZW50LCBldiwgdWkpOwoJCQkJCWlmIChkYXlEZWx0YSkgewoJCQkJCQlldmVudEVsZW1lbnQuZmluZCgnYScpLnJlbW92ZUF0dHIoJ2hyZWYnKTsgLy8gcHJldmVudHMgc2FmYXJpIGZyb20gdmlzaXRpbmcgdGhlIGxpbmsKCQkJCQkJZXZlbnREcm9wKHRoaXMsIGV2ZW50LCBkYXlEZWx0YSwgMCwgZXZlbnQuYWxsRGF5LCBldiwgdWkpOwoJCQkJCX1lbHNlewoJCQkJCQlpZiAoJC5icm93c2VyLm1zaWUpIHsKCQkJCQkJCWV2ZW50RWxlbWVudC5jc3MoJ2ZpbHRlcicsICcnKTsgLy8gY2xlYXIgSUUgb3BhY2l0eSBzaWRlLWVmZmVjdHMKCQkJCQkJfQoJCQkJCQlzaG93RXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfQoJfQoKCn0KCmZjVmlld3MuYWdlbmRhV2VlayA9IEFnZW5kYVdlZWtWaWV3OwoKZnVuY3Rpb24gQWdlbmRhV2Vla1ZpZXcoZWxlbWVudCwgY2FsZW5kYXIpIHsKCXZhciB0ID0gdGhpczsKCQoJCgkvLyBleHBvcnRzCgl0LnJlbmRlciA9IHJlbmRlcjsKCQoJCgkvLyBpbXBvcnRzCglBZ2VuZGFWaWV3LmNhbGwodCwgZWxlbWVudCwgY2FsZW5kYXIsICdhZ2VuZGFXZWVrJyk7Cgl2YXIgb3B0ID0gdC5vcHQ7Cgl2YXIgcmVuZGVyQWdlbmRhID0gdC5yZW5kZXJBZ2VuZGE7Cgl2YXIgZm9ybWF0RGF0ZXMgPSBjYWxlbmRhci5mb3JtYXREYXRlczsKCQoJCgkKCWZ1bmN0aW9uIHJlbmRlcihkYXRlLCBkZWx0YSkgewoJCWlmIChkZWx0YSkgewoJCQlhZGREYXlzKGRhdGUsIGRlbHRhICogNyk7CgkJfQoJCXZhciBzdGFydCA9IGFkZERheXMoY2xvbmVEYXRlKGRhdGUpLCAtKChkYXRlLmdldERheSgpIC0gb3B0KCdmaXJzdERheScpICsgNykgJSA3KSk7CgkJdmFyIGVuZCA9IGFkZERheXMoY2xvbmVEYXRlKHN0YXJ0KSwgNyk7CgkJdmFyIHZpc1N0YXJ0ID0gY2xvbmVEYXRlKHN0YXJ0KTsKCQl2YXIgdmlzRW5kID0gY2xvbmVEYXRlKGVuZCk7CgkJdmFyIHdlZWtlbmRzID0gb3B0KCd3ZWVrZW5kcycpOwoJCWlmICghd2Vla2VuZHMpIHsKCQkJc2tpcFdlZWtlbmQodmlzU3RhcnQpOwoJCQlza2lwV2Vla2VuZCh2aXNFbmQsIC0xLCB0cnVlKTsKCQl9CgkJdC50aXRsZSA9IGZvcm1hdERhdGVzKAoJCQl2aXNTdGFydCwKCQkJYWRkRGF5cyhjbG9uZURhdGUodmlzRW5kKSwgLTEpLAoJCQlvcHQoJ3RpdGxlRm9ybWF0JykKCQkpOwoJCXQuc3RhcnQgPSBzdGFydDsKCQl0LmVuZCA9IGVuZDsKCQl0LnZpc1N0YXJ0ID0gdmlzU3RhcnQ7CgkJdC52aXNFbmQgPSB2aXNFbmQ7CgkJcmVuZGVyQWdlbmRhKHdlZWtlbmRzID8gNyA6IDUpOwoJfQoJCgp9CgpmY1ZpZXdzLmFnZW5kYURheSA9IEFnZW5kYURheVZpZXc7CgpmdW5jdGlvbiBBZ2VuZGFEYXlWaWV3KGVsZW1lbnQsIGNhbGVuZGFyKSB7Cgl2YXIgdCA9IHRoaXM7CgkKCQoJLy8gZXhwb3J0cwoJdC5yZW5kZXIgPSByZW5kZXI7CgkKCQoJLy8gaW1wb3J0cwoJQWdlbmRhVmlldy5jYWxsKHQsIGVsZW1lbnQsIGNhbGVuZGFyLCAnYWdlbmRhRGF5Jyk7Cgl2YXIgb3B0ID0gdC5vcHQ7Cgl2YXIgcmVuZGVyQWdlbmRhID0gdC5yZW5kZXJBZ2VuZGE7Cgl2YXIgZm9ybWF0RGF0ZSA9IGNhbGVuZGFyLmZvcm1hdERhdGU7CgkKCQoJCglmdW5jdGlvbiByZW5kZXIoZGF0ZSwgZGVsdGEpIHsKCQlpZiAoZGVsdGEpIHsKCQkJYWRkRGF5cyhkYXRlLCBkZWx0YSk7CgkJCWlmICghb3B0KCd3ZWVrZW5kcycpKSB7CgkJCQlza2lwV2Vla2VuZChkYXRlLCBkZWx0YSA8IDAgPyAtMSA6IDEpOwoJCQl9CgkJfQoJCXZhciBzdGFydCA9IGNsb25lRGF0ZShkYXRlLCB0cnVlKTsKCQl2YXIgZW5kID0gYWRkRGF5cyhjbG9uZURhdGUoc3RhcnQpLCAxKTsKCQl0LnRpdGxlID0gZm9ybWF0RGF0ZShkYXRlLCBvcHQoJ3RpdGxlRm9ybWF0JykpOwoJCXQuc3RhcnQgPSB0LnZpc1N0YXJ0ID0gc3RhcnQ7CgkJdC5lbmQgPSB0LnZpc0VuZCA9IGVuZDsKCQlyZW5kZXJBZ2VuZGEoMSk7Cgl9CgkKCn0KCnNldERlZmF1bHRzKHsKCWFsbERheVNsb3Q6IHRydWUsCglhbGxEYXlUZXh0OiAnYWxsLWRheScsCglmaXJzdEhvdXI6IDYsCglzbG90TWludXRlczogMzAsCglkZWZhdWx0RXZlbnRNaW51dGVzOiAxMjAsCglheGlzRm9ybWF0OiAnaCg6bW0pdHQnLAoJdGltZUZvcm1hdDogewoJCWFnZW5kYTogJ2g6bW17IC0gaDptbX0nCgl9LAoJZHJhZ09wYWNpdHk6IHsKCQlhZ2VuZGE6IC41Cgl9LAoJbWluVGltZTogMCwKCW1heFRpbWU6IDI0Cn0pOwoKCmZ1bmN0aW9uIEFnZW5kYVZpZXcoZWxlbWVudCwgY2FsZW5kYXIsIHZpZXdOYW1lKSB7Cgl2YXIgdCA9IHRoaXM7CgkKCQoJLy8gZXhwb3J0cwoJdC5yZW5kZXJBZ2VuZGEgPSByZW5kZXJBZ2VuZGE7Cgl0LnNldFdpZHRoID0gc2V0V2lkdGg7Cgl0LnNldEhlaWdodCA9IHNldEhlaWdodDsKCXQuYmVmb3JlSGlkZSA9IGJlZm9yZUhpZGU7Cgl0LmFmdGVyU2hvdyA9IGFmdGVyU2hvdzsKCXQuZGVmYXVsdEV2ZW50RW5kID0gZGVmYXVsdEV2ZW50RW5kOwoJdC50aW1lUG9zaXRpb24gPSB0aW1lUG9zaXRpb247Cgl0LmRheU9mV2Vla0NvbCA9IGRheU9mV2Vla0NvbDsKCXQuZGF0ZUNlbGwgPSBkYXRlQ2VsbDsKCXQuY2VsbERhdGUgPSBjZWxsRGF0ZTsKCXQuY2VsbElzQWxsRGF5ID0gY2VsbElzQWxsRGF5OwoJdC5hbGxEYXlUUiA9IGFsbERheVRSOwoJdC5hbGxEYXlCb3VuZHMgPSBhbGxEYXlCb3VuZHM7Cgl0LmdldEhvdmVyTGlzdGVuZXIgPSBmdW5jdGlvbigpIHsgcmV0dXJuIGhvdmVyTGlzdGVuZXIgfTsKCXQuY29sQ29udGVudExlZnQgPSBjb2xDb250ZW50TGVmdDsKCXQuY29sQ29udGVudFJpZ2h0ID0gY29sQ29udGVudFJpZ2h0OwoJdC5nZXREYXlTZWdtZW50Q29udGFpbmVyID0gZnVuY3Rpb24oKSB7IHJldHVybiBkYXlTZWdtZW50Q29udGFpbmVyIH07Cgl0LmdldFNsb3RTZWdtZW50Q29udGFpbmVyID0gZnVuY3Rpb24oKSB7IHJldHVybiBzbG90U2VnbWVudENvbnRhaW5lciB9OwoJdC5nZXRNaW5NaW51dGUgPSBmdW5jdGlvbigpIHsgcmV0dXJuIG1pbk1pbnV0ZSB9OwoJdC5nZXRNYXhNaW51dGUgPSBmdW5jdGlvbigpIHsgcmV0dXJuIG1heE1pbnV0ZSB9OwoJdC5nZXRCb2R5Q29udGVudCA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gYm9keUNvbnRlbnQgfTsKCXQuZ2V0Um93Q250ID0gZnVuY3Rpb24oKSB7IHJldHVybiAxIH07Cgl0LmdldENvbENudCA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gY29sQ250IH07Cgl0LmdldENvbFdpZHRoID0gZnVuY3Rpb24oKSB7IHJldHVybiBjb2xXaWR0aCB9OwoJdC5nZXRTbG90SGVpZ2h0ID0gZnVuY3Rpb24oKSB7IHJldHVybiBzbG90SGVpZ2h0IH07Cgl0LmRlZmF1bHRTZWxlY3Rpb25FbmQgPSBkZWZhdWx0U2VsZWN0aW9uRW5kOwoJdC5yZW5kZXJEYXlPdmVybGF5ID0gcmVuZGVyRGF5T3ZlcmxheTsKCXQucmVuZGVyU2VsZWN0aW9uID0gcmVuZGVyU2VsZWN0aW9uOwoJdC5jbGVhclNlbGVjdGlvbiA9IGNsZWFyU2VsZWN0aW9uOwoJdC5kcmFnU3RhcnQgPSBkcmFnU3RhcnQ7Cgl0LmRyYWdTdG9wID0gZHJhZ1N0b3A7CgkKCQoJLy8gaW1wb3J0cwoJVmlldy5jYWxsKHQsIGVsZW1lbnQsIGNhbGVuZGFyLCB2aWV3TmFtZSk7CglPdmVybGF5TWFuYWdlci5jYWxsKHQpOwoJU2VsZWN0aW9uTWFuYWdlci5jYWxsKHQpOwoJQWdlbmRhRXZlbnRSZW5kZXJlci5jYWxsKHQpOwoJdmFyIG9wdCA9IHQub3B0OwoJdmFyIHRyaWdnZXIgPSB0LnRyaWdnZXI7Cgl2YXIgY2xlYXJFdmVudHMgPSB0LmNsZWFyRXZlbnRzOwoJdmFyIHJlbmRlck92ZXJsYXkgPSB0LnJlbmRlck92ZXJsYXk7Cgl2YXIgY2xlYXJPdmVybGF5cyA9IHQuY2xlYXJPdmVybGF5czsKCXZhciByZXBvcnRTZWxlY3Rpb24gPSB0LnJlcG9ydFNlbGVjdGlvbjsKCXZhciB1bnNlbGVjdCA9IHQudW5zZWxlY3Q7Cgl2YXIgZGF5U2VsZWN0aW9uTW91c2Vkb3duID0gdC5kYXlTZWxlY3Rpb25Nb3VzZWRvd247Cgl2YXIgc2xvdFNlZ0h0bWwgPSB0LnNsb3RTZWdIdG1sOwoJdmFyIGZvcm1hdERhdGUgPSBjYWxlbmRhci5mb3JtYXREYXRlOwoJCgkKCS8vIGxvY2FscwoJdmFyIGhlYWQsIGJvZHksIGJvZHlDb250ZW50LCBib2R5VGFibGUsIGJnOwoJdmFyIGNvbENudDsKCXZhciBzbG90Q250PTA7IC8vIHNwYW5uaW5nIGFsbCB0aGUgd2F5IGFjcm9zcwoJdmFyIGF4aXNXaWR0aCwgY29sV2lkdGgsIHNsb3RIZWlnaHQ7Cgl2YXIgdmlld1dpZHRoLCB2aWV3SGVpZ2h0OwoJdmFyIHNhdmVkU2Nyb2xsVG9wOwoJdmFyIHRtLCBmaXJzdERheTsKCXZhciBud2U7ICAgICAgICAgICAgLy8gbm8gd2Vla2VuZHMgKGludCkKCXZhciBydGwsIGRpcywgZGl0OyAgLy8gZGF5IGluZGV4IHNpZ24gLyB0cmFuc2xhdGUKCXZhciBtaW5NaW51dGUsIG1heE1pbnV0ZTsKCXZhciBjb29yZGluYXRlR3JpZDsKCXZhciBob3Zlckxpc3RlbmVyOwoJdmFyIGNvbENvbnRlbnRQb3NpdGlvbnM7Cgl2YXIgc2xvdFRvcENhY2hlID0ge307Cgl2YXIgc2VsZWN0aW9uSGVscGVyOwoJdmFyIGRheVNlZ21lbnRDb250YWluZXI7Cgl2YXIgc2xvdFNlZ21lbnRDb250YWluZXI7CgkKCgkKCS8qIFJlbmRlcmluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWRpc2FibGVUZXh0U2VsZWN0aW9uKGVsZW1lbnQuYWRkQ2xhc3MoJ2ZjLWFnZW5kYScpKTsKCQoJCglmdW5jdGlvbiByZW5kZXJBZ2VuZGEoYykgewoJCgkJY29sQ250ID0gYzsKCQkKCQkvLyB1cGRhdGUgb3B0aW9uLWRlcml2ZWQgdmFyaWFibGVzCgkJdG0gPSBvcHQoJ3RoZW1lJykgPyAndWknIDogJ2ZjJzsKCQlud2UgPSBvcHQoJ3dlZWtlbmRzJykgPyAwIDogMTsKCQlmaXJzdERheSA9IG9wdCgnZmlyc3REYXknKTsKCQlpZiAocnRsID0gb3B0KCdpc1JUTCcpKSB7CgkJCWRpcyA9IC0xOwoJCQlkaXQgPSBjb2xDbnQgLSAxOwoJCX1lbHNlewoJCQlkaXMgPSAxOwoJCQlkaXQgPSAwOwoJCX0KCQltaW5NaW51dGUgPSBwYXJzZVRpbWUob3B0KCdtaW5UaW1lJykpOwoJCW1heE1pbnV0ZSA9IHBhcnNlVGltZShvcHQoJ21heFRpbWUnKSk7CgkJCgkJdmFyIGQwID0gcnRsID8gYWRkRGF5cyhjbG9uZURhdGUodC52aXNFbmQpLCAtMSkgOiBjbG9uZURhdGUodC52aXNTdGFydCksCgkJCWQgPSBjbG9uZURhdGUoZDApLAoJCQl0b2RheSA9IGNsZWFyVGltZShuZXcgRGF0ZSgpKSwKCQkJY29sRm9ybWF0ID0gb3B0KCdjb2x1bW5Gb3JtYXQnKTsKCQkKCQlpZiAoIWhlYWQpIHsgLy8gZmlyc3QgdGltZSByZW5kZXJpbmcsIGJ1aWxkIGZyb20gc2NyYXRjaAoJCQoJCQl2YXIgaSwKCQkJCW1pbnV0ZXMsCgkJCQlzbG90Tm9ybWFsID0gb3B0KCdzbG90TWludXRlcycpICUgMTUgPT0gMCwgLy8uLi4KCQkJCgkJCS8vIGhlYWQKCQkJcyA9ICI8ZGl2IGNsYXNzPSdmYy1hZ2VuZGEtaGVhZCcgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlO3otaW5kZXg6NCc+IiArCgkJCQkiPHRhYmxlIHN0eWxlPSd3aWR0aDoxMDAlJz4iICsKCQkJCSI8dHIgY2xhc3M9J2ZjLWZpcnN0IiArIChvcHQoJ2FsbERheVNsb3QnKSA/ICcnIDogJyBmYy1sYXN0JykgKyAiJz4iICsKCQkJCSI8dGggY2xhc3M9J2ZjLWxlZnRtb3N0ICIgKwoJCQkJCXRtICsgIi1zdGF0ZS1kZWZhdWx0Jz4mbmJzcDs8L3RoPiI7CgkJCWZvciAoaT0wOyBpPGNvbENudDsgaSsrKSB7CgkJCQlzICs9ICI8dGggY2xhc3M9J2ZjLSIgKwoJCQkJCWRheUlEc1tkLmdldERheSgpXSArICcgJyArIC8vIG5lZWRzIHRvIGJlIGZpcnN0CgkJCQkJdG0gKyAnLXN0YXRlLWRlZmF1bHQnICsKCQkJCQkiJz4iICsgZm9ybWF0RGF0ZShkLCBjb2xGb3JtYXQpICsgIjwvdGg+IjsKCQkJCWFkZERheXMoZCwgZGlzKTsKCQkJCWlmIChud2UpIHsKCQkJCQlza2lwV2Vla2VuZChkLCBkaXMpOwoJCQkJfQoJCQl9CgkJCXMgKz0gIjx0aCBjbGFzcz0nIiArIHRtICsgIi1zdGF0ZS1kZWZhdWx0Jz4mbmJzcDs8L3RoPjwvdHI+IjsKCQkJaWYgKG9wdCgnYWxsRGF5U2xvdCcpKSB7CgkJCQlzICs9ICI8dHIgY2xhc3M9J2ZjLWFsbC1kYXknPiIgKwoJCQkJCQkiPHRoIGNsYXNzPSdmYy1heGlzIGZjLWxlZnRtb3N0ICIgKyB0bSArICItc3RhdGUtZGVmYXVsdCc+IiArIG9wdCgnYWxsRGF5VGV4dCcpICsgIjwvdGg+IiArCgkJCQkJCSI8dGQgY29sc3Bhbj0nIiArIGNvbENudCArICInIGNsYXNzPSciICsgdG0gKyAiLXN0YXRlLWRlZmF1bHQnPiIgKwoJCQkJCQkJIjxkaXYgY2xhc3M9J2ZjLWRheS1jb250ZW50Jz48ZGl2IHN0eWxlPSdwb3NpdGlvbjpyZWxhdGl2ZSc+Jm5ic3A7PC9kaXY+PC9kaXY+PC90ZD4iICsKCQkJCQkJIjx0aCBjbGFzcz0nIiArIHRtICsgIi1zdGF0ZS1kZWZhdWx0Jz4mbmJzcDs8L3RoPiIgKwoJCQkJCSI8L3RyPjx0ciBjbGFzcz0nZmMtZGl2aWRlciBmYy1sYXN0Jz48dGggY29sc3Bhbj0nIiArIChjb2xDbnQrMikgKyAiJyBjbGFzcz0nIiArCgkJCQkJCXRtICsgIi1zdGF0ZS1kZWZhdWx0IGZjLWxlZnRtb3N0Jz48ZGl2Lz48L3RoPjwvdHI+IjsKCQkJfQoJCQlzKz0gIjwvdGFibGU+PC9kaXY+IjsKCQkJaGVhZCA9ICQocykuYXBwZW5kVG8oZWxlbWVudCk7CgkJCWRheUJpbmQoaGVhZC5maW5kKCd0ZCcpKTsKCQkJCgkJCS8vIGFsbC1kYXkgZXZlbnQgY29udGFpbmVyCgkJCWRheVNlZ21lbnRDb250YWluZXIgPSAkKCI8ZGl2IHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4Ojg7dG9wOjA7bGVmdDowJy8+IikuYXBwZW5kVG8oaGVhZCk7CgkJCQoJCQkvLyBib2R5CgkJCWQgPSB6ZXJvRGF0ZSgpOwoJCQl2YXIgbWF4ZCA9IGFkZE1pbnV0ZXMoY2xvbmVEYXRlKGQpLCBtYXhNaW51dGUpOwoJCQlhZGRNaW51dGVzKGQsIG1pbk1pbnV0ZSk7CgkJCXMgPSAiPHRhYmxlPiI7CgkJCWZvciAoaT0wOyBkIDwgbWF4ZDsgaSsrKSB7CgkJCQltaW51dGVzID0gZC5nZXRNaW51dGVzKCk7CgkJCQlzICs9ICI8dHIgY2xhc3M9JyIgKwoJCQkJCSghaSA/ICdmYy1maXJzdCcgOiAoIW1pbnV0ZXMgPyAnJyA6ICdmYy1taW5vcicpKSArCgkJCQkJIic+PHRoIGNsYXNzPSdmYy1heGlzIGZjLWxlZnRtb3N0ICIgKyB0bSArICItc3RhdGUtZGVmYXVsdCc+IiArCgkJCQkJKCghc2xvdE5vcm1hbCB8fCAhbWludXRlcykgPyBmb3JtYXREYXRlKGQsIG9wdCgnYXhpc0Zvcm1hdCcpKSA6ICcmbmJzcDsnKSArIAoJCQkJCSI8L3RoPjx0ZCBjbGFzcz0nZmMtc2xvdCIgKyBpICsgJyAnICsKCQkJCQkJdG0gKyAiLXN0YXRlLWRlZmF1bHQnPjxkaXYgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlJz4mbmJzcDs8L2Rpdj48L3RkPjwvdHI+IjsKCQkJCWFkZE1pbnV0ZXMoZCwgb3B0KCdzbG90TWludXRlcycpKTsKCQkJCXNsb3RDbnQrKzsKCQkJfQoJCQlzICs9ICI8L3RhYmxlPiI7CgkJCWJvZHkgPSAkKCI8ZGl2IGNsYXNzPSdmYy1hZ2VuZGEtYm9keScgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlO3otaW5kZXg6MjtvdmVyZmxvdzphdXRvJy8+IikKCQkJCS5hcHBlbmQoYm9keUNvbnRlbnQgPSAkKCI8ZGl2IHN0eWxlPSdwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW4nPiIpCgkJCQkJLmFwcGVuZChib2R5VGFibGUgPSAkKHMpKSkKCQkJCS5hcHBlbmRUbyhlbGVtZW50KTsKCQkJc2xvdEJpbmQoYm9keS5maW5kKCd0ZCcpKTsKCQkJCgkJCS8vIHNsb3QgZXZlbnQgY29udGFpbmVyCgkJCXNsb3RTZWdtZW50Q29udGFpbmVyID0gJCgiPGRpdiBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDo4O3RvcDowO2xlZnQ6MCcvPiIpLmFwcGVuZFRvKGJvZHlDb250ZW50KTsKCQkJCgkJCS8vIGJhY2tncm91bmQgc3RyaXBlcwoJCQlkID0gY2xvbmVEYXRlKGQwKTsKCQkJcyA9ICI8ZGl2IGNsYXNzPSdmYy1hZ2VuZGEtYmcnIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjEnPiIgKwoJCQkJIjx0YWJsZSBzdHlsZT0nd2lkdGg6MTAwJTtoZWlnaHQ6MTAwJSc+PHRyIGNsYXNzPSdmYy1maXJzdCc+IjsKCQkJZm9yIChpPTA7IGk8Y29sQ250OyBpKyspIHsKCQkJCXMgKz0gIjx0ZCBjbGFzcz0nZmMtIiArCgkJCQkJZGF5SURzW2QuZ2V0RGF5KCldICsgJyAnICsgLy8gbmVlZHMgdG8gYmUgZmlyc3QKCQkJCQl0bSArICctc3RhdGUtZGVmYXVsdCAnICsKCQkJCQkoIWkgPyAnZmMtbGVmdG1vc3QgJyA6ICcnKSArCgkJCQkJKCtkID09ICt0b2RheSA/IHRtICsgJy1zdGF0ZS1oaWdobGlnaHQgZmMtdG9kYXknIDogJ2ZjLW5vdC10b2RheScpICsKCQkJCQkiJz48ZGl2IGNsYXNzPSdmYy1kYXktY29udGVudCc+PGRpdj4mbmJzcDs8L2Rpdj48L2Rpdj48L3RkPiI7CgkJCQlhZGREYXlzKGQsIGRpcyk7CgkJCQlpZiAobndlKSB7CgkJCQkJc2tpcFdlZWtlbmQoZCwgZGlzKTsKCQkJCX0KCQkJfQoJCQlzICs9ICI8L3RyPjwvdGFibGU+PC9kaXY+IjsKCQkJYmcgPSAkKHMpLmFwcGVuZFRvKGVsZW1lbnQpOwoJCQkKCQl9ZWxzZXsgLy8gc2tlbGV0b24gYWxyZWFkeSBidWlsdCwganVzdCBtb2RpZnkgaXQKCQkKCQkJY2xlYXJFdmVudHMoKTsKCQkJCgkJCS8vIHJlZG8gY29sdW1uIGhlYWRlciB0ZXh0IGFuZCBjbGFzcwoJCQloZWFkLmZpbmQoJ3RyOmZpcnN0IHRoJykuc2xpY2UoMSwgLTEpLmVhY2goZnVuY3Rpb24oaSwgdGgpIHsKCQkJCSQodGgpLnRleHQoZm9ybWF0RGF0ZShkLCBjb2xGb3JtYXQpKTsKCQkJCXRoLmNsYXNzTmFtZSA9IHRoLmNsYXNzTmFtZS5yZXBsYWNlKC9eZmMtXHcrKD89ICkvLCAnZmMtJyArIGRheUlEc1tkLmdldERheSgpXSk7CgkJCQlhZGREYXlzKGQsIGRpcyk7CgkJCQlpZiAobndlKSB7CgkJCQkJc2tpcFdlZWtlbmQoZCwgZGlzKTsKCQkJCX0KCQkJfSk7CgkJCQoJCQkvLyBjaGFuZ2UgY2xhc3NlcyBvZiBiYWNrZ3JvdW5kIHN0cmlwZXMKCQkJZCA9IGNsb25lRGF0ZShkMCk7CgkJCWJnLmZpbmQoJ3RkJykuZWFjaChmdW5jdGlvbihpLCB0ZCkgewoJCQkJdGQuY2xhc3NOYW1lID0gdGQuY2xhc3NOYW1lLnJlcGxhY2UoL15mYy1cdysoPz0gKS8sICdmYy0nICsgZGF5SURzW2QuZ2V0RGF5KCldKTsKCQkJCWlmICgrZCA9PSArdG9kYXkpIHsKCQkJCQkkKHRkKQoJCQkJCQkucmVtb3ZlQ2xhc3MoJ2ZjLW5vdC10b2RheScpCgkJCQkJCS5hZGRDbGFzcygnZmMtdG9kYXknKQoJCQkJCQkuYWRkQ2xhc3ModG0gKyAnLXN0YXRlLWhpZ2hsaWdodCcpOwoJCQkJfWVsc2V7CgkJCQkJJCh0ZCkKCQkJCQkJLmFkZENsYXNzKCdmYy1ub3QtdG9kYXknKQoJCQkJCQkucmVtb3ZlQ2xhc3MoJ2ZjLXRvZGF5JykKCQkJCQkJLnJlbW92ZUNsYXNzKHRtICsgJy1zdGF0ZS1oaWdobGlnaHQnKTsKCQkJCX0KCQkJCWFkZERheXMoZCwgZGlzKTsKCQkJCWlmIChud2UpIHsKCQkJCQlza2lwV2Vla2VuZChkLCBkaXMpOwoJCQkJfQoJCQl9KTsKCQkKCQl9CgkJCgl9CgkKCQoJCglmdW5jdGlvbiBzZXRIZWlnaHQoaGVpZ2h0LCBkYXRlQ2hhbmdlZCkgewoJCgkJaWYgKGhlaWdodCA9PT0gdW5kZWZpbmVkKSB7CgkJCWhlaWdodCA9IHZpZXdIZWlnaHQ7CgkJfQoJCQoJCXZpZXdIZWlnaHQgPSBoZWlnaHQ7CgkJc2xvdFRvcENhY2hlID0ge307CgkJCgkJdmFyIGJvZHlIZWlnaHQgPSBoZWlnaHQgLSBoZWFkLmhlaWdodCgpOwoJCWJvZHlIZWlnaHQgPSBNYXRoLm1pbihib2R5SGVpZ2h0LCBib2R5VGFibGUuaGVpZ2h0KCkpOyAvLyBzaHJpbmsgdG8gZml0IHRhYmxlCgkJYm9keS5oZWlnaHQoYm9keUhlaWdodCk7CgkJCgkJc2xvdEhlaWdodCA9IGJvZHkuZmluZCgndHI6Zmlyc3QgZGl2JykuaGVpZ2h0KCkgKyAxOwoJCQoJCWlmIChkYXRlQ2hhbmdlZCkgewoJCQlyZXNldFNjcm9sbCgpOwoJCX0KCX0KCQoJCgkKCWZ1bmN0aW9uIHNldFdpZHRoKHdpZHRoKSB7CgkJdmlld1dpZHRoID0gd2lkdGg7CgkJY29sQ29udGVudFBvc2l0aW9ucy5jbGVhcigpOwoJCQoJCWJvZHkud2lkdGgod2lkdGgpLmNzcygnb3ZlcmZsb3cnLCAnYXV0bycpOwoJCWJvZHlUYWJsZS53aWR0aCgnJyk7CgkJCgkJdmFyIHRvcFREcyA9IGhlYWQuZmluZCgndHI6Zmlyc3QgdGgnKSwKCQkJYWxsRGF5TGFzdFRIID0gaGVhZC5maW5kKCd0ci5mYy1hbGwtZGF5IHRoOmxhc3QnKSwKCQkJc3RyaXBlVERzID0gYmcuZmluZCgndGQnKSwKCQkJY2xpZW50V2lkdGggPSBib2R5WzBdLmNsaWVudFdpZHRoOwoJCQkKCQlib2R5VGFibGUud2lkdGgoY2xpZW50V2lkdGgpOwoJCWNsaWVudFdpZHRoID0gYm9keVswXS5jbGllbnRXaWR0aDsgLy8gaW4gaWU2LCBzb21ldGltZXMgcHJldmlvdXMgY2xpZW50V2lkdGggd2FzIHdyb25nbHkgcmVwb3J0ZWQKCQlib2R5VGFibGUud2lkdGgoY2xpZW50V2lkdGgpOwoJCQoJCS8vIHRpbWUtYXhpcyB3aWR0aAoJCWF4aXNXaWR0aCA9IDA7CgkJc2V0T3V0ZXJXaWR0aCgKCQkJaGVhZC5maW5kKCd0cjpsdCgyKSB0aDpmaXJzdCcpLmFkZChib2R5LmZpbmQoJ3RyOmZpcnN0IHRoJykpCgkJCQkud2lkdGgoMSkKCQkJCS5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJCWF4aXNXaWR0aCA9IE1hdGgubWF4KGF4aXNXaWR0aCwgJCh0aGlzKS5vdXRlcldpZHRoKCkpOwoJCQkJfSksCgkJCWF4aXNXaWR0aAoJCSk7CgkJCgkJLy8gY29sdW1uIHdpZHRoLCBleGNlcHQgZm9yIGxhc3QgY29sdW1uCgkJY29sV2lkdGggPSBNYXRoLmZsb29yKChjbGllbnRXaWR0aCAtIGF4aXNXaWR0aCkgLyBjb2xDbnQpOwoJCXNldE91dGVyV2lkdGgoc3RyaXBlVERzLnNsaWNlKDAsIC0xKSwgY29sV2lkdGgpOwoJCXNldE91dGVyV2lkdGgodG9wVERzLnNsaWNlKDEsIC0yKSwgY29sV2lkdGgpOwoJCQoJCS8vIGNvbHVtbiB3aWR0aCBmb3IgbGFzdCBjb2x1bW4KCQlpZiAod2lkdGggIT0gY2xpZW50V2lkdGgpIHsgLy8gaGFzIHNjcm9sbGJhcgoJCQlzZXRPdXRlcldpZHRoKHRvcFREcy5zbGljZSgtMiwgLTEpLCBjbGllbnRXaWR0aCAtIGF4aXNXaWR0aCAtIGNvbFdpZHRoKihjb2xDbnQtMSkpOwoJCQl0b3BURHMuc2xpY2UoLTEpLnNob3coKTsKCQkJYWxsRGF5TGFzdFRILnNob3coKTsKCQl9ZWxzZXsKCQkJYm9keS5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpOwoJCQl0b3BURHMuc2xpY2UoLTIsIC0xKS53aWR0aCgnJyk7CgkJCXRvcFREcy5zbGljZSgtMSkuaGlkZSgpOwoJCQlhbGxEYXlMYXN0VEguaGlkZSgpOwoJCX0KCQkKCQliZy5jc3MoewoJCQl0b3A6IGhlYWQuZmluZCgndHInKS5oZWlnaHQoKSwKCQkJbGVmdDogYXhpc1dpZHRoLAoJCQl3aWR0aDogY2xpZW50V2lkdGggLSBheGlzV2lkdGgsCgkJCWhlaWdodDogdmlld0hlaWdodAoJCX0pOwoJfQoJCgkKCWZ1bmN0aW9uIHJlc2V0U2Nyb2xsKCkgewoJCXZhciBkMCA9IHplcm9EYXRlKCksCgkJCXNjcm9sbERhdGUgPSBjbG9uZURhdGUoZDApOwoJCXNjcm9sbERhdGUuc2V0SG91cnMob3B0KCdmaXJzdEhvdXInKSk7CgkJdmFyIHRvcCA9IHRpbWVQb3NpdGlvbihkMCwgc2Nyb2xsRGF0ZSkgKyAxLCAvLyArMSBmb3IgdGhlIGJvcmRlcgoJCQlzY3JvbGwgPSBmdW5jdGlvbigpIHsKCQkJCWJvZHkuc2Nyb2xsVG9wKHRvcCk7CgkJCX07CgkJc2Nyb2xsKCk7CgkJc2V0VGltZW91dChzY3JvbGwsIDApOyAvLyBvdmVycmlkZXMgYW55IHByZXZpb3VzIHNjcm9sbCBzdGF0ZSBtYWRlIGJ5IHRoZSBicm93c2VyCgl9CgkKCQoJZnVuY3Rpb24gYmVmb3JlSGlkZSgpIHsKCQlzYXZlZFNjcm9sbFRvcCA9IGJvZHkuc2Nyb2xsVG9wKCk7Cgl9CgkKCQoJZnVuY3Rpb24gYWZ0ZXJTaG93KCkgewoJCWJvZHkuc2Nyb2xsVG9wKHNhdmVkU2Nyb2xsVG9wKTsKCX0KCQoJCgkKCS8qIFNsb3QvRGF5IGNsaWNraW5nIGFuZCBiaW5kaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCglmdW5jdGlvbiBkYXlCaW5kKHRkcykgewoJCXRkcy5jbGljayhzbG90Q2xpY2spCgkJCS5tb3VzZWRvd24oZGF5U2VsZWN0aW9uTW91c2Vkb3duKTsKCX0KCgoJZnVuY3Rpb24gc2xvdEJpbmQodGRzKSB7CgkJdGRzLmNsaWNrKHNsb3RDbGljaykKCQkJLm1vdXNlZG93bihzbG90U2VsZWN0aW9uTW91c2Vkb3duKTsKCX0KCQoJCglmdW5jdGlvbiBzbG90Q2xpY2soZXYpIHsKCQlpZiAoIW9wdCgnc2VsZWN0YWJsZScpKSB7IC8vIFNlbGVjdGlvbk1hbmFnZXIgd2lsbCB3b3JyeSBhYm91dCBkYXlDbGljawoJCQl2YXIgY29sID0gTWF0aC5taW4oY29sQ250LTEsIE1hdGguZmxvb3IoKGV2LnBhZ2VYIC0gYmcub2Zmc2V0KCkubGVmdCkgLyBjb2xXaWR0aCkpLAoJCQkJZGF0ZSA9IGFkZERheXMoY2xvbmVEYXRlKHQudmlzU3RhcnQpLCBjb2wqZGlzK2RpdCksCgkJCQlyb3dNYXRjaCA9IHRoaXMuY2xhc3NOYW1lLm1hdGNoKC9mYy1zbG90KFxkKykvKTsKCQkJaWYgKHJvd01hdGNoKSB7CgkJCQl2YXIgbWlucyA9IHBhcnNlSW50KHJvd01hdGNoWzFdKSAqIG9wdCgnc2xvdE1pbnV0ZXMnKSwKCQkJCQlob3VycyA9IE1hdGguZmxvb3IobWlucy82MCk7CgkJCQlkYXRlLnNldEhvdXJzKGhvdXJzKTsKCQkJCWRhdGUuc2V0TWludXRlcyhtaW5zJTYwICsgbWluTWludXRlKTsKCQkJCXRyaWdnZXIoJ2RheUNsaWNrJywgdGhpcywgZGF0ZSwgZmFsc2UsIGV2KTsKCQkJfWVsc2V7CgkJCQl0cmlnZ2VyKCdkYXlDbGljaycsIHRoaXMsIGRhdGUsIHRydWUsIGV2KTsKCQkJfQoJCX0KCX0KCQoJCgkKCS8qIFNlbWktdHJhbnNwYXJlbnQgT3ZlcmxheSBIZWxwZXJzCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCglmdW5jdGlvbiByZW5kZXJEYXlPdmVybGF5KHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgcmVmcmVzaENvb3JkaW5hdGVHcmlkKSB7IC8vIGVuZERhdGUgaXMgZXhjbHVzaXZlCgkJaWYgKHJlZnJlc2hDb29yZGluYXRlR3JpZCkgewoJCQljb29yZGluYXRlR3JpZC5idWlsZCgpOwoJCX0KCQl2YXIgdmlzU3RhcnQgPSBjbG9uZURhdGUodC52aXNTdGFydCk7CgkJdmFyIHN0YXJ0Q29sLCBlbmRDb2w7CgkJaWYgKHJ0bCkgewoJCQlzdGFydENvbCA9IGRheURpZmYoZW5kRGF0ZSwgdmlzU3RhcnQpKmRpcytkaXQrMTsKCQkJZW5kQ29sID0gZGF5RGlmZihzdGFydERhdGUsIHZpc1N0YXJ0KSpkaXMrZGl0KzE7CgkJfWVsc2V7CgkJCXN0YXJ0Q29sID0gZGF5RGlmZihzdGFydERhdGUsIHZpc1N0YXJ0KTsKCQkJZW5kQ29sID0gZGF5RGlmZihlbmREYXRlLCB2aXNTdGFydCk7CgkJfQoJCXN0YXJ0Q29sID0gTWF0aC5tYXgoMCwgc3RhcnRDb2wpOwoJCWVuZENvbCA9IE1hdGgubWluKGNvbENudCwgZW5kQ29sKTsKCQlpZiAoc3RhcnRDb2wgPCBlbmRDb2wpIHsKCQkJZGF5QmluZCgKCQkJCXJlbmRlckNlbGxPdmVybGF5KDAsIHN0YXJ0Q29sLCAwLCBlbmRDb2wtMSkKCQkJKTsKCQl9Cgl9CgkKCQoJZnVuY3Rpb24gcmVuZGVyQ2VsbE92ZXJsYXkoY29sMCwgcm93MCwgY29sMSwgcm93MSkgewoJCXZhciByZWN0ID0gY29vcmRpbmF0ZUdyaWQucmVjdChjb2wwLCByb3cwLCBjb2wxLCByb3cxLCBoZWFkKTsKCQlyZXR1cm4gcmVuZGVyT3ZlcmxheShyZWN0LCBoZWFkKTsKCX0KCQoKCWZ1bmN0aW9uIHJlbmRlclNsb3RPdmVybGF5KG92ZXJsYXlTdGFydCwgb3ZlcmxheUVuZCkgewoJCXZhciBkYXlTdGFydCA9IGNsb25lRGF0ZSh0LnZpc1N0YXJ0KTsKCQl2YXIgZGF5RW5kID0gYWRkRGF5cyhjbG9uZURhdGUoZGF5U3RhcnQpLCAxKTsKCQlmb3IgKHZhciBpPTA7IGk8Y29sQ250OyBpKyspIHsKCQkJdmFyIHN0cmV0Y2hTdGFydCA9IG5ldyBEYXRlKE1hdGgubWF4KGRheVN0YXJ0LCBvdmVybGF5U3RhcnQpKTsKCQkJdmFyIHN0cmV0Y2hFbmQgPSBuZXcgRGF0ZShNYXRoLm1pbihkYXlFbmQsIG92ZXJsYXlFbmQpKTsKCQkJaWYgKHN0cmV0Y2hTdGFydCA8IHN0cmV0Y2hFbmQpIHsKCQkJCXZhciBjb2wgPSBpKmRpcytkaXQ7CgkJCQl2YXIgcmVjdCA9IGNvb3JkaW5hdGVHcmlkLnJlY3QoMCwgY29sLCAwLCBjb2wsIGJvZHlDb250ZW50KTsgLy8gb25seSB1c2UgaXQgZm9yIGhvcml6b250YWwgY29vcmRzCgkJCQl2YXIgdG9wID0gdGltZVBvc2l0aW9uKGRheVN0YXJ0LCBzdHJldGNoU3RhcnQpOwoJCQkJdmFyIGJvdHRvbSA9IHRpbWVQb3NpdGlvbihkYXlTdGFydCwgc3RyZXRjaEVuZCk7CgkJCQlyZWN0LnRvcCA9IHRvcDsKCQkJCXJlY3QuaGVpZ2h0ID0gYm90dG9tIC0gdG9wOwoJCQkJc2xvdEJpbmQoCgkJCQkJcmVuZGVyT3ZlcmxheShyZWN0LCBib2R5Q29udGVudCkKCQkJCSk7CgkJCX0KCQkJYWRkRGF5cyhkYXlTdGFydCwgMSk7CgkJCWFkZERheXMoZGF5RW5kLCAxKTsKCQl9Cgl9CgkKCQoJCgkvKiBDb29yZGluYXRlIFV0aWxpdGllcwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWNvb3JkaW5hdGVHcmlkID0gbmV3IENvb3JkaW5hdGVHcmlkKGZ1bmN0aW9uKHJvd3MsIGNvbHMpIHsKCQl2YXIgZSwgbiwgcDsKCQliZy5maW5kKCd0ZCcpLmVhY2goZnVuY3Rpb24oaSwgX2UpIHsKCQkJZSA9ICQoX2UpOwoJCQluID0gZS5vZmZzZXQoKS5sZWZ0OwoJCQlpZiAoaSkgewoJCQkJcFsxXSA9IG47CgkJCX0KCQkJcCA9IFtuXTsKCQkJY29sc1tpXSA9IHA7CgkJfSk7CgkJcFsxXSA9IG4gKyBlLm91dGVyV2lkdGgoKTsKCQlpZiAob3B0KCdhbGxEYXlTbG90JykpIHsKCQkJZSA9IGhlYWQuZmluZCgndGQnKTsKCQkJbiA9IGUub2Zmc2V0KCkudG9wOwoJCQlyb3dzWzBdID0gW24sIG4rZS5vdXRlckhlaWdodCgpXTsKCQl9CgkJdmFyIGJvZHlDb250ZW50VG9wID0gYm9keUNvbnRlbnQub2Zmc2V0KCkudG9wOwoJCXZhciBib2R5VG9wID0gYm9keS5vZmZzZXQoKS50b3A7CgkJdmFyIGJvZHlCb3R0b20gPSBib2R5VG9wICsgYm9keS5vdXRlckhlaWdodCgpOwoJCWZ1bmN0aW9uIGNvbnN0cmFpbihuKSB7CgkJCXJldHVybiBNYXRoLm1heChib2R5VG9wLCBNYXRoLm1pbihib2R5Qm90dG9tLCBuKSk7CgkJfQoJCWZvciAodmFyIGk9MDsgaTxzbG90Q250OyBpKyspIHsKCQkJcm93cy5wdXNoKFsKCQkJCWNvbnN0cmFpbihib2R5Q29udGVudFRvcCArIHNsb3RIZWlnaHQqaSksCgkJCQljb25zdHJhaW4oYm9keUNvbnRlbnRUb3AgKyBzbG90SGVpZ2h0KihpKzEpKQoJCQldKTsKCQl9Cgl9KTsKCQoJCglob3Zlckxpc3RlbmVyID0gbmV3IEhvdmVyTGlzdGVuZXIoY29vcmRpbmF0ZUdyaWQpOwoJCgkKCWNvbENvbnRlbnRQb3NpdGlvbnMgPSBuZXcgSG9yaXpvbnRhbFBvc2l0aW9uQ2FjaGUoZnVuY3Rpb24oY29sKSB7CgkJcmV0dXJuIGJnLmZpbmQoJ3RkOmVxKCcgKyBjb2wgKyAnKSBkaXYgZGl2Jyk7Cgl9KTsKCQoJCglmdW5jdGlvbiBjb2xDb250ZW50TGVmdChjb2wpIHsKCQlyZXR1cm4gYXhpc1dpZHRoICsgY29sQ29udGVudFBvc2l0aW9ucy5sZWZ0KGNvbCk7Cgl9CgkKCQoJZnVuY3Rpb24gY29sQ29udGVudFJpZ2h0KGNvbCkgewoJCXJldHVybiBheGlzV2lkdGggKyBjb2xDb250ZW50UG9zaXRpb25zLnJpZ2h0KGNvbCk7Cgl9CgkKCQoJZnVuY3Rpb24gZGF5T2ZXZWVrQ29sKGRheU9mV2VlaykgewoJCXJldHVybiAoKGRheU9mV2VlayAtIE1hdGgubWF4KGZpcnN0RGF5LCBud2UpICsgY29sQ250KSAlIGNvbENudCkqZGlzK2RpdDsKCX0KCQoJCglmdW5jdGlvbiBkYXRlQ2VsbChkYXRlKSB7CgkJcmV0dXJuIHsKCQkJcm93OiBNYXRoLmZsb29yKGRheURpZmYoZGF0ZSwgdC52aXNTdGFydCkgLyA3KSwKCQkJY29sOiBkYXlPZldlZWtDb2woZGF0ZS5nZXREYXkoKSkKCQl9OwoJfQoJCgkKCS8vIGdldCB0aGUgWSBjb29yZGluYXRlIG9mIHRoZSBnaXZlbiB0aW1lIG9uIHRoZSBnaXZlbiBkYXkgKGJvdGggRGF0ZSBvYmplY3RzKQoJZnVuY3Rpb24gdGltZVBvc2l0aW9uKGRheSwgdGltZSkgeyAvLyBib3RoIGRhdGUgb2JqZWN0cy4gZGF5IGhvbGRzIDAwOjAwIG9mIGN1cnJlbnQgZGF5CgkJZGF5ID0gY2xvbmVEYXRlKGRheSwgdHJ1ZSk7CgkJaWYgKHRpbWUgPCBhZGRNaW51dGVzKGNsb25lRGF0ZShkYXkpLCBtaW5NaW51dGUpKSB7CgkJCXJldHVybiAwOwoJCX0KCQlpZiAodGltZSA+PSBhZGRNaW51dGVzKGNsb25lRGF0ZShkYXkpLCBtYXhNaW51dGUpKSB7CgkJCXJldHVybiBib2R5Q29udGVudC5oZWlnaHQoKTsKCQl9CgkJdmFyIHNsb3RNaW51dGVzID0gb3B0KCdzbG90TWludXRlcycpLAoJCQltaW51dGVzID0gdGltZS5nZXRIb3VycygpKjYwICsgdGltZS5nZXRNaW51dGVzKCkgLSBtaW5NaW51dGUsCgkJCXNsb3RJID0gTWF0aC5mbG9vcihtaW51dGVzIC8gc2xvdE1pbnV0ZXMpLAoJCQlzbG90VG9wID0gc2xvdFRvcENhY2hlW3Nsb3RJXTsKCQlpZiAoc2xvdFRvcCA9PT0gdW5kZWZpbmVkKSB7CgkJCXNsb3RUb3AgPSBzbG90VG9wQ2FjaGVbc2xvdEldID0gYm9keS5maW5kKCd0cjplcSgnICsgc2xvdEkgKyAnKSB0ZCBkaXYnKVswXS5vZmZzZXRUb3A7CgkJfQoJCXJldHVybiBNYXRoLm1heCgwLCBNYXRoLnJvdW5kKAoJCQlzbG90VG9wIC0gMSArIHNsb3RIZWlnaHQgKiAoKG1pbnV0ZXMgJSBzbG90TWludXRlcykgLyBzbG90TWludXRlcykKCQkpKTsKCX0KCQoJCglmdW5jdGlvbiBjZWxsRGF0ZShjZWxsKSB7CgkJdmFyIGQgPSBhZGREYXlzKGNsb25lRGF0ZSh0LnZpc1N0YXJ0KSwgY2VsbC5jb2wqZGlzK2RpdCk7CgkJdmFyIHNsb3RJbmRleCA9IGNlbGwucm93OwoJCWlmIChvcHQoJ2FsbERheVNsb3QnKSkgewoJCQlzbG90SW5kZXgtLTsKCQl9CgkJaWYgKHNsb3RJbmRleCA+PSAwKSB7CgkJCWFkZE1pbnV0ZXMoZCwgbWluTWludXRlICsgc2xvdEluZGV4Km9wdCgnc2xvdE1pbnV0ZXMnKSk7CgkJfQoJCXJldHVybiBkOwoJfQoJCgkKCWZ1bmN0aW9uIGNlbGxJc0FsbERheShjZWxsKSB7CgkJcmV0dXJuIG9wdCgnYWxsRGF5U2xvdCcpICYmICFjZWxsLnJvdzsKCX0KCQoJCglmdW5jdGlvbiBhbGxEYXlCb3VuZHMoKSB7CgkJcmV0dXJuIHsKCQkJbGVmdDogYXhpc1dpZHRoLAoJCQlyaWdodDogdmlld1dpZHRoCgkJfQoJfQoJCgkKCWZ1bmN0aW9uIGFsbERheVRSKGluZGV4KSB7CgkJcmV0dXJuIGhlYWQuZmluZCgndHIuZmMtYWxsLWRheScpOwoJfQoJCgkKCWZ1bmN0aW9uIGRlZmF1bHRFdmVudEVuZChldmVudCkgewoJCXZhciBzdGFydCA9IGNsb25lRGF0ZShldmVudC5zdGFydCk7CgkJaWYgKGV2ZW50LmFsbERheSkgewoJCQlyZXR1cm4gc3RhcnQ7CgkJfQoJCXJldHVybiBhZGRNaW51dGVzKHN0YXJ0LCBvcHQoJ2RlZmF1bHRFdmVudE1pbnV0ZXMnKSk7Cgl9CgkKCQoJCgkvKiBTZWxlY3Rpb24KCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gZGVmYXVsdFNlbGVjdGlvbkVuZChzdGFydERhdGUsIGFsbERheSkgewoJCWlmIChhbGxEYXkpIHsKCQkJcmV0dXJuIGNsb25lRGF0ZShzdGFydERhdGUpOwoJCX0KCQlyZXR1cm4gYWRkTWludXRlcyhjbG9uZURhdGUoc3RhcnREYXRlKSwgb3B0KCdzbG90TWludXRlcycpKTsKCX0KCQoJCglmdW5jdGlvbiByZW5kZXJTZWxlY3Rpb24oc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXkpIHsKCQlpZiAoYWxsRGF5KSB7CgkJCWlmIChvcHQoJ2FsbERheVNsb3QnKSkgewoJCQkJcmVuZGVyRGF5T3ZlcmxheShzdGFydERhdGUsIGFkZERheXMoY2xvbmVEYXRlKGVuZERhdGUpLCAxKSwgdHJ1ZSk7CgkJCX0KCQl9ZWxzZXsKCQkJcmVuZGVyU2xvdFNlbGVjdGlvbihzdGFydERhdGUsIGVuZERhdGUpOwoJCX0KCX0KCQoJCglmdW5jdGlvbiByZW5kZXJTbG90U2VsZWN0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSkgewoJCXZhciBoZWxwZXJPcHRpb24gPSBvcHQoJ3NlbGVjdEhlbHBlcicpOwoJCWNvb3JkaW5hdGVHcmlkLmJ1aWxkKCk7CgkJaWYgKGhlbHBlck9wdGlvbikgewoJCQl2YXIgY29sID0gZGF5RGlmZihzdGFydERhdGUsIHQudmlzU3RhcnQpICogZGlzICsgZGl0OwoJCQlpZiAoY29sID49IDAgJiYgY29sIDwgY29sQ250KSB7IC8vIG9ubHkgd29ya3Mgd2hlbiB0aW1lcyBhcmUgb24gc2FtZSBkYXkKCQkJCXZhciByZWN0ID0gY29vcmRpbmF0ZUdyaWQucmVjdCgwLCBjb2wsIDAsIGNvbCwgYm9keUNvbnRlbnQpOyAvLyBvbmx5IGZvciBob3Jpem9udGFsIGNvb3JkcwoJCQkJdmFyIHRvcCA9IHRpbWVQb3NpdGlvbihzdGFydERhdGUsIHN0YXJ0RGF0ZSk7CgkJCQl2YXIgYm90dG9tID0gdGltZVBvc2l0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7CgkJCQlpZiAoYm90dG9tID4gdG9wKSB7IC8vIHByb3RlY3QgYWdhaW5zdCBzZWxlY3Rpb25zIHRoYXQgYXJlIGVudGlyZWx5IGJlZm9yZSBvciBhZnRlciB2aXNpYmxlIHJhbmdlCgkJCQkJcmVjdC50b3AgPSB0b3A7CgkJCQkJcmVjdC5oZWlnaHQgPSBib3R0b20gLSB0b3A7CgkJCQkJcmVjdC5sZWZ0ICs9IDI7CgkJCQkJcmVjdC53aWR0aCAtPSA1OwoJCQkJCWlmICgkLmlzRnVuY3Rpb24oaGVscGVyT3B0aW9uKSkgewoJCQkJCQl2YXIgaGVscGVyUmVzID0gaGVscGVyT3B0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7CgkJCQkJCWlmIChoZWxwZXJSZXMpIHsKCQkJCQkJCXJlY3QucG9zaXRpb24gPSAnYWJzb2x1dGUnOwoJCQkJCQkJcmVjdC56SW5kZXggPSA4OwoJCQkJCQkJc2VsZWN0aW9uSGVscGVyID0gJChoZWxwZXJSZXMpCgkJCQkJCQkJLmNzcyhyZWN0KQoJCQkJCQkJCS5hcHBlbmRUbyhib2R5Q29udGVudCk7CgkJCQkJCX0KCQkJCQl9ZWxzZXsKCQkJCQkJc2VsZWN0aW9uSGVscGVyID0gJChzbG90U2VnSHRtbCgKCQkJCQkJCXsKCQkJCQkJCQl0aXRsZTogJycsCgkJCQkJCQkJc3RhcnQ6IHN0YXJ0RGF0ZSwKCQkJCQkJCQllbmQ6IGVuZERhdGUsCgkJCQkJCQkJY2xhc3NOYW1lOiBbXSwKCQkJCQkJCQllZGl0YWJsZTogZmFsc2UKCQkJCQkJCX0sCgkJCQkJCQlyZWN0LAoJCQkJCQkJJ2ZjLWV2ZW50IGZjLWV2ZW50LXZlcnQgZmMtY29ybmVyLXRvcCBmYy1jb3JuZXItYm90dG9tICcKCQkJCQkJKSk7CgkJCQkJCWlmICgkLmJyb3dzZXIubXNpZSkgewoJCQkJCQkJc2VsZWN0aW9uSGVscGVyLmZpbmQoJ3NwYW4uZmMtZXZlbnQtYmcnKS5oaWRlKCk7IC8vIG5lc3RlZCBvcGFjaXRpZXMgbWVzcyB1cCBpbiBJRSwganVzdCBoaWRlCgkJCQkJCX0KCQkJCQkJc2VsZWN0aW9uSGVscGVyLmNzcygnb3BhY2l0eScsIG9wdCgnZHJhZ09wYWNpdHknKSk7CgkJCQkJfQoJCQkJCWlmIChzZWxlY3Rpb25IZWxwZXIpIHsKCQkJCQkJc2xvdEJpbmQoc2VsZWN0aW9uSGVscGVyKTsKCQkJCQkJYm9keUNvbnRlbnQuYXBwZW5kKHNlbGVjdGlvbkhlbHBlcik7CgkJCQkJCXNldE91dGVyV2lkdGgoc2VsZWN0aW9uSGVscGVyLCByZWN0LndpZHRoLCB0cnVlKTsgLy8gbmVlZHMgdG8gYmUgYWZ0ZXIgYXBwZW5kZWQKCQkJCQkJc2V0T3V0ZXJIZWlnaHQoc2VsZWN0aW9uSGVscGVyLCByZWN0LmhlaWdodCwgdHJ1ZSk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfWVsc2V7CgkJCXJlbmRlclNsb3RPdmVybGF5KHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIGNsZWFyU2VsZWN0aW9uKCkgewoJCWNsZWFyT3ZlcmxheXMoKTsKCQlpZiAoc2VsZWN0aW9uSGVscGVyKSB7CgkJCXNlbGVjdGlvbkhlbHBlci5yZW1vdmUoKTsKCQkJc2VsZWN0aW9uSGVscGVyID0gbnVsbDsKCQl9Cgl9CgkKCQoJZnVuY3Rpb24gc2xvdFNlbGVjdGlvbk1vdXNlZG93bihldikgewoJCWlmIChldi53aGljaCA9PSAxICYmIG9wdCgnc2VsZWN0YWJsZScpKSB7IC8vIGV2LndoaWNoPT0xIG1lYW5zIGxlZnQgbW91c2UgYnV0dG9uCgkJCXVuc2VsZWN0KGV2KTsKCQkJdmFyIF9tb3VzZWRvd25FbGVtZW50ID0gdGhpczsKCQkJdmFyIGRhdGVzOwoJCQlob3Zlckxpc3RlbmVyLnN0YXJ0KGZ1bmN0aW9uKGNlbGwsIG9yaWdDZWxsKSB7CgkJCQljbGVhclNlbGVjdGlvbigpOwoJCQkJaWYgKGNlbGwgJiYgY2VsbC5jb2wgPT0gb3JpZ0NlbGwuY29sICYmICFjZWxsSXNBbGxEYXkoY2VsbCkpIHsKCQkJCQl2YXIgZDEgPSBjZWxsRGF0ZShvcmlnQ2VsbCk7CgkJCQkJdmFyIGQyID0gY2VsbERhdGUoY2VsbCk7CgkJCQkJZGF0ZXMgPSBbCgkJCQkJCWQxLAoJCQkJCQlhZGRNaW51dGVzKGNsb25lRGF0ZShkMSksIG9wdCgnc2xvdE1pbnV0ZXMnKSksCgkJCQkJCWQyLAoJCQkJCQlhZGRNaW51dGVzKGNsb25lRGF0ZShkMiksIG9wdCgnc2xvdE1pbnV0ZXMnKSkKCQkJCQldLnNvcnQoY21wKTsKCQkJCQlyZW5kZXJTbG90U2VsZWN0aW9uKGRhdGVzWzBdLCBkYXRlc1szXSk7CgkJCQl9ZWxzZXsKCQkJCQlkYXRlcyA9IG51bGw7CgkJCQl9CgkJCX0sIGV2KTsKCQkJJChkb2N1bWVudCkub25lKCdtb3VzZXVwJywgZnVuY3Rpb24oZXYpIHsKCQkJCWhvdmVyTGlzdGVuZXIuc3RvcCgpOwoJCQkJaWYgKGRhdGVzKSB7CgkJCQkJaWYgKCtkYXRlc1swXSA9PSArZGF0ZXNbMV0pIHsKCQkJCQkJdHJpZ2dlcignZGF5Q2xpY2snLCBfbW91c2Vkb3duRWxlbWVudCwgZGF0ZXNbMF0sIGZhbHNlLCBldik7CgkJCQkJCS8vIEJVRzogX21vdXNlZG93bkVsZW1lbnQgd2lsbCBzb21ldGltZXMgYmUgdGhlIG92ZXJsYXkKCQkJCQl9CgkJCQkJcmVwb3J0U2VsZWN0aW9uKGRhdGVzWzBdLCBkYXRlc1szXSwgZmFsc2UsIGV2KTsKCQkJCX0KCQkJfSk7CgkJfQoJfQoJCgkKCQoJLyogRXh0ZXJuYWwgRHJhZ2dpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglmdW5jdGlvbiBkcmFnU3RhcnQoX2RyYWdFbGVtZW50LCBldiwgdWkpIHsKCQlob3Zlckxpc3RlbmVyLnN0YXJ0KGZ1bmN0aW9uKGNlbGwpIHsKCQkJY2xlYXJPdmVybGF5cygpOwoJCQlpZiAoY2VsbCkgewoJCQkJaWYgKGNlbGxJc0FsbERheShjZWxsKSkgewoJCQkJCXJlbmRlckNlbGxPdmVybGF5KGNlbGwucm93LCBjZWxsLmNvbCwgY2VsbC5yb3csIGNlbGwuY29sKTsKCQkJCX1lbHNlewoJCQkJCXZhciBkMSA9IGNlbGxEYXRlKGNlbGwpOwoJCQkJCXZhciBkMiA9IGFkZE1pbnV0ZXMoY2xvbmVEYXRlKGQxKSwgb3B0KCdkZWZhdWx0RXZlbnRNaW51dGVzJykpOwoJCQkJCXJlbmRlclNsb3RPdmVybGF5KGQxLCBkMik7CgkJCQl9CgkJCX0KCQl9LCBldik7Cgl9CgkKCQoJZnVuY3Rpb24gZHJhZ1N0b3AoX2RyYWdFbGVtZW50LCBldiwgdWkpIHsKCQl2YXIgY2VsbCA9IGhvdmVyTGlzdGVuZXIuc3RvcCgpOwoJCWNsZWFyT3ZlcmxheXMoKTsKCQlpZiAoY2VsbCkgewoJCQl0cmlnZ2VyKCdkcm9wJywgX2RyYWdFbGVtZW50LCBjZWxsRGF0ZShjZWxsKSwgY2VsbElzQWxsRGF5KGNlbGwpLCBldiwgdWkpOwoJCX0KCX0KCgp9CgpmdW5jdGlvbiBBZ2VuZGFFdmVudFJlbmRlcmVyKCkgewoJdmFyIHQgPSB0aGlzOwoJCgkKCS8vIGV4cG9ydHMKCXQucmVuZGVyRXZlbnRzID0gcmVuZGVyRXZlbnRzOwoJdC5jb21waWxlRGF5U2VncyA9IGNvbXBpbGVEYXlTZWdzOyAvLyBmb3IgRGF5RXZlbnRSZW5kZXJlcgoJdC5jbGVhckV2ZW50cyA9IGNsZWFyRXZlbnRzOwoJdC5zbG90U2VnSHRtbCA9IHNsb3RTZWdIdG1sOwoJdC5iaW5kRGF5U2VnID0gYmluZERheVNlZzsKCQoJCgkvLyBpbXBvcnRzCglEYXlFdmVudFJlbmRlcmVyLmNhbGwodCk7Cgl2YXIgb3B0ID0gdC5vcHQ7Cgl2YXIgdHJpZ2dlciA9IHQudHJpZ2dlcjsKCXZhciBldmVudEVuZCA9IHQuZXZlbnRFbmQ7Cgl2YXIgcmVwb3J0RXZlbnRzID0gdC5yZXBvcnRFdmVudHM7Cgl2YXIgcmVwb3J0RXZlbnRDbGVhciA9IHQucmVwb3J0RXZlbnRDbGVhcjsKCXZhciBldmVudEVsZW1lbnRIYW5kbGVycyA9IHQuZXZlbnRFbGVtZW50SGFuZGxlcnM7Cgl2YXIgc2V0SGVpZ2h0ID0gdC5zZXRIZWlnaHQ7Cgl2YXIgZ2V0RGF5U2VnbWVudENvbnRhaW5lciA9IHQuZ2V0RGF5U2VnbWVudENvbnRhaW5lcjsKCXZhciBnZXRTbG90U2VnbWVudENvbnRhaW5lciA9IHQuZ2V0U2xvdFNlZ21lbnRDb250YWluZXI7Cgl2YXIgZ2V0SG92ZXJMaXN0ZW5lciA9IHQuZ2V0SG92ZXJMaXN0ZW5lcjsKCXZhciBnZXRNYXhNaW51dGUgPSB0LmdldE1heE1pbnV0ZTsKCXZhciBnZXRNaW5NaW51dGUgPSB0LmdldE1pbk1pbnV0ZTsKCXZhciB0aW1lUG9zaXRpb24gPSB0LnRpbWVQb3NpdGlvbjsKCXZhciBjb2xDb250ZW50TGVmdCA9IHQuY29sQ29udGVudExlZnQ7Cgl2YXIgY29sQ29udGVudFJpZ2h0ID0gdC5jb2xDb250ZW50UmlnaHQ7Cgl2YXIgcmVuZGVyRGF5U2VncyA9IHQucmVuZGVyRGF5U2VnczsKCXZhciByZXNpemFibGVEYXlFdmVudCA9IHQucmVzaXphYmxlRGF5RXZlbnQ7IC8vIFRPRE86IHN0cmVhbWxpbmUgYmluZGluZyBhcmNoaXRlY3R1cmUKCXZhciBnZXRDb2xDbnQgPSB0LmdldENvbENudDsKCXZhciBnZXRDb2xXaWR0aCA9IHQuZ2V0Q29sV2lkdGg7Cgl2YXIgZ2V0U2xvdEhlaWdodCA9IHQuZ2V0U2xvdEhlaWdodDsKCXZhciBnZXRCb2R5Q29udGVudCA9IHQuZ2V0Qm9keUNvbnRlbnQ7Cgl2YXIgcmVwb3J0RXZlbnRFbGVtZW50ID0gdC5yZXBvcnRFdmVudEVsZW1lbnQ7Cgl2YXIgc2hvd0V2ZW50cyA9IHQuc2hvd0V2ZW50czsKCXZhciBoaWRlRXZlbnRzID0gdC5oaWRlRXZlbnRzOwoJdmFyIGV2ZW50RHJvcCA9IHQuZXZlbnREcm9wOwoJdmFyIGV2ZW50UmVzaXplID0gdC5ldmVudFJlc2l6ZTsKCXZhciByZW5kZXJEYXlPdmVybGF5ID0gdC5yZW5kZXJEYXlPdmVybGF5OwoJdmFyIGNsZWFyT3ZlcmxheXMgPSB0LmNsZWFyT3ZlcmxheXM7Cgl2YXIgY2FsZW5kYXIgPSB0LmNhbGVuZGFyOwoJdmFyIGZvcm1hdERhdGUgPSBjYWxlbmRhci5mb3JtYXREYXRlOwoJdmFyIGZvcm1hdERhdGVzID0gY2FsZW5kYXIuZm9ybWF0RGF0ZXM7CgkKCQoJCgkvKiBSZW5kZXJpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgoJZnVuY3Rpb24gcmVuZGVyRXZlbnRzKGV2ZW50cywgbW9kaWZpZWRFdmVudElkKSB7CgkJcmVwb3J0RXZlbnRzKGV2ZW50cyk7CgkJdmFyIGksIGxlbj1ldmVudHMubGVuZ3RoLAoJCQlkYXlFdmVudHM9W10sCgkJCXNsb3RFdmVudHM9W107CgkJZm9yIChpPTA7IGk8bGVuOyBpKyspIHsKCQkJaWYgKGV2ZW50c1tpXS5hbGxEYXkpIHsKCQkJCWRheUV2ZW50cy5wdXNoKGV2ZW50c1tpXSk7CgkJCX1lbHNlewoJCQkJc2xvdEV2ZW50cy5wdXNoKGV2ZW50c1tpXSk7CgkJCX0KCQl9CgkJaWYgKG9wdCgnYWxsRGF5U2xvdCcpKSB7CgkJCXJlbmRlckRheVNlZ3MoY29tcGlsZURheVNlZ3MoZGF5RXZlbnRzKSwgbW9kaWZpZWRFdmVudElkKTsKCQkJc2V0SGVpZ2h0KCk7IC8vIG5vIHBhcmFtcyBtZWFucyBzZXQgdG8gdmlld0hlaWdodAoJCX0KCQlyZW5kZXJTbG90U2Vncyhjb21waWxlU2xvdFNlZ3Moc2xvdEV2ZW50cyksIG1vZGlmaWVkRXZlbnRJZCk7Cgl9CgkKCQoJZnVuY3Rpb24gY2xlYXJFdmVudHMoKSB7CgkJcmVwb3J0RXZlbnRDbGVhcigpOwoJCWdldERheVNlZ21lbnRDb250YWluZXIoKS5lbXB0eSgpOwoJCWdldFNsb3RTZWdtZW50Q29udGFpbmVyKCkuZW1wdHkoKTsKCX0KCQoJCglmdW5jdGlvbiBjb21waWxlRGF5U2VncyhldmVudHMpIHsKCQl2YXIgbGV2ZWxzID0gc3RhY2tTZWdzKHNsaWNlU2VncyhldmVudHMsICQubWFwKGV2ZW50cywgZXhjbEVuZERheSksIHQudmlzU3RhcnQsIHQudmlzRW5kKSksCgkJCWksIGxldmVsQ250PWxldmVscy5sZW5ndGgsIGxldmVsLAoJCQlqLCBzZWcsCgkJCXNlZ3M9W107CgkJZm9yIChpPTA7IGk8bGV2ZWxDbnQ7IGkrKykgewoJCQlsZXZlbCA9IGxldmVsc1tpXTsKCQkJZm9yIChqPTA7IGo8bGV2ZWwubGVuZ3RoOyBqKyspIHsKCQkJCXNlZyA9IGxldmVsW2pdOwoJCQkJc2VnLnJvdyA9IDA7CgkJCQlzZWcubGV2ZWwgPSBpOyAvLyBub3QgbmVlZGVkIGFueW1vcmUKCQkJCXNlZ3MucHVzaChzZWcpOwoJCQl9CgkJfQoJCXJldHVybiBzZWdzOwoJfQoJCgkKCWZ1bmN0aW9uIGNvbXBpbGVTbG90U2VncyhldmVudHMpIHsKCQl2YXIgY29sQ250ID0gZ2V0Q29sQ250KCksCgkJCW1pbk1pbnV0ZSA9IGdldE1pbk1pbnV0ZSgpLAoJCQltYXhNaW51dGUgPSBnZXRNYXhNaW51dGUoKSwKCQkJZCA9IGFkZE1pbnV0ZXMoY2xvbmVEYXRlKHQudmlzU3RhcnQpLCBtaW5NaW51dGUpLAoJCQl2aXNFdmVudEVuZHMgPSAkLm1hcChldmVudHMsIHNsb3RFdmVudEVuZCksCgkJCWksIGNvbCwKCQkJaiwgbGV2ZWwsCgkJCWssIHNlZywKCQkJc2Vncz1bXTsKCQlmb3IgKGk9MDsgaTxjb2xDbnQ7IGkrKykgewoJCQljb2wgPSBzdGFja1NlZ3Moc2xpY2VTZWdzKGV2ZW50cywgdmlzRXZlbnRFbmRzLCBkLCBhZGRNaW51dGVzKGNsb25lRGF0ZShkKSwgbWF4TWludXRlLW1pbk1pbnV0ZSkpKTsKCQkJY291bnRGb3J3YXJkU2Vncyhjb2wpOwoJCQlmb3IgKGo9MDsgajxjb2wubGVuZ3RoOyBqKyspIHsKCQkJCWxldmVsID0gY29sW2pdOwoJCQkJZm9yIChrPTA7IGs8bGV2ZWwubGVuZ3RoOyBrKyspIHsKCQkJCQlzZWcgPSBsZXZlbFtrXTsKCQkJCQlzZWcuY29sID0gaTsKCQkJCQlzZWcubGV2ZWwgPSBqOwoJCQkJCXNlZ3MucHVzaChzZWcpOwoJCQkJfQoJCQl9CgkJCWFkZERheXMoZCwgMSwgdHJ1ZSk7CgkJfQoJCXJldHVybiBzZWdzOwoJfQoJCgkKCWZ1bmN0aW9uIHNsb3RFdmVudEVuZChldmVudCkgewoJCWlmIChldmVudC5lbmQpIHsKCQkJcmV0dXJuIGNsb25lRGF0ZShldmVudC5lbmQpOwoJCX1lbHNlewoJCQlyZXR1cm4gYWRkTWludXRlcyhjbG9uZURhdGUoZXZlbnQuc3RhcnQpLCBvcHQoJ2RlZmF1bHRFdmVudE1pbnV0ZXMnKSk7CgkJfQoJfQoJCgkKCS8vIHJlbmRlcnMgZXZlbnRzIGluIHRoZSAndGltZSBzbG90cycgYXQgdGhlIGJvdHRvbQoJCglmdW5jdGlvbiByZW5kZXJTbG90U2VncyhzZWdzLCBtb2RpZmllZEV2ZW50SWQpIHsKCQoJCXZhciBpLCBzZWdDbnQ9c2Vncy5sZW5ndGgsIHNlZywKCQkJZXZlbnQsCgkJCWNsYXNzTmFtZSwKCQkJdG9wLCBib3R0b20sCgkJCWNvbEksIGxldmVsSSwgZm9yd2FyZCwKCQkJbGVmdG1vc3QsCgkJCWF2YWlsV2lkdGgsCgkJCW91dGVyV2lkdGgsCgkJCWxlZnQsCgkJCWh0bWw9JycsCgkJCWV2ZW50RWxlbWVudHMsCgkJCWV2ZW50RWxlbWVudCwKCQkJdHJpZ2dlclJlcywKCQkJdnNpZGVDYWNoZT17fSwKCQkJaHNpZGVDYWNoZT17fSwKCQkJa2V5LCB2YWwsCgkJCXRpdGxlU3BhbiwKCQkJaGVpZ2h0LAoJCQlzbG90U2VnbWVudENvbnRhaW5lciA9IGdldFNsb3RTZWdtZW50Q29udGFpbmVyKCksCgkJCXJ0bCwgZGlzLCBkaXQsCgkJCWNvbENudCA9IGdldENvbENudCgpOwoJCQkKCQlpZiAocnRsID0gb3B0KCdpc1JUTCcpKSB7CgkJCWRpcyA9IC0xOwoJCQlkaXQgPSBjb2xDbnQgLSAxOwoJCX1lbHNlewoJCQlkaXMgPSAxOwoJCQlkaXQgPSAwOwoJCX0KCQkJCgkJLy8gY2FsY3VsYXRlIHBvc2l0aW9uL2RpbWVuc2lvbnMsIGNyZWF0ZSBodG1sCgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJZXZlbnQgPSBzZWcuZXZlbnQ7CgkJCWNsYXNzTmFtZSA9ICdmYy1ldmVudCBmYy1ldmVudC12ZXJ0ICc7CgkJCWlmIChzZWcuaXNTdGFydCkgewoJCQkJY2xhc3NOYW1lICs9ICdmYy1jb3JuZXItdG9wICc7CgkJCX0KCQkJaWYgKHNlZy5pc0VuZCkgewoJCQkJY2xhc3NOYW1lICs9ICdmYy1jb3JuZXItYm90dG9tICc7CgkJCX0KCQkJdG9wID0gdGltZVBvc2l0aW9uKHNlZy5zdGFydCwgc2VnLnN0YXJ0KTsKCQkJYm90dG9tID0gdGltZVBvc2l0aW9uKHNlZy5zdGFydCwgc2VnLmVuZCk7CgkJCWNvbEkgPSBzZWcuY29sOwoJCQlsZXZlbEkgPSBzZWcubGV2ZWw7CgkJCWZvcndhcmQgPSBzZWcuZm9yd2FyZCB8fCAwOwoJCQlsZWZ0bW9zdCA9IGNvbENvbnRlbnRMZWZ0KGNvbEkqZGlzICsgZGl0KTsKCQkJYXZhaWxXaWR0aCA9IGNvbENvbnRlbnRSaWdodChjb2xJKmRpcyArIGRpdCkgLSBsZWZ0bW9zdDsKCQkJYXZhaWxXaWR0aCA9IE1hdGgubWluKGF2YWlsV2lkdGgtNiwgYXZhaWxXaWR0aCouOTUpOyAvLyBUT0RPOiBtb3ZlIHRoaXMgdG8gQ1NTCgkJCWlmIChsZXZlbEkpIHsKCQkJCS8vIGluZGVudGVkIGFuZCB0aGluCgkJCQlvdXRlcldpZHRoID0gYXZhaWxXaWR0aCAvIChsZXZlbEkgKyBmb3J3YXJkICsgMSk7CgkJCX1lbHNlewoJCQkJaWYgKGZvcndhcmQpIHsKCQkJCQkvLyBtb2RlcmF0ZWx5IHdpZGUsIGFsaWduZWQgbGVmdCBzdGlsbAoJCQkJCW91dGVyV2lkdGggPSAoKGF2YWlsV2lkdGggLyAoZm9yd2FyZCArIDEpKSAtICgxMi8yKSkgKiAyOyAvLyAxMiBpcyB0aGUgcHJlZGljdGVkIHdpZHRoIG9mIHJlc2l6ZXIgPQoJCQkJfWVsc2V7CgkJCQkJLy8gY2FuIGJlIGVudGlyZSB3aWR0aCwgYWxpZ25lZCBsZWZ0CgkJCQkJb3V0ZXJXaWR0aCA9IGF2YWlsV2lkdGg7CgkJCQl9CgkJCX0KCQkJbGVmdCA9IGxlZnRtb3N0ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGVmdG1vc3QgcG9zc2libGUKCQkJCShhdmFpbFdpZHRoIC8gKGxldmVsSSArIGZvcndhcmQgKyAxKSAqIGxldmVsSSkgLy8gaW5kZW50YXRpb24KCQkJCSogZGlzICsgKHJ0bCA/IGF2YWlsV2lkdGggLSBvdXRlcldpZHRoIDogMCk7ICAgLy8gcnRsCgkJCXNlZy50b3AgPSB0b3A7CgkJCXNlZy5sZWZ0ID0gbGVmdDsKCQkJc2VnLm91dGVyV2lkdGggPSBvdXRlcldpZHRoOwoJCQlzZWcub3V0ZXJIZWlnaHQgPSBib3R0b20gLSB0b3A7CgkJCWh0bWwgKz0gc2xvdFNlZ0h0bWwoZXZlbnQsIHNlZywgY2xhc3NOYW1lKTsKCQl9CgkJc2xvdFNlZ21lbnRDb250YWluZXJbMF0uaW5uZXJIVE1MID0gaHRtbDsgLy8gZmFzdGVyIHRoYW4gaHRtbCgpCgkJZXZlbnRFbGVtZW50cyA9IHNsb3RTZWdtZW50Q29udGFpbmVyLmNoaWxkcmVuKCk7CgkJCgkJLy8gcmV0cmlldmUgZWxlbWVudHMsIHJ1biB0aHJvdWdoIGV2ZW50UmVuZGVyIGNhbGxiYWNrLCBiaW5kIGV2ZW50IGhhbmRsZXJzCgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJZXZlbnQgPSBzZWcuZXZlbnQ7CgkJCWV2ZW50RWxlbWVudCA9ICQoZXZlbnRFbGVtZW50c1tpXSk7IC8vIGZhc3RlciB0aGFuIGVxKCkKCQkJdHJpZ2dlclJlcyA9IHRyaWdnZXIoJ2V2ZW50UmVuZGVyJywgZXZlbnQsIGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQlpZiAodHJpZ2dlclJlcyA9PT0gZmFsc2UpIHsKCQkJCWV2ZW50RWxlbWVudC5yZW1vdmUoKTsKCQkJfWVsc2V7CgkJCQlpZiAodHJpZ2dlclJlcyAmJiB0cmlnZ2VyUmVzICE9PSB0cnVlKSB7CgkJCQkJZXZlbnRFbGVtZW50LnJlbW92ZSgpOwoJCQkJCWV2ZW50RWxlbWVudCA9ICQodHJpZ2dlclJlcykKCQkJCQkJLmNzcyh7CgkJCQkJCQlwb3NpdGlvbjogJ2Fic29sdXRlJywKCQkJCQkJCXRvcDogc2VnLnRvcCwKCQkJCQkJCWxlZnQ6IHNlZy5sZWZ0CgkJCQkJCX0pCgkJCQkJCS5hcHBlbmRUbyhzbG90U2VnbWVudENvbnRhaW5lcik7CgkJCQl9CgkJCQlzZWcuZWxlbWVudCA9IGV2ZW50RWxlbWVudDsKCQkJCWlmIChldmVudC5faWQgPT09IG1vZGlmaWVkRXZlbnRJZCkgewoJCQkJCWJpbmRTbG90U2VnKGV2ZW50LCBldmVudEVsZW1lbnQsIHNlZyk7CgkJCQl9ZWxzZXsKCQkJCQlldmVudEVsZW1lbnRbMF0uX2ZjaSA9IGk7IC8vIGZvciBsYXp5U2VnQmluZAoJCQkJfQoJCQkJcmVwb3J0RXZlbnRFbGVtZW50KGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQl9CgkJfQoJCQoJCWxhenlTZWdCaW5kKHNsb3RTZWdtZW50Q29udGFpbmVyLCBzZWdzLCBiaW5kU2xvdFNlZyk7CgkJCgkJLy8gcmVjb3JkIGV2ZW50IHNpZGVzIGFuZCB0aXRsZSBwb3NpdGlvbnMKCQlmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCQlzZWcgPSBzZWdzW2ldOwoJCQlpZiAoZXZlbnRFbGVtZW50ID0gc2VnLmVsZW1lbnQpIHsKCQkJCXZhbCA9IHZzaWRlQ2FjaGVba2V5ID0gc2VnLmtleSA9IGNzc0tleShldmVudEVsZW1lbnRbMF0pXTsKCQkJCXNlZy52c2lkZXMgPSB2YWwgPT09IHVuZGVmaW5lZCA/ICh2c2lkZUNhY2hlW2tleV0gPSB2c2lkZXMoZXZlbnRFbGVtZW50WzBdLCB0cnVlKSkgOiB2YWw7CgkJCQl2YWwgPSBoc2lkZUNhY2hlW2tleV07CgkJCQlzZWcuaHNpZGVzID0gdmFsID09PSB1bmRlZmluZWQgPyAoaHNpZGVDYWNoZVtrZXldID0gaHNpZGVzKGV2ZW50RWxlbWVudFswXSwgdHJ1ZSkpIDogdmFsOwoJCQkJdGl0bGVTcGFuID0gZXZlbnRFbGVtZW50LmZpbmQoJ3NwYW4uZmMtZXZlbnQtdGl0bGUnKTsKCQkJCWlmICh0aXRsZVNwYW4ubGVuZ3RoKSB7CgkJCQkJc2VnLnRpdGxlVG9wID0gdGl0bGVTcGFuWzBdLm9mZnNldFRvcDsKCQkJCX0KCQkJfQoJCX0KCQkKCQkvLyBzZXQgYWxsIHBvc2l0aW9ucy9kaW1lbnNpb25zIGF0IG9uY2UKCQlmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCQlzZWcgPSBzZWdzW2ldOwoJCQlpZiAoZXZlbnRFbGVtZW50ID0gc2VnLmVsZW1lbnQpIHsKCQkJCWV2ZW50RWxlbWVudFswXS5zdHlsZS53aWR0aCA9IE1hdGgubWF4KDAsIHNlZy5vdXRlcldpZHRoIC0gc2VnLmhzaWRlcykgKyAncHgnOwoJCQkJaGVpZ2h0ID0gTWF0aC5tYXgoMCwgc2VnLm91dGVySGVpZ2h0IC0gc2VnLnZzaWRlcyk7CgkJCQlldmVudEVsZW1lbnRbMF0uc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JzsKCQkJCWV2ZW50ID0gc2VnLmV2ZW50OwoJCQkJaWYgKHNlZy50aXRsZVRvcCAhPT0gdW5kZWZpbmVkICYmIGhlaWdodCAtIHNlZy50aXRsZVRvcCA8IDEwKSB7CgkJCQkJLy8gbm90IGVub3VnaCByb29tIGZvciB0aXRsZSwgcHV0IGl0IGluIHRoZSB0aW1lIGhlYWRlcgoJCQkJCWV2ZW50RWxlbWVudC5maW5kKCdzcGFuLmZjLWV2ZW50LXRpbWUnKQoJCQkJCQkudGV4dChmb3JtYXREYXRlKGV2ZW50LnN0YXJ0LCBvcHQoJ3RpbWVGb3JtYXQnKSkgKyAnIC0gJyArIGV2ZW50LnRpdGxlKTsKCQkJCQlldmVudEVsZW1lbnQuZmluZCgnc3Bhbi5mYy1ldmVudC10aXRsZScpCgkJCQkJCS5yZW1vdmUoKTsKCQkJCX0KCQkJCXRyaWdnZXIoJ2V2ZW50QWZ0ZXJSZW5kZXInLCBldmVudCwgZXZlbnQsIGV2ZW50RWxlbWVudCk7CgkJCX0KCQl9CgkJCQkJCgl9CgkKCQoJZnVuY3Rpb24gc2xvdFNlZ0h0bWwoZXZlbnQsIHNlZywgY2xhc3NOYW1lKSB7CgkJcmV0dXJuICI8ZGl2IGNsYXNzPSciICsgY2xhc3NOYW1lICsgZXZlbnQuY2xhc3NOYW1lLmpvaW4oJyAnKSArICInIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4Ojg7dG9wOiIgKyBzZWcudG9wICsgInB4O2xlZnQ6IiArIHNlZy5sZWZ0ICsgInB4Jz4iICsKCQkJIjxhIiArIChldmVudC51cmwgPyAiIGhyZWY9JyIgKyBodG1sRXNjYXBlKGV2ZW50LnVybCkgKyAiJyIgOiAnJykgKyAiPiIgKwoJCQkJIjxzcGFuIGNsYXNzPSdmYy1ldmVudC1iZyc+PC9zcGFuPiIgKwoJCQkJIjxzcGFuIGNsYXNzPSdmYy1ldmVudC10aW1lJz4iICsgaHRtbEVzY2FwZShmb3JtYXREYXRlcyhldmVudC5zdGFydCwgZXZlbnQuZW5kLCBvcHQoJ3RpbWVGb3JtYXQnKSkpICsgIjwvc3Bhbj4iICsKCQkJCSI8c3BhbiBjbGFzcz0nZmMtZXZlbnQtdGl0bGUnPiIgKyBodG1sRXNjYXBlKGV2ZW50LnRpdGxlKSArICI8L3NwYW4+IiArCgkJCSI8L2E+IiArCgkJCSgoZXZlbnQuZWRpdGFibGUgfHwgZXZlbnQuZWRpdGFibGUgPT09IHVuZGVmaW5lZCAmJiBvcHQoJ2VkaXRhYmxlJykpICYmICFvcHQoJ2Rpc2FibGVSZXNpemluZycpICYmICQuZm4ucmVzaXphYmxlID8KCQkJCSI8ZGl2IGNsYXNzPSd1aS1yZXNpemFibGUtaGFuZGxlIHVpLXJlc2l6YWJsZS1zJz49PC9kaXY+IgoJCQkJOiAnJykgKwoJCSI8L2Rpdj4iOwoJfQoJCgkKCWZ1bmN0aW9uIGJpbmREYXlTZWcoZXZlbnQsIGV2ZW50RWxlbWVudCwgc2VnKSB7CgkJZXZlbnRFbGVtZW50SGFuZGxlcnMoZXZlbnQsIGV2ZW50RWxlbWVudCk7CgkJaWYgKGV2ZW50LmVkaXRhYmxlIHx8IGV2ZW50LmVkaXRhYmxlID09PSB1bmRlZmluZWQgJiYgb3B0KCdlZGl0YWJsZScpKSB7CgkJCWRyYWdnYWJsZURheUV2ZW50KGV2ZW50LCBldmVudEVsZW1lbnQsIHNlZy5pc1N0YXJ0KTsKCQkJaWYgKHNlZy5pc0VuZCkgewoJCQkJcmVzaXphYmxlRGF5RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgc2VnKTsKCQkJfQoJCX0KCX0KCQoJCglmdW5jdGlvbiBiaW5kU2xvdFNlZyhldmVudCwgZXZlbnRFbGVtZW50LCBzZWcpIHsKCQlldmVudEVsZW1lbnRIYW5kbGVycyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQlpZiAoZXZlbnQuZWRpdGFibGUgfHwgZXZlbnQuZWRpdGFibGUgPT09IHVuZGVmaW5lZCAmJiBvcHQoJ2VkaXRhYmxlJykpIHsKCQkJdmFyIHRpbWVFbGVtZW50ID0gZXZlbnRFbGVtZW50LmZpbmQoJ3NwYW4uZmMtZXZlbnQtdGltZScpOwoJCQlkcmFnZ2FibGVTbG90RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgdGltZUVsZW1lbnQpOwoJCQlpZiAoc2VnLmlzRW5kKSB7CgkJCQlyZXNpemFibGVTbG90RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgdGltZUVsZW1lbnQpOwoJCQl9CgkJfQoJfQoJCgkKCQoJLyogRHJhZ2dpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCgkvLyB3aGVuIGV2ZW50IHN0YXJ0cyBvdXQgRlVMTC1EQVkKCQoJZnVuY3Rpb24gZHJhZ2dhYmxlRGF5RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgaXNTdGFydCkgewoJCWlmICghb3B0KCdkaXNhYmxlRHJhZ2dpbmcnKSAmJiBldmVudEVsZW1lbnQuZHJhZ2dhYmxlKSB7CgkJCXZhciBvcmlnV2lkdGg7CgkJCXZhciBhbGxEYXk9dHJ1ZTsKCQkJdmFyIGRheURlbHRhOwoJCQl2YXIgZGlzID0gb3B0KCdpc1JUTCcpID8gLTEgOiAxOwoJCQl2YXIgaG92ZXJMaXN0ZW5lciA9IGdldEhvdmVyTGlzdGVuZXIoKTsKCQkJdmFyIGNvbFdpZHRoID0gZ2V0Q29sV2lkdGgoKTsKCQkJdmFyIHNsb3RIZWlnaHQgPSBnZXRTbG90SGVpZ2h0KCk7CgkJCXZhciBtaW5NaW51dGUgPSBnZXRNaW5NaW51dGUoKTsKCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSh7CgkJCQl6SW5kZXg6IDksCgkJCQlvcGFjaXR5OiBvcHQoJ2RyYWdPcGFjaXR5JywgJ21vbnRoJyksIC8vIHVzZSB3aGF0ZXZlciB0aGUgbW9udGggdmlldyB3YXMgdXNpbmcKCQkJCXJldmVydER1cmF0aW9uOiBvcHQoJ2RyYWdSZXZlcnREdXJhdGlvbicpLAoJCQkJc3RhcnQ6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCXRyaWdnZXIoJ2V2ZW50RHJhZ1N0YXJ0JywgZXZlbnRFbGVtZW50LCBldmVudCwgZXYsIHVpKTsKCQkJCQloaWRlRXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCW9yaWdXaWR0aCA9IGV2ZW50RWxlbWVudC53aWR0aCgpOwoJCQkJCWhvdmVyTGlzdGVuZXIuc3RhcnQoZnVuY3Rpb24oY2VsbCwgb3JpZ0NlbGwsIHJvd0RlbHRhLCBjb2xEZWx0YSkgewoJCQkJCQlldmVudEVsZW1lbnQuZHJhZ2dhYmxlKCdvcHRpb24nLCAncmV2ZXJ0JywgIWNlbGwgfHwgIXJvd0RlbHRhICYmICFjb2xEZWx0YSk7CgkJCQkJCWNsZWFyT3ZlcmxheXMoKTsKCQkJCQkJaWYgKGNlbGwpIHsKCQkJCQkJCWRheURlbHRhID0gY29sRGVsdGEgKiBkaXM7CgkJCQkJCQlpZiAoIWNlbGwucm93KSB7CgkJCQkJCQkJLy8gb24gZnVsbC1kYXlzCgkJCQkJCQkJcmVuZGVyRGF5T3ZlcmxheSgKCQkJCQkJCQkJYWRkRGF5cyhjbG9uZURhdGUoZXZlbnQuc3RhcnQpLCBkYXlEZWx0YSksCgkJCQkJCQkJCWFkZERheXMoZXhjbEVuZERheShldmVudCksIGRheURlbHRhKQoJCQkJCQkJCSk7CgkJCQkJCQkJcmVzZXRFbGVtZW50KCk7CgkJCQkJCQl9ZWxzZXsKCQkJCQkJCQkvLyBtb3VzZSBpcyBvdmVyIGJvdHRvbSBzbG90cwoJCQkJCQkJCWlmIChpc1N0YXJ0ICYmIGFsbERheSkgewoJCQkJCQkJCQkvLyBjb252ZXJ0IGV2ZW50IHRvIHRlbXBvcmFyeSBzbG90LWV2ZW50CgkJCQkJCQkJCXNldE91dGVySGVpZ2h0KAoJCQkJCQkJCQkJZXZlbnRFbGVtZW50LndpZHRoKGNvbFdpZHRoIC0gMTApLCAvLyBkb24ndCB1c2UgZW50aXJlIHdpZHRoCgkJCQkJCQkJCQlzbG90SGVpZ2h0ICogTWF0aC5yb3VuZCgKCQkJCQkJCQkJCQkoZXZlbnQuZW5kID8gKChldmVudC5lbmQgLSBldmVudC5zdGFydCkgLyBNSU5VVEVfTVMpIDogb3B0KCdkZWZhdWx0RXZlbnRNaW51dGVzJykpCgkJCQkJCQkJCQkJLyBvcHQoJ3Nsb3RNaW51dGVzJykKCQkJCQkJCQkJCSkKCQkJCQkJCQkJKTsKCQkJCQkJCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSgnb3B0aW9uJywgJ2dyaWQnLCBbY29sV2lkdGgsIDFdKTsKCQkJCQkJCQkJYWxsRGF5ID0gZmFsc2U7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfSwgZXYsICdkcmFnJyk7CgkJCQl9LAoJCQkJc3RvcDogZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJdmFyIGNlbGwgPSBob3Zlckxpc3RlbmVyLnN0b3AoKTsKCQkJCQljbGVhck92ZXJsYXlzKCk7CgkJCQkJdHJpZ2dlcignZXZlbnREcmFnU3RvcCcsIGV2ZW50RWxlbWVudCwgZXZlbnQsIGV2LCB1aSk7CgkJCQkJaWYgKGNlbGwgJiYgKCFhbGxEYXkgfHwgZGF5RGVsdGEpKSB7CgkJCQkJCS8vIGNoYW5nZWQhCgkJCQkJCWV2ZW50RWxlbWVudC5maW5kKCdhJykucmVtb3ZlQXR0cignaHJlZicpOyAvLyBwcmV2ZW50cyBzYWZhcmkgZnJvbSB2aXNpdGluZyB0aGUgbGluawoJCQkJCQl2YXIgbWludXRlRGVsdGEgPSAwOwoJCQkJCQlpZiAoIWFsbERheSkgewoJCQkJCQkJbWludXRlRGVsdGEgPSBNYXRoLnJvdW5kKChldmVudEVsZW1lbnQub2Zmc2V0KCkudG9wIC0gZ2V0Qm9keUNvbnRlbnQoKS5vZmZzZXQoKS50b3ApIC8gc2xvdEhlaWdodCkKCQkJCQkJCQkqIG9wdCgnc2xvdE1pbnV0ZXMnKQoJCQkJCQkJCSsgbWluTWludXRlCgkJCQkJCQkJLSAoZXZlbnQuc3RhcnQuZ2V0SG91cnMoKSAqIDYwICsgZXZlbnQuc3RhcnQuZ2V0TWludXRlcygpKTsKCQkJCQkJfQoJCQkJCQlldmVudERyb3AodGhpcywgZXZlbnQsIGRheURlbHRhLCBtaW51dGVEZWx0YSwgYWxsRGF5LCBldiwgdWkpOwoJCQkJCX1lbHNlewoJCQkJCQkvLyBoYXNuJ3QgbW92ZWQgb3IgaXMgb3V0IG9mIGJvdW5kcyAoZHJhZ2dhYmxlIGhhcyBhbHJlYWR5IHJldmVydGVkKQoJCQkJCQlyZXNldEVsZW1lbnQoKTsKCQkJCQkJaWYgKCQuYnJvd3Nlci5tc2llKSB7CgkJCQkJCQlldmVudEVsZW1lbnQuY3NzKCdmaWx0ZXInLCAnJyk7IC8vIGNsZWFyIElFIG9wYWNpdHkgc2lkZS1lZmZlY3RzCgkJCQkJCX0KCQkJCQkJc2hvd0V2ZW50cyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoJCQlmdW5jdGlvbiByZXNldEVsZW1lbnQoKSB7CgkJCQlpZiAoIWFsbERheSkgewoJCQkJCWV2ZW50RWxlbWVudAoJCQkJCQkud2lkdGgob3JpZ1dpZHRoKQoJCQkJCQkuaGVpZ2h0KCcnKQoJCQkJCQkuZHJhZ2dhYmxlKCdvcHRpb24nLCAnZ3JpZCcsIG51bGwpOwoJCQkJCWFsbERheSA9IHRydWU7CgkJCQl9CgkJCX0KCQl9Cgl9CgkKCQoJLy8gd2hlbiBldmVudCBzdGFydHMgb3V0IElOIFRJTUVTTE9UUwoJCglmdW5jdGlvbiBkcmFnZ2FibGVTbG90RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgdGltZUVsZW1lbnQpIHsKCQlpZiAoIW9wdCgnZGlzYWJsZURyYWdnaW5nJykgJiYgZXZlbnRFbGVtZW50LmRyYWdnYWJsZSkgewoJCQl2YXIgb3JpZ1Bvc2l0aW9uOwoJCQl2YXIgYWxsRGF5PWZhbHNlOwoJCQl2YXIgZGF5RGVsdGE7CgkJCXZhciBtaW51dGVEZWx0YTsKCQkJdmFyIHByZXZNaW51dGVEZWx0YTsKCQkJdmFyIGRpcyA9IG9wdCgnaXNSVEwnKSA/IC0xIDogMTsKCQkJdmFyIGhvdmVyTGlzdGVuZXIgPSBnZXRIb3Zlckxpc3RlbmVyKCk7CgkJCXZhciBjb2xDbnQgPSBnZXRDb2xDbnQoKTsKCQkJdmFyIGNvbFdpZHRoID0gZ2V0Q29sV2lkdGgoKTsKCQkJdmFyIHNsb3RIZWlnaHQgPSBnZXRTbG90SGVpZ2h0KCk7CgkJCWV2ZW50RWxlbWVudC5kcmFnZ2FibGUoewoJCQkJekluZGV4OiA5LAoJCQkJc2Nyb2xsOiBmYWxzZSwKCQkJCWdyaWQ6IFtjb2xXaWR0aCwgc2xvdEhlaWdodF0sCgkJCQlheGlzOiBjb2xDbnQ9PTEgPyAneScgOiBmYWxzZSwKCQkJCW9wYWNpdHk6IG9wdCgnZHJhZ09wYWNpdHknKSwKCQkJCXJldmVydER1cmF0aW9uOiBvcHQoJ2RyYWdSZXZlcnREdXJhdGlvbicpLAoJCQkJc3RhcnQ6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCXRyaWdnZXIoJ2V2ZW50RHJhZ1N0YXJ0JywgZXZlbnRFbGVtZW50LCBldmVudCwgZXYsIHVpKTsKCQkJCQloaWRlRXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCWlmICgkLmJyb3dzZXIubXNpZSkgewoJCQkJCQlldmVudEVsZW1lbnQuZmluZCgnc3Bhbi5mYy1ldmVudC1iZycpLmhpZGUoKTsgLy8gbmVzdGVkIG9wYWNpdGllcyBtZXNzIHVwIGluIElFLCBqdXN0IGhpZGUKCQkJCQl9CgkJCQkJb3JpZ1Bvc2l0aW9uID0gZXZlbnRFbGVtZW50LnBvc2l0aW9uKCk7CgkJCQkJbWludXRlRGVsdGEgPSBwcmV2TWludXRlRGVsdGEgPSAwOwoJCQkJCWhvdmVyTGlzdGVuZXIuc3RhcnQoZnVuY3Rpb24oY2VsbCwgb3JpZ0NlbGwsIHJvd0RlbHRhLCBjb2xEZWx0YSkgewoJCQkJCQlldmVudEVsZW1lbnQuZHJhZ2dhYmxlKCdvcHRpb24nLCAncmV2ZXJ0JywgIWNlbGwpOwoJCQkJCQljbGVhck92ZXJsYXlzKCk7CgkJCQkJCWlmIChjZWxsKSB7CgkJCQkJCQlkYXlEZWx0YSA9IGNvbERlbHRhICogZGlzOwoJCQkJCQkJaWYgKG9wdCgnYWxsRGF5U2xvdCcpICYmICFjZWxsLnJvdykgewoJCQkJCQkJCS8vIG92ZXIgZnVsbCBkYXlzCgkJCQkJCQkJaWYgKCFhbGxEYXkpIHsKCQkJCQkJCQkJLy8gY29udmVydCB0byB0ZW1wb3JhcnkgYWxsLWRheSBldmVudAoJCQkJCQkJCQlhbGxEYXkgPSB0cnVlOwoJCQkJCQkJCQl0aW1lRWxlbWVudC5oaWRlKCk7CgkJCQkJCQkJCWV2ZW50RWxlbWVudC5kcmFnZ2FibGUoJ29wdGlvbicsICdncmlkJywgbnVsbCk7CgkJCQkJCQkJfQoJCQkJCQkJCXJlbmRlckRheU92ZXJsYXkoCgkJCQkJCQkJCWFkZERheXMoY2xvbmVEYXRlKGV2ZW50LnN0YXJ0KSwgZGF5RGVsdGEpLAoJCQkJCQkJCQlhZGREYXlzKGV4Y2xFbmREYXkoZXZlbnQpLCBkYXlEZWx0YSkKCQkJCQkJCQkpOwoJCQkJCQkJfWVsc2V7CgkJCQkJCQkJLy8gb24gc2xvdHMKCQkJCQkJCQlyZXNldEVsZW1lbnQoKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0sIGV2LCAnZHJhZycpOwoJCQkJfSwKCQkJCWRyYWc6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCW1pbnV0ZURlbHRhID0gTWF0aC5yb3VuZCgodWkucG9zaXRpb24udG9wIC0gb3JpZ1Bvc2l0aW9uLnRvcCkgLyBzbG90SGVpZ2h0KSAqIG9wdCgnc2xvdE1pbnV0ZXMnKTsKCQkJCQlpZiAobWludXRlRGVsdGEgIT0gcHJldk1pbnV0ZURlbHRhKSB7CgkJCQkJCWlmICghYWxsRGF5KSB7CgkJCQkJCQl1cGRhdGVUaW1lVGV4dChtaW51dGVEZWx0YSk7CgkJCQkJCX0KCQkJCQkJcHJldk1pbnV0ZURlbHRhID0gbWludXRlRGVsdGE7CgkJCQkJfQoJCQkJfSwKCQkJCXN0b3A6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCXZhciBjZWxsID0gaG92ZXJMaXN0ZW5lci5zdG9wKCk7CgkJCQkJY2xlYXJPdmVybGF5cygpOwoJCQkJCXRyaWdnZXIoJ2V2ZW50RHJhZ1N0b3AnLCBldmVudEVsZW1lbnQsIGV2ZW50LCBldiwgdWkpOwoJCQkJCWlmIChjZWxsICYmIChkYXlEZWx0YSB8fCBtaW51dGVEZWx0YSB8fCBhbGxEYXkpKSB7CgkJCQkJCS8vIGNoYW5nZWQhCgkJCQkJCWV2ZW50RHJvcCh0aGlzLCBldmVudCwgZGF5RGVsdGEsIGFsbERheSA/IDAgOiBtaW51dGVEZWx0YSwgYWxsRGF5LCBldiwgdWkpOwoJCQkJCX1lbHNlewoJCQkJCQkvLyBlaXRoZXIgbm8gY2hhbmdlIG9yIG91dC1vZi1ib3VuZHMgKGRyYWdnYWJsZSBoYXMgYWxyZWFkeSByZXZlcnRlZCkKCQkJCQkJcmVzZXRFbGVtZW50KCk7CgkJCQkJCWV2ZW50RWxlbWVudC5jc3Mob3JpZ1Bvc2l0aW9uKTsgLy8gc29tZXRpbWVzIGZhc3QgZHJhZ3MgbWFrZSBldmVudCByZXZlcnQgdG8gd3JvbmcgcG9zaXRpb24KCQkJCQkJdXBkYXRlVGltZVRleHQoMCk7CgkJCQkJCWlmICgkLmJyb3dzZXIubXNpZSkgewoJCQkJCQkJZXZlbnRFbGVtZW50CgkJCQkJCQkJLmNzcygnZmlsdGVyJywgJycpIC8vIGNsZWFyIElFIG9wYWNpdHkgc2lkZS1lZmZlY3RzCgkJCQkJCQkJLmZpbmQoJ3NwYW4uZmMtZXZlbnQtYmcnKQoJCQkJCQkJCQkuY3NzKCdkaXNwbGF5JywgJycpOyAvLyAuc2hvdygpIG1hZGUgZGlzcGxheT1pbmxpbmUKCQkJCQkJfQoJCQkJCQlzaG93RXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJCWZ1bmN0aW9uIHVwZGF0ZVRpbWVUZXh0KG1pbnV0ZURlbHRhKSB7CgkJCQl2YXIgbmV3U3RhcnQgPSBhZGRNaW51dGVzKGNsb25lRGF0ZShldmVudC5zdGFydCksIG1pbnV0ZURlbHRhKTsKCQkJCXZhciBuZXdFbmQ7CgkJCQlpZiAoZXZlbnQuZW5kKSB7CgkJCQkJbmV3RW5kID0gYWRkTWludXRlcyhjbG9uZURhdGUoZXZlbnQuZW5kKSwgbWludXRlRGVsdGEpOwoJCQkJfQoJCQkJdGltZUVsZW1lbnQudGV4dChmb3JtYXREYXRlcyhuZXdTdGFydCwgbmV3RW5kLCBvcHQoJ3RpbWVGb3JtYXQnKSkpOwoJCQl9CgkJCWZ1bmN0aW9uIHJlc2V0RWxlbWVudCgpIHsKCQkJCS8vIGNvbnZlcnQgYmFjayB0byBvcmlnaW5hbCBzbG90LWV2ZW50CgkJCQlpZiAoYWxsRGF5KSB7CgkJCQkJdGltZUVsZW1lbnQuY3NzKCdkaXNwbGF5JywgJycpOyAvLyBzaG93KCkgd2FzIGNhdXNpbmcgZGlzcGxheT1pbmxpbmUKCQkJCQlldmVudEVsZW1lbnQuZHJhZ2dhYmxlKCdvcHRpb24nLCAnZ3JpZCcsIFtjb2xXaWR0aCwgc2xvdEhlaWdodF0pOwoJCQkJCWFsbERheSA9IGZhbHNlOwoJCQkJfQoJCQl9CgkJfQoJfQoJCgkKCQoJLyogUmVzaXppbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglmdW5jdGlvbiByZXNpemFibGVTbG90RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgdGltZUVsZW1lbnQpIHsKCQlpZiAoIW9wdCgnZGlzYWJsZVJlc2l6aW5nJykgJiYgZXZlbnRFbGVtZW50LnJlc2l6YWJsZSkgewoJCQl2YXIgc2xvdERlbHRhLCBwcmV2U2xvdERlbHRhOwoJCQl2YXIgc2xvdEhlaWdodCA9IGdldFNsb3RIZWlnaHQoKTsKCQkJZXZlbnRFbGVtZW50LnJlc2l6YWJsZSh7CgkJCQloYW5kbGVzOiB7CgkJCQkJczogJ2Rpdi51aS1yZXNpemFibGUtcycKCQkJCX0sCgkJCQlncmlkOiBzbG90SGVpZ2h0LAoJCQkJc3RhcnQ6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCXNsb3REZWx0YSA9IHByZXZTbG90RGVsdGEgPSAwOwoJCQkJCWhpZGVFdmVudHMoZXZlbnQsIGV2ZW50RWxlbWVudCk7CgkJCQkJaWYgKCQuYnJvd3Nlci5tc2llICYmICQuYnJvd3Nlci52ZXJzaW9uID09ICc2LjAnKSB7CgkJCQkJCWV2ZW50RWxlbWVudC5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpOwoJCQkJCX0KCQkJCQlldmVudEVsZW1lbnQuY3NzKCd6LWluZGV4JywgOSk7CgkJCQkJdHJpZ2dlcignZXZlbnRSZXNpemVTdGFydCcsIHRoaXMsIGV2ZW50LCBldiwgdWkpOwoJCQkJfSwKCQkJCXJlc2l6ZTogZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJLy8gZG9uJ3QgcmVseSBvbiB1aS5zaXplLmhlaWdodCwgZG9lc24ndCB0YWtlIGdyaWQgaW50byBhY2NvdW50CgkJCQkJc2xvdERlbHRhID0gTWF0aC5yb3VuZCgoTWF0aC5tYXgoc2xvdEhlaWdodCwgZXZlbnRFbGVtZW50LmhlaWdodCgpKSAtIHVpLm9yaWdpbmFsU2l6ZS5oZWlnaHQpIC8gc2xvdEhlaWdodCk7CgkJCQkJaWYgKHNsb3REZWx0YSAhPSBwcmV2U2xvdERlbHRhKSB7CgkJCQkJCXRpbWVFbGVtZW50LnRleHQoCgkJCQkJCQlmb3JtYXREYXRlcygKCQkJCQkJCQlldmVudC5zdGFydCwKCQkJCQkJCQkoIXNsb3REZWx0YSAmJiAhZXZlbnQuZW5kKSA/IG51bGwgOiAvLyBubyBjaGFuZ2UsIHNvIGRvbid0IGRpc3BsYXkgdGltZSByYW5nZQoJCQkJCQkJCQlhZGRNaW51dGVzKGV2ZW50RW5kKGV2ZW50KSwgb3B0KCdzbG90TWludXRlcycpKnNsb3REZWx0YSksCgkJCQkJCQkJb3B0KCd0aW1lRm9ybWF0JykKCQkJCQkJCSkKCQkJCQkJKTsKCQkJCQkJcHJldlNsb3REZWx0YSA9IHNsb3REZWx0YTsKCQkJCQl9CgkJCQl9LAoJCQkJc3RvcDogZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJdHJpZ2dlcignZXZlbnRSZXNpemVTdG9wJywgdGhpcywgZXZlbnQsIGV2LCB1aSk7CgkJCQkJaWYgKHNsb3REZWx0YSkgewoJCQkJCQlldmVudFJlc2l6ZSh0aGlzLCBldmVudCwgMCwgb3B0KCdzbG90TWludXRlcycpKnNsb3REZWx0YSwgZXYsIHVpKTsKCQkJCQl9ZWxzZXsKCQkJCQkJZXZlbnRFbGVtZW50LmNzcygnei1pbmRleCcsIDgpOwoJCQkJCQlzaG93RXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCQkvLyBCVUc6IGlmIGV2ZW50IHdhcyByZWFsbHkgc2hvcnQsIG5lZWQgdG8gcHV0IHRpdGxlIGJhY2sgaW4gc3BhbgoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfQoJfQoJCgp9CgoKZnVuY3Rpb24gY291bnRGb3J3YXJkU2VncyhsZXZlbHMpIHsKCXZhciBpLCBqLCBrLCBsZXZlbCwgc2VnRm9yd2FyZCwgc2VnQmFjazsKCWZvciAoaT1sZXZlbHMubGVuZ3RoLTE7IGk+MDsgaS0tKSB7CgkJbGV2ZWwgPSBsZXZlbHNbaV07CgkJZm9yIChqPTA7IGo8bGV2ZWwubGVuZ3RoOyBqKyspIHsKCQkJc2VnRm9yd2FyZCA9IGxldmVsW2pdOwoJCQlmb3IgKGs9MDsgazxsZXZlbHNbaS0xXS5sZW5ndGg7IGsrKykgewoJCQkJc2VnQmFjayA9IGxldmVsc1tpLTFdW2tdOwoJCQkJaWYgKHNlZ3NDb2xsaWRlKHNlZ0ZvcndhcmQsIHNlZ0JhY2spKSB7CgkJCQkJc2VnQmFjay5mb3J3YXJkID0gTWF0aC5tYXgoc2VnQmFjay5mb3J3YXJkfHwwLCAoc2VnRm9yd2FyZC5mb3J3YXJkfHwwKSsxKTsKCQkJCX0KCQkJfQoJCX0KCX0KfQoKCgoKZnVuY3Rpb24gVmlldyhlbGVtZW50LCBjYWxlbmRhciwgdmlld05hbWUpIHsKCXZhciB0ID0gdGhpczsKCQoJCgkvLyBleHBvcnRzCgl0LmVsZW1lbnQgPSBlbGVtZW50OwoJdC5jYWxlbmRhciA9IGNhbGVuZGFyOwoJdC5uYW1lID0gdmlld05hbWU7Cgl0Lm9wdCA9IG9wdDsKCXQudHJpZ2dlciA9IHRyaWdnZXI7Cgl0LnJlcG9ydEV2ZW50cyA9IHJlcG9ydEV2ZW50czsKCXQuZXZlbnRFbmQgPSBldmVudEVuZDsKCXQucmVwb3J0RXZlbnRFbGVtZW50ID0gcmVwb3J0RXZlbnRFbGVtZW50OwoJdC5yZXBvcnRFdmVudENsZWFyID0gcmVwb3J0RXZlbnRDbGVhcjsKCXQuZXZlbnRFbGVtZW50SGFuZGxlcnMgPSBldmVudEVsZW1lbnRIYW5kbGVyczsKCXQuc2hvd0V2ZW50cyA9IHNob3dFdmVudHM7Cgl0LmhpZGVFdmVudHMgPSBoaWRlRXZlbnRzOwoJdC5ldmVudERyb3AgPSBldmVudERyb3A7Cgl0LmV2ZW50UmVzaXplID0gZXZlbnRSZXNpemU7CgkvLyB0LnRpdGxlCgkvLyB0LnN0YXJ0LCB0LmVuZAoJLy8gdC52aXNTdGFydCwgdC52aXNFbmQKCQoJCgkvLyBpbXBvcnRzCgl2YXIgZGVmYXVsdEV2ZW50RW5kID0gdC5kZWZhdWx0RXZlbnRFbmQ7Cgl2YXIgbm9ybWFsaXplRXZlbnQgPSBjYWxlbmRhci5ub3JtYWxpemVFdmVudDsgLy8gaW4gRXZlbnRNYW5hZ2VyCgl2YXIgcmVwb3J0RXZlbnRDaGFuZ2UgPSBjYWxlbmRhci5yZXBvcnRFdmVudENoYW5nZTsKCQoJCgkvLyBsb2NhbHMKCXZhciBldmVudHNCeUlEID0ge307Cgl2YXIgZXZlbnRFbGVtZW50cyA9IFtdOwoJdmFyIGV2ZW50RWxlbWVudHNCeUlEID0ge307Cgl2YXIgb3B0aW9ucyA9IGNhbGVuZGFyLm9wdGlvbnM7CgkKCQoJCglmdW5jdGlvbiBvcHQobmFtZSwgdmlld05hbWVPdmVycmlkZSkgewoJCXZhciB2ID0gb3B0aW9uc1tuYW1lXTsKCQlpZiAodHlwZW9mIHYgPT0gJ29iamVjdCcpIHsKCQkJcmV0dXJuIHNtYXJ0UHJvcGVydHkodiwgdmlld05hbWVPdmVycmlkZSB8fCB2aWV3TmFtZSk7CgkJfQoJCXJldHVybiB2OwoJfQoKCQoJZnVuY3Rpb24gdHJpZ2dlcihuYW1lLCB0aGlzT2JqKSB7CgkJcmV0dXJuIGNhbGVuZGFyLnRyaWdnZXIuYXBwbHkoCgkJCWNhbGVuZGFyLAoJCQlbbmFtZSwgdGhpc09iaiB8fCB0XS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSwgW3RdKQoJCSk7Cgl9CgkKCQoJCgkvKiBFdmVudCBEYXRhCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCS8vIHJlcG9ydCB3aGVuIHZpZXcgcmVjZWl2ZXMgbmV3IGV2ZW50cwoJZnVuY3Rpb24gcmVwb3J0RXZlbnRzKGV2ZW50cykgeyAvLyBldmVudHMgYXJlIGFscmVhZHkgbm9ybWFsaXplZCBhdCB0aGlzIHBvaW50CgkJZXZlbnRzQnlJRCA9IHt9OwoJCXZhciBpLCBsZW49ZXZlbnRzLmxlbmd0aCwgZXZlbnQ7CgkJZm9yIChpPTA7IGk8bGVuOyBpKyspIHsKCQkJZXZlbnQgPSBldmVudHNbaV07CgkJCWlmIChldmVudHNCeUlEW2V2ZW50Ll9pZF0pIHsKCQkJCWV2ZW50c0J5SURbZXZlbnQuX2lkXS5wdXNoKGV2ZW50KTsKCQkJfWVsc2V7CgkJCQlldmVudHNCeUlEW2V2ZW50Ll9pZF0gPSBbZXZlbnRdOwoJCQl9CgkJfQoJfQoJCgkKCS8vIHJldHVybnMgYSBEYXRlIG9iamVjdCBmb3IgYW4gZXZlbnQncyBlbmQKCWZ1bmN0aW9uIGV2ZW50RW5kKGV2ZW50KSB7CgkJcmV0dXJuIGV2ZW50LmVuZCA/IGNsb25lRGF0ZShldmVudC5lbmQpIDogZGVmYXVsdEV2ZW50RW5kKGV2ZW50KTsKCX0KCQoJCgkKCS8qIEV2ZW50IEVsZW1lbnRzCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCS8vIHJlcG9ydCB3aGVuIHZpZXcgY3JlYXRlcyBhbiBlbGVtZW50IGZvciBhbiBldmVudAoJZnVuY3Rpb24gcmVwb3J0RXZlbnRFbGVtZW50KGV2ZW50LCBlbGVtZW50KSB7CgkJZXZlbnRFbGVtZW50cy5wdXNoKGVsZW1lbnQpOwoJCWlmIChldmVudEVsZW1lbnRzQnlJRFtldmVudC5faWRdKSB7CgkJCWV2ZW50RWxlbWVudHNCeUlEW2V2ZW50Ll9pZF0ucHVzaChlbGVtZW50KTsKCQl9ZWxzZXsKCQkJZXZlbnRFbGVtZW50c0J5SURbZXZlbnQuX2lkXSA9IFtlbGVtZW50XTsKCQl9Cgl9CgkKCQoJZnVuY3Rpb24gcmVwb3J0RXZlbnRDbGVhcigpIHsKCQlldmVudEVsZW1lbnRzID0gW107CgkJZXZlbnRFbGVtZW50c0J5SUQgPSB7fTsKCX0KCQoJCgkvLyBhdHRhY2hlcyBldmVudENsaWNrLCBldmVudE1vdXNlb3ZlciwgZXZlbnRNb3VzZW91dAoJZnVuY3Rpb24gZXZlbnRFbGVtZW50SGFuZGxlcnMoZXZlbnQsIGV2ZW50RWxlbWVudCkgewoJCWV2ZW50RWxlbWVudAoJCQkuY2xpY2soZnVuY3Rpb24oZXYpIHsKCQkJCWlmICghZXZlbnRFbGVtZW50Lmhhc0NsYXNzKCd1aS1kcmFnZ2FibGUtZHJhZ2dpbmcnKSAmJgoJCQkJCSFldmVudEVsZW1lbnQuaGFzQ2xhc3MoJ3VpLXJlc2l6YWJsZS1yZXNpemluZycpKSB7CgkJCQkJCXJldHVybiB0cmlnZ2VyKCdldmVudENsaWNrJywgdGhpcywgZXZlbnQsIGV2KTsKCQkJCQl9CgkJCX0pCgkJCS5ob3ZlcigKCQkJCWZ1bmN0aW9uKGV2KSB7CgkJCQkJdHJpZ2dlcignZXZlbnRNb3VzZW92ZXInLCB0aGlzLCBldmVudCwgZXYpOwoJCQkJfSwKCQkJCWZ1bmN0aW9uKGV2KSB7CgkJCQkJdHJpZ2dlcignZXZlbnRNb3VzZW91dCcsIHRoaXMsIGV2ZW50LCBldik7CgkJCQl9CgkJCSk7CgkJLy8gVE9ETzogZG9uJ3QgZmlyZSBldmVudE1vdXNlb3Zlci9ldmVudE1vdXNlb3V0ICp3aGlsZSogZHJhZ2dpbmcgaXMgb2NjdXJpbmcgKG9uIHN1YmplY3QgZWxlbWVudCkKCQkvLyBUT0RPOiBzYW1lIGZvciByZXNpemluZwoJfQoJCgkKCWZ1bmN0aW9uIHNob3dFdmVudHMoZXZlbnQsIGV4Y2VwdEVsZW1lbnQpIHsKCQllYWNoRXZlbnRFbGVtZW50KGV2ZW50LCBleGNlcHRFbGVtZW50LCAnc2hvdycpOwoJfQoJCgkKCWZ1bmN0aW9uIGhpZGVFdmVudHMoZXZlbnQsIGV4Y2VwdEVsZW1lbnQpIHsKCQllYWNoRXZlbnRFbGVtZW50KGV2ZW50LCBleGNlcHRFbGVtZW50LCAnaGlkZScpOwoJfQoJCgkKCWZ1bmN0aW9uIGVhY2hFdmVudEVsZW1lbnQoZXZlbnQsIGV4Y2VwdEVsZW1lbnQsIGZ1bmNOYW1lKSB7CgkJdmFyIGVsZW1lbnRzID0gZXZlbnRFbGVtZW50c0J5SURbZXZlbnQuX2lkXSwKCQkJaSwgbGVuID0gZWxlbWVudHMubGVuZ3RoOwoJCWZvciAoaT0wOyBpPGxlbjsgaSsrKSB7CgkJCWlmICghZXhjZXB0RWxlbWVudCB8fCBlbGVtZW50c1tpXVswXSAhPSBleGNlcHRFbGVtZW50WzBdKSB7CgkJCQllbGVtZW50c1tpXVtmdW5jTmFtZV0oKTsKCQkJfQoJCX0KCX0KCQoJCgkKCS8qIEV2ZW50IE1vZGlmaWNhdGlvbiBSZXBvcnRpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gZXZlbnREcm9wKGUsIGV2ZW50LCBkYXlEZWx0YSwgbWludXRlRGVsdGEsIGFsbERheSwgZXYsIHVpKSB7CgkJdmFyIG9sZEFsbERheSA9IGV2ZW50LmFsbERheTsKCQl2YXIgZXZlbnRJZCA9IGV2ZW50Ll9pZDsKCQltb3ZlRXZlbnRzKGV2ZW50c0J5SURbZXZlbnRJZF0sIGRheURlbHRhLCBtaW51dGVEZWx0YSwgYWxsRGF5KTsKCQl0cmlnZ2VyKAoJCQknZXZlbnREcm9wJywKCQkJZSwKCQkJZXZlbnQsCgkJCWRheURlbHRhLAoJCQltaW51dGVEZWx0YSwKCQkJYWxsRGF5LAoJCQlmdW5jdGlvbigpIHsKCQkJCS8vIFRPRE86IGludmVzdGlnYXRlIGNhc2VzIHdoZXJlIHRoaXMgaW52ZXJzZSB0ZWNobmlxdWUgbWlnaHQgbm90IHdvcmsKCQkJCW1vdmVFdmVudHMoZXZlbnRzQnlJRFtldmVudElkXSwgLWRheURlbHRhLCAtbWludXRlRGVsdGEsIG9sZEFsbERheSk7CgkJCQlyZXBvcnRFdmVudENoYW5nZShldmVudElkKTsKCQkJfSwKCQkJZXYsCgkJCXVpCgkJKTsKCQlyZXBvcnRFdmVudENoYW5nZShldmVudElkKTsKCX0KCQoJCglmdW5jdGlvbiBldmVudFJlc2l6ZShlLCBldmVudCwgZGF5RGVsdGEsIG1pbnV0ZURlbHRhLCBldiwgdWkpIHsKCQl2YXIgZXZlbnRJZCA9IGV2ZW50Ll9pZDsKCQllbG9uZ2F0ZUV2ZW50cyhldmVudHNCeUlEW2V2ZW50SWRdLCBkYXlEZWx0YSwgbWludXRlRGVsdGEpOwoJCXRyaWdnZXIoCgkJCSdldmVudFJlc2l6ZScsCgkJCWUsCgkJCWV2ZW50LAoJCQlkYXlEZWx0YSwKCQkJbWludXRlRGVsdGEsCgkJCWZ1bmN0aW9uKCkgewoJCQkJLy8gVE9ETzogaW52ZXN0aWdhdGUgY2FzZXMgd2hlcmUgdGhpcyBpbnZlcnNlIHRlY2huaXF1ZSBtaWdodCBub3Qgd29yawoJCQkJZWxvbmdhdGVFdmVudHMoZXZlbnRzQnlJRFtldmVudElkXSwgLWRheURlbHRhLCAtbWludXRlRGVsdGEpOwoJCQkJcmVwb3J0RXZlbnRDaGFuZ2UoZXZlbnRJZCk7CgkJCX0sCgkJCWV2LAoJCQl1aQoJCSk7CgkJcmVwb3J0RXZlbnRDaGFuZ2UoZXZlbnRJZCk7Cgl9CgkKCQoJCgkvKiBFdmVudCBNb2RpZmljYXRpb24gTWF0aAoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJCglmdW5jdGlvbiBtb3ZlRXZlbnRzKGV2ZW50cywgZGF5RGVsdGEsIG1pbnV0ZURlbHRhLCBhbGxEYXkpIHsKCQltaW51dGVEZWx0YSA9IG1pbnV0ZURlbHRhIHx8IDA7CgkJZm9yICh2YXIgZSwgbGVuPWV2ZW50cy5sZW5ndGgsIGk9MDsgaTxsZW47IGkrKykgewoJCQllID0gZXZlbnRzW2ldOwoJCQlpZiAoYWxsRGF5ICE9PSB1bmRlZmluZWQpIHsKCQkJCWUuYWxsRGF5ID0gYWxsRGF5OwoJCQl9CgkJCWFkZE1pbnV0ZXMoYWRkRGF5cyhlLnN0YXJ0LCBkYXlEZWx0YSwgdHJ1ZSksIG1pbnV0ZURlbHRhKTsKCQkJaWYgKGUuZW5kKSB7CgkJCQllLmVuZCA9IGFkZE1pbnV0ZXMoYWRkRGF5cyhlLmVuZCwgZGF5RGVsdGEsIHRydWUpLCBtaW51dGVEZWx0YSk7CgkJCX0KCQkJbm9ybWFsaXplRXZlbnQoZSwgb3B0aW9ucyk7CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIGVsb25nYXRlRXZlbnRzKGV2ZW50cywgZGF5RGVsdGEsIG1pbnV0ZURlbHRhKSB7CgkJbWludXRlRGVsdGEgPSBtaW51dGVEZWx0YSB8fCAwOwoJCWZvciAodmFyIGUsIGxlbj1ldmVudHMubGVuZ3RoLCBpPTA7IGk8bGVuOyBpKyspIHsKCQkJZSA9IGV2ZW50c1tpXTsKCQkJZS5lbmQgPSBhZGRNaW51dGVzKGFkZERheXMoZXZlbnRFbmQoZSksIGRheURlbHRhLCB0cnVlKSwgbWludXRlRGVsdGEpOwoJCQlub3JtYWxpemVFdmVudChlLCBvcHRpb25zKTsKCQl9Cgl9CgkKCn0KCmZ1bmN0aW9uIERheUV2ZW50UmVuZGVyZXIoKSB7Cgl2YXIgdCA9IHRoaXM7CgoJCgkvLyBleHBvcnRzCgl0LnJlbmRlckRheVNlZ3MgPSByZW5kZXJEYXlTZWdzOwoJdC5yZXNpemFibGVEYXlFdmVudCA9IHJlc2l6YWJsZURheUV2ZW50OwoJCgkKCS8vIGltcG9ydHMKCXZhciBvcHQgPSB0Lm9wdDsKCXZhciB0cmlnZ2VyID0gdC50cmlnZ2VyOwoJdmFyIGV2ZW50RW5kID0gdC5ldmVudEVuZDsKCXZhciByZXBvcnRFdmVudEVsZW1lbnQgPSB0LnJlcG9ydEV2ZW50RWxlbWVudDsKCXZhciBzaG93RXZlbnRzID0gdC5zaG93RXZlbnRzOwoJdmFyIGhpZGVFdmVudHMgPSB0LmhpZGVFdmVudHM7Cgl2YXIgZXZlbnRSZXNpemUgPSB0LmV2ZW50UmVzaXplOwoJdmFyIGdldFJvd0NudCA9IHQuZ2V0Um93Q250OwoJdmFyIGdldENvbENudCA9IHQuZ2V0Q29sQ250OwoJdmFyIGdldENvbFdpZHRoID0gdC5nZXRDb2xXaWR0aDsKCXZhciBhbGxEYXlUUiA9IHQuYWxsRGF5VFI7Cgl2YXIgYWxsRGF5Qm91bmRzID0gdC5hbGxEYXlCb3VuZHM7Cgl2YXIgY29sQ29udGVudExlZnQgPSB0LmNvbENvbnRlbnRMZWZ0OwoJdmFyIGNvbENvbnRlbnRSaWdodCA9IHQuY29sQ29udGVudFJpZ2h0OwoJdmFyIGRheU9mV2Vla0NvbCA9IHQuZGF5T2ZXZWVrQ29sOwoJdmFyIGRhdGVDZWxsID0gdC5kYXRlQ2VsbDsKCXZhciBjb21waWxlRGF5U2VncyA9IHQuY29tcGlsZURheVNlZ3M7Cgl2YXIgZ2V0RGF5U2VnbWVudENvbnRhaW5lciA9IHQuZ2V0RGF5U2VnbWVudENvbnRhaW5lcjsKCXZhciBiaW5kRGF5U2VnID0gdC5iaW5kRGF5U2VnOyAvL1RPRE86IHN0cmVhbWxpbmUgdGhpcwoJdmFyIGZvcm1hdERhdGVzID0gdC5jYWxlbmRhci5mb3JtYXREYXRlczsKCXZhciByZW5kZXJEYXlPdmVybGF5ID0gdC5yZW5kZXJEYXlPdmVybGF5OwoJdmFyIGNsZWFyT3ZlcmxheXMgPSB0LmNsZWFyT3ZlcmxheXM7Cgl2YXIgY2xlYXJTZWxlY3Rpb24gPSB0LmNsZWFyU2VsZWN0aW9uOwoJCgkKCQoJLyogUmVuZGVyaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gcmVuZGVyRGF5U2VncyhzZWdzLCBtb2RpZmllZEV2ZW50SWQpIHsKCQl2YXIgc2VnbWVudENvbnRhaW5lciA9IGdldERheVNlZ21lbnRDb250YWluZXIoKTsKCQl2YXIgcm93RGl2czsKCQl2YXIgcm93Q250ID0gZ2V0Um93Q250KCk7CgkJdmFyIGNvbENudCA9IGdldENvbENudCgpOwoJCXZhciBpID0gMDsKCQl2YXIgcm93STsKCQl2YXIgbGV2ZWxJOwoJCXZhciBjb2xIZWlnaHRzOwoJCXZhciBqOwoJCXZhciBzZWdDbnQgPSBzZWdzLmxlbmd0aDsKCQl2YXIgc2VnOwoJCXZhciB0b3A7CgkJdmFyIGs7CgkJc2VnbWVudENvbnRhaW5lclswXS5pbm5lckhUTUwgPSBkYXlTZWdIVE1MKHNlZ3MpOyAvLyBmYXN0ZXIgdGhhbiAuaHRtbCgpCgkJZGF5U2VnRWxlbWVudFJlc29sdmUoc2Vncywgc2VnbWVudENvbnRhaW5lci5jaGlsZHJlbigpKTsKCQlkYXlTZWdFbGVtZW50UmVwb3J0KHNlZ3MpOwoJCWRheVNlZ0hhbmRsZXJzKHNlZ3MsIHNlZ21lbnRDb250YWluZXIsIG1vZGlmaWVkRXZlbnRJZCk7CgkJZGF5U2VnQ2FsY0hTaWRlcyhzZWdzKTsKCQlkYXlTZWdTZXRXaWR0aHMoc2Vncyk7CgkJZGF5U2VnQ2FsY0hlaWdodHMoc2Vncyk7CgkJcm93RGl2cyA9IGdldFJvd0RpdnMoKTsKCQkvLyBzZXQgcm93IGhlaWdodHMsIGNhbGN1bGF0ZSBldmVudCB0b3BzIChpbiByZWxhdGlvbiB0byByb3cgdG9wKQoJCWZvciAocm93ST0wOyByb3dJPHJvd0NudDsgcm93SSsrKSB7CgkJCWxldmVsSSA9IDA7CgkJCWNvbEhlaWdodHMgPSBbXTsKCQkJZm9yIChqPTA7IGo8Y29sQ250OyBqKyspIHsKCQkJCWNvbEhlaWdodHNbal0gPSAwOwoJCQl9CgkJCXdoaWxlIChpPHNlZ0NudCAmJiAoc2VnID0gc2Vnc1tpXSkucm93ID09IHJvd0kpIHsKCQkJCS8vIGxvb3AgdGhyb3VnaCBzZWdzIGluIGEgcm93CgkJCQl0b3AgPSBhcnJheU1heChjb2xIZWlnaHRzLnNsaWNlKHNlZy5zdGFydENvbCwgc2VnLmVuZENvbCkpOwoJCQkJc2VnLnRvcCA9IHRvcDsKCQkJCXRvcCArPSBzZWcub3V0ZXJIZWlnaHQ7CgkJCQlmb3IgKGs9c2VnLnN0YXJ0Q29sOyBrPHNlZy5lbmRDb2w7IGsrKykgewoJCQkJCWNvbEhlaWdodHNba10gPSB0b3A7CgkJCQl9CgkJCQlpKys7CgkJCX0KCQkJcm93RGl2c1tyb3dJXS5oZWlnaHQoYXJyYXlNYXgoY29sSGVpZ2h0cykpOwoJCX0KCQlkYXlTZWdTZXRUb3BzKHNlZ3MsIGdldFJvd1RvcHMocm93RGl2cykpOwoJfQoJCgkKCWZ1bmN0aW9uIHJlbmRlclRlbXBEYXlTZWdzKHNlZ3MsIGFkanVzdFJvdywgYWRqdXN0VG9wKSB7CgkJdmFyIHRlbXBDb250YWluZXIgPSAkKCI8ZGl2Lz4iKTsKCQl2YXIgZWxlbWVudHM7CgkJdmFyIHNlZ21lbnRDb250YWluZXIgPSBnZXREYXlTZWdtZW50Q29udGFpbmVyKCk7CgkJdmFyIGk7CgkJdmFyIHNlZ0NudCA9IHNlZ3MubGVuZ3RoOwoJCXZhciBlbGVtZW50OwoJCXRlbXBDb250YWluZXJbMF0uaW5uZXJIVE1MID0gZGF5U2VnSFRNTChzZWdzKTsgLy8gZmFzdGVyIHRoYW4gLmh0bWwoKQoJCWVsZW1lbnRzID0gdGVtcENvbnRhaW5lci5jaGlsZHJlbigpOwoJCXNlZ21lbnRDb250YWluZXIuYXBwZW5kKGVsZW1lbnRzKTsKCQlkYXlTZWdFbGVtZW50UmVzb2x2ZShzZWdzLCBlbGVtZW50cyk7CgkJZGF5U2VnQ2FsY0hTaWRlcyhzZWdzKTsKCQlkYXlTZWdTZXRXaWR0aHMoc2Vncyk7CgkJZGF5U2VnQ2FsY0hlaWdodHMoc2Vncyk7CgkJZGF5U2VnU2V0VG9wcyhzZWdzLCBnZXRSb3dUb3BzKGdldFJvd0RpdnMoKSkpOwoJCWVsZW1lbnRzID0gW107CgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJZWxlbWVudCA9IHNlZ3NbaV0uZWxlbWVudDsKCQkJaWYgKGVsZW1lbnQpIHsKCQkJCWlmIChzZWdzW2ldLnJvdyA9PT0gYWRqdXN0Um93KSB7CgkJCQkJZWxlbWVudC5jc3MoJ3RvcCcsIGFkanVzdFRvcCk7CgkJCQl9CgkJCQllbGVtZW50cy5wdXNoKGVsZW1lbnRbMF0pOwoJCQl9CgkJfQoJCXJldHVybiAkKGVsZW1lbnRzKTsKCX0KCQoJCglmdW5jdGlvbiBkYXlTZWdIVE1MKHNlZ3MpIHsgLy8gYWxzbyBzZXRzIHNlZy5sZWZ0IGFuZCBzZWcub3V0ZXJXaWR0aAoJCXZhciBydGwgPSBvcHQoJ2lzUlRMJyk7CgkJdmFyIGk7CgkJdmFyIHNlZ0NudD1zZWdzLmxlbmd0aDsKCQl2YXIgc2VnOwoJCXZhciBldmVudDsKCQl2YXIgY2xhc3NOYW1lOwoJCXZhciBib3VuZHMgPSBhbGxEYXlCb3VuZHMoKTsKCQl2YXIgbWluTGVmdCA9IGJvdW5kcy5sZWZ0OwoJCXZhciBtYXhMZWZ0ID0gYm91bmRzLnJpZ2h0OwoJCXZhciBjb2xzID0gW107IC8vIGRvbid0IHJlYWxseSBsaWtlIHRoaXMgc3lzdGVtIChidXQgaGF2ZSB0byBkbyB0aGlzIGIvYyBSVEwgd29ya3MgZGlmZmVyZW50bHkgaW4gYmFzaWMgdnMgYWdlbmRhKQoJCXZhciBsZWZ0OwoJCXZhciByaWdodDsKCQl2YXIgaHRtbCA9ICcnOwoJCS8vIGNhbGN1bGF0ZSBkZXNpcmVkIHBvc2l0aW9uL2RpbWVuc2lvbnMsIGNyZWF0ZSBodG1sCgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJZXZlbnQgPSBzZWcuZXZlbnQ7CgkJCWNsYXNzTmFtZSA9ICdmYy1ldmVudCBmYy1ldmVudC1ob3JpICc7CgkJCWlmIChydGwpIHsKCQkJCWlmIChzZWcuaXNTdGFydCkgewoJCQkJCWNsYXNzTmFtZSArPSAnZmMtY29ybmVyLXJpZ2h0ICc7CgkJCQl9CgkJCQlpZiAoc2VnLmlzRW5kKSB7CgkJCQkJY2xhc3NOYW1lICs9ICdmYy1jb3JuZXItbGVmdCAnOwoJCQkJfQoJCQkJY29sc1swXSA9IGRheU9mV2Vla0NvbChzZWcuZW5kLmdldERheSgpLTEpOwoJCQkJY29sc1sxXSA9IGRheU9mV2Vla0NvbChzZWcuc3RhcnQuZ2V0RGF5KCkpOwoJCQkJbGVmdCA9IHNlZy5pc0VuZCA/IGNvbENvbnRlbnRMZWZ0KGNvbHNbMF0pIDogbWluTGVmdDsKCQkJCXJpZ2h0ID0gc2VnLmlzU3RhcnQgPyBjb2xDb250ZW50UmlnaHQoY29sc1sxXSkgOiBtYXhMZWZ0OwoJCQl9ZWxzZXsKCQkJCWlmIChzZWcuaXNTdGFydCkgewoJCQkJCWNsYXNzTmFtZSArPSAnZmMtY29ybmVyLWxlZnQgJzsKCQkJCX0KCQkJCWlmIChzZWcuaXNFbmQpIHsKCQkJCQljbGFzc05hbWUgKz0gJ2ZjLWNvcm5lci1yaWdodCAnOwoJCQkJfQoJCQkJY29sc1swXSA9IGRheU9mV2Vla0NvbChzZWcuc3RhcnQuZ2V0RGF5KCkpOwoJCQkJY29sc1sxXSA9IGRheU9mV2Vla0NvbChzZWcuZW5kLmdldERheSgpLTEpOwoJCQkJbGVmdCA9IHNlZy5pc1N0YXJ0ID8gY29sQ29udGVudExlZnQoY29sc1swXSkgOiBtaW5MZWZ0OwoJCQkJcmlnaHQgPSBzZWcuaXNFbmQgPyBjb2xDb250ZW50UmlnaHQoY29sc1sxXSkgOiBtYXhMZWZ0OwoJCQl9CgkJCWh0bWwgKz0KCQkJCSI8ZGl2IGNsYXNzPSciICsgY2xhc3NOYW1lICsgZXZlbnQuY2xhc3NOYW1lLmpvaW4oJyAnKSArICInIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4Ojg7bGVmdDoiK2xlZnQrInB4Jz4iICsKCQkJCQkiPGEiICsgKGV2ZW50LnVybCA/ICIgaHJlZj0nIiArIGh0bWxFc2NhcGUoZXZlbnQudXJsKSArICInIiA6ICcnKSArICI+IiArCgkJCQkJCSghZXZlbnQuYWxsRGF5ICYmIHNlZy5pc1N0YXJ0ID8KCQkJCQkJCSI8c3BhbiBjbGFzcz0nZmMtZXZlbnQtdGltZSc+IiArCgkJCQkJCQkJaHRtbEVzY2FwZShmb3JtYXREYXRlcyhldmVudC5zdGFydCwgZXZlbnQuZW5kLCBvcHQoJ3RpbWVGb3JtYXQnKSkpICsKCQkJCQkJCSI8L3NwYW4+IgoJCQkJCQk6JycpICsKCQkJCQkJIjxzcGFuIGNsYXNzPSdmYy1ldmVudC10aXRsZSc+IiArIGh0bWxFc2NhcGUoZXZlbnQudGl0bGUpICsgIjwvc3Bhbj4iICsKCQkJCQkiPC9hPiIgKwoJCQkJCShzZWcuaXNFbmQgJiYgKGV2ZW50LmVkaXRhYmxlIHx8IGV2ZW50LmVkaXRhYmxlID09PSB1bmRlZmluZWQgJiYgb3B0KCdlZGl0YWJsZScpKSAmJiAhb3B0KCdkaXNhYmxlUmVzaXppbmcnKSA/CgkJCQkJCSI8ZGl2IGNsYXNzPSd1aS1yZXNpemFibGUtaGFuZGxlIHVpLXJlc2l6YWJsZS0iICsgKHJ0bCA/ICd3JyA6ICdlJykgKyAiJz48L2Rpdj4iCgkJCQkJCTogJycpICsKCQkJCSI8L2Rpdj4iOwoJCQlzZWcubGVmdCA9IGxlZnQ7CgkJCXNlZy5vdXRlcldpZHRoID0gcmlnaHQgLSBsZWZ0OwoJCQljb2xzLnNvcnQoY21wKTsKCQkJc2VnLnN0YXJ0Q29sID0gY29sc1swXTsKCQkJc2VnLmVuZENvbCA9IGNvbHNbMV0gKyAxOwoJCX0KCQlyZXR1cm4gaHRtbDsKCX0KCQoJCglmdW5jdGlvbiBkYXlTZWdFbGVtZW50UmVzb2x2ZShzZWdzLCBlbGVtZW50cykgeyAvLyBzZXRzIHNlZy5lbGVtZW50CgkJdmFyIGk7CgkJdmFyIHNlZ0NudCA9IHNlZ3MubGVuZ3RoOwoJCXZhciBzZWc7CgkJdmFyIGV2ZW50OwoJCXZhciBlbGVtZW50OwoJCXZhciB0cmlnZ2VyUmVzOwoJCWZvciAoaT0wOyBpPHNlZ0NudDsgaSsrKSB7CgkJCXNlZyA9IHNlZ3NbaV07CgkJCWV2ZW50ID0gc2VnLmV2ZW50OwoJCQllbGVtZW50ID0gJChlbGVtZW50c1tpXSk7IC8vIGZhc3RlciB0aGFuIC5lcSgpCgkJCXRyaWdnZXJSZXMgPSB0cmlnZ2VyKCdldmVudFJlbmRlcicsIGV2ZW50LCBldmVudCwgZWxlbWVudCk7CgkJCWlmICh0cmlnZ2VyUmVzID09PSBmYWxzZSkgewoJCQkJZWxlbWVudC5yZW1vdmUoKTsKCQkJfWVsc2V7CgkJCQlpZiAodHJpZ2dlclJlcyAmJiB0cmlnZ2VyUmVzICE9PSB0cnVlKSB7CgkJCQkJdHJpZ2dlclJlcyA9ICQodHJpZ2dlclJlcykKCQkJCQkJLmNzcyh7CgkJCQkJCQlwb3NpdGlvbjogJ2Fic29sdXRlJywKCQkJCQkJCWxlZnQ6IHNlZy5sZWZ0CgkJCQkJCX0pOwoJCQkJCWVsZW1lbnQucmVwbGFjZVdpdGgodHJpZ2dlclJlcyk7CgkJCQkJZWxlbWVudCA9IHRyaWdnZXJSZXM7CgkJCQl9CgkJCQlzZWcuZWxlbWVudCA9IGVsZW1lbnQ7CgkJCX0KCQl9Cgl9CgkKCQoJZnVuY3Rpb24gZGF5U2VnRWxlbWVudFJlcG9ydChzZWdzKSB7CgkJdmFyIGk7CgkJdmFyIHNlZ0NudCA9IHNlZ3MubGVuZ3RoOwoJCXZhciBzZWc7CgkJdmFyIGVsZW1lbnQ7CgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJZWxlbWVudCA9IHNlZy5lbGVtZW50OwoJCQlpZiAoZWxlbWVudCkgewoJCQkJcmVwb3J0RXZlbnRFbGVtZW50KHNlZy5ldmVudCwgZWxlbWVudCk7CgkJCX0KCQl9Cgl9CgkKCQoJZnVuY3Rpb24gZGF5U2VnSGFuZGxlcnMoc2Vncywgc2VnbWVudENvbnRhaW5lciwgbW9kaWZpZWRFdmVudElkKSB7CgkJdmFyIGk7CgkJdmFyIHNlZ0NudCA9IHNlZ3MubGVuZ3RoOwoJCXZhciBzZWc7CgkJdmFyIGVsZW1lbnQ7CgkJdmFyIGV2ZW50OwoJCS8vIHJldHJpZXZlIGVsZW1lbnRzLCBydW4gdGhyb3VnaCBldmVudFJlbmRlciBjYWxsYmFjaywgYmluZCBoYW5kbGVycwoJCWZvciAoaT0wOyBpPHNlZ0NudDsgaSsrKSB7CgkJCXNlZyA9IHNlZ3NbaV07CgkJCWVsZW1lbnQgPSBzZWcuZWxlbWVudDsKCQkJaWYgKGVsZW1lbnQpIHsKCQkJCWV2ZW50ID0gc2VnLmV2ZW50OwoJCQkJaWYgKGV2ZW50Ll9pZCA9PT0gbW9kaWZpZWRFdmVudElkKSB7CgkJCQkJYmluZERheVNlZyhldmVudCwgZWxlbWVudCwgc2VnKTsKCQkJCX1lbHNlewoJCQkJCWVsZW1lbnRbMF0uX2ZjaSA9IGk7IC8vIGZvciBsYXp5U2VnQmluZAoJCQkJfQoJCQl9CgkJfQoJCWxhenlTZWdCaW5kKHNlZ21lbnRDb250YWluZXIsIHNlZ3MsIGJpbmREYXlTZWcpOwoJfQoJCgkKCWZ1bmN0aW9uIGRheVNlZ0NhbGNIU2lkZXMoc2VncykgeyAvLyBhbHNvIHNldHMgc2VnLmtleQoJCXZhciBpOwoJCXZhciBzZWdDbnQgPSBzZWdzLmxlbmd0aDsKCQl2YXIgc2VnOwoJCXZhciBlbGVtZW50OwoJCXZhciBrZXksIHZhbDsKCQl2YXIgaHNpZGVDYWNoZSA9IHt9OwoJCS8vIHJlY29yZCBldmVudCBob3Jpem9udGFsIHNpZGVzCgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJZWxlbWVudCA9IHNlZy5lbGVtZW50OwoJCQlpZiAoZWxlbWVudCkgewoJCQkJa2V5ID0gc2VnLmtleSA9IGNzc0tleShlbGVtZW50WzBdKTsKCQkJCXZhbCA9IGhzaWRlQ2FjaGVba2V5XTsKCQkJCWlmICh2YWwgPT09IHVuZGVmaW5lZCkgewoJCQkJCXZhbCA9IGhzaWRlQ2FjaGVba2V5XSA9IGhzaWRlcyhlbGVtZW50WzBdLCB0cnVlKTsKCQkJCX0KCQkJCXNlZy5oc2lkZXMgPSB2YWw7CgkJCX0KCQl9Cgl9CgkKCQoJZnVuY3Rpb24gZGF5U2VnU2V0V2lkdGhzKHNlZ3MpIHsKCQl2YXIgaTsKCQl2YXIgc2VnQ250ID0gc2Vncy5sZW5ndGg7CgkJdmFyIHNlZzsKCQl2YXIgZWxlbWVudDsKCQlmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCQlzZWcgPSBzZWdzW2ldOwoJCQllbGVtZW50ID0gc2VnLmVsZW1lbnQ7CgkJCWlmIChlbGVtZW50KSB7CgkJCQllbGVtZW50WzBdLnN0eWxlLndpZHRoID0gTWF0aC5tYXgoMCwgc2VnLm91dGVyV2lkdGggLSBzZWcuaHNpZGVzKSArICdweCc7CgkJCX0KCQl9Cgl9CgkKCQoJZnVuY3Rpb24gZGF5U2VnQ2FsY0hlaWdodHMoc2VncykgewoJCXZhciBpOwoJCXZhciBzZWdDbnQgPSBzZWdzLmxlbmd0aDsKCQl2YXIgc2VnOwoJCXZhciBlbGVtZW50OwoJCXZhciBrZXksIHZhbDsKCQl2YXIgdm1hcmdpbkNhY2hlID0ge307CgkJLy8gcmVjb3JkIGV2ZW50IGhlaWdodHMKCQlmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCQlzZWcgPSBzZWdzW2ldOwoJCQllbGVtZW50ID0gc2VnLmVsZW1lbnQ7CgkJCWlmIChlbGVtZW50KSB7CgkJCQlrZXkgPSBzZWcua2V5OyAvLyBjcmVhdGVkIGluIGRheVNlZ0NhbGNIU2lkZXMKCQkJCXZhbCA9IHZtYXJnaW5DYWNoZVtrZXldOwoJCQkJaWYgKHZhbCA9PT0gdW5kZWZpbmVkKSB7CgkJCQkJdmFsID0gdm1hcmdpbkNhY2hlW2tleV0gPSB2bWFyZ2lucyhlbGVtZW50WzBdKTsKCQkJCX0KCQkJCXNlZy5vdXRlckhlaWdodCA9IGVsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0ICsgdmFsOwoJCQl9CgkJfQoJfQoJCgkKCWZ1bmN0aW9uIGdldFJvd0RpdnMoKSB7CgkJdmFyIGk7CgkJdmFyIHJvd0NudCA9IGdldFJvd0NudCgpOwoJCXZhciByb3dEaXZzID0gW107CgkJZm9yIChpPTA7IGk8cm93Q250OyBpKyspIHsKCQkJcm93RGl2c1tpXSA9IGFsbERheVRSKGkpCgkJCQkuZmluZCgndGQ6Zmlyc3QgZGl2LmZjLWRheS1jb250ZW50ID4gZGl2Jyk7IC8vIG9wdGltYWwgc2VsZWN0b3I/CgkJfQoJCXJldHVybiByb3dEaXZzOwoJfQoJCgkKCWZ1bmN0aW9uIGdldFJvd1RvcHMocm93RGl2cykgewoJCXZhciBpOwoJCXZhciByb3dDbnQgPSByb3dEaXZzLmxlbmd0aDsKCQl2YXIgdG9wcyA9IFtdOwoJCWZvciAoaT0wOyBpPHJvd0NudDsgaSsrKSB7CgkJCXRvcHNbaV0gPSByb3dEaXZzW2ldWzBdLm9mZnNldFRvcDsKCQl9CgkJcmV0dXJuIHRvcHM7Cgl9CgkKCQoJZnVuY3Rpb24gZGF5U2VnU2V0VG9wcyhzZWdzLCByb3dUb3BzKSB7IC8vIGFsc28gdHJpZ2dlcnMgZXZlbnRBZnRlclJlbmRlcgoJCXZhciBpOwoJCXZhciBzZWdDbnQgPSBzZWdzLmxlbmd0aDsKCQl2YXIgc2VnOwoJCXZhciBlbGVtZW50OwoJCXZhciBldmVudDsKCQlmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCQlzZWcgPSBzZWdzW2ldOwoJCQllbGVtZW50ID0gc2VnLmVsZW1lbnQ7CgkJCWlmIChlbGVtZW50KSB7CgkJCQllbGVtZW50WzBdLnN0eWxlLnRvcCA9IHJvd1RvcHNbc2VnLnJvd10gKyAoc2VnLnRvcHx8MCkgKyAncHgnOwoJCQkJZXZlbnQgPSBzZWcuZXZlbnQ7CgkJCQl0cmlnZ2VyKCdldmVudEFmdGVyUmVuZGVyJywgZXZlbnQsIGV2ZW50LCBlbGVtZW50KTsKCQkJfQoJCX0KCX0KCQoJCgkKCS8qIFJlc2l6aW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gcmVzaXphYmxlRGF5RXZlbnQoZXZlbnQsIGVsZW1lbnQsIHNlZykgewoJCWlmICghb3B0KCdkaXNhYmxlUmVzaXppbmcnKSAmJiBzZWcuaXNFbmQpIHsKCQkJdmFyIHJ0bCA9IG9wdCgnaXNSVEwnKTsKCQkJdmFyIGRpcmVjdGlvbiA9IHJ0bCA/ICd3JyA6ICdlJzsKCQkJdmFyIGhhbmRsZSA9IGVsZW1lbnQuZmluZCgnZGl2LnVpLXJlc2l6YWJsZS0nICsgZGlyZWN0aW9uKTsKCQkJaGFuZGxlLm1vdXNlZG93bihmdW5jdGlvbihldikgewoJCQkJaWYgKGV2LndoaWNoICE9IDEpIHsKCQkJCQlyZXR1cm47IC8vIG5lZWRzIHRvIGJlIGxlZnQgbW91c2UgYnV0dG9uCgkJCQl9CgkJCQl2YXIgaG92ZXJMaXN0ZW5lciA9IHQuZ2V0SG92ZXJMaXN0ZW5lcigpOwoJCQkJdmFyIHJvd0NudCA9IGdldFJvd0NudCgpOwoJCQkJdmFyIGNvbENudCA9IGdldENvbENudCgpOwoJCQkJdmFyIGRpcyA9IHJ0bCA/IC0xIDogMTsKCQkJCXZhciBkaXQgPSBydGwgPyBjb2xDbnQgOiAwOwoJCQkJdmFyIGVsZW1lbnRUb3AgPSBlbGVtZW50LmNzcygndG9wJyk7CgkJCQl2YXIgZGF5RGVsdGE7CgkJCQl2YXIgaGVscGVyczsKCQkJCXZhciBldmVudENvcHkgPSAkLmV4dGVuZCh7fSwgZXZlbnQpOwoJCQkJdmFyIG1pbkNlbGwgPSBkYXRlQ2VsbChldmVudC5zdGFydCk7CgkJCQljbGVhclNlbGVjdGlvbigpOwoJCQkJJCgnYm9keScpCgkJCQkJLmNzcygnY3Vyc29yJywgZGlyZWN0aW9uICsgJy1yZXNpemUnKQoJCQkJCS5vbmUoJ21vdXNldXAnLCBtb3VzZXVwKTsKCQkJCXRyaWdnZXIoJ2V2ZW50UmVzaXplU3RhcnQnLCB0aGlzLCBldmVudCwgZXYpOwoJCQkJaG92ZXJMaXN0ZW5lci5zdGFydChmdW5jdGlvbihjZWxsLCBvcmlnQ2VsbCkgewoJCQkJCWlmIChjZWxsKSB7CgkJCQkJCXZhciByID0gTWF0aC5tYXgobWluQ2VsbC5yb3csIGNlbGwucm93KTsKCQkJCQkJdmFyIGMgPSBjZWxsLmNvbDsKCQkJCQkJaWYgKHJvd0NudCA9PSAxKSB7CgkJCQkJCQlyID0gMDsgLy8gaGFjayBmb3IgYWxsLWRheSBhcmVhIGluIGFnZW5kYSB2aWV3cwoJCQkJCQl9CgkJCQkJCWlmIChyID09IG1pbkNlbGwucm93KSB7CgkJCQkJCQlpZiAocnRsKSB7CgkJCQkJCQkJYyA9IE1hdGgubWluKG1pbkNlbGwuY29sLCBjKTsKCQkJCQkJCX1lbHNlewoJCQkJCQkJCWMgPSBNYXRoLm1heChtaW5DZWxsLmNvbCwgYyk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJZGF5RGVsdGEgPSAociAqIGNvbENudCArIGMqZGlzK2RpdCkgLSAob3JpZ0NlbGwucm93ICogY29sQ250ICsgb3JpZ0NlbGwuY29sKmRpcytkaXQpOwoJCQkJCQl2YXIgbmV3RW5kID0gYWRkRGF5cyhldmVudEVuZChldmVudCksIGRheURlbHRhLCB0cnVlKTsKCQkJCQkJaWYgKGRheURlbHRhKSB7CgkJCQkJCQlldmVudENvcHkuZW5kID0gbmV3RW5kOwoJCQkJCQkJdmFyIG9sZEhlbHBlcnMgPSBoZWxwZXJzOwoJCQkJCQkJaGVscGVycyA9IHJlbmRlclRlbXBEYXlTZWdzKGNvbXBpbGVEYXlTZWdzKFtldmVudENvcHldKSwgc2VnLnJvdywgZWxlbWVudFRvcCk7CgkJCQkJCQloZWxwZXJzLmZpbmQoJyonKS5jc3MoJ2N1cnNvcicsIGRpcmVjdGlvbiArICctcmVzaXplJyk7CgkJCQkJCQlpZiAob2xkSGVscGVycykgewoJCQkJCQkJCW9sZEhlbHBlcnMucmVtb3ZlKCk7CgkJCQkJCQl9CgkJCQkJCQloaWRlRXZlbnRzKGV2ZW50KTsKCQkJCQkJfWVsc2V7CgkJCQkJCQlpZiAoaGVscGVycykgewoJCQkJCQkJCXNob3dFdmVudHMoZXZlbnQpOwoJCQkJCQkJCWhlbHBlcnMucmVtb3ZlKCk7CgkJCQkJCQkJaGVscGVycyA9IG51bGw7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJY2xlYXJPdmVybGF5cygpOwoJCQkJCQlyZW5kZXJEYXlPdmVybGF5KGV2ZW50LnN0YXJ0LCBhZGREYXlzKGNsb25lRGF0ZShuZXdFbmQpLCAxKSk7IC8vIGNvb3JkaW5hdGUgZ3JpZCBhbHJlYWR5IHJlYnVpbGQgYXQgaG92ZXJMaXN0ZW5lci5zdGFydAoJCQkJCX0KCQkJCX0sIGV2KTsKCQkJCWZ1bmN0aW9uIG1vdXNldXAoZXYpIHsKCQkJCQl0cmlnZ2VyKCdldmVudFJlc2l6ZVN0b3AnLCB0aGlzLCBldmVudCwgZXYpOwoJCQkJCSQoJ2JvZHknKS5jc3MoJ2N1cnNvcicsICdhdXRvJyk7CgkJCQkJaG92ZXJMaXN0ZW5lci5zdG9wKCk7CgkJCQkJY2xlYXJPdmVybGF5cygpOwoJCQkJCWlmIChkYXlEZWx0YSkgewoJCQkJCQlldmVudFJlc2l6ZSh0aGlzLCBldmVudCwgZGF5RGVsdGEsIDAsIGV2KTsKCQkJCQkJLy8gZXZlbnQgcmVkcmF3IHdpbGwgY2xlYXIgaGVscGVycwoJCQkJCX0KCQkJCQkvLyBvdGhlcndpc2UsIHRoZSBkcmFnIGhhbmRsZXIgYWxyZWFkeSByZXN0b3JlZCB0aGUgb2xkIGV2ZW50cwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgkKCn0KCi8vQlVHOiB1bnNlbGVjdCBuZWVkcyB0byBiZSB0cmlnZ2VyZWQgd2hlbiBldmVudHMgYXJlIGRyYWdnZWQrZHJvcHBlZAoKZnVuY3Rpb24gU2VsZWN0aW9uTWFuYWdlcigpIHsKCXZhciB0ID0gdGhpczsKCQoJCgkvLyBleHBvcnRzCgl0LnNlbGVjdCA9IHNlbGVjdDsKCXQudW5zZWxlY3QgPSB1bnNlbGVjdDsKCXQucmVwb3J0U2VsZWN0aW9uID0gcmVwb3J0U2VsZWN0aW9uOwoJdC5kYXlTZWxlY3Rpb25Nb3VzZWRvd24gPSBkYXlTZWxlY3Rpb25Nb3VzZWRvd247CgkKCQoJLy8gaW1wb3J0cwoJdmFyIG9wdCA9IHQub3B0OwoJdmFyIHRyaWdnZXIgPSB0LnRyaWdnZXI7Cgl2YXIgZGVmYXVsdFNlbGVjdGlvbkVuZCA9IHQuZGVmYXVsdFNlbGVjdGlvbkVuZDsKCXZhciByZW5kZXJTZWxlY3Rpb24gPSB0LnJlbmRlclNlbGVjdGlvbjsKCXZhciBjbGVhclNlbGVjdGlvbiA9IHQuY2xlYXJTZWxlY3Rpb247CgkKCQoJLy8gbG9jYWxzCgl2YXIgc2VsZWN0ZWQgPSBmYWxzZTsKCgoKCS8vIHVuc2VsZWN0QXV0bwoJaWYgKG9wdCgnc2VsZWN0YWJsZScpICYmIG9wdCgndW5zZWxlY3RBdXRvJykpIHsKCQkkKGRvY3VtZW50KS5tb3VzZWRvd24oZnVuY3Rpb24oZXYpIHsKCQkJdmFyIGlnbm9yZSA9IG9wdCgndW5zZWxlY3RDYW5jZWwnKTsKCQkJaWYgKGlnbm9yZSkgewoJCQkJaWYgKCQoZXYudGFyZ2V0KS5wYXJlbnRzKGlnbm9yZSkubGVuZ3RoKSB7IC8vIGNvdWxkIGJlIG9wdGltaXplZCB0byBzdG9wIGFmdGVyIGZpcnN0IG1hdGNoCgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgkJCXVuc2VsZWN0KGV2KTsKCQl9KTsKCX0KCQoKCWZ1bmN0aW9uIHNlbGVjdChzdGFydERhdGUsIGVuZERhdGUsIGFsbERheSkgewoJCXVuc2VsZWN0KCk7CgkJaWYgKCFlbmREYXRlKSB7CgkJCWVuZERhdGUgPSBkZWZhdWx0U2VsZWN0aW9uRW5kKHN0YXJ0RGF0ZSwgYWxsRGF5KTsKCQl9CgkJcmVuZGVyU2VsZWN0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgYWxsRGF5KTsKCQlyZXBvcnRTZWxlY3Rpb24oc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXkpOwoJfQoJCgkKCWZ1bmN0aW9uIHVuc2VsZWN0KGV2KSB7CgkJaWYgKHNlbGVjdGVkKSB7CgkJCXNlbGVjdGVkID0gZmFsc2U7CgkJCWNsZWFyU2VsZWN0aW9uKCk7CgkJCXRyaWdnZXIoJ3Vuc2VsZWN0JywgbnVsbCwgZXYpOwoJCX0KCX0KCQoJCglmdW5jdGlvbiByZXBvcnRTZWxlY3Rpb24oc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXksIGV2KSB7CgkJc2VsZWN0ZWQgPSB0cnVlOwoJCXRyaWdnZXIoJ3NlbGVjdCcsIG51bGwsIHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgYWxsRGF5LCBldik7Cgl9CgkKCQoJZnVuY3Rpb24gZGF5U2VsZWN0aW9uTW91c2Vkb3duKGV2KSB7IC8vIG5vdCByZWFsbHkgYSBnZW5lcmljIG1hbmFnZXIgbWV0aG9kLCBvaCB3ZWxsCgkJdmFyIGNlbGxEYXRlID0gdC5jZWxsRGF0ZTsKCQl2YXIgY2VsbElzQWxsRGF5ID0gdC5jZWxsSXNBbGxEYXk7CgkJdmFyIGhvdmVyTGlzdGVuZXIgPSB0LmdldEhvdmVyTGlzdGVuZXIoKTsKCQlpZiAoZXYud2hpY2ggPT0gMSAmJiBvcHQoJ3NlbGVjdGFibGUnKSkgeyAvLyB3aGljaD09MSBtZWFucyBsZWZ0IG1vdXNlIGJ1dHRvbgoJCQl1bnNlbGVjdChldik7CgkJCXZhciBfbW91c2Vkb3duRWxlbWVudCA9IHRoaXM7CgkJCXZhciBkYXRlczsKCQkJaG92ZXJMaXN0ZW5lci5zdGFydChmdW5jdGlvbihjZWxsLCBvcmlnQ2VsbCkgeyAvLyBUT0RPOiBtYXliZSBwdXQgY2VsbERhdGUvY2VsbElzQWxsRGF5IGluZm8gaW4gY2VsbAoJCQkJY2xlYXJTZWxlY3Rpb24oKTsKCQkJCWlmIChjZWxsICYmIGNlbGxJc0FsbERheShjZWxsKSkgewoJCQkJCWRhdGVzID0gWyBjZWxsRGF0ZShvcmlnQ2VsbCksIGNlbGxEYXRlKGNlbGwpIF0uc29ydChjbXApOwoJCQkJCXJlbmRlclNlbGVjdGlvbihkYXRlc1swXSwgZGF0ZXNbMV0sIHRydWUpOwoJCQkJfWVsc2V7CgkJCQkJZGF0ZXMgPSBudWxsOwoJCQkJfQoJCQl9LCBldik7CgkJCSQoZG9jdW1lbnQpLm9uZSgnbW91c2V1cCcsIGZ1bmN0aW9uKGV2KSB7CgkJCQlob3Zlckxpc3RlbmVyLnN0b3AoKTsKCQkJCWlmIChkYXRlcykgewoJCQkJCWlmICgrZGF0ZXNbMF0gPT0gK2RhdGVzWzFdKSB7CgkJCQkJCXRyaWdnZXIoJ2RheUNsaWNrJywgX21vdXNlZG93bkVsZW1lbnQsIGRhdGVzWzBdLCB0cnVlLCBldik7CgkJCQkJCS8vIEJVRzogX21vdXNlZG93bkVsZW1lbnQgd2lsbCBzb21ldGltZXMgYmUgdGhlIG92ZXJsYXkKCQkJCQl9CgkJCQkJcmVwb3J0U2VsZWN0aW9uKGRhdGVzWzBdLCBkYXRlc1sxXSwgdHJ1ZSwgZXYpOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoKfQogCmZ1bmN0aW9uIE92ZXJsYXlNYW5hZ2VyKCkgewoJdmFyIHQgPSB0aGlzOwoJCgkKCS8vIGV4cG9ydHMKCXQucmVuZGVyT3ZlcmxheSA9IHJlbmRlck92ZXJsYXk7Cgl0LmNsZWFyT3ZlcmxheXMgPSBjbGVhck92ZXJsYXlzOwoJCgkKCS8vIGxvY2FscwoJdmFyIHVzZWRPdmVybGF5cyA9IFtdOwoJdmFyIHVudXNlZE92ZXJsYXlzID0gW107CgkKCQoJZnVuY3Rpb24gcmVuZGVyT3ZlcmxheShyZWN0LCBwYXJlbnQpIHsKCQl2YXIgZSA9IHVudXNlZE92ZXJsYXlzLnNoaWZ0KCk7CgkJaWYgKCFlKSB7CgkJCWUgPSAkKCI8ZGl2IGNsYXNzPSdmYy1jZWxsLW92ZXJsYXknIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjMnLz4iKTsKCQl9CgkJaWYgKGVbMF0ucGFyZW50Tm9kZSAhPSBwYXJlbnRbMF0pIHsKCQkJZS5hcHBlbmRUbyhwYXJlbnQpOwoJCX0KCQl1c2VkT3ZlcmxheXMucHVzaChlLmNzcyhyZWN0KS5zaG93KCkpOwoJCXJldHVybiBlOwoJfQoJCgoJZnVuY3Rpb24gY2xlYXJPdmVybGF5cygpIHsKCQl2YXIgZTsKCQl3aGlsZSAoZSA9IHVzZWRPdmVybGF5cy5zaGlmdCgpKSB7CgkJCXVudXNlZE92ZXJsYXlzLnB1c2goZS5oaWRlKCkudW5iaW5kKCkpOwoJCX0KCX0KCgp9CgpmdW5jdGlvbiBDb29yZGluYXRlR3JpZChidWlsZEZ1bmMpIHsKCgl2YXIgdCA9IHRoaXM7Cgl2YXIgcm93czsKCXZhciBjb2xzOwoJCgl0LmJ1aWxkID0gZnVuY3Rpb24oKSB7CgkJcm93cyA9IFtdOwoJCWNvbHMgPSBbXTsKCQlidWlsZEZ1bmMocm93cywgY29scyk7Cgl9OwoJCgl0LmNlbGwgPSBmdW5jdGlvbih4LCB5KSB7CgkJdmFyIHJvd0NudCA9IHJvd3MubGVuZ3RoOwoJCXZhciBjb2xDbnQgPSBjb2xzLmxlbmd0aDsKCQl2YXIgaSwgcj0tMSwgYz0tMTsKCQlmb3IgKGk9MDsgaTxyb3dDbnQ7IGkrKykgewoJCQlpZiAoeSA+PSByb3dzW2ldWzBdICYmIHkgPCByb3dzW2ldWzFdKSB7CgkJCQlyID0gaTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWZvciAoaT0wOyBpPGNvbENudDsgaSsrKSB7CgkJCWlmICh4ID49IGNvbHNbaV1bMF0gJiYgeCA8IGNvbHNbaV1bMV0pIHsKCQkJCWMgPSBpOwoJCQkJYnJlYWs7CgkJCX0KCQl9CgkJcmV0dXJuIChyPj0wICYmIGM+PTApID8geyByb3c6ciwgY29sOmMgfSA6IG51bGw7Cgl9OwoJCgl0LnJlY3QgPSBmdW5jdGlvbihyb3cwLCBjb2wwLCByb3cxLCBjb2wxLCBvcmlnaW5FbGVtZW50KSB7IC8vIHJvdzEsY29sMSBpcyBpbmNsdXNpdmUKCQl2YXIgb3JpZ2luID0gb3JpZ2luRWxlbWVudC5vZmZzZXQoKTsKCQlyZXR1cm4gewoJCQl0b3A6IHJvd3Nbcm93MF1bMF0gLSBvcmlnaW4udG9wLAoJCQlsZWZ0OiBjb2xzW2NvbDBdWzBdIC0gb3JpZ2luLmxlZnQsCgkJCXdpZHRoOiBjb2xzW2NvbDFdWzFdIC0gY29sc1tjb2wwXVswXSwKCQkJaGVpZ2h0OiByb3dzW3JvdzFdWzFdIC0gcm93c1tyb3cwXVswXQoJCX07Cgl9OwoKfQoKZnVuY3Rpb24gSG92ZXJMaXN0ZW5lcihjb29yZGluYXRlR3JpZCkgewoKCgl2YXIgdCA9IHRoaXM7Cgl2YXIgYmluZFR5cGU7Cgl2YXIgY2hhbmdlOwoJdmFyIGZpcnN0Q2VsbDsKCXZhciBjZWxsOwoJCgkKCXQuc3RhcnQgPSBmdW5jdGlvbihfY2hhbmdlLCBldiwgX2JpbmRUeXBlKSB7CgkJY2hhbmdlID0gX2NoYW5nZTsKCQlmaXJzdENlbGwgPSBjZWxsID0gbnVsbDsKCQljb29yZGluYXRlR3JpZC5idWlsZCgpOwoJCW1vdXNlKGV2KTsKCQliaW5kVHlwZSA9IF9iaW5kVHlwZSB8fCAnbW91c2Vtb3ZlJzsKCQkkKGRvY3VtZW50KS5iaW5kKGJpbmRUeXBlLCBtb3VzZSk7Cgl9OwoJCgkKCWZ1bmN0aW9uIG1vdXNlKGV2KSB7CgkJdmFyIG5ld0NlbGwgPSBjb29yZGluYXRlR3JpZC5jZWxsKGV2LnBhZ2VYLCBldi5wYWdlWSk7CgkJaWYgKCFuZXdDZWxsICE9ICFjZWxsIHx8IG5ld0NlbGwgJiYgKG5ld0NlbGwucm93ICE9IGNlbGwucm93IHx8IG5ld0NlbGwuY29sICE9IGNlbGwuY29sKSkgewoJCQlpZiAobmV3Q2VsbCkgewoJCQkJaWYgKCFmaXJzdENlbGwpIHsKCQkJCQlmaXJzdENlbGwgPSBuZXdDZWxsOwoJCQkJfQoJCQkJY2hhbmdlKG5ld0NlbGwsIGZpcnN0Q2VsbCwgbmV3Q2VsbC5yb3ctZmlyc3RDZWxsLnJvdywgbmV3Q2VsbC5jb2wtZmlyc3RDZWxsLmNvbCk7CgkJCX1lbHNlewoJCQkJY2hhbmdlKG5ld0NlbGwsIGZpcnN0Q2VsbCk7CgkJCX0KCQkJY2VsbCA9IG5ld0NlbGw7CgkJfQoJfQoJCgkKCXQuc3RvcCA9IGZ1bmN0aW9uKCkgewoJCSQoZG9jdW1lbnQpLnVuYmluZChiaW5kVHlwZSwgbW91c2UpOwoJCXJldHVybiBjZWxsOwoJfTsKCQoJCn0KCmZ1bmN0aW9uIEhvcml6b250YWxQb3NpdGlvbkNhY2hlKGdldEVsZW1lbnQpIHsKCgl2YXIgdCA9IHRoaXMsCgkJZWxlbWVudHMgPSB7fSwKCQlsZWZ0cyA9IHt9LAoJCXJpZ2h0cyA9IHt9OwoJCQoJZnVuY3Rpb24gZShpKSB7CgkJcmV0dXJuIGVsZW1lbnRzW2ldID0gZWxlbWVudHNbaV0gfHwgZ2V0RWxlbWVudChpKTsKCX0KCQoJdC5sZWZ0ID0gZnVuY3Rpb24oaSkgewoJCXJldHVybiBsZWZ0c1tpXSA9IGxlZnRzW2ldID09PSB1bmRlZmluZWQgPyBlKGkpLnBvc2l0aW9uKCkubGVmdCA6IGxlZnRzW2ldOwoJfTsKCQoJdC5yaWdodCA9IGZ1bmN0aW9uKGkpIHsKCQlyZXR1cm4gcmlnaHRzW2ldID0gcmlnaHRzW2ldID09PSB1bmRlZmluZWQgPyB0LmxlZnQoaSkgKyBlKGkpLndpZHRoKCkgOiByaWdodHNbaV07Cgl9OwoJCgl0LmNsZWFyID0gZnVuY3Rpb24oKSB7CgkJZWxlbWVudHMgPSB7fTsKCQlsZWZ0cyA9IHt9OwoJCXJpZ2h0cyA9IHt9OwoJfTsKCQp9CgoKZmMuYWRkRGF5cyA9IGFkZERheXM7CmZjLmNsb25lRGF0ZSA9IGNsb25lRGF0ZTsKZmMucGFyc2VEYXRlID0gcGFyc2VEYXRlOwpmYy5wYXJzZUlTTzg2MDEgPSBwYXJzZUlTTzg2MDE7CmZjLnBhcnNlVGltZSA9IHBhcnNlVGltZTsKZmMuZm9ybWF0RGF0ZSA9IGZvcm1hdERhdGU7CmZjLmZvcm1hdERhdGVzID0gZm9ybWF0RGF0ZXM7CgoKCi8qIERhdGUgTWF0aAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgp2YXIgZGF5SURzID0gWydzdW4nLCAnbW9uJywgJ3R1ZScsICd3ZWQnLCAndGh1JywgJ2ZyaScsICdzYXQnXSwKCURBWV9NUyA9IDg2NDAwMDAwLAoJSE9VUl9NUyA9IDM2MDAwMDAsCglNSU5VVEVfTVMgPSA2MDAwMDsKCQoKZnVuY3Rpb24gYWRkWWVhcnMoZCwgbiwga2VlcFRpbWUpIHsKCWQuc2V0RnVsbFllYXIoZC5nZXRGdWxsWWVhcigpICsgbik7CglpZiAoIWtlZXBUaW1lKSB7CgkJY2xlYXJUaW1lKGQpOwoJfQoJcmV0dXJuIGQ7Cn0KCgpmdW5jdGlvbiBhZGRNb250aHMoZCwgbiwga2VlcFRpbWUpIHsgLy8gcHJldmVudHMgZGF5IG92ZXJmbG93L3VuZGVyZmxvdwoJaWYgKCtkKSB7IC8vIHByZXZlbnQgaW5maW5pdGUgbG9vcGluZyBvbiBpbnZhbGlkIGRhdGVzCgkJdmFyIG0gPSBkLmdldE1vbnRoKCkgKyBuLAoJCQljaGVjayA9IGNsb25lRGF0ZShkKTsKCQljaGVjay5zZXREYXRlKDEpOwoJCWNoZWNrLnNldE1vbnRoKG0pOwoJCWQuc2V0TW9udGgobSk7CgkJaWYgKCFrZWVwVGltZSkgewoJCQljbGVhclRpbWUoZCk7CgkJfQoJCXdoaWxlIChkLmdldE1vbnRoKCkgIT0gY2hlY2suZ2V0TW9udGgoKSkgewoJCQlkLnNldERhdGUoZC5nZXREYXRlKCkgKyAoZCA8IGNoZWNrID8gMSA6IC0xKSk7CgkJfQoJfQoJcmV0dXJuIGQ7Cn0KCgpmdW5jdGlvbiBhZGREYXlzKGQsIG4sIGtlZXBUaW1lKSB7IC8vIGRlYWxzIHdpdGggZGF5bGlnaHQgc2F2aW5ncwoJaWYgKCtkKSB7CgkJdmFyIGRkID0gZC5nZXREYXRlKCkgKyBuLAoJCQljaGVjayA9IGNsb25lRGF0ZShkKTsKCQljaGVjay5zZXRIb3Vycyg5KTsgLy8gc2V0IHRvIG1pZGRsZSBvZiBkYXkKCQljaGVjay5zZXREYXRlKGRkKTsKCQlkLnNldERhdGUoZGQpOwoJCWlmICgha2VlcFRpbWUpIHsKCQkJY2xlYXJUaW1lKGQpOwoJCX0KCQlmaXhEYXRlKGQsIGNoZWNrKTsKCX0KCXJldHVybiBkOwp9CgoKZnVuY3Rpb24gZml4RGF0ZShkLCBjaGVjaykgeyAvLyBmb3JjZSBkIHRvIGJlIG9uIGNoZWNrJ3MgWU1ELCBmb3IgZGF5bGlnaHQgc2F2aW5ncyBwdXJwb3NlcwoJaWYgKCtkKSB7IC8vIHByZXZlbnQgaW5maW5pdGUgbG9vcGluZyBvbiBpbnZhbGlkIGRhdGVzCgkJd2hpbGUgKGQuZ2V0RGF0ZSgpICE9IGNoZWNrLmdldERhdGUoKSkgewoJCQlkLnNldFRpbWUoK2QgKyAoZCA8IGNoZWNrID8gMSA6IC0xKSAqIEhPVVJfTVMpOwoJCX0KCX0KfQoKCmZ1bmN0aW9uIGFkZE1pbnV0ZXMoZCwgbikgewoJZC5zZXRNaW51dGVzKGQuZ2V0TWludXRlcygpICsgbik7CglyZXR1cm4gZDsKfQoKCmZ1bmN0aW9uIGNsZWFyVGltZShkKSB7CglkLnNldEhvdXJzKDApOwoJZC5zZXRNaW51dGVzKDApOwoJZC5zZXRTZWNvbmRzKDApOyAKCWQuc2V0TWlsbGlzZWNvbmRzKDApOwoJcmV0dXJuIGQ7Cn0KCgpmdW5jdGlvbiBjbG9uZURhdGUoZCwgZG9udEtlZXBUaW1lKSB7CglpZiAoZG9udEtlZXBUaW1lKSB7CgkJcmV0dXJuIGNsZWFyVGltZShuZXcgRGF0ZSgrZCkpOwoJfQoJcmV0dXJuIG5ldyBEYXRlKCtkKTsKfQoKCmZ1bmN0aW9uIHplcm9EYXRlKCkgeyAvLyByZXR1cm5zIGEgRGF0ZSB3aXRoIHRpbWUgMDA6MDA6MDAgYW5kIGRhdGVPZk1vbnRoPTEKCXZhciBpPTAsIGQ7CglkbyB7CgkJZCA9IG5ldyBEYXRlKDE5NzAsIGkrKywgMSk7Cgl9IHdoaWxlIChkLmdldEhvdXJzKCkpOyAvLyAhPSAwCglyZXR1cm4gZDsKfQoKCmZ1bmN0aW9uIHNraXBXZWVrZW5kKGRhdGUsIGluYywgZXhjbCkgewoJaW5jID0gaW5jIHx8IDE7Cgl3aGlsZSAoIWRhdGUuZ2V0RGF5KCkgfHwgKGV4Y2wgJiYgZGF0ZS5nZXREYXkoKT09MSB8fCAhZXhjbCAmJiBkYXRlLmdldERheSgpPT02KSkgewoJCWFkZERheXMoZGF0ZSwgaW5jKTsKCX0KCXJldHVybiBkYXRlOwp9CgoKZnVuY3Rpb24gZGF5RGlmZihkMSwgZDIpIHsgLy8gZDEgLSBkMgoJcmV0dXJuIE1hdGgucm91bmQoKGNsb25lRGF0ZShkMSwgdHJ1ZSkgLSBjbG9uZURhdGUoZDIsIHRydWUpKSAvIERBWV9NUyk7Cn0KCgpmdW5jdGlvbiBzZXRZTUQoZGF0ZSwgeSwgbSwgZCkgewoJaWYgKHkgIT09IHVuZGVmaW5lZCAmJiB5ICE9IGRhdGUuZ2V0RnVsbFllYXIoKSkgewoJCWRhdGUuc2V0RGF0ZSgxKTsKCQlkYXRlLnNldE1vbnRoKDApOwoJCWRhdGUuc2V0RnVsbFllYXIoeSk7Cgl9CglpZiAobSAhPT0gdW5kZWZpbmVkICYmIG0gIT0gZGF0ZS5nZXRNb250aCgpKSB7CgkJZGF0ZS5zZXREYXRlKDEpOwoJCWRhdGUuc2V0TW9udGgobSk7Cgl9CglpZiAoZCAhPT0gdW5kZWZpbmVkKSB7CgkJZGF0ZS5zZXREYXRlKGQpOwoJfQp9CgoKCi8qIERhdGUgUGFyc2luZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgoKZnVuY3Rpb24gcGFyc2VEYXRlKHMsIGlnbm9yZVRpbWV6b25lKSB7IC8vIGlnbm9yZVRpbWV6b25lIGRlZmF1bHRzIHRvIHRydWUKCWlmICh0eXBlb2YgcyA9PSAnb2JqZWN0JykgeyAvLyBhbHJlYWR5IGEgRGF0ZSBvYmplY3QKCQlyZXR1cm4gczsKCX0KCWlmICh0eXBlb2YgcyA9PSAnbnVtYmVyJykgeyAvLyBhIFVOSVggdGltZXN0YW1wCgkJcmV0dXJuIG5ldyBEYXRlKHMgKiAxMDAwKTsKCX0KCWlmICh0eXBlb2YgcyA9PSAnc3RyaW5nJykgewoJCWlmIChzLm1hdGNoKC9eXGQrJC8pKSB7IC8vIGEgVU5JWCB0aW1lc3RhbXAKCQkJcmV0dXJuIG5ldyBEYXRlKHBhcnNlSW50KHMpICogMTAwMCk7CgkJfQoJCWlmIChpZ25vcmVUaW1lem9uZSA9PT0gdW5kZWZpbmVkKSB7CgkJCWlnbm9yZVRpbWV6b25lID0gdHJ1ZTsKCQl9CgkJcmV0dXJuIHBhcnNlSVNPODYwMShzLCBpZ25vcmVUaW1lem9uZSkgfHwgKHMgPyBuZXcgRGF0ZShzKSA6IG51bGwpOwoJfQoJLy8gVE9ETzogbmV2ZXIgcmV0dXJuIGludmFsaWQgZGF0ZXMgKGxpa2UgZnJvbSBuZXcgRGF0ZSg8c3RyaW5nPikpLCByZXR1cm4gbnVsbCBpbnN0ZWFkCglyZXR1cm4gbnVsbDsKfQoKCmZ1bmN0aW9uIHBhcnNlSVNPODYwMShzLCBpZ25vcmVUaW1lem9uZSkgeyAvLyBpZ25vcmVUaW1lem9uZSBkZWZhdWx0cyB0byBmYWxzZQoJLy8gZGVyaXZlZCBmcm9tIGh0dHA6Ly9kZWxldGUubWUudWsvMjAwNS8wMy9pc284NjAxLmh0bWwKCS8vIFRPRE86IGZvciBhIGtub3cgZ2xpdGNoL2ZlYXR1cmUsIHJlYWQgdGVzdHMvaXNzdWVfMjA2X3BhcnNlRGF0ZV9kc3QuaHRtbAoJdmFyIG0gPSBzLm1hdGNoKC9eKFswLTldezR9KSgtKFswLTldezJ9KSgtKFswLTldezJ9KShbVCBdKFswLTldezJ9KTooWzAtOV17Mn0pKDooWzAtOV17Mn0pKFwuKFswLTldKykpPyk/KFp8KChbLStdKShbMC05XXsyfSk6KFswLTldezJ9KSkpPyk/KT8pPyQvKTsKCWlmICghbSkgewoJCXJldHVybiBudWxsOwoJfQoJdmFyIGRhdGUgPSBuZXcgRGF0ZShtWzFdLCAwLCAxKTsKCWlmIChpZ25vcmVUaW1lem9uZSB8fCAhbVsxNF0pIHsKCQl2YXIgY2hlY2sgPSBuZXcgRGF0ZShtWzFdLCAwLCAxLCA5LCAwKTsKCQlpZiAobVszXSkgewoJCQlkYXRlLnNldE1vbnRoKG1bM10gLSAxKTsKCQkJY2hlY2suc2V0TW9udGgobVszXSAtIDEpOwoJCX0KCQlpZiAobVs1XSkgewoJCQlkYXRlLnNldERhdGUobVs1XSk7CgkJCWNoZWNrLnNldERhdGUobVs1XSk7CgkJfQoJCWZpeERhdGUoZGF0ZSwgY2hlY2spOwoJCWlmIChtWzddKSB7CgkJCWRhdGUuc2V0SG91cnMobVs3XSk7CgkJfQoJCWlmIChtWzhdKSB7CgkJCWRhdGUuc2V0TWludXRlcyhtWzhdKTsKCQl9CgkJaWYgKG1bMTBdKSB7CgkJCWRhdGUuc2V0U2Vjb25kcyhtWzEwXSk7CgkJfQoJCWlmIChtWzEyXSkgewoJCQlkYXRlLnNldE1pbGxpc2Vjb25kcyhOdW1iZXIoIjAuIiArIG1bMTJdKSAqIDEwMDApOwoJCX0KCQlmaXhEYXRlKGRhdGUsIGNoZWNrKTsKCX1lbHNlewoJCWRhdGUuc2V0VVRDRnVsbFllYXIoCgkJCW1bMV0sCgkJCW1bM10gPyBtWzNdIC0gMSA6IDAsCgkJCW1bNV0gfHwgMQoJCSk7CgkJZGF0ZS5zZXRVVENIb3VycygKCQkJbVs3XSB8fCAwLAoJCQltWzhdIHx8IDAsCgkJCW1bMTBdIHx8IDAsCgkJCW1bMTJdID8gTnVtYmVyKCIwLiIgKyBtWzEyXSkgKiAxMDAwIDogMAoJCSk7CgkJdmFyIG9mZnNldCA9IE51bWJlcihtWzE2XSkgKiA2MCArIE51bWJlcihtWzE3XSk7CgkJb2Zmc2V0ICo9IG1bMTVdID09ICctJyA/IDEgOiAtMTsKCQlkYXRlID0gbmV3IERhdGUoK2RhdGUgKyAob2Zmc2V0ICogNjAgKiAxMDAwKSk7Cgl9CglyZXR1cm4gZGF0ZTsKfQoKCmZ1bmN0aW9uIHBhcnNlVGltZShzKSB7IC8vIHJldHVybnMgbWludXRlcyBzaW5jZSBzdGFydCBvZiBkYXkKCWlmICh0eXBlb2YgcyA9PSAnbnVtYmVyJykgeyAvLyBhbiBob3VyCgkJcmV0dXJuIHMgKiA2MDsKCX0KCWlmICh0eXBlb2YgcyA9PSAnb2JqZWN0JykgeyAvLyBhIERhdGUgb2JqZWN0CgkJcmV0dXJuIHMuZ2V0SG91cnMoKSAqIDYwICsgcy5nZXRNaW51dGVzKCk7Cgl9Cgl2YXIgbSA9IHMubWF0Y2goLyhcZCspKD86OihcZCspKT9ccyooXHcrKT8vKTsKCWlmIChtKSB7CgkJdmFyIGggPSBwYXJzZUludChtWzFdKTsKCQlpZiAobVszXSkgewoJCQloICU9IDEyOwoJCQlpZiAobVszXS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKSA9PSAncCcpIHsKCQkJCWggKz0gMTI7CgkJCX0KCQl9CgkJcmV0dXJuIGggKiA2MCArIChtWzJdID8gcGFyc2VJbnQobVsyXSkgOiAwKTsKCX0KfQoKCgovKiBEYXRlIEZvcm1hdHRpbmcKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwovLyBUT0RPOiB1c2Ugc2FtZSBmdW5jdGlvbiBmb3JtYXREYXRlKGRhdGUsIFtkYXRlMl0sIGZvcm1hdCwgW29wdGlvbnNdKQoKCmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSwgZm9ybWF0LCBvcHRpb25zKSB7CglyZXR1cm4gZm9ybWF0RGF0ZXMoZGF0ZSwgbnVsbCwgZm9ybWF0LCBvcHRpb25zKTsKfQoKCmZ1bmN0aW9uIGZvcm1hdERhdGVzKGRhdGUxLCBkYXRlMiwgZm9ybWF0LCBvcHRpb25zKSB7CglvcHRpb25zID0gb3B0aW9ucyB8fCBkZWZhdWx0czsKCXZhciBkYXRlID0gZGF0ZTEsCgkJb3RoZXJEYXRlID0gZGF0ZTIsCgkJaSwgbGVuID0gZm9ybWF0Lmxlbmd0aCwgYywKCQlpMiwgZm9ybWF0dGVyLAoJCXJlcyA9ICcnOwoJZm9yIChpPTA7IGk8bGVuOyBpKyspIHsKCQljID0gZm9ybWF0LmNoYXJBdChpKTsKCQlpZiAoYyA9PSAiJyIpIHsKCQkJZm9yIChpMj1pKzE7IGkyPGxlbjsgaTIrKykgewoJCQkJaWYgKGZvcm1hdC5jaGFyQXQoaTIpID09ICInIikgewoJCQkJCWlmIChkYXRlKSB7CgkJCQkJCWlmIChpMiA9PSBpKzEpIHsKCQkJCQkJCXJlcyArPSAiJyI7CgkJCQkJCX1lbHNlewoJCQkJCQkJcmVzICs9IGZvcm1hdC5zdWJzdHJpbmcoaSsxLCBpMik7CgkJCQkJCX0KCQkJCQkJaSA9IGkyOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCQllbHNlIGlmIChjID09ICcoJykgewoJCQlmb3IgKGkyPWkrMTsgaTI8bGVuOyBpMisrKSB7CgkJCQlpZiAoZm9ybWF0LmNoYXJBdChpMikgPT0gJyknKSB7CgkJCQkJdmFyIHN1YnJlcyA9IGZvcm1hdERhdGUoZGF0ZSwgZm9ybWF0LnN1YnN0cmluZyhpKzEsIGkyKSwgb3B0aW9ucyk7CgkJCQkJaWYgKHBhcnNlSW50KHN1YnJlcy5yZXBsYWNlKC9cRC8sICcnKSkpIHsKCQkJCQkJcmVzICs9IHN1YnJlczsKCQkJCQl9CgkJCQkJaSA9IGkyOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJCWVsc2UgaWYgKGMgPT0gJ1snKSB7CgkJCWZvciAoaTI9aSsxOyBpMjxsZW47IGkyKyspIHsKCQkJCWlmIChmb3JtYXQuY2hhckF0KGkyKSA9PSAnXScpIHsKCQkJCQl2YXIgc3ViZm9ybWF0ID0gZm9ybWF0LnN1YnN0cmluZyhpKzEsIGkyKTsKCQkJCQl2YXIgc3VicmVzID0gZm9ybWF0RGF0ZShkYXRlLCBzdWJmb3JtYXQsIG9wdGlvbnMpOwoJCQkJCWlmIChzdWJyZXMgIT0gZm9ybWF0RGF0ZShvdGhlckRhdGUsIHN1YmZvcm1hdCwgb3B0aW9ucykpIHsKCQkJCQkJcmVzICs9IHN1YnJlczsKCQkJCQl9CgkJCQkJaSA9IGkyOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJCWVsc2UgaWYgKGMgPT0gJ3snKSB7CgkJCWRhdGUgPSBkYXRlMjsKCQkJb3RoZXJEYXRlID0gZGF0ZTE7CgkJfQoJCWVsc2UgaWYgKGMgPT0gJ30nKSB7CgkJCWRhdGUgPSBkYXRlMTsKCQkJb3RoZXJEYXRlID0gZGF0ZTI7CgkJfQoJCWVsc2UgewoJCQlmb3IgKGkyPWxlbjsgaTI+aTsgaTItLSkgewoJCQkJaWYgKGZvcm1hdHRlciA9IGRhdGVGb3JtYXR0ZXJzW2Zvcm1hdC5zdWJzdHJpbmcoaSwgaTIpXSkgewoJCQkJCWlmIChkYXRlKSB7CgkJCQkJCXJlcyArPSBmb3JtYXR0ZXIoZGF0ZSwgb3B0aW9ucyk7CgkJCQkJfQoJCQkJCWkgPSBpMiAtIDE7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJaWYgKGkyID09IGkpIHsKCQkJCWlmIChkYXRlKSB7CgkJCQkJcmVzICs9IGM7CgkJCQl9CgkJCX0KCQl9Cgl9CglyZXR1cm4gcmVzOwp9OwoKCnZhciBkYXRlRm9ybWF0dGVycyA9IHsKCXMJOiBmdW5jdGlvbihkKQl7IHJldHVybiBkLmdldFNlY29uZHMoKSB9LAoJc3MJOiBmdW5jdGlvbihkKQl7IHJldHVybiB6ZXJvUGFkKGQuZ2V0U2Vjb25kcygpKSB9LAoJbQk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0TWludXRlcygpIH0sCgltbQk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIHplcm9QYWQoZC5nZXRNaW51dGVzKCkpIH0sCgloCTogZnVuY3Rpb24oZCkJeyByZXR1cm4gZC5nZXRIb3VycygpICUgMTIgfHwgMTIgfSwKCWhoCTogZnVuY3Rpb24oZCkJeyByZXR1cm4gemVyb1BhZChkLmdldEhvdXJzKCkgJSAxMiB8fCAxMikgfSwKCUgJOiBmdW5jdGlvbihkKQl7IHJldHVybiBkLmdldEhvdXJzKCkgfSwKCUhICTogZnVuY3Rpb24oZCkJeyByZXR1cm4gemVyb1BhZChkLmdldEhvdXJzKCkpIH0sCglkCTogZnVuY3Rpb24oZCkJeyByZXR1cm4gZC5nZXREYXRlKCkgfSwKCWRkCTogZnVuY3Rpb24oZCkJeyByZXR1cm4gemVyb1BhZChkLmdldERhdGUoKSkgfSwKCWRkZAk6IGZ1bmN0aW9uKGQsbykJeyByZXR1cm4gby5kYXlOYW1lc1Nob3J0W2QuZ2V0RGF5KCldIH0sCglkZGRkOiBmdW5jdGlvbihkLG8pCXsgcmV0dXJuIG8uZGF5TmFtZXNbZC5nZXREYXkoKV0gfSwKCU0JOiBmdW5jdGlvbihkKQl7IHJldHVybiBkLmdldE1vbnRoKCkgKyAxIH0sCglNTQk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIHplcm9QYWQoZC5nZXRNb250aCgpICsgMSkgfSwKCU1NTQk6IGZ1bmN0aW9uKGQsbykJeyByZXR1cm4gby5tb250aE5hbWVzU2hvcnRbZC5nZXRNb250aCgpXSB9LAoJTU1NTTogZnVuY3Rpb24oZCxvKQl7IHJldHVybiBvLm1vbnRoTmFtZXNbZC5nZXRNb250aCgpXSB9LAoJeXkJOiBmdW5jdGlvbihkKQl7IHJldHVybiAoZC5nZXRGdWxsWWVhcigpKycnKS5zdWJzdHJpbmcoMikgfSwKCXl5eXk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0RnVsbFllYXIoKSB9LAoJdAk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0SG91cnMoKSA8IDEyID8gJ2EnIDogJ3AnIH0sCgl0dAk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0SG91cnMoKSA8IDEyID8gJ2FtJyA6ICdwbScgfSwKCVQJOiBmdW5jdGlvbihkKQl7IHJldHVybiBkLmdldEhvdXJzKCkgPCAxMiA/ICdBJyA6ICdQJyB9LAoJVFQJOiBmdW5jdGlvbihkKQl7IHJldHVybiBkLmdldEhvdXJzKCkgPCAxMiA/ICdBTScgOiAnUE0nIH0sCgl1CTogZnVuY3Rpb24oZCkJeyByZXR1cm4gZm9ybWF0RGF0ZShkLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzJ1onIikgfSwKCVMJOiBmdW5jdGlvbihkKQl7CgkJdmFyIGRhdGUgPSBkLmdldERhdGUoKTsKCQlpZiAoZGF0ZSA+IDEwICYmIGRhdGUgPCAyMCkgewoJCQlyZXR1cm4gJ3RoJzsKCQl9CgkJcmV0dXJuIFsnc3QnLCAnbmQnLCAncmQnXVtkYXRlJTEwLTFdIHx8ICd0aCc7Cgl9Cn07CgoKCgovKiBFdmVudCBEYXRlIE1hdGgKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCmZ1bmN0aW9uIGV4Y2xFbmREYXkoZXZlbnQpIHsKCWlmIChldmVudC5lbmQpIHsKCQlyZXR1cm4gX2V4Y2xFbmREYXkoZXZlbnQuZW5kLCBldmVudC5hbGxEYXkpOwoJfWVsc2V7CgkJcmV0dXJuIGFkZERheXMoY2xvbmVEYXRlKGV2ZW50LnN0YXJ0KSwgMSk7Cgl9Cn0KCgpmdW5jdGlvbiBfZXhjbEVuZERheShlbmQsIGFsbERheSkgewoJZW5kID0gY2xvbmVEYXRlKGVuZCk7CglyZXR1cm4gYWxsRGF5IHx8IGVuZC5nZXRIb3VycygpIHx8IGVuZC5nZXRNaW51dGVzKCkgPyBhZGREYXlzKGVuZCwgMSkgOiBjbGVhclRpbWUoZW5kKTsKfQoKCmZ1bmN0aW9uIHNlZ0NtcChhLCBiKSB7CglyZXR1cm4gKGIubXNMZW5ndGggLSBhLm1zTGVuZ3RoKSAqIDEwMCArIChhLmV2ZW50LnN0YXJ0IC0gYi5ldmVudC5zdGFydCk7Cn0KCgpmdW5jdGlvbiBzZWdzQ29sbGlkZShzZWcxLCBzZWcyKSB7CglyZXR1cm4gc2VnMS5lbmQgPiBzZWcyLnN0YXJ0ICYmIHNlZzEuc3RhcnQgPCBzZWcyLmVuZDsKfQoKCgovKiBFdmVudCBTb3J0aW5nCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCgovLyBldmVudCByZW5kZXJpbmcgdXRpbGl0aWVzCmZ1bmN0aW9uIHNsaWNlU2VncyhldmVudHMsIHZpc0V2ZW50RW5kcywgc3RhcnQsIGVuZCkgewoJdmFyIHNlZ3MgPSBbXSwKCQlpLCBsZW49ZXZlbnRzLmxlbmd0aCwgZXZlbnQsCgkJZXZlbnRTdGFydCwgZXZlbnRFbmQsCgkJc2VnU3RhcnQsIHNlZ0VuZCwKCQlpc1N0YXJ0LCBpc0VuZDsKCWZvciAoaT0wOyBpPGxlbjsgaSsrKSB7CgkJZXZlbnQgPSBldmVudHNbaV07CgkJZXZlbnRTdGFydCA9IGV2ZW50LnN0YXJ0OwoJCWV2ZW50RW5kID0gdmlzRXZlbnRFbmRzW2ldOwoJCWlmIChldmVudEVuZCA+IHN0YXJ0ICYmIGV2ZW50U3RhcnQgPCBlbmQpIHsKCQkJaWYgKGV2ZW50U3RhcnQgPCBzdGFydCkgewoJCQkJc2VnU3RhcnQgPSBjbG9uZURhdGUoc3RhcnQpOwoJCQkJaXNTdGFydCA9IGZhbHNlOwoJCQl9ZWxzZXsKCQkJCXNlZ1N0YXJ0ID0gZXZlbnRTdGFydDsKCQkJCWlzU3RhcnQgPSB0cnVlOwoJCQl9CgkJCWlmIChldmVudEVuZCA+IGVuZCkgewoJCQkJc2VnRW5kID0gY2xvbmVEYXRlKGVuZCk7CgkJCQlpc0VuZCA9IGZhbHNlOwoJCQl9ZWxzZXsKCQkJCXNlZ0VuZCA9IGV2ZW50RW5kOwoJCQkJaXNFbmQgPSB0cnVlOwoJCQl9CgkJCXNlZ3MucHVzaCh7CgkJCQlldmVudDogZXZlbnQsCgkJCQlzdGFydDogc2VnU3RhcnQsCgkJCQllbmQ6IHNlZ0VuZCwKCQkJCWlzU3RhcnQ6IGlzU3RhcnQsCgkJCQlpc0VuZDogaXNFbmQsCgkJCQltc0xlbmd0aDogc2VnRW5kIC0gc2VnU3RhcnQKCQkJfSk7CgkJfQoJfSAKCXJldHVybiBzZWdzLnNvcnQoc2VnQ21wKTsKfQoKCi8vIGV2ZW50IHJlbmRlcmluZyBjYWxjdWxhdGlvbiB1dGlsaXRpZXMKZnVuY3Rpb24gc3RhY2tTZWdzKHNlZ3MpIHsKCXZhciBsZXZlbHMgPSBbXSwKCQlpLCBsZW4gPSBzZWdzLmxlbmd0aCwgc2VnLAoJCWosIGNvbGxpZGUsIGs7Cglmb3IgKGk9MDsgaTxsZW47IGkrKykgewoJCXNlZyA9IHNlZ3NbaV07CgkJaiA9IDA7IC8vIHRoZSBsZXZlbCBpbmRleCB3aGVyZSBzZWcgc2hvdWxkIGJlbG9uZwoJCXdoaWxlICh0cnVlKSB7CgkJCWNvbGxpZGUgPSBmYWxzZTsKCQkJaWYgKGxldmVsc1tqXSkgewoJCQkJZm9yIChrPTA7IGs8bGV2ZWxzW2pdLmxlbmd0aDsgaysrKSB7CgkJCQkJaWYgKHNlZ3NDb2xsaWRlKGxldmVsc1tqXVtrXSwgc2VnKSkgewoJCQkJCQljb2xsaWRlID0gdHJ1ZTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCWlmIChjb2xsaWRlKSB7CgkJCQlqKys7CgkJCX1lbHNlewoJCQkJYnJlYWs7CgkJCX0KCQl9CgkJaWYgKGxldmVsc1tqXSkgewoJCQlsZXZlbHNbal0ucHVzaChzZWcpOwoJCX1lbHNlewoJCQlsZXZlbHNbal0gPSBbc2VnXTsKCQl9Cgl9CglyZXR1cm4gbGV2ZWxzOwp9CgoKCi8qIEV2ZW50IEVsZW1lbnQgQmluZGluZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgoKZnVuY3Rpb24gbGF6eVNlZ0JpbmQoY29udGFpbmVyLCBzZWdzLCBiaW5kSGFuZGxlcnMpIHsKCWNvbnRhaW5lci51bmJpbmQoJ21vdXNlb3ZlcicpLm1vdXNlb3ZlcihmdW5jdGlvbihldikgewoJCXZhciBwYXJlbnQ9ZXYudGFyZ2V0LCBlLAoJCQlpLCBzZWc7CgkJd2hpbGUgKHBhcmVudCAhPSB0aGlzKSB7CgkJCWUgPSBwYXJlbnQ7CgkJCXBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlOwoJCX0KCQlpZiAoKGkgPSBlLl9mY2kpICE9PSB1bmRlZmluZWQpIHsKCQkJZS5fZmNpID0gdW5kZWZpbmVkOwoJCQlzZWcgPSBzZWdzW2ldOwoJCQliaW5kSGFuZGxlcnMoc2VnLmV2ZW50LCBzZWcuZWxlbWVudCwgc2VnKTsKCQkJJChldi50YXJnZXQpLnRyaWdnZXIoZXYpOwoJCX0KCQlldi5zdG9wUHJvcGFnYXRpb24oKTsKCX0pOwp9CgoKCi8qIEVsZW1lbnQgRGltZW5zaW9ucwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgoKZnVuY3Rpb24gc2V0T3V0ZXJXaWR0aChlbGVtZW50LCB3aWR0aCwgaW5jbHVkZU1hcmdpbnMpIHsKCWVsZW1lbnQuZWFjaChmdW5jdGlvbihpLCBfZWxlbWVudCkgewoJCV9lbGVtZW50LnN0eWxlLndpZHRoID0gTWF0aC5tYXgoMCwgd2lkdGggLSBoc2lkZXMoX2VsZW1lbnQsIGluY2x1ZGVNYXJnaW5zKSkgKyAncHgnOwoJfSk7Cn0KCgpmdW5jdGlvbiBzZXRPdXRlckhlaWdodChlbGVtZW50LCBoZWlnaHQsIGluY2x1ZGVNYXJnaW5zKSB7CgllbGVtZW50LmVhY2goZnVuY3Rpb24oaSwgX2VsZW1lbnQpIHsKCQlfZWxlbWVudC5zdHlsZS5oZWlnaHQgPSBNYXRoLm1heCgwLCBoZWlnaHQgLSB2c2lkZXMoX2VsZW1lbnQsIGluY2x1ZGVNYXJnaW5zKSkgKyAncHgnOwoJfSk7Cn0KCgovLyBUT0RPOiBjdXJDU1MgaGFzIGJlZW4gZGVwcmVjYXRlZAoKCmZ1bmN0aW9uIGhzaWRlcyhfZWxlbWVudCwgaW5jbHVkZU1hcmdpbnMpIHsKCXJldHVybiAocGFyc2VGbG9hdCgkLmN1ckNTUyhfZWxlbWVudCwgJ3BhZGRpbmdMZWZ0JywgdHJ1ZSkpIHx8IDApICsKCSAgICAgICAocGFyc2VGbG9hdCgkLmN1ckNTUyhfZWxlbWVudCwgJ3BhZGRpbmdSaWdodCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoJC5jdXJDU1MoX2VsZW1lbnQsICdib3JkZXJMZWZ0V2lkdGgnLCB0cnVlKSkgfHwgMCkgKwoJICAgICAgIChwYXJzZUZsb2F0KCQuY3VyQ1NTKF9lbGVtZW50LCAnYm9yZGVyUmlnaHRXaWR0aCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKGluY2x1ZGVNYXJnaW5zID8gaG1hcmdpbnMoX2VsZW1lbnQpIDogMCk7Cn0KCgpmdW5jdGlvbiBobWFyZ2lucyhfZWxlbWVudCkgewoJcmV0dXJuIChwYXJzZUZsb2F0KCQuY3VyQ1NTKF9lbGVtZW50LCAnbWFyZ2luTGVmdCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoJC5jdXJDU1MoX2VsZW1lbnQsICdtYXJnaW5SaWdodCcsIHRydWUpKSB8fCAwKTsKfQoKCmZ1bmN0aW9uIHZzaWRlcyhfZWxlbWVudCwgaW5jbHVkZU1hcmdpbnMpIHsKCXJldHVybiAocGFyc2VGbG9hdCgkLmN1ckNTUyhfZWxlbWVudCwgJ3BhZGRpbmdUb3AnLCB0cnVlKSkgfHwgMCkgKwoJICAgICAgIChwYXJzZUZsb2F0KCQuY3VyQ1NTKF9lbGVtZW50LCAncGFkZGluZ0JvdHRvbScsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoJC5jdXJDU1MoX2VsZW1lbnQsICdib3JkZXJUb3BXaWR0aCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoJC5jdXJDU1MoX2VsZW1lbnQsICdib3JkZXJCb3R0b21XaWR0aCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKGluY2x1ZGVNYXJnaW5zID8gdm1hcmdpbnMoX2VsZW1lbnQpIDogMCk7Cn0KCgpmdW5jdGlvbiB2bWFyZ2lucyhfZWxlbWVudCkgewoJcmV0dXJuIChwYXJzZUZsb2F0KCQuY3VyQ1NTKF9lbGVtZW50LCAnbWFyZ2luVG9wJywgdHJ1ZSkpIHx8IDApICsKCSAgICAgICAocGFyc2VGbG9hdCgkLmN1ckNTUyhfZWxlbWVudCwgJ21hcmdpbkJvdHRvbScsIHRydWUpKSB8fCAwKTsKfQoKCmZ1bmN0aW9uIHNldE1pbkhlaWdodChlbGVtZW50LCBoKSB7CgloID0gdHlwZW9mIGggPT0gJ251bWJlcicgPyBoICsgJ3B4JyA6IGg7CgllbGVtZW50WzBdLnN0eWxlLmNzc1RleHQgKz0gJzttaW4taGVpZ2h0OicgKyBoICsgJztfaGVpZ2h0OicgKyBoOwp9CgoKCi8qIFBvc2l0aW9uIENhbGN1bGF0aW9uCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KLy8gbmFzdHkgYnVncyBpbiBvcGVyYSA5LjI1Ci8vIHBvc2l0aW9uKCkncyB0b3AgcmV0dXJuaW5nIGluY29ycmVjdGx5IHdpdGggVFIvVEQgb3IgZWxlbWVudHMgd2l0aGluIFRECgp2YXIgdG9wQnVnOwoKZnVuY3Rpb24gdG9wQ29ycmVjdCh0cikgeyAvLyB0ci90aC90ZCBvciBhbnl0aGluZyBlbHNlCglpZiAodG9wQnVnICE9PSBmYWxzZSkgewoJCXZhciBjZWxsOwoJCWlmICh0ci5pcygndGgsdGQnKSkgewoJCQl0ciA9IChjZWxsID0gdHIpLnBhcmVudCgpOwoJCX0KCQlpZiAodG9wQnVnID09PSB1bmRlZmluZWQgJiYgdHIuaXMoJ3RyJykpIHsKCQkJdG9wQnVnID0gdHIucG9zaXRpb24oKS50b3AgIT0gdHIuY2hpbGRyZW4oKS5wb3NpdGlvbigpLnRvcDsKCQl9CgkJaWYgKHRvcEJ1ZykgewoJCQlyZXR1cm4gdHIucGFyZW50KCkucG9zaXRpb24oKS50b3AgKyAoY2VsbCA/IHRyLnBvc2l0aW9uKCkudG9wIC0gY2VsbC5wb3NpdGlvbigpLnRvcCA6IDApOwoJCX0KCX0KCXJldHVybiAwOwp9CgoKCi8qIE1pc2MgVXRpbHMKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCi8vVE9ETzogYXJyYXlTbGljZQovL1RPRE86IGlzRnVuY3Rpb24sIGdyZXAgPwoKCmZ1bmN0aW9uIG5vb3AoKSB7IH0KCgpmdW5jdGlvbiBjbXAoYSwgYikgewoJcmV0dXJuIGEgLSBiOwp9CgoKZnVuY3Rpb24gYXJyYXlNYXgoYSkgewoJcmV0dXJuIE1hdGgubWF4LmFwcGx5KE1hdGgsIGEpOwp9CgoKZnVuY3Rpb24gemVyb1BhZChuKSB7CglyZXR1cm4gKG4gPCAxMCA/ICcwJyA6ICcnKSArIG47Cn0KCgpmdW5jdGlvbiBzbWFydFByb3BlcnR5KG9iaiwgbmFtZSkgeyAvLyBnZXQgYSBjYW1lbC1jYXNlZC9uYW1lc3BhY2VkIHByb3BlcnR5IG9mIGFuIG9iamVjdAoJaWYgKG9ialtuYW1lXSAhPT0gdW5kZWZpbmVkKSB7CgkJcmV0dXJuIG9ialtuYW1lXTsKCX0KCXZhciBwYXJ0cyA9IG5hbWUuc3BsaXQoLyg/PVtBLVpdKS8pLAoJCWk9cGFydHMubGVuZ3RoLTEsIHJlczsKCWZvciAoOyBpPj0wOyBpLS0pIHsKCQlyZXMgPSBvYmpbcGFydHNbaV0udG9Mb3dlckNhc2UoKV07CgkJaWYgKHJlcyAhPT0gdW5kZWZpbmVkKSB7CgkJCXJldHVybiByZXM7CgkJfQoJfQoJcmV0dXJuIG9ialsnJ107Cn0KCgpmdW5jdGlvbiBodG1sRXNjYXBlKHMpIHsKCXJldHVybiBzLnJlcGxhY2UoLyYvZywgJyZhbXA7JykKCQkucmVwbGFjZSgvPC9nLCAnJmx0OycpCgkJLnJlcGxhY2UoLz4vZywgJyZndDsnKQoJCS5yZXBsYWNlKC8nL2csICcmIzAzOTsnKQoJCS5yZXBsYWNlKC8iL2csICcmcXVvdDsnKQoJCS5yZXBsYWNlKC9cbi9nLCAnPGJyIC8+Jyk7Cn0KCgpmdW5jdGlvbiBjc3NLZXkoX2VsZW1lbnQpIHsKCXJldHVybiBfZWxlbWVudC5pZCArICcvJyArIF9lbGVtZW50LmNsYXNzTmFtZSArICcvJyArIF9lbGVtZW50LnN0eWxlLmNzc1RleHQucmVwbGFjZSgvKF58OylccyoodG9wfGxlZnR8d2lkdGh8aGVpZ2h0KVxzKjpbXjtdKi9pZywgJycpOwp9CgoKZnVuY3Rpb24gZGlzYWJsZVRleHRTZWxlY3Rpb24oZWxlbWVudCkgewoJZWxlbWVudAoJCS5hdHRyKCd1bnNlbGVjdGFibGUnLCAnb24nKQoJCS5jc3MoJ01velVzZXJTZWxlY3QnLCAnbm9uZScpCgkJLmJpbmQoJ3NlbGVjdHN0YXJ0LnVpJywgZnVuY3Rpb24oKSB7IHJldHVybiBmYWxzZTsgfSk7Cn0KCgovKgpmdW5jdGlvbiBlbmFibGVUZXh0U2VsZWN0aW9uKGVsZW1lbnQpIHsKCWVsZW1lbnQKCQkuYXR0cigndW5zZWxlY3RhYmxlJywgJ29mZicpCgkJLmNzcygnTW96VXNlclNlbGVjdCcsICcnKQoJCS51bmJpbmQoJ3NlbGVjdHN0YXJ0LnVpJyk7Cn0KKi8KCgoNCn0pKGpRdWVyeSk7",
	"int.js": "LyoKIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgR1BMdjMKIENvcHlyaWdodCAyMDEwLCBBbGVzc2FuZHJvIEFyemlsbGkKICovCgpmdW5jdGlvbiB0b2dnbGUocXVlcnkpIHsKICAgIHZhciBkaXYgPSAkKHF1ZXJ5KS5nZXQoMCk7CiAgICBpZiAoZGl2LnN0eWxlWydkaXNwbGF5J10gPT0gJ25vbmUnKSB7CiAgICAgICAgZGl2LnN0eWxlWydkaXNwbGF5J10gPSAnYmxvY2snOwogICAgICAgIHJldHVybiB0cnVlCiAgICB9IGVsc2UgewogICAgICAgIGRpdi5zdHlsZVsnZGlzcGxheSddID0gJ25vbmUnOwogICAgICAgIHJldHVybiBmYWxzZQogICAgfQp9CgpmdW5jdGlvbiB0b2dnbGVfc2VhcmNocG9wKCkgewogICAgdG9nZ2xlKCIjc2VhcmNocG9wIik7CiAgICAkKCIjcSIpLmdldCgwKS5mb2N1cygpOwp9CgpmdW5jdGlvbiB0b2dnbGVfYWRkcG9wKCkgewogICAgdG9nZ2xlKCIjYWRkcG9wIik7CiAgICAkKCIjbmV3ZW50cnkiKS5nZXQoMCkuZm9jdXMoKTsKfQoKZnVuY3Rpb24gdG9nZ2xlX25hdnBvcCgpIHsKICAgIHRvZ2dsZSgiI25hdnBvcCIpCn0KCmZ1bmN0aW9uIGtleXRhYmxlKGUpIHsKICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7CiAgICBjYXNlIDI3OgogICAgICAgICQoIiNzZWFyY2hwb3AiKS5nZXQoMCkuc3R5bGVbJ2Rpc3BsYXknXSA9ICdub25lJzsKICAgICAgICAkKCIjYWRkcG9wIikuZ2V0KDApLnN0eWxlWydkaXNwbGF5J10gPSAnbm9uZSc7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIDEzOgogICAgICAgIGlmIChlLmFsdEtleSkgewogICAgICAgICAgICBpZiAoJCgiI3NlYXJjaHBvcCIpLmdldCgwKS5zdHlsZVsnZGlzcGxheSddICE9ICdub25lJykgewogICAgICAgICAgICAgICAgJCgiI3NlYXJjaGZvcm0iKS5nZXQoMCkuc3VibWl0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQudHlwZSAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgc3dpdGNoKGUud2hpY2gpIHsKICAgIGNhc2UgOTc6IC8vIGEga2V5CiAgICAgICAgdG9nZ2xlX2FkZHBvcCgpOwogICAgICAgIHJldHVybiBmYWxzZTsgCiAgICBjYXNlIDExNTogLy8gcyBrZXkKICAgICAgICB0b2dnbGVfc2VhcmNocG9wKCk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQoKZnVuY3Rpb24gcmVtb3ZlX2VudHJ5KG5hbWUpIHsKICAkLmFqYXgoeyB1cmw6ICJyZW1vdmU/aWQ9IiArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSwgc3VjY2VzczogZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgcmVxKSB7CglpZiAoZGF0YS5tYXRjaCgvXnJlbW92ZWQvKSkgewoJICB2YXIgbWFpbnRhYmxlID0gJCgiI21haW50YWJsZSIpLmdldCgwKTsKCSAgZm9yICh2YXIgaSBpbiBtYWludGFibGUucm93cykgewoJICAgIGlmIChtYWludGFibGUucm93c1tpXSA9PSBudWxsKSBjb250aW51ZTsgLy8gZGVsZXRlZCByb3dzCgkgICAgaWYgKG1haW50YWJsZS5yb3dzW2ldLmlkID09IG51bGwpIGNvbnRpbnVlOyAvLyByb3dzIHdpdGhvdXQgaWQKICAgICAgICAgICAgCgkgICAgaWYgKG1haW50YWJsZS5yb3dzW2ldLmlkID09ICJlZGl0b3JfIiArIG5hbWUpIHsKCSAgICAgIG1haW50YWJsZS5kZWxldGVSb3coaSk7CgkgICAgICBtYWludGFibGUuZGVsZXRlUm93KGktMSk7IC8vIHRoaXMgaXMgdGhlIHRpdGxlCgkgICAgICBicmVhazsKCSAgICB9CgkgIH0KCX0gZWxzZSB7CgkgICQoIiN0c18iK3YuaWQpLmh0bWwoIlJlbW92ZSBmYWlsZWQ6ICIgKyBkYXRhKTsKCX0KICAgIH19KTsKfQoKZnVuY3Rpb24gc2F2ZV9lZGl0b3IoZm9ybSkgewogICAgaWYgKGZvcm0gPT0gbnVsbCkgcmV0dXJuOwogICAgaWYgKGZvcm0uZWxlbWVudHNbJ2VkdGl0bGUnXS5kaXNhYmxlZCAhPSAiIikgcmV0dXJuOwogICAgCiAgICBvYmogPSBuZXcgT2JqZWN0KCk7CiAgICBvYmoudGl0bGUgPSBmb3JtLmVsZW1lbnRzWydlZHRpdGxlJ10udmFsdWU7CiAgICBvYmoudGV4dCA9IGZvcm0uZWxlbWVudHNbJ2VkdGV4dCddLnZhbHVlOwogICAgb2JqLnRyaWdnZXJBdCA9IGZvcm0uZWxlbWVudHNbJ2VkYXQnXS52YWx1ZTsKICAgIG9iai5zb3J0ID0gZm9ybS5lbGVtZW50c1snZWRzb3J0J10udmFsdWU7CiAgICBvYmouaWQgPSBmb3JtLmVsZW1lbnRzWydlZGlkJ10udmFsdWU7CiAgICBvYmoucHJpb3JpdHkgPSBwYXJzZUludChmb3JtLmVsZW1lbnRzWydlZHByaW8nXS52YWx1ZSk7CiAgICBvYmouY29scyA9IGZvcm0uZWxlbWVudHNbJ2VkY29scyddLnZhbHVlOwogICAgJCgiI2xvYWRpbmdfIitvYmouaWQpLmdldCgwKS5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CiAgICAKICAgICQuYWpheCh7IHR5cGU6ICJQT1NUIiwgdXJsOiAiL3NhdmUiLCBkYXRhOiBvYmoudG9KU09OU3RyaW5nKCksIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIHJlcSkgewoJICBpZiAoZGF0YS5tYXRjaCgvXnNhdmVkLWF0LXRpbWVzdGFtcDogLykpIHsKCSAgICAkKCIjdHNfIitvYmouaWQpLmh0bWwoZGF0YS5zdWJzdHIoInNhdmVkLWF0LXRpbWVzdGFtcDogIi5sZW5ndGgpKTsKCSAgfSBlbHNlIHsKCSAgICAkKCIjdHNfIitvYmouaWQpLmh0bWwoIiBMQVNUIFNBVkUgRkFJTEVEOiAiICsgZGF0YSk7CgkgIH0KCSAgJCgiI2xvYWRpbmdfIitvYmouaWQpLmdldCgwKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoJfX0pOwp9CgpmdW5jdGlvbiBhZGRfcm93KGlkKSB7CiAgJC5hamF4KHsgdXJsOiAiaHRtbGdldD90eXBlPWFkZCZpZD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KGlkKSwgc3VjY2VzczogZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgcmVxKSB7Cgl2YXIgbmV3cm93cyA9IGRhdGEuc3BsaXQoIlx1MjAyOSIsIDIpOwoJCgl2YXIgbWFpbnRhYmxlID0gJCgiI21haW50YWJsZSIpLmdldCgwKTsKCQoJdmFyIG5ld3JvdzEgPSBtYWludGFibGUuaW5zZXJ0Um93KDApOwoJbmV3cm93MS5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImVudHJ5Iik7CgluZXdyb3cxLmlubmVySFRNTCA9IG5ld3Jvd3NbMF07CgkgIAoJdmFyIG5ld3JvdzIgPSBtYWludGFibGUuaW5zZXJ0Um93KDEpOwoJbmV3cm93Mi5zZXRBdHRyaWJ1dGUoImlkIiwgImVkaXRvcl8iK2VuY29kZVVSSUNvbXBvbmVudChpZCkpOwoJbmV3cm93Mi5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImVkaXRvciIpOwoJbmV3cm93Mi5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgImRpc3BsYXk6IG5vbmUiKTsKCW5ld3JvdzIuaW5uZXJIVE1MID0gbmV3cm93c1sxXTsKCglzYXZlX29wZW5fZWRpdG9yKHRydWUpOwogICAgICB9fSk7Cn0KCmZ1bmN0aW9uIGFkZF9lbnRyeShxdWVyeSkgewogICAgdmFyIG5ldGV4dCA9ICQoJyNuZXdlbnRyeScpLnZhbCgpOwogICAgJC5hamF4KHsgdXJsOiAicWFkZD9xPSIgKyBlbmNvZGVVUklDb21wb25lbnQocXVlcnkpICsgIiZ0ZXh0PSIgKyBlbmNvZGVVUklDb21wb25lbnQobmV0ZXh0KSwgc3VjY2VzczogZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgcmVxKSB7CgkgIGlmIChkYXRhLm1hdGNoKC9eYWRkZWQ6IC8pKSB7CgkgICAgbmV3aWQgPSBkYXRhLnN1YnN0cigiYWRkZWQ6ICIubGVuZ3RoKTsKCSAgICBhZGRfcm93KG5ld2lkKTsKCSAgICAKCSAgICAkKCcjbmV3ZW50cnknKS52YWwoIiIpOwogICAgICAgICQoIiNhZGRwb3AiKS5nZXQoMCkuc3R5bGVbImRpc3BsYXkiXSA9ICJub25lIjsKCSAgfSBlbHNlIHsKCSAgICBhbGVydCgiQUREIEZBSUxFRDogIiArIGRhdGEpOwoJICB9Cgl9fSk7CiAgICByZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIGNoYW5nZV9lZGl0b3JfZGlzYWJsZWQoZWQsIGRpc2FibGVkU3RhdHVzKSB7CiAgICBpZiAoZWQgPT0gbnVsbCkgcmV0dXJuOwogICAgZWQuZWxlbWVudHNbJ2VkdGl0bGUnXS5kaXNhYmxlZCA9IGRpc2FibGVkU3RhdHVzOwogICAgZWQuZWxlbWVudHNbJ2VkdGV4dCddLmRpc2FibGVkID0gZGlzYWJsZWRTdGF0dXM7CiAgICBlZC5lbGVtZW50c1snZWRhdCddLmRpc2FibGVkID0gZGlzYWJsZWRTdGF0dXM7CiAgICBlZC5lbGVtZW50c1snZWRzb3J0J10uZGlzYWJsZWQgPSBkaXNhYmxlZFN0YXR1czsKICAgIGVkLmVsZW1lbnRzWydlZGlkJ10uZGlzYWJsZWQgPSBkaXNhYmxlZFN0YXR1czsKICAgIGVkLmVsZW1lbnRzWydlZHByaW8nXS5kaXNhYmxlZCA9IGRpc2FibGVkU3RhdHVzOwogICAgZWQuZWxlbWVudHNbJ2VkY29scyddLmRpc2FibGVkID0gZGlzYWJsZWRTdGF0dXM7CiAgICBlZC5lbGVtZW50c1snc2F2ZWJ0biddLmRpc2FibGVkID0gZGlzYWJsZWRTdGF0dXM7Cn0KCmZ1bmN0aW9uIGZpbGxfZWRpdG9yKG5hbWUpIHsKICAkKCIjbG9hZGluZ18iK25hbWUpLmdldCgwKS5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CiAgJC5hamF4KHt1cmw6ICJnZXQ/aWQ9IiArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSwgc3VjY2VzczogZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgcmVxKSB7Cgl2YXIgdGltZXN0YW1wID0gZGF0YS5zcGxpdCgiXG4iLCAyKVswXTsKCXZhciBqc29uT2JqID0gZGF0YS5zdWJzdHIodGltZXN0YW1wLmxlbmd0aCk7Cgl2ID0ganNvbk9iai5wYXJzZUpTT04oKTsKCXZhciBlZCA9ICQoIiNlZGl2XyIgKyBuYW1lKS5maXJzdCgpLmdldCgwKTsKCWVkLmVsZW1lbnRzWydlZHRpdGxlJ10udmFsdWUgPSB2LlRpdGxlOwoJZWQuZWxlbWVudHNbJ2VkdGV4dCddLnZhbHVlID0gdi5UZXh0OwoJZWQuZWxlbWVudHNbJ2VkYXQnXS52YWx1ZSA9IHYuVHJpZ2dlckF0OwoJZWQuZWxlbWVudHNbJ2Vkc29ydCddLnZhbHVlID0gdi5Tb3J0OwoJZWQuZWxlbWVudHNbJ2VkaWQnXS52YWx1ZSA9IHYuSWQ7CgllZC5lbGVtZW50c1snZWRwcmlvJ10udmFsdWUgPSB2LlByaW9yaXR5OwoJZWQuZWxlbWVudHNbJ2VkY29scyddLnZhbHVlID0gdi5Db2xzOwoJCgkkKCIjdHNfIiArIHYuSWQpLmh0bWwodGltZXN0YW1wKTsKCWNoYW5nZV9lZGl0b3JfZGlzYWJsZWQoZWQsICIiKTsKCSQoIiNsb2FkaW5nXyIrbmFtZSkuZ2V0KDApLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIH19KTsKfQoKZnVuY3Rpb24gZWRpdG9yX2Zyb21fcm93KHJvdykgewogIHJldHVybiAkKCIjZWRpdl8iK3Jvdy5pZC5zdWJzdHIoImVkaXRvcl8iLmxlbmd0aCkpLmdldCgwKTsKfQoKZnVuY3Rpb24gc2F2ZV9vcGVuX2VkaXRvcihzaG91bGRfY2xvc2VfZWRpdG9yKSB7CiAgICBvcm93cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ciIpOwogICAgZm9yICh2YXIgaSBpbiBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgidHIiKSkgewogICAgICAgIG9yb3cgPSBvcm93c1tpXTsKCiAgICAgICAgaWYgKG9yb3cgPT0gbnVsbCkgY29udGludWU7IC8vIGRlbGV0ZWQgcm93cwogICAgICAgIGlmIChvcm93LnN0eWxlID09IG51bGwpIGNvbnRpbnVlOwogICAgICAgIGlmIChvcm93LmlkID09IG51bGwpIGNvbnRpbnVlOwogICAgICAgIAogICAgICAgIGlmICgob3Jvdy5pZC5tYXRjaCgvXmVkaXRvcl8vKSkgJiYgKG9yb3cuc3R5bGVbJ2Rpc3BsYXknXSAhPSAnbm9uZScpKSB7CiAgICAgICAgICAgIGlmIChzaG91bGRfY2xvc2VfZWRpdG9yKSB7CiAgICAgICAgICAgICAgICBjbG9zZV9lZGl0b3Iob3JvdykKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNhdmVfZWRpdG9yKGVkaXRvcl9mcm9tX3Jvdyhvcm93KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIHNhdmVfZWRpdG9yX2J5X2lkKG5hbWUsIGV2ZW50KSB7CiAgICBzYXZlX2VkaXRvcigkKCIjZWRpdl8iK25hbWUpLmdldCgwKSk7Cn0KCmZ1bmN0aW9uIGNsb3NlX2VkaXRvcihyb3cpIHsKICAgIHZhciBlZCA9IGVkaXRvcl9mcm9tX3Jvdyhyb3cpOwogICAgc2F2ZV9lZGl0b3IoZWQpOwogICAgY2hhbmdlX2VkaXRvcl9kaXNhYmxlZChlZCwgImRpc2FibGVkIik7CiAgICByb3cuc3R5bGVbJ2Rpc3BsYXknXSA9ICdub25lJzsKfQoKZnVuY3Rpb24gdG9nZ2xlX2VkaXRvcihuYW1lLCBldmVudCkgewogICAgdmFyIHJvdyA9ICQoIiNlZGl0b3JfIituYW1lKS5nZXQoMCk7CiAgICBpZiAocm93LnN0eWxlWydkaXNwbGF5J10gPT0gJ25vbmUnKSB7CiAgICAgICAgb3Jvd3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgidHIiKTsKICAgICAgICBmb3IgKHZhciBpIGluIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ciIpKSB7CiAgICAgICAgICAgIG9yb3cgPSBvcm93c1tpXTsKCiAgICAgICAgICAgIGlmIChvcm93ID09IG51bGwpIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAob3Jvdy5zdHlsZSA9PSBudWxsKSBjb250aW51ZTsKICAgICAgICAgICAgaWYgKG9yb3cuaWQgPT0gbnVsbCkgY29udGludWU7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoKG9yb3cuaWQubWF0Y2goL15lZGl0b3JfLykpICYmIChvcm93LnN0eWxlWydkaXNwbGF5J10gIT0gJ25vbmUnKSkgewogICAgICAgICAgICAgICAgY2xvc2VfZWRpdG9yKG9yb3cpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJvdy5zdHlsZVsnZGlzcGxheSddID0gJyc7CgogICAgICAgIGZpbGxfZWRpdG9yKG5hbWUpOwogICAgfSBlbHNlIHsKICAgICAgICBjbG9zZV9lZGl0b3Iocm93KQogICAgfQp9CgpmdW5jdGlvbiBjaGFuZ2VfcHJpb3JpdHkobmFtZSwgZXZlbnQpIHsKICAkLmFqYXgoeyB1cmw6ICJjaGFuZ2UtcHJpb3JpdHk/aWQ9IiArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICImc3BlY2lhbD0iICsgZXZlbnQuc2hpZnRLZXksIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIHJlcSkgewoJaWYgKGRhdGEubWF0Y2goL15wcmlvcml0eS1jaGFuZ2UtdG86IC8pKSB7CgkgIHByaW9yaXR5ID0gZGF0YS5zdWJzdHIoInByaW9yaXR5LWNoYW5nZS10bzogIi5sZW5ndGgpOwoJICBwcmlvcml0eU51bSA9IHByaW9yaXR5WzBdOwoJICBwcmlvcml0eSA9IHByaW9yaXR5LnN1YnN0cigyKTsKCSAgdmFyIGVwciA9ICQoJyNlcHJfJytuYW1lKTsKCSAgZXByLnZhbChwcmlvcml0eSk7CgkgIGVwci5hdHRyKCJjbGFzcyIsICJwcmlvcml0eWJ1dHRvbiBwcmlvcml0eWNsYXNzXyIgKyBwcmlvcml0eSk7CgkgIAoJICAvLyBjaGFuZ2VzIHRoZSB2YWx1ZSBzYXZlZCBpbnNpZGUgdGhlIGVkaXRvciBkaXYgc28gdGhhdCBzYXZpbmcgdGhlIGVkaXRvciBjb250ZW50cyBkb2Vzbid0IHJldmVydCBhIGNoYW5nZWQgcHJpb3JpdHkKCSAgdmFyIGVkID0gJCgiI2VkaXZfIituYW1lKS5nZXQoMCk7CgkgIGVkLmVsZW1lbnRzWyJlZHByaW8iXS52YWx1ZSA9IHByaW9yaXR5TnVtOwoJfSBlbHNlIHsKCSAgYWxlcnQoZGF0YSk7Cgl9CiAgICAgIH19KTsKfQoKZnVuY3Rpb24gc2F2ZXNlYXJjaF9leChuYW1lLCBxdWVyeSkgewogICQuYWpheCh7IHVybDogInNhdmUtc2VhcmNoP25hbWU9IiArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICImcXVlcnk9IiArIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeSksIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIHJlcSkgewoJaWYgKCFkYXRhLm1hdGNoKC9ecXVlcnktc2F2ZWQ6IC8pKSB7CgkgIGFsZXJ0KGRhdGEpOwogICAgICAgIH0KICAgICAgfX0pOwp9CgpmdW5jdGlvbiBzYXZlc2VhcmNoKCkgewogICAgdmFyIG5hbWUgPSBwcm9tcHQoInNhdmUgc2VhcmNoIHRvOiIpOwogICAgc2F2ZXNlYXJjaF9leChuYW1lLCAkKCcjcScpLnZhbCgpKQp9CgpmdW5jdGlvbiBlZGl0c2VhcmNoKCkgewogICQuYWpheCh7IHVybDogInNhdmUtc2VhcmNoP25hbWU9IiArIGVuY29kZVVSSUNvbXBvbmVudCgkKCcjcScpLnZhbCgpKSwgc3VjY2VzczogZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgcmVxKSB7CglpZiAoZGF0YS5tYXRjaCgvXnF1ZXJ5LXNhdmVkOiAvKSkgewoJICBxdWVyeSA9IGRhdGEuc3Vic3RyaW5nKDEzKTsKCSAgbmV3cXVlcnkgPSBwcm9tcHQoIkVkaXQgcXVlcnkgZm9yICIgKyAkKCcjcScpLnZhbCgpLCBxdWVyeSk7CgkgIGlmICgobmV3cXVlcnkgIT0gIiIpICYmIChuZXdxdWVyeSAhPSBudWxsKSkgc2F2ZXNlYXJjaF9leCgkKCcjcScpLnZhbCgpLCBuZXdxdWVyeSk7CiAgICAgICAgfQogICAgICB9fSk7Cn0KCmZ1bmN0aW9uIHJlbW92ZXNlYXJjaCgpIHsKICAkLmFqYXgoeyB1cmw6ICJyZW1vdmUtc2VhcmNoP3F1ZXJ5PSIgKyBlbmNvZGVVUklDb21wb25lbnQoJCgnI3EnKS52YWwoKSkgfSk7Cn0K",
	"jquery-ui-custom.js": "LyohCiAqIGpRdWVyeSBVSSAxLjguNgogKgogKiBDb3B5cmlnaHQgMjAxMCwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLgogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCiAqCiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkKICovCihmdW5jdGlvbihjLGope2Z1bmN0aW9uIGsoYSl7cmV0dXJuIWMoYSkucGFyZW50cygpLmFuZFNlbGYoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gYy5jdXJDU1ModGhpcywidmlzaWJpbGl0eSIpPT09ImhpZGRlbiJ8fGMuZXhwci5maWx0ZXJzLmhpZGRlbih0aGlzKX0pLmxlbmd0aH1jLnVpPWMudWl8fHt9O2lmKCFjLnVpLnZlcnNpb24pe2MuZXh0ZW5kKGMudWkse3ZlcnNpb246IjEuOC42IixrZXlDb2RlOntBTFQ6MTgsQkFDS1NQQUNFOjgsQ0FQU19MT0NLOjIwLENPTU1BOjE4OCxDT01NQU5EOjkxLENPTU1BTkRfTEVGVDo5MSxDT01NQU5EX1JJR0hUOjkzLENPTlRST0w6MTcsREVMRVRFOjQ2LERPV046NDAsRU5EOjM1LEVOVEVSOjEzLEVTQ0FQRToyNyxIT01FOjM2LElOU0VSVDo0NSxMRUZUOjM3LE1FTlU6OTMsTlVNUEFEX0FERDoxMDcsTlVNUEFEX0RFQ0lNQUw6MTEwLE5VTVBBRF9ESVZJREU6MTExLE5VTVBBRF9FTlRFUjoxMDgsTlVNUEFEX01VTFRJUExZOjEwNiwKTlVNUEFEX1NVQlRSQUNUOjEwOSxQQUdFX0RPV046MzQsUEFHRV9VUDozMyxQRVJJT0Q6MTkwLFJJR0hUOjM5LFNISUZUOjE2LFNQQUNFOjMyLFRBQjo5LFVQOjM4LFdJTkRPV1M6OTF9fSk7Yy5mbi5leHRlbmQoe19mb2N1czpjLmZuLmZvY3VzLGZvY3VzOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHR5cGVvZiBhPT09Im51bWJlciI/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGQ9dGhpcztzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YyhkKS5mb2N1cygpO2ImJmIuY2FsbChkKX0sYSl9KTp0aGlzLl9mb2N1cy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHNjcm9sbFBhcmVudDpmdW5jdGlvbigpe3ZhciBhO2E9Yy5icm93c2VyLm1zaWUmJi8oc3RhdGljfHJlbGF0aXZlKS8udGVzdCh0aGlzLmNzcygicG9zaXRpb24iKSl8fC9hYnNvbHV0ZS8udGVzdCh0aGlzLmNzcygicG9zaXRpb24iKSk/dGhpcy5wYXJlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuLyhyZWxhdGl2ZXxhYnNvbHV0ZXxmaXhlZCkvLnRlc3QoYy5jdXJDU1ModGhpcywKInBvc2l0aW9uIiwxKSkmJi8oYXV0b3xzY3JvbGwpLy50ZXN0KGMuY3VyQ1NTKHRoaXMsIm92ZXJmbG93IiwxKStjLmN1ckNTUyh0aGlzLCJvdmVyZmxvdy15IiwxKStjLmN1ckNTUyh0aGlzLCJvdmVyZmxvdy14IiwxKSl9KS5lcSgwKTp0aGlzLnBhcmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4vKGF1dG98c2Nyb2xsKS8udGVzdChjLmN1ckNTUyh0aGlzLCJvdmVyZmxvdyIsMSkrYy5jdXJDU1ModGhpcywib3ZlcmZsb3cteSIsMSkrYy5jdXJDU1ModGhpcywib3ZlcmZsb3cteCIsMSkpfSkuZXEoMCk7cmV0dXJuL2ZpeGVkLy50ZXN0KHRoaXMuY3NzKCJwb3NpdGlvbiIpKXx8IWEubGVuZ3RoP2MoZG9jdW1lbnQpOmF9LHpJbmRleDpmdW5jdGlvbihhKXtpZihhIT09ailyZXR1cm4gdGhpcy5jc3MoInpJbmRleCIsYSk7aWYodGhpcy5sZW5ndGgpe2E9Yyh0aGlzWzBdKTtmb3IodmFyIGI7YS5sZW5ndGgmJmFbMF0hPT1kb2N1bWVudDspe2I9YS5jc3MoInBvc2l0aW9uIik7CmlmKGI9PT0iYWJzb2x1dGUifHxiPT09InJlbGF0aXZlInx8Yj09PSJmaXhlZCIpe2I9cGFyc2VJbnQoYS5jc3MoInpJbmRleCIpLDEwKTtpZighaXNOYU4oYikmJmIhPT0wKXJldHVybiBifWE9YS5wYXJlbnQoKX19cmV0dXJuIDB9LGRpc2FibGVTZWxlY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iaW5kKChjLnN1cHBvcnQuc2VsZWN0c3RhcnQ/InNlbGVjdHN0YXJ0IjoibW91c2Vkb3duIikrIi51aS1kaXNhYmxlU2VsZWN0aW9uIixmdW5jdGlvbihhKXthLnByZXZlbnREZWZhdWx0KCl9KX0sZW5hYmxlU2VsZWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5iaW5kKCIudWktZGlzYWJsZVNlbGVjdGlvbiIpfX0pO2MuZWFjaChbIldpZHRoIiwiSGVpZ2h0Il0sZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBkKGYsZyxsLG0pe2MuZWFjaChlLGZ1bmN0aW9uKCl7Zy09cGFyc2VGbG9hdChjLmN1ckNTUyhmLCJwYWRkaW5nIit0aGlzLHRydWUpKXx8MDtpZihsKWctPXBhcnNlRmxvYXQoYy5jdXJDU1MoZiwKImJvcmRlciIrdGhpcysiV2lkdGgiLHRydWUpKXx8MDtpZihtKWctPXBhcnNlRmxvYXQoYy5jdXJDU1MoZiwibWFyZ2luIit0aGlzLHRydWUpKXx8MH0pO3JldHVybiBnfXZhciBlPWI9PT0iV2lkdGgiP1siTGVmdCIsIlJpZ2h0Il06WyJUb3AiLCJCb3R0b20iXSxoPWIudG9Mb3dlckNhc2UoKSxpPXtpbm5lcldpZHRoOmMuZm4uaW5uZXJXaWR0aCxpbm5lckhlaWdodDpjLmZuLmlubmVySGVpZ2h0LG91dGVyV2lkdGg6Yy5mbi5vdXRlcldpZHRoLG91dGVySGVpZ2h0OmMuZm4ub3V0ZXJIZWlnaHR9O2MuZm5bImlubmVyIitiXT1mdW5jdGlvbihmKXtpZihmPT09ailyZXR1cm4gaVsiaW5uZXIiK2JdLmNhbGwodGhpcyk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2ModGhpcykuY3NzKGgsZCh0aGlzLGYpKyJweCIpfSl9O2MuZm5bIm91dGVyIitiXT1mdW5jdGlvbihmLGcpe2lmKHR5cGVvZiBmIT09Im51bWJlciIpcmV0dXJuIGlbIm91dGVyIitiXS5jYWxsKHRoaXMsZik7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2ModGhpcykuY3NzKGgsCmQodGhpcyxmLHRydWUsZykrInB4Iil9KX19KTtjLmV4dGVuZChjLmV4cHJbIjoiXSx7ZGF0YTpmdW5jdGlvbihhLGIsZCl7cmV0dXJuISFjLmRhdGEoYSxkWzNdKX0sZm9jdXNhYmxlOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxkPWMuYXR0cihhLCJ0YWJpbmRleCIpO2lmKCJhcmVhIj09PWIpe2I9YS5wYXJlbnROb2RlO2Q9Yi5uYW1lO2lmKCFhLmhyZWZ8fCFkfHxiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkhPT0ibWFwIilyZXR1cm4gZmFsc2U7YT1jKCJpbWdbdXNlbWFwPSMiK2QrIl0iKVswXTtyZXR1cm4hIWEmJmsoYSl9cmV0dXJuKC9pbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9ufG9iamVjdC8udGVzdChiKT8hYS5kaXNhYmxlZDoiYSI9PWI/YS5ocmVmfHwhaXNOYU4oZCk6IWlzTmFOKGQpKSYmayhhKX0sdGFiYmFibGU6ZnVuY3Rpb24oYSl7dmFyIGI9Yy5hdHRyKGEsInRhYmluZGV4Iik7cmV0dXJuKGlzTmFOKGIpfHxiPj0wKSYmYyhhKS5pcygiOmZvY3VzYWJsZSIpfX0pOwpjKGZ1bmN0aW9uKCl7dmFyIGE9ZG9jdW1lbnQuYm9keSxiPWEuYXBwZW5kQ2hpbGQoYj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSk7Yy5leHRlbmQoYi5zdHlsZSx7bWluSGVpZ2h0OiIxMDBweCIsaGVpZ2h0OiJhdXRvIixwYWRkaW5nOjAsYm9yZGVyV2lkdGg6MH0pO2Muc3VwcG9ydC5taW5IZWlnaHQ9Yi5vZmZzZXRIZWlnaHQ9PT0xMDA7Yy5zdXBwb3J0LnNlbGVjdHN0YXJ0PSJvbnNlbGVjdHN0YXJ0ImluIGI7YS5yZW1vdmVDaGlsZChiKS5zdHlsZS5kaXNwbGF5PSJub25lIn0pO2MuZXh0ZW5kKGMudWkse3BsdWdpbjp7YWRkOmZ1bmN0aW9uKGEsYixkKXthPWMudWlbYV0ucHJvdG90eXBlO2Zvcih2YXIgZSBpbiBkKXthLnBsdWdpbnNbZV09YS5wbHVnaW5zW2VdfHxbXTthLnBsdWdpbnNbZV0ucHVzaChbYixkW2VdXSl9fSxjYWxsOmZ1bmN0aW9uKGEsYixkKXtpZigoYj1hLnBsdWdpbnNbYl0pJiZhLmVsZW1lbnRbMF0ucGFyZW50Tm9kZSlmb3IodmFyIGU9MDtlPGIubGVuZ3RoO2UrKylhLm9wdGlvbnNbYltlXVswXV0mJgpiW2VdWzFdLmFwcGx5KGEuZWxlbWVudCxkKX19LGNvbnRhaW5zOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGRvY3VtZW50LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uP2EuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikmMTY6YSE9PWImJmEuY29udGFpbnMoYil9LGhhc1Njcm9sbDpmdW5jdGlvbihhLGIpe2lmKGMoYSkuY3NzKCJvdmVyZmxvdyIpPT09ImhpZGRlbiIpcmV0dXJuIGZhbHNlO2I9YiYmYj09PSJsZWZ0Ij8ic2Nyb2xsTGVmdCI6InNjcm9sbFRvcCI7dmFyIGQ9ZmFsc2U7aWYoYVtiXT4wKXJldHVybiB0cnVlO2FbYl09MTtkPWFbYl0+MDthW2JdPTA7cmV0dXJuIGR9LGlzT3ZlckF4aXM6ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBhPmImJmE8YitkfSxpc092ZXI6ZnVuY3Rpb24oYSxiLGQsZSxoLGkpe3JldHVybiBjLnVpLmlzT3ZlckF4aXMoYSxkLGgpJiZjLnVpLmlzT3ZlckF4aXMoYixlLGkpfX0pfX0pKGpRdWVyeSk7CjsvKiEKICogalF1ZXJ5IFVJIFdpZGdldCAxLjguNgogKgogKiBDb3B5cmlnaHQgMjAxMCwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLgogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCiAqCiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvV2lkZ2V0CiAqLwooZnVuY3Rpb24oYixqKXtpZihiLmNsZWFuRGF0YSl7dmFyIGs9Yi5jbGVhbkRhdGE7Yi5jbGVhbkRhdGE9ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPTAsZDsoZD1hW2NdKSE9bnVsbDtjKyspYihkKS50cmlnZ2VySGFuZGxlcigicmVtb3ZlIik7ayhhKX19ZWxzZXt2YXIgbD1iLmZuLnJlbW92ZTtiLmZuLnJlbW92ZT1mdW5jdGlvbihhLGMpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZighYylpZighYXx8Yi5maWx0ZXIoYSxbdGhpc10pLmxlbmd0aCliKCIqIix0aGlzKS5hZGQoW3RoaXNdKS5lYWNoKGZ1bmN0aW9uKCl7Yih0aGlzKS50cmlnZ2VySGFuZGxlcigicmVtb3ZlIil9KTtyZXR1cm4gbC5jYWxsKGIodGhpcyksYSxjKX0pfX1iLndpZGdldD1mdW5jdGlvbihhLGMsZCl7dmFyIGU9YS5zcGxpdCgiLiIpWzBdLGY7YT1hLnNwbGl0KCIuIilbMV07Zj1lKyItIithO2lmKCFkKXtkPWM7Yz1iLldpZGdldH1iLmV4cHJbIjoiXVtmXT1mdW5jdGlvbihoKXtyZXR1cm4hIWIuZGF0YShoLAphKX07YltlXT1iW2VdfHx7fTtiW2VdW2FdPWZ1bmN0aW9uKGgsZyl7YXJndW1lbnRzLmxlbmd0aCYmdGhpcy5fY3JlYXRlV2lkZ2V0KGgsZyl9O2M9bmV3IGM7Yy5vcHRpb25zPWIuZXh0ZW5kKHRydWUse30sYy5vcHRpb25zKTtiW2VdW2FdLnByb3RvdHlwZT1iLmV4dGVuZCh0cnVlLGMse25hbWVzcGFjZTplLHdpZGdldE5hbWU6YSx3aWRnZXRFdmVudFByZWZpeDpiW2VdW2FdLnByb3RvdHlwZS53aWRnZXRFdmVudFByZWZpeHx8YSx3aWRnZXRCYXNlQ2xhc3M6Zn0sZCk7Yi53aWRnZXQuYnJpZGdlKGEsYltlXVthXSl9O2Iud2lkZ2V0LmJyaWRnZT1mdW5jdGlvbihhLGMpe2IuZm5bYV09ZnVuY3Rpb24oZCl7dmFyIGU9dHlwZW9mIGQ9PT0ic3RyaW5nIixmPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxoPXRoaXM7ZD0hZSYmZi5sZW5ndGg/Yi5leHRlbmQuYXBwbHkobnVsbCxbdHJ1ZSxkXS5jb25jYXQoZikpOmQ7aWYoZSYmZC5jaGFyQXQoMCk9PT0iXyIpcmV0dXJuIGg7CmU/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGc9Yi5kYXRhKHRoaXMsYSksaT1nJiZiLmlzRnVuY3Rpb24oZ1tkXSk/Z1tkXS5hcHBseShnLGYpOmc7aWYoaSE9PWcmJmkhPT1qKXtoPWk7cmV0dXJuIGZhbHNlfX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBnPWIuZGF0YSh0aGlzLGEpO2c/Zy5vcHRpb24oZHx8e30pLl9pbml0KCk6Yi5kYXRhKHRoaXMsYSxuZXcgYyhkLHRoaXMpKX0pO3JldHVybiBofX07Yi5XaWRnZXQ9ZnVuY3Rpb24oYSxjKXthcmd1bWVudHMubGVuZ3RoJiZ0aGlzLl9jcmVhdGVXaWRnZXQoYSxjKX07Yi5XaWRnZXQucHJvdG90eXBlPXt3aWRnZXROYW1lOiJ3aWRnZXQiLHdpZGdldEV2ZW50UHJlZml4OiIiLG9wdGlvbnM6e2Rpc2FibGVkOmZhbHNlfSxfY3JlYXRlV2lkZ2V0OmZ1bmN0aW9uKGEsYyl7Yi5kYXRhKGMsdGhpcy53aWRnZXROYW1lLHRoaXMpO3RoaXMuZWxlbWVudD1iKGMpO3RoaXMub3B0aW9ucz1iLmV4dGVuZCh0cnVlLHt9LHRoaXMub3B0aW9ucywKdGhpcy5fZ2V0Q3JlYXRlT3B0aW9ucygpLGEpO3ZhciBkPXRoaXM7dGhpcy5lbGVtZW50LmJpbmQoInJlbW92ZS4iK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbigpe2QuZGVzdHJveSgpfSk7dGhpcy5fY3JlYXRlKCk7dGhpcy5fdHJpZ2dlcigiY3JlYXRlIik7dGhpcy5faW5pdCgpfSxfZ2V0Q3JlYXRlT3B0aW9uczpmdW5jdGlvbigpe3JldHVybiBiLm1ldGFkYXRhJiZiLm1ldGFkYXRhLmdldCh0aGlzLmVsZW1lbnRbMF0pW3RoaXMud2lkZ2V0TmFtZV19LF9jcmVhdGU6ZnVuY3Rpb24oKXt9LF9pbml0OmZ1bmN0aW9uKCl7fSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnVuYmluZCgiLiIrdGhpcy53aWRnZXROYW1lKS5yZW1vdmVEYXRhKHRoaXMud2lkZ2V0TmFtZSk7dGhpcy53aWRnZXQoKS51bmJpbmQoIi4iK3RoaXMud2lkZ2V0TmFtZSkucmVtb3ZlQXR0cigiYXJpYS1kaXNhYmxlZCIpLnJlbW92ZUNsYXNzKHRoaXMud2lkZ2V0QmFzZUNsYXNzKyItZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWQiKX0sCndpZGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVsZW1lbnR9LG9wdGlvbjpmdW5jdGlvbihhLGMpe3ZhciBkPWE7aWYoYXJndW1lbnRzLmxlbmd0aD09PTApcmV0dXJuIGIuZXh0ZW5kKHt9LHRoaXMub3B0aW9ucyk7aWYodHlwZW9mIGE9PT0ic3RyaW5nIil7aWYoYz09PWopcmV0dXJuIHRoaXMub3B0aW9uc1thXTtkPXt9O2RbYV09Y310aGlzLl9zZXRPcHRpb25zKGQpO3JldHVybiB0aGlzfSxfc2V0T3B0aW9uczpmdW5jdGlvbihhKXt2YXIgYz10aGlzO2IuZWFjaChhLGZ1bmN0aW9uKGQsZSl7Yy5fc2V0T3B0aW9uKGQsZSl9KTtyZXR1cm4gdGhpc30sX3NldE9wdGlvbjpmdW5jdGlvbihhLGMpe3RoaXMub3B0aW9uc1thXT1jO2lmKGE9PT0iZGlzYWJsZWQiKXRoaXMud2lkZ2V0KClbYz8iYWRkQ2xhc3MiOiJyZW1vdmVDbGFzcyJdKHRoaXMud2lkZ2V0QmFzZUNsYXNzKyItZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIixjKTtyZXR1cm4gdGhpc30sCmVuYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zZXRPcHRpb24oImRpc2FibGVkIixmYWxzZSl9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2V0T3B0aW9uKCJkaXNhYmxlZCIsdHJ1ZSl9LF90cmlnZ2VyOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZT10aGlzLm9wdGlvbnNbYV07Yz1iLkV2ZW50KGMpO2MudHlwZT0oYT09PXRoaXMud2lkZ2V0RXZlbnRQcmVmaXg/YTp0aGlzLndpZGdldEV2ZW50UHJlZml4K2EpLnRvTG93ZXJDYXNlKCk7ZD1kfHx7fTtpZihjLm9yaWdpbmFsRXZlbnQpe2E9Yi5ldmVudC5wcm9wcy5sZW5ndGg7Zm9yKHZhciBmO2E7KXtmPWIuZXZlbnQucHJvcHNbLS1hXTtjW2ZdPWMub3JpZ2luYWxFdmVudFtmXX19dGhpcy5lbGVtZW50LnRyaWdnZXIoYyxkKTtyZXR1cm4hKGIuaXNGdW5jdGlvbihlKSYmZS5jYWxsKHRoaXMuZWxlbWVudFswXSxjLGQpPT09ZmFsc2V8fGMuaXNEZWZhdWx0UHJldmVudGVkKCkpfX19KShqUXVlcnkpOwo7LyohCiAqIGpRdWVyeSBVSSBNb3VzZSAxLjguNgogKgogKiBDb3B5cmlnaHQgMjAxMCwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLgogKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCiAqCiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvTW91c2UKICoKICogRGVwZW5kczoKICoJanF1ZXJ5LnVpLndpZGdldC5qcwogKi8KKGZ1bmN0aW9uKGMpe2Mud2lkZ2V0KCJ1aS5tb3VzZSIse29wdGlvbnM6e2NhbmNlbDoiOmlucHV0LG9wdGlvbiIsZGlzdGFuY2U6MSxkZWxheTowfSxfbW91c2VJbml0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpczt0aGlzLmVsZW1lbnQuYmluZCgibW91c2Vkb3duLiIrdGhpcy53aWRnZXROYW1lLGZ1bmN0aW9uKGIpe3JldHVybiBhLl9tb3VzZURvd24oYil9KS5iaW5kKCJjbGljay4iK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbihiKXtpZihhLl9wcmV2ZW50Q2xpY2tFdmVudCl7YS5fcHJldmVudENsaWNrRXZlbnQ9ZmFsc2U7Yi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtyZXR1cm4gZmFsc2V9fSk7dGhpcy5zdGFydGVkPWZhbHNlfSxfbW91c2VEZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnVuYmluZCgiLiIrdGhpcy53aWRnZXROYW1lKX0sX21vdXNlRG93bjpmdW5jdGlvbihhKXthLm9yaWdpbmFsRXZlbnQ9YS5vcmlnaW5hbEV2ZW50fHx7fTtpZighYS5vcmlnaW5hbEV2ZW50Lm1vdXNlSGFuZGxlZCl7dGhpcy5fbW91c2VTdGFydGVkJiYKdGhpcy5fbW91c2VVcChhKTt0aGlzLl9tb3VzZURvd25FdmVudD1hO3ZhciBiPXRoaXMsZT1hLndoaWNoPT0xLGY9dHlwZW9mIHRoaXMub3B0aW9ucy5jYW5jZWw9PSJzdHJpbmciP2MoYS50YXJnZXQpLnBhcmVudHMoKS5hZGQoYS50YXJnZXQpLmZpbHRlcih0aGlzLm9wdGlvbnMuY2FuY2VsKS5sZW5ndGg6ZmFsc2U7aWYoIWV8fGZ8fCF0aGlzLl9tb3VzZUNhcHR1cmUoYSkpcmV0dXJuIHRydWU7dGhpcy5tb3VzZURlbGF5TWV0PSF0aGlzLm9wdGlvbnMuZGVsYXk7aWYoIXRoaXMubW91c2VEZWxheU1ldCl0aGlzLl9tb3VzZURlbGF5VGltZXI9c2V0VGltZW91dChmdW5jdGlvbigpe2IubW91c2VEZWxheU1ldD10cnVlfSx0aGlzLm9wdGlvbnMuZGVsYXkpO2lmKHRoaXMuX21vdXNlRGlzdGFuY2VNZXQoYSkmJnRoaXMuX21vdXNlRGVsYXlNZXQoYSkpe3RoaXMuX21vdXNlU3RhcnRlZD10aGlzLl9tb3VzZVN0YXJ0KGEpIT09ZmFsc2U7aWYoIXRoaXMuX21vdXNlU3RhcnRlZCl7YS5wcmV2ZW50RGVmYXVsdCgpOwpyZXR1cm4gdHJ1ZX19dGhpcy5fbW91c2VNb3ZlRGVsZWdhdGU9ZnVuY3Rpb24oZCl7cmV0dXJuIGIuX21vdXNlTW92ZShkKX07dGhpcy5fbW91c2VVcERlbGVnYXRlPWZ1bmN0aW9uKGQpe3JldHVybiBiLl9tb3VzZVVwKGQpfTtjKGRvY3VtZW50KS5iaW5kKCJtb3VzZW1vdmUuIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUpLmJpbmQoIm1vdXNldXAuIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VVcERlbGVnYXRlKTthLnByZXZlbnREZWZhdWx0KCk7cmV0dXJuIGEub3JpZ2luYWxFdmVudC5tb3VzZUhhbmRsZWQ9dHJ1ZX19LF9tb3VzZU1vdmU6ZnVuY3Rpb24oYSl7aWYoYy5icm93c2VyLm1zaWUmJiEoZG9jdW1lbnQuZG9jdW1lbnRNb2RlPj05KSYmIWEuYnV0dG9uKXJldHVybiB0aGlzLl9tb3VzZVVwKGEpO2lmKHRoaXMuX21vdXNlU3RhcnRlZCl7dGhpcy5fbW91c2VEcmFnKGEpO3JldHVybiBhLnByZXZlbnREZWZhdWx0KCl9aWYodGhpcy5fbW91c2VEaXN0YW5jZU1ldChhKSYmCnRoaXMuX21vdXNlRGVsYXlNZXQoYSkpKHRoaXMuX21vdXNlU3RhcnRlZD10aGlzLl9tb3VzZVN0YXJ0KHRoaXMuX21vdXNlRG93bkV2ZW50LGEpIT09ZmFsc2UpP3RoaXMuX21vdXNlRHJhZyhhKTp0aGlzLl9tb3VzZVVwKGEpO3JldHVybiF0aGlzLl9tb3VzZVN0YXJ0ZWR9LF9tb3VzZVVwOmZ1bmN0aW9uKGEpe2MoZG9jdW1lbnQpLnVuYmluZCgibW91c2Vtb3ZlLiIrdGhpcy53aWRnZXROYW1lLHRoaXMuX21vdXNlTW92ZURlbGVnYXRlKS51bmJpbmQoIm1vdXNldXAuIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VVcERlbGVnYXRlKTtpZih0aGlzLl9tb3VzZVN0YXJ0ZWQpe3RoaXMuX21vdXNlU3RhcnRlZD1mYWxzZTt0aGlzLl9wcmV2ZW50Q2xpY2tFdmVudD1hLnRhcmdldD09dGhpcy5fbW91c2VEb3duRXZlbnQudGFyZ2V0O3RoaXMuX21vdXNlU3RvcChhKX1yZXR1cm4gZmFsc2V9LF9tb3VzZURpc3RhbmNlTWV0OmZ1bmN0aW9uKGEpe3JldHVybiBNYXRoLm1heChNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWC0KYS5wYWdlWCksTWF0aC5hYnModGhpcy5fbW91c2VEb3duRXZlbnQucGFnZVktYS5wYWdlWSkpPj10aGlzLm9wdGlvbnMuZGlzdGFuY2V9LF9tb3VzZURlbGF5TWV0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW91c2VEZWxheU1ldH0sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oKXt9LF9tb3VzZURyYWc6ZnVuY3Rpb24oKXt9LF9tb3VzZVN0b3A6ZnVuY3Rpb24oKXt9LF9tb3VzZUNhcHR1cmU6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZX19KX0pKGpRdWVyeSk7CjsvKgogKiBqUXVlcnkgVUkgRHJhZ2dhYmxlIDEuOC42CiAqCiAqIENvcHlyaWdodCAyMDEwLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dCkKICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIG9yIEdQTCBWZXJzaW9uIDIgbGljZW5zZXMuCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UKICoKICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9EcmFnZ2FibGVzCiAqCiAqIERlcGVuZHM6CiAqCWpxdWVyeS51aS5jb3JlLmpzCiAqCWpxdWVyeS51aS5tb3VzZS5qcwogKglqcXVlcnkudWkud2lkZ2V0LmpzCiAqLwooZnVuY3Rpb24oZCl7ZC53aWRnZXQoInVpLmRyYWdnYWJsZSIsZC51aS5tb3VzZSx7d2lkZ2V0RXZlbnRQcmVmaXg6ImRyYWciLG9wdGlvbnM6e2FkZENsYXNzZXM6dHJ1ZSxhcHBlbmRUbzoicGFyZW50IixheGlzOmZhbHNlLGNvbm5lY3RUb1NvcnRhYmxlOmZhbHNlLGNvbnRhaW5tZW50OmZhbHNlLGN1cnNvcjoiYXV0byIsY3Vyc29yQXQ6ZmFsc2UsZ3JpZDpmYWxzZSxoYW5kbGU6ZmFsc2UsaGVscGVyOiJvcmlnaW5hbCIsaWZyYW1lRml4OmZhbHNlLG9wYWNpdHk6ZmFsc2UscmVmcmVzaFBvc2l0aW9uczpmYWxzZSxyZXZlcnQ6ZmFsc2UscmV2ZXJ0RHVyYXRpb246NTAwLHNjb3BlOiJkZWZhdWx0IixzY3JvbGw6dHJ1ZSxzY3JvbGxTZW5zaXRpdml0eToyMCxzY3JvbGxTcGVlZDoyMCxzbmFwOmZhbHNlLHNuYXBNb2RlOiJib3RoIixzbmFwVG9sZXJhbmNlOjIwLHN0YWNrOmZhbHNlLHpJbmRleDpmYWxzZX0sX2NyZWF0ZTpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5oZWxwZXI9PQoib3JpZ2luYWwiJiYhL14oPzpyfGF8ZikvLnRlc3QodGhpcy5lbGVtZW50LmNzcygicG9zaXRpb24iKSkpdGhpcy5lbGVtZW50WzBdLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSI7dGhpcy5vcHRpb25zLmFkZENsYXNzZXMmJnRoaXMuZWxlbWVudC5hZGRDbGFzcygidWktZHJhZ2dhYmxlIik7dGhpcy5vcHRpb25zLmRpc2FibGVkJiZ0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoInVpLWRyYWdnYWJsZS1kaXNhYmxlZCIpO3RoaXMuX21vdXNlSW5pdCgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtZW50LmRhdGEoImRyYWdnYWJsZSIpKXt0aGlzLmVsZW1lbnQucmVtb3ZlRGF0YSgiZHJhZ2dhYmxlIikudW5iaW5kKCIuZHJhZ2dhYmxlIikucmVtb3ZlQ2xhc3MoInVpLWRyYWdnYWJsZSB1aS1kcmFnZ2FibGUtZHJhZ2dpbmcgdWktZHJhZ2dhYmxlLWRpc2FibGVkIik7dGhpcy5fbW91c2VEZXN0cm95KCk7cmV0dXJuIHRoaXN9fSxfbW91c2VDYXB0dXJlOmZ1bmN0aW9uKGEpe3ZhciBiPQp0aGlzLm9wdGlvbnM7aWYodGhpcy5oZWxwZXJ8fGIuZGlzYWJsZWR8fGQoYS50YXJnZXQpLmlzKCIudWktcmVzaXphYmxlLWhhbmRsZSIpKXJldHVybiBmYWxzZTt0aGlzLmhhbmRsZT10aGlzLl9nZXRIYW5kbGUoYSk7aWYoIXRoaXMuaGFuZGxlKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZX0sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zO3RoaXMuaGVscGVyPXRoaXMuX2NyZWF0ZUhlbHBlcihhKTt0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7aWYoZC51aS5kZG1hbmFnZXIpZC51aS5kZG1hbmFnZXIuY3VycmVudD10aGlzO3RoaXMuX2NhY2hlTWFyZ2lucygpO3RoaXMuY3NzUG9zaXRpb249dGhpcy5oZWxwZXIuY3NzKCJwb3NpdGlvbiIpO3RoaXMuc2Nyb2xsUGFyZW50PXRoaXMuaGVscGVyLnNjcm9sbFBhcmVudCgpO3RoaXMub2Zmc2V0PXRoaXMucG9zaXRpb25BYnM9dGhpcy5lbGVtZW50Lm9mZnNldCgpO3RoaXMub2Zmc2V0PXt0b3A6dGhpcy5vZmZzZXQudG9wLQp0aGlzLm1hcmdpbnMudG9wLGxlZnQ6dGhpcy5vZmZzZXQubGVmdC10aGlzLm1hcmdpbnMubGVmdH07ZC5leHRlbmQodGhpcy5vZmZzZXQse2NsaWNrOntsZWZ0OmEucGFnZVgtdGhpcy5vZmZzZXQubGVmdCx0b3A6YS5wYWdlWS10aGlzLm9mZnNldC50b3B9LHBhcmVudDp0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSxyZWxhdGl2ZTp0aGlzLl9nZXRSZWxhdGl2ZU9mZnNldCgpfSk7dGhpcy5vcmlnaW5hbFBvc2l0aW9uPXRoaXMucG9zaXRpb249dGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihhKTt0aGlzLm9yaWdpbmFsUGFnZVg9YS5wYWdlWDt0aGlzLm9yaWdpbmFsUGFnZVk9YS5wYWdlWTtiLmN1cnNvckF0JiZ0aGlzLl9hZGp1c3RPZmZzZXRGcm9tSGVscGVyKGIuY3Vyc29yQXQpO2IuY29udGFpbm1lbnQmJnRoaXMuX3NldENvbnRhaW5tZW50KCk7aWYodGhpcy5fdHJpZ2dlcigic3RhcnQiLGEpPT09ZmFsc2Upe3RoaXMuX2NsZWFyKCk7cmV0dXJuIGZhbHNlfXRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTsKZC51aS5kZG1hbmFnZXImJiFiLmRyb3BCZWhhdmlvdXImJmQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKHRoaXMsYSk7dGhpcy5oZWxwZXIuYWRkQ2xhc3MoInVpLWRyYWdnYWJsZS1kcmFnZ2luZyIpO3RoaXMuX21vdXNlRHJhZyhhLHRydWUpO3JldHVybiB0cnVlfSxfbW91c2VEcmFnOmZ1bmN0aW9uKGEsYil7dGhpcy5wb3NpdGlvbj10aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKGEpO3RoaXMucG9zaXRpb25BYnM9dGhpcy5fY29udmVydFBvc2l0aW9uVG8oImFic29sdXRlIik7aWYoIWIpe2I9dGhpcy5fdWlIYXNoKCk7aWYodGhpcy5fdHJpZ2dlcigiZHJhZyIsYSxiKT09PWZhbHNlKXt0aGlzLl9tb3VzZVVwKHt9KTtyZXR1cm4gZmFsc2V9dGhpcy5wb3NpdGlvbj1iLnBvc2l0aW9ufWlmKCF0aGlzLm9wdGlvbnMuYXhpc3x8dGhpcy5vcHRpb25zLmF4aXMhPSJ5Iil0aGlzLmhlbHBlclswXS5zdHlsZS5sZWZ0PXRoaXMucG9zaXRpb24ubGVmdCsicHgiO2lmKCF0aGlzLm9wdGlvbnMuYXhpc3x8CnRoaXMub3B0aW9ucy5heGlzIT0ieCIpdGhpcy5oZWxwZXJbMF0uc3R5bGUudG9wPXRoaXMucG9zaXRpb24udG9wKyJweCI7ZC51aS5kZG1hbmFnZXImJmQudWkuZGRtYW5hZ2VyLmRyYWcodGhpcyxhKTtyZXR1cm4gZmFsc2V9LF9tb3VzZVN0b3A6ZnVuY3Rpb24oYSl7dmFyIGI9ZmFsc2U7aWYoZC51aS5kZG1hbmFnZXImJiF0aGlzLm9wdGlvbnMuZHJvcEJlaGF2aW91ciliPWQudWkuZGRtYW5hZ2VyLmRyb3AodGhpcyxhKTtpZih0aGlzLmRyb3BwZWQpe2I9dGhpcy5kcm9wcGVkO3RoaXMuZHJvcHBlZD1mYWxzZX1pZighdGhpcy5lbGVtZW50WzBdfHwhdGhpcy5lbGVtZW50WzBdLnBhcmVudE5vZGUpcmV0dXJuIGZhbHNlO2lmKHRoaXMub3B0aW9ucy5yZXZlcnQ9PSJpbnZhbGlkIiYmIWJ8fHRoaXMub3B0aW9ucy5yZXZlcnQ9PSJ2YWxpZCImJmJ8fHRoaXMub3B0aW9ucy5yZXZlcnQ9PT10cnVlfHxkLmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLnJldmVydCkmJnRoaXMub3B0aW9ucy5yZXZlcnQuY2FsbCh0aGlzLmVsZW1lbnQsCmIpKXt2YXIgYz10aGlzO2QodGhpcy5oZWxwZXIpLmFuaW1hdGUodGhpcy5vcmlnaW5hbFBvc2l0aW9uLHBhcnNlSW50KHRoaXMub3B0aW9ucy5yZXZlcnREdXJhdGlvbiwxMCksZnVuY3Rpb24oKXtjLl90cmlnZ2VyKCJzdG9wIixhKSE9PWZhbHNlJiZjLl9jbGVhcigpfSl9ZWxzZSB0aGlzLl90cmlnZ2VyKCJzdG9wIixhKSE9PWZhbHNlJiZ0aGlzLl9jbGVhcigpO3JldHVybiBmYWxzZX0sY2FuY2VsOmZ1bmN0aW9uKCl7dGhpcy5oZWxwZXIuaXMoIi51aS1kcmFnZ2FibGUtZHJhZ2dpbmciKT90aGlzLl9tb3VzZVVwKHt9KTp0aGlzLl9jbGVhcigpO3JldHVybiB0aGlzfSxfZ2V0SGFuZGxlOmZ1bmN0aW9uKGEpe3ZhciBiPSF0aGlzLm9wdGlvbnMuaGFuZGxlfHwhZCh0aGlzLm9wdGlvbnMuaGFuZGxlLHRoaXMuZWxlbWVudCkubGVuZ3RoP3RydWU6ZmFsc2U7ZCh0aGlzLm9wdGlvbnMuaGFuZGxlLHRoaXMuZWxlbWVudCkuZmluZCgiKiIpLmFuZFNlbGYoKS5lYWNoKGZ1bmN0aW9uKCl7aWYodGhpcz09CmEudGFyZ2V0KWI9dHJ1ZX0pO3JldHVybiBifSxfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9uczthPWQuaXNGdW5jdGlvbihiLmhlbHBlcik/ZChiLmhlbHBlci5hcHBseSh0aGlzLmVsZW1lbnRbMF0sW2FdKSk6Yi5oZWxwZXI9PSJjbG9uZSI/dGhpcy5lbGVtZW50LmNsb25lKCk6dGhpcy5lbGVtZW50O2EucGFyZW50cygiYm9keSIpLmxlbmd0aHx8YS5hcHBlbmRUbyhiLmFwcGVuZFRvPT0icGFyZW50Ij90aGlzLmVsZW1lbnRbMF0ucGFyZW50Tm9kZTpiLmFwcGVuZFRvKTthWzBdIT10aGlzLmVsZW1lbnRbMF0mJiEvKGZpeGVkfGFic29sdXRlKS8udGVzdChhLmNzcygicG9zaXRpb24iKSkmJmEuY3NzKCJwb3NpdGlvbiIsImFic29sdXRlIik7cmV0dXJuIGF9LF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOmZ1bmN0aW9uKGEpe2lmKHR5cGVvZiBhPT0ic3RyaW5nIilhPWEuc3BsaXQoIiAiKTtpZihkLmlzQXJyYXkoYSkpYT17bGVmdDorYVswXSx0b3A6K2FbMV18fAowfTtpZigibGVmdCJpbiBhKXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ9YS5sZWZ0K3RoaXMubWFyZ2lucy5sZWZ0O2lmKCJyaWdodCJpbiBhKXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ9dGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC1hLnJpZ2h0K3RoaXMubWFyZ2lucy5sZWZ0O2lmKCJ0b3AiaW4gYSl0aGlzLm9mZnNldC5jbGljay50b3A9YS50b3ArdGhpcy5tYXJnaW5zLnRvcDtpZigiYm90dG9tImluIGEpdGhpcy5vZmZzZXQuY2xpY2sudG9wPXRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LWEuYm90dG9tK3RoaXMubWFyZ2lucy50b3B9LF9nZXRQYXJlbnRPZmZzZXQ6ZnVuY3Rpb24oKXt0aGlzLm9mZnNldFBhcmVudD10aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKTt2YXIgYT10aGlzLm9mZnNldFBhcmVudC5vZmZzZXQoKTtpZih0aGlzLmNzc1Bvc2l0aW9uPT0iYWJzb2x1dGUiJiZ0aGlzLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmQudWkuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sCnRoaXMub2Zmc2V0UGFyZW50WzBdKSl7YS5sZWZ0Kz10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCk7YS50b3ArPXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpfWlmKHRoaXMub2Zmc2V0UGFyZW50WzBdPT1kb2N1bWVudC5ib2R5fHx0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lJiZ0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lLnRvTG93ZXJDYXNlKCk9PSJodG1sIiYmZC5icm93c2VyLm1zaWUpYT17dG9wOjAsbGVmdDowfTtyZXR1cm57dG9wOmEudG9wKyhwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoImJvcmRlclRvcFdpZHRoIiksMTApfHwwKSxsZWZ0OmEubGVmdCsocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDApfX0sX2dldFJlbGF0aXZlT2Zmc2V0OmZ1bmN0aW9uKCl7aWYodGhpcy5jc3NQb3NpdGlvbj09InJlbGF0aXZlIil7dmFyIGE9dGhpcy5lbGVtZW50LnBvc2l0aW9uKCk7cmV0dXJue3RvcDphLnRvcC0KKHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcygidG9wIiksMTApfHwwKSt0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSxsZWZ0OmEubGVmdC0ocGFyc2VJbnQodGhpcy5oZWxwZXIuY3NzKCJsZWZ0IiksMTApfHwwKSt0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCl9fWVsc2UgcmV0dXJue3RvcDowLGxlZnQ6MH19LF9jYWNoZU1hcmdpbnM6ZnVuY3Rpb24oKXt0aGlzLm1hcmdpbnM9e2xlZnQ6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcygibWFyZ2luTGVmdCIpLDEwKXx8MCx0b3A6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcygibWFyZ2luVG9wIiksMTApfHwwfX0sX2NhY2hlSGVscGVyUHJvcG9ydGlvbnM6ZnVuY3Rpb24oKXt0aGlzLmhlbHBlclByb3BvcnRpb25zPXt3aWR0aDp0aGlzLmhlbHBlci5vdXRlcldpZHRoKCksaGVpZ2h0OnRoaXMuaGVscGVyLm91dGVySGVpZ2h0KCl9fSxfc2V0Q29udGFpbm1lbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnM7aWYoYS5jb250YWlubWVudD09CiJwYXJlbnQiKWEuY29udGFpbm1lbnQ9dGhpcy5oZWxwZXJbMF0ucGFyZW50Tm9kZTtpZihhLmNvbnRhaW5tZW50PT0iZG9jdW1lbnQifHxhLmNvbnRhaW5tZW50PT0id2luZG93Iil0aGlzLmNvbnRhaW5tZW50PVswLXRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQtdGhpcy5vZmZzZXQucGFyZW50LmxlZnQsMC10aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AtdGhpcy5vZmZzZXQucGFyZW50LnRvcCxkKGEuY29udGFpbm1lbnQ9PSJkb2N1bWVudCI/ZG9jdW1lbnQ6d2luZG93KS53aWR0aCgpLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtdGhpcy5tYXJnaW5zLmxlZnQsKGQoYS5jb250YWlubWVudD09ImRvY3VtZW50Ij9kb2N1bWVudDp3aW5kb3cpLmhlaWdodCgpfHxkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0KS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wXTtpZighL14oZG9jdW1lbnR8d2luZG93fHBhcmVudCkkLy50ZXN0KGEuY29udGFpbm1lbnQpJiYKYS5jb250YWlubWVudC5jb25zdHJ1Y3RvciE9QXJyYXkpe3ZhciBiPWQoYS5jb250YWlubWVudClbMF07aWYoYil7YT1kKGEuY29udGFpbm1lbnQpLm9mZnNldCgpO3ZhciBjPWQoYikuY3NzKCJvdmVyZmxvdyIpIT0iaGlkZGVuIjt0aGlzLmNvbnRhaW5tZW50PVthLmxlZnQrKHBhcnNlSW50KGQoYikuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDApKyhwYXJzZUludChkKGIpLmNzcygicGFkZGluZ0xlZnQiKSwxMCl8fDApLXRoaXMubWFyZ2lucy5sZWZ0LGEudG9wKyhwYXJzZUludChkKGIpLmNzcygiYm9yZGVyVG9wV2lkdGgiKSwxMCl8fDApKyhwYXJzZUludChkKGIpLmNzcygicGFkZGluZ1RvcCIpLDEwKXx8MCktdGhpcy5tYXJnaW5zLnRvcCxhLmxlZnQrKGM/TWF0aC5tYXgoYi5zY3JvbGxXaWR0aCxiLm9mZnNldFdpZHRoKTpiLm9mZnNldFdpZHRoKS0ocGFyc2VJbnQoZChiKS5jc3MoImJvcmRlckxlZnRXaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KGQoYikuY3NzKCJwYWRkaW5nUmlnaHQiKSwKMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLXRoaXMubWFyZ2lucy5sZWZ0LGEudG9wKyhjP01hdGgubWF4KGIuc2Nyb2xsSGVpZ2h0LGIub2Zmc2V0SGVpZ2h0KTpiLm9mZnNldEhlaWdodCktKHBhcnNlSW50KGQoYikuY3NzKCJib3JkZXJUb3BXaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KGQoYikuY3NzKCJwYWRkaW5nQm90dG9tIiksMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wXX19ZWxzZSBpZihhLmNvbnRhaW5tZW50LmNvbnN0cnVjdG9yPT1BcnJheSl0aGlzLmNvbnRhaW5tZW50PWEuY29udGFpbm1lbnR9LF9jb252ZXJ0UG9zaXRpb25UbzpmdW5jdGlvbihhLGIpe2lmKCFiKWI9dGhpcy5wb3NpdGlvbjthPWE9PSJhYnNvbHV0ZSI/MTotMTt2YXIgYz10aGlzLmNzc1Bvc2l0aW9uPT0iYWJzb2x1dGUiJiYhKHRoaXMuc2Nyb2xsUGFyZW50WzBdIT1kb2N1bWVudCYmZC51aS5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSwKdGhpcy5vZmZzZXRQYXJlbnRbMF0pKT90aGlzLm9mZnNldFBhcmVudDp0aGlzLnNjcm9sbFBhcmVudCxmPS8oaHRtbHxib2R5KS9pLnRlc3QoY1swXS50YWdOYW1lKTtyZXR1cm57dG9wOmIudG9wK3RoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCphK3RoaXMub2Zmc2V0LnBhcmVudC50b3AqYS0oZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT0iZml4ZWQiPzA6KHRoaXMuY3NzUG9zaXRpb249PSJmaXhlZCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpOmY/MDpjLnNjcm9sbFRvcCgpKSphKSxsZWZ0OmIubGVmdCt0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0KmErdGhpcy5vZmZzZXQucGFyZW50LmxlZnQqYS0oZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT0iZml4ZWQiPzA6KHRoaXMuY3NzUG9zaXRpb249PSJmaXhlZCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKToKZj8wOmMuc2Nyb2xsTGVmdCgpKSphKX19LF9nZW5lcmF0ZVBvc2l0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPXRoaXMuY3NzUG9zaXRpb249PSJhYnNvbHV0ZSImJiEodGhpcy5zY3JvbGxQYXJlbnRbMF0hPWRvY3VtZW50JiZkLnVpLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLHRoaXMub2Zmc2V0UGFyZW50WzBdKSk/dGhpcy5vZmZzZXRQYXJlbnQ6dGhpcy5zY3JvbGxQYXJlbnQsZj0vKGh0bWx8Ym9keSkvaS50ZXN0KGNbMF0udGFnTmFtZSksZT1hLnBhZ2VYLGc9YS5wYWdlWTtpZih0aGlzLm9yaWdpbmFsUG9zaXRpb24pe2lmKHRoaXMuY29udGFpbm1lbnQpe2lmKGEucGFnZVgtdGhpcy5vZmZzZXQuY2xpY2subGVmdDx0aGlzLmNvbnRhaW5tZW50WzBdKWU9dGhpcy5jb250YWlubWVudFswXSt0aGlzLm9mZnNldC5jbGljay5sZWZ0O2lmKGEucGFnZVktdGhpcy5vZmZzZXQuY2xpY2sudG9wPHRoaXMuY29udGFpbm1lbnRbMV0pZz10aGlzLmNvbnRhaW5tZW50WzFdKwp0aGlzLm9mZnNldC5jbGljay50b3A7aWYoYS5wYWdlWC10aGlzLm9mZnNldC5jbGljay5sZWZ0PnRoaXMuY29udGFpbm1lbnRbMl0pZT10aGlzLmNvbnRhaW5tZW50WzJdK3RoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7aWYoYS5wYWdlWS10aGlzLm9mZnNldC5jbGljay50b3A+dGhpcy5jb250YWlubWVudFszXSlnPXRoaXMuY29udGFpbm1lbnRbM10rdGhpcy5vZmZzZXQuY2xpY2sudG9wfWlmKGIuZ3JpZCl7Zz10aGlzLm9yaWdpbmFsUGFnZVkrTWF0aC5yb3VuZCgoZy10aGlzLm9yaWdpbmFsUGFnZVkpL2IuZ3JpZFsxXSkqYi5ncmlkWzFdO2c9dGhpcy5jb250YWlubWVudD8hKGctdGhpcy5vZmZzZXQuY2xpY2sudG9wPHRoaXMuY29udGFpbm1lbnRbMV18fGctdGhpcy5vZmZzZXQuY2xpY2sudG9wPnRoaXMuY29udGFpbm1lbnRbM10pP2c6IShnLXRoaXMub2Zmc2V0LmNsaWNrLnRvcDx0aGlzLmNvbnRhaW5tZW50WzFdKT9nLWIuZ3JpZFsxXTpnK2IuZ3JpZFsxXTpnO2U9dGhpcy5vcmlnaW5hbFBhZ2VYKwpNYXRoLnJvdW5kKChlLXRoaXMub3JpZ2luYWxQYWdlWCkvYi5ncmlkWzBdKSpiLmdyaWRbMF07ZT10aGlzLmNvbnRhaW5tZW50PyEoZS10aGlzLm9mZnNldC5jbGljay5sZWZ0PHRoaXMuY29udGFpbm1lbnRbMF18fGUtdGhpcy5vZmZzZXQuY2xpY2subGVmdD50aGlzLmNvbnRhaW5tZW50WzJdKT9lOiEoZS10aGlzLm9mZnNldC5jbGljay5sZWZ0PHRoaXMuY29udGFpbm1lbnRbMF0pP2UtYi5ncmlkWzBdOmUrYi5ncmlkWzBdOmV9fXJldHVybnt0b3A6Zy10aGlzLm9mZnNldC5jbGljay50b3AtdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wLXRoaXMub2Zmc2V0LnBhcmVudC50b3ArKGQuYnJvd3Nlci5zYWZhcmkmJmQuYnJvd3Nlci52ZXJzaW9uPDUyNiYmdGhpcy5jc3NQb3NpdGlvbj09ImZpeGVkIj8wOnRoaXMuY3NzUG9zaXRpb249PSJmaXhlZCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpOmY/MDpjLnNjcm9sbFRvcCgpKSxsZWZ0OmUtdGhpcy5vZmZzZXQuY2xpY2subGVmdC0KdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdCsoZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT0iZml4ZWQiPzA6dGhpcy5jc3NQb3NpdGlvbj09ImZpeGVkIj8tdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpOmY/MDpjLnNjcm9sbExlZnQoKSl9fSxfY2xlYXI6ZnVuY3Rpb24oKXt0aGlzLmhlbHBlci5yZW1vdmVDbGFzcygidWktZHJhZ2dhYmxlLWRyYWdnaW5nIik7dGhpcy5oZWxwZXJbMF0hPXRoaXMuZWxlbWVudFswXSYmIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCYmdGhpcy5oZWxwZXIucmVtb3ZlKCk7dGhpcy5oZWxwZXI9bnVsbDt0aGlzLmNhbmNlbEhlbHBlclJlbW92YWw9ZmFsc2V9LF90cmlnZ2VyOmZ1bmN0aW9uKGEsYixjKXtjPWN8fHRoaXMuX3VpSGFzaCgpO2QudWkucGx1Z2luLmNhbGwodGhpcyxhLFtiLGNdKTtpZihhPT0iZHJhZyIpdGhpcy5wb3NpdGlvbkFicz0KdGhpcy5fY29udmVydFBvc2l0aW9uVG8oImFic29sdXRlIik7cmV0dXJuIGQuV2lkZ2V0LnByb3RvdHlwZS5fdHJpZ2dlci5jYWxsKHRoaXMsYSxiLGMpfSxwbHVnaW5zOnt9LF91aUhhc2g6ZnVuY3Rpb24oKXtyZXR1cm57aGVscGVyOnRoaXMuaGVscGVyLHBvc2l0aW9uOnRoaXMucG9zaXRpb24sb3JpZ2luYWxQb3NpdGlvbjp0aGlzLm9yaWdpbmFsUG9zaXRpb24sb2Zmc2V0OnRoaXMucG9zaXRpb25BYnN9fX0pO2QuZXh0ZW5kKGQudWkuZHJhZ2dhYmxlLHt2ZXJzaW9uOiIxLjguNiJ9KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsImNvbm5lY3RUb1NvcnRhYmxlIix7c3RhcnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLGY9Yy5vcHRpb25zLGU9ZC5leHRlbmQoe30sYix7aXRlbTpjLmVsZW1lbnR9KTtjLnNvcnRhYmxlcz1bXTtkKGYuY29ubmVjdFRvU29ydGFibGUpLmVhY2goZnVuY3Rpb24oKXt2YXIgZz1kLmRhdGEodGhpcywic29ydGFibGUiKTsKaWYoZyYmIWcub3B0aW9ucy5kaXNhYmxlZCl7Yy5zb3J0YWJsZXMucHVzaCh7aW5zdGFuY2U6ZyxzaG91bGRSZXZlcnQ6Zy5vcHRpb25zLnJldmVydH0pO2cuX3JlZnJlc2hJdGVtcygpO2cuX3RyaWdnZXIoImFjdGl2YXRlIixhLGUpfX0pfSxzdG9wOmZ1bmN0aW9uKGEsYil7dmFyIGM9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKSxmPWQuZXh0ZW5kKHt9LGIse2l0ZW06Yy5lbGVtZW50fSk7ZC5lYWNoKGMuc29ydGFibGVzLGZ1bmN0aW9uKCl7aWYodGhpcy5pbnN0YW5jZS5pc092ZXIpe3RoaXMuaW5zdGFuY2UuaXNPdmVyPTA7Yy5jYW5jZWxIZWxwZXJSZW1vdmFsPXRydWU7dGhpcy5pbnN0YW5jZS5jYW5jZWxIZWxwZXJSZW1vdmFsPWZhbHNlO2lmKHRoaXMuc2hvdWxkUmV2ZXJ0KXRoaXMuaW5zdGFuY2Uub3B0aW9ucy5yZXZlcnQ9dHJ1ZTt0aGlzLmluc3RhbmNlLl9tb3VzZVN0b3AoYSk7dGhpcy5pbnN0YW5jZS5vcHRpb25zLmhlbHBlcj10aGlzLmluc3RhbmNlLm9wdGlvbnMuX2hlbHBlcjsKYy5vcHRpb25zLmhlbHBlcj09Im9yaWdpbmFsIiYmdGhpcy5pbnN0YW5jZS5jdXJyZW50SXRlbS5jc3Moe3RvcDoiYXV0byIsbGVmdDoiYXV0byJ9KX1lbHNle3RoaXMuaW5zdGFuY2UuY2FuY2VsSGVscGVyUmVtb3ZhbD1mYWxzZTt0aGlzLmluc3RhbmNlLl90cmlnZ2VyKCJkZWFjdGl2YXRlIixhLGYpfX0pfSxkcmFnOmZ1bmN0aW9uKGEsYil7dmFyIGM9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKSxmPXRoaXM7ZC5lYWNoKGMuc29ydGFibGVzLGZ1bmN0aW9uKCl7dGhpcy5pbnN0YW5jZS5wb3NpdGlvbkFicz1jLnBvc2l0aW9uQWJzO3RoaXMuaW5zdGFuY2UuaGVscGVyUHJvcG9ydGlvbnM9Yy5oZWxwZXJQcm9wb3J0aW9uczt0aGlzLmluc3RhbmNlLm9mZnNldC5jbGljaz1jLm9mZnNldC5jbGljaztpZih0aGlzLmluc3RhbmNlLl9pbnRlcnNlY3RzV2l0aCh0aGlzLmluc3RhbmNlLmNvbnRhaW5lckNhY2hlKSl7aWYoIXRoaXMuaW5zdGFuY2UuaXNPdmVyKXt0aGlzLmluc3RhbmNlLmlzT3Zlcj0KMTt0aGlzLmluc3RhbmNlLmN1cnJlbnRJdGVtPWQoZikuY2xvbmUoKS5hcHBlbmRUbyh0aGlzLmluc3RhbmNlLmVsZW1lbnQpLmRhdGEoInNvcnRhYmxlLWl0ZW0iLHRydWUpO3RoaXMuaW5zdGFuY2Uub3B0aW9ucy5faGVscGVyPXRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oZWxwZXI7dGhpcy5pbnN0YW5jZS5vcHRpb25zLmhlbHBlcj1mdW5jdGlvbigpe3JldHVybiBiLmhlbHBlclswXX07YS50YXJnZXQ9dGhpcy5pbnN0YW5jZS5jdXJyZW50SXRlbVswXTt0aGlzLmluc3RhbmNlLl9tb3VzZUNhcHR1cmUoYSx0cnVlKTt0aGlzLmluc3RhbmNlLl9tb3VzZVN0YXJ0KGEsdHJ1ZSx0cnVlKTt0aGlzLmluc3RhbmNlLm9mZnNldC5jbGljay50b3A9Yy5vZmZzZXQuY2xpY2sudG9wO3RoaXMuaW5zdGFuY2Uub2Zmc2V0LmNsaWNrLmxlZnQ9Yy5vZmZzZXQuY2xpY2subGVmdDt0aGlzLmluc3RhbmNlLm9mZnNldC5wYXJlbnQubGVmdC09Yy5vZmZzZXQucGFyZW50LmxlZnQtdGhpcy5pbnN0YW5jZS5vZmZzZXQucGFyZW50LmxlZnQ7CnRoaXMuaW5zdGFuY2Uub2Zmc2V0LnBhcmVudC50b3AtPWMub2Zmc2V0LnBhcmVudC50b3AtdGhpcy5pbnN0YW5jZS5vZmZzZXQucGFyZW50LnRvcDtjLl90cmlnZ2VyKCJ0b1NvcnRhYmxlIixhKTtjLmRyb3BwZWQ9dGhpcy5pbnN0YW5jZS5lbGVtZW50O2MuY3VycmVudEl0ZW09Yy5lbGVtZW50O3RoaXMuaW5zdGFuY2UuZnJvbU91dHNpZGU9Y310aGlzLmluc3RhbmNlLmN1cnJlbnRJdGVtJiZ0aGlzLmluc3RhbmNlLl9tb3VzZURyYWcoYSl9ZWxzZSBpZih0aGlzLmluc3RhbmNlLmlzT3Zlcil7dGhpcy5pbnN0YW5jZS5pc092ZXI9MDt0aGlzLmluc3RhbmNlLmNhbmNlbEhlbHBlclJlbW92YWw9dHJ1ZTt0aGlzLmluc3RhbmNlLm9wdGlvbnMucmV2ZXJ0PWZhbHNlO3RoaXMuaW5zdGFuY2UuX3RyaWdnZXIoIm91dCIsYSx0aGlzLmluc3RhbmNlLl91aUhhc2godGhpcy5pbnN0YW5jZSkpO3RoaXMuaW5zdGFuY2UuX21vdXNlU3RvcChhLHRydWUpO3RoaXMuaW5zdGFuY2Uub3B0aW9ucy5oZWxwZXI9CnRoaXMuaW5zdGFuY2Uub3B0aW9ucy5faGVscGVyO3RoaXMuaW5zdGFuY2UuY3VycmVudEl0ZW0ucmVtb3ZlKCk7dGhpcy5pbnN0YW5jZS5wbGFjZWhvbGRlciYmdGhpcy5pbnN0YW5jZS5wbGFjZWhvbGRlci5yZW1vdmUoKTtjLl90cmlnZ2VyKCJmcm9tU29ydGFibGUiLGEpO2MuZHJvcHBlZD1mYWxzZX19KX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsImN1cnNvciIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCgiYm9keSIpLGI9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKS5vcHRpb25zO2lmKGEuY3NzKCJjdXJzb3IiKSliLl9jdXJzb3I9YS5jc3MoImN1cnNvciIpO2EuY3NzKCJjdXJzb3IiLGIuY3Vyc29yKX0sc3RvcDpmdW5jdGlvbigpe3ZhciBhPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIikub3B0aW9uczthLl9jdXJzb3ImJmQoImJvZHkiKS5jc3MoImN1cnNvciIsYS5fY3Vyc29yKX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsImlmcmFtZUZpeCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9CmQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIikub3B0aW9ucztkKGEuaWZyYW1lRml4PT09dHJ1ZT8iaWZyYW1lIjphLmlmcmFtZUZpeCkuZWFjaChmdW5jdGlvbigpe2QoJzxkaXYgY2xhc3M9InVpLWRyYWdnYWJsZS1pZnJhbWVGaXgiIHN0eWxlPSJiYWNrZ3JvdW5kOiAjZmZmOyI+PC9kaXY+JykuY3NzKHt3aWR0aDp0aGlzLm9mZnNldFdpZHRoKyJweCIsaGVpZ2h0OnRoaXMub2Zmc2V0SGVpZ2h0KyJweCIscG9zaXRpb246ImFic29sdXRlIixvcGFjaXR5OiIwLjAwMSIsekluZGV4OjFFM30pLmNzcyhkKHRoaXMpLm9mZnNldCgpKS5hcHBlbmRUbygiYm9keSIpfSl9LHN0b3A6ZnVuY3Rpb24oKXtkKCJkaXYudWktZHJhZ2dhYmxlLWlmcmFtZUZpeCIpLmVhY2goZnVuY3Rpb24oKXt0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyl9KX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsIm9wYWNpdHkiLHtzdGFydDpmdW5jdGlvbihhLGIpe2E9ZChiLmhlbHBlcik7Yj1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7CmlmKGEuY3NzKCJvcGFjaXR5IikpYi5fb3BhY2l0eT1hLmNzcygib3BhY2l0eSIpO2EuY3NzKCJvcGFjaXR5IixiLm9wYWNpdHkpfSxzdG9wOmZ1bmN0aW9uKGEsYil7YT1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7YS5fb3BhY2l0eSYmZChiLmhlbHBlcikuY3NzKCJvcGFjaXR5IixhLl9vcGFjaXR5KX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsInNjcm9sbCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKTtpZihhLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmEuc2Nyb2xsUGFyZW50WzBdLnRhZ05hbWUhPSJIVE1MIilhLm92ZXJmbG93T2Zmc2V0PWEuc2Nyb2xsUGFyZW50Lm9mZnNldCgpfSxkcmFnOmZ1bmN0aW9uKGEpe3ZhciBiPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIiksYz1iLm9wdGlvbnMsZj1mYWxzZTtpZihiLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmIuc2Nyb2xsUGFyZW50WzBdLnRhZ05hbWUhPQoiSFRNTCIpe2lmKCFjLmF4aXN8fGMuYXhpcyE9IngiKWlmKGIub3ZlcmZsb3dPZmZzZXQudG9wK2Iuc2Nyb2xsUGFyZW50WzBdLm9mZnNldEhlaWdodC1hLnBhZ2VZPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wPWY9Yi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wK2Muc2Nyb2xsU3BlZWQ7ZWxzZSBpZihhLnBhZ2VZLWIub3ZlcmZsb3dPZmZzZXQudG9wPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wPWY9Yi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wLWMuc2Nyb2xsU3BlZWQ7aWYoIWMuYXhpc3x8Yy5heGlzIT0ieSIpaWYoYi5vdmVyZmxvd09mZnNldC5sZWZ0K2Iuc2Nyb2xsUGFyZW50WzBdLm9mZnNldFdpZHRoLWEucGFnZVg8Yy5zY3JvbGxTZW5zaXRpdml0eSliLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0PWY9Yi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdCtjLnNjcm9sbFNwZWVkO2Vsc2UgaWYoYS5wYWdlWC0KYi5vdmVyZmxvd09mZnNldC5sZWZ0PGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdD1mPWIuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQtYy5zY3JvbGxTcGVlZH1lbHNle2lmKCFjLmF4aXN8fGMuYXhpcyE9IngiKWlmKGEucGFnZVktZChkb2N1bWVudCkuc2Nyb2xsVG9wKCk8Yy5zY3JvbGxTZW5zaXRpdml0eSlmPWQoZG9jdW1lbnQpLnNjcm9sbFRvcChkKGRvY3VtZW50KS5zY3JvbGxUb3AoKS1jLnNjcm9sbFNwZWVkKTtlbHNlIGlmKGQod2luZG93KS5oZWlnaHQoKS0oYS5wYWdlWS1kKGRvY3VtZW50KS5zY3JvbGxUb3AoKSk8Yy5zY3JvbGxTZW5zaXRpdml0eSlmPWQoZG9jdW1lbnQpLnNjcm9sbFRvcChkKGRvY3VtZW50KS5zY3JvbGxUb3AoKStjLnNjcm9sbFNwZWVkKTtpZighYy5heGlzfHxjLmF4aXMhPSJ5IilpZihhLnBhZ2VYLWQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKTxjLnNjcm9sbFNlbnNpdGl2aXR5KWY9ZChkb2N1bWVudCkuc2Nyb2xsTGVmdChkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCktCmMuc2Nyb2xsU3BlZWQpO2Vsc2UgaWYoZCh3aW5kb3cpLndpZHRoKCktKGEucGFnZVgtZChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpKTxjLnNjcm9sbFNlbnNpdGl2aXR5KWY9ZChkb2N1bWVudCkuc2Nyb2xsTGVmdChkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkrYy5zY3JvbGxTcGVlZCl9ZiE9PWZhbHNlJiZkLnVpLmRkbWFuYWdlciYmIWMuZHJvcEJlaGF2aW91ciYmZC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoYixhKX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsInNuYXAiLHtzdGFydDpmdW5jdGlvbigpe3ZhciBhPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIiksYj1hLm9wdGlvbnM7YS5zbmFwRWxlbWVudHM9W107ZChiLnNuYXAuY29uc3RydWN0b3IhPVN0cmluZz9iLnNuYXAuaXRlbXN8fCI6ZGF0YShkcmFnZ2FibGUpIjpiLnNuYXApLmVhY2goZnVuY3Rpb24oKXt2YXIgYz1kKHRoaXMpLGY9Yy5vZmZzZXQoKTt0aGlzIT1hLmVsZW1lbnRbMF0mJmEuc25hcEVsZW1lbnRzLnB1c2goe2l0ZW06dGhpcywKd2lkdGg6Yy5vdXRlcldpZHRoKCksaGVpZ2h0OmMub3V0ZXJIZWlnaHQoKSx0b3A6Zi50b3AsbGVmdDpmLmxlZnR9KX0pfSxkcmFnOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIiksZj1jLm9wdGlvbnMsZT1mLnNuYXBUb2xlcmFuY2UsZz1iLm9mZnNldC5sZWZ0LG49ZytjLmhlbHBlclByb3BvcnRpb25zLndpZHRoLG09Yi5vZmZzZXQudG9wLG89bStjLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxoPWMuc25hcEVsZW1lbnRzLmxlbmd0aC0xO2g+PTA7aC0tKXt2YXIgaT1jLnNuYXBFbGVtZW50c1toXS5sZWZ0LGs9aStjLnNuYXBFbGVtZW50c1toXS53aWR0aCxqPWMuc25hcEVsZW1lbnRzW2hdLnRvcCxsPWorYy5zbmFwRWxlbWVudHNbaF0uaGVpZ2h0O2lmKGktZTxnJiZnPGsrZSYmai1lPG0mJm08bCtlfHxpLWU8ZyYmZzxrK2UmJmotZTxvJiZvPGwrZXx8aS1lPG4mJm48aytlJiZqLWU8bSYmbTxsK2V8fGktZTxuJiZuPGsrZSYmai1lPG8mJgpvPGwrZSl7aWYoZi5zbmFwTW9kZSE9ImlubmVyIil7dmFyIHA9TWF0aC5hYnMoai1vKTw9ZSxxPU1hdGguYWJzKGwtbSk8PWUscj1NYXRoLmFicyhpLW4pPD1lLHM9TWF0aC5hYnMoay1nKTw9ZTtpZihwKWIucG9zaXRpb24udG9wPWMuX2NvbnZlcnRQb3NpdGlvblRvKCJyZWxhdGl2ZSIse3RvcDpqLWMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LGxlZnQ6MH0pLnRvcC1jLm1hcmdpbnMudG9wO2lmKHEpYi5wb3NpdGlvbi50b3A9Yy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOmwsbGVmdDowfSkudG9wLWMubWFyZ2lucy50b3A7aWYociliLnBvc2l0aW9uLmxlZnQ9Yy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOjAsbGVmdDppLWMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGh9KS5sZWZ0LWMubWFyZ2lucy5sZWZ0O2lmKHMpYi5wb3NpdGlvbi5sZWZ0PWMuX2NvbnZlcnRQb3NpdGlvblRvKCJyZWxhdGl2ZSIse3RvcDowLGxlZnQ6a30pLmxlZnQtYy5tYXJnaW5zLmxlZnR9dmFyIHQ9CnB8fHF8fHJ8fHM7aWYoZi5zbmFwTW9kZSE9Im91dGVyIil7cD1NYXRoLmFicyhqLW0pPD1lO3E9TWF0aC5hYnMobC1vKTw9ZTtyPU1hdGguYWJzKGktZyk8PWU7cz1NYXRoLmFicyhrLW4pPD1lO2lmKHApYi5wb3NpdGlvbi50b3A9Yy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOmosbGVmdDowfSkudG9wLWMubWFyZ2lucy50b3A7aWYocSliLnBvc2l0aW9uLnRvcD1jLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6bC1jLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxsZWZ0OjB9KS50b3AtYy5tYXJnaW5zLnRvcDtpZihyKWIucG9zaXRpb24ubGVmdD1jLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6MCxsZWZ0Oml9KS5sZWZ0LWMubWFyZ2lucy5sZWZ0O2lmKHMpYi5wb3NpdGlvbi5sZWZ0PWMuX2NvbnZlcnRQb3NpdGlvblRvKCJyZWxhdGl2ZSIse3RvcDowLGxlZnQ6ay1jLmhlbHBlclByb3BvcnRpb25zLndpZHRofSkubGVmdC1jLm1hcmdpbnMubGVmdH1pZighYy5zbmFwRWxlbWVudHNbaF0uc25hcHBpbmcmJgoocHx8cXx8cnx8c3x8dCkpYy5vcHRpb25zLnNuYXAuc25hcCYmYy5vcHRpb25zLnNuYXAuc25hcC5jYWxsKGMuZWxlbWVudCxhLGQuZXh0ZW5kKGMuX3VpSGFzaCgpLHtzbmFwSXRlbTpjLnNuYXBFbGVtZW50c1toXS5pdGVtfSkpO2Muc25hcEVsZW1lbnRzW2hdLnNuYXBwaW5nPXB8fHF8fHJ8fHN8fHR9ZWxzZXtjLnNuYXBFbGVtZW50c1toXS5zbmFwcGluZyYmYy5vcHRpb25zLnNuYXAucmVsZWFzZSYmYy5vcHRpb25zLnNuYXAucmVsZWFzZS5jYWxsKGMuZWxlbWVudCxhLGQuZXh0ZW5kKGMuX3VpSGFzaCgpLHtzbmFwSXRlbTpjLnNuYXBFbGVtZW50c1toXS5pdGVtfSkpO2Muc25hcEVsZW1lbnRzW2hdLnNuYXBwaW5nPWZhbHNlfX19fSk7ZC51aS5wbHVnaW4uYWRkKCJkcmFnZ2FibGUiLCJzdGFjayIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKS5vcHRpb25zO2E9ZC5tYWtlQXJyYXkoZChhLnN0YWNrKSkuc29ydChmdW5jdGlvbihjLGYpe3JldHVybihwYXJzZUludChkKGMpLmNzcygiekluZGV4IiksCjEwKXx8MCktKHBhcnNlSW50KGQoZikuY3NzKCJ6SW5kZXgiKSwxMCl8fDApfSk7aWYoYS5sZW5ndGgpe3ZhciBiPXBhcnNlSW50KGFbMF0uc3R5bGUuekluZGV4KXx8MDtkKGEpLmVhY2goZnVuY3Rpb24oYyl7dGhpcy5zdHlsZS56SW5kZXg9YitjfSk7dGhpc1swXS5zdHlsZS56SW5kZXg9YithLmxlbmd0aH19fSk7ZC51aS5wbHVnaW4uYWRkKCJkcmFnZ2FibGUiLCJ6SW5kZXgiLHtzdGFydDpmdW5jdGlvbihhLGIpe2E9ZChiLmhlbHBlcik7Yj1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7aWYoYS5jc3MoInpJbmRleCIpKWIuX3pJbmRleD1hLmNzcygiekluZGV4Iik7YS5jc3MoInpJbmRleCIsYi56SW5kZXgpfSxzdG9wOmZ1bmN0aW9uKGEsYil7YT1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7YS5fekluZGV4JiZkKGIuaGVscGVyKS5jc3MoInpJbmRleCIsYS5fekluZGV4KX19KX0pKGpRdWVyeSk7CjsvKgogKiBqUXVlcnkgVUkgUmVzaXphYmxlIDEuOC42CiAqCiAqIENvcHlyaWdodCAyMDEwLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dCkKICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIG9yIEdQTCBWZXJzaW9uIDIgbGljZW5zZXMuCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UKICoKICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9SZXNpemFibGVzCiAqCiAqIERlcGVuZHM6CiAqCWpxdWVyeS51aS5jb3JlLmpzCiAqCWpxdWVyeS51aS5tb3VzZS5qcwogKglqcXVlcnkudWkud2lkZ2V0LmpzCiAqLwooZnVuY3Rpb24oZSl7ZS53aWRnZXQoInVpLnJlc2l6YWJsZSIsZS51aS5tb3VzZSx7d2lkZ2V0RXZlbnRQcmVmaXg6InJlc2l6ZSIsb3B0aW9uczp7YWxzb1Jlc2l6ZTpmYWxzZSxhbmltYXRlOmZhbHNlLGFuaW1hdGVEdXJhdGlvbjoic2xvdyIsYW5pbWF0ZUVhc2luZzoic3dpbmciLGFzcGVjdFJhdGlvOmZhbHNlLGF1dG9IaWRlOmZhbHNlLGNvbnRhaW5tZW50OmZhbHNlLGdob3N0OmZhbHNlLGdyaWQ6ZmFsc2UsaGFuZGxlczoiZSxzLHNlIixoZWxwZXI6ZmFsc2UsbWF4SGVpZ2h0Om51bGwsbWF4V2lkdGg6bnVsbCxtaW5IZWlnaHQ6MTAsbWluV2lkdGg6MTAsekluZGV4OjFFM30sX2NyZWF0ZTpmdW5jdGlvbigpe3ZhciBiPXRoaXMsYT10aGlzLm9wdGlvbnM7dGhpcy5lbGVtZW50LmFkZENsYXNzKCJ1aS1yZXNpemFibGUiKTtlLmV4dGVuZCh0aGlzLHtfYXNwZWN0UmF0aW86ISFhLmFzcGVjdFJhdGlvLGFzcGVjdFJhdGlvOmEuYXNwZWN0UmF0aW8sb3JpZ2luYWxFbGVtZW50OnRoaXMuZWxlbWVudCwKX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHM6W10sX2hlbHBlcjphLmhlbHBlcnx8YS5naG9zdHx8YS5hbmltYXRlP2EuaGVscGVyfHwidWktcmVzaXphYmxlLWhlbHBlciI6bnVsbH0pO2lmKHRoaXMuZWxlbWVudFswXS5ub2RlTmFtZS5tYXRjaCgvY2FudmFzfHRleHRhcmVhfGlucHV0fHNlbGVjdHxidXR0b258aW1nL2kpKXsvcmVsYXRpdmUvLnRlc3QodGhpcy5lbGVtZW50LmNzcygicG9zaXRpb24iKSkmJmUuYnJvd3Nlci5vcGVyYSYmdGhpcy5lbGVtZW50LmNzcyh7cG9zaXRpb246InJlbGF0aXZlIix0b3A6ImF1dG8iLGxlZnQ6ImF1dG8ifSk7dGhpcy5lbGVtZW50LndyYXAoZSgnPGRpdiBjbGFzcz0idWktd3JhcHBlciIgc3R5bGU9Im92ZXJmbG93OiBoaWRkZW47Ij48L2Rpdj4nKS5jc3Moe3Bvc2l0aW9uOnRoaXMuZWxlbWVudC5jc3MoInBvc2l0aW9uIiksd2lkdGg6dGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKSxoZWlnaHQ6dGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCksCnRvcDp0aGlzLmVsZW1lbnQuY3NzKCJ0b3AiKSxsZWZ0OnRoaXMuZWxlbWVudC5jc3MoImxlZnQiKX0pKTt0aGlzLmVsZW1lbnQ9dGhpcy5lbGVtZW50LnBhcmVudCgpLmRhdGEoInJlc2l6YWJsZSIsdGhpcy5lbGVtZW50LmRhdGEoInJlc2l6YWJsZSIpKTt0aGlzLmVsZW1lbnRJc1dyYXBwZXI9dHJ1ZTt0aGlzLmVsZW1lbnQuY3NzKHttYXJnaW5MZWZ0OnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcygibWFyZ2luTGVmdCIpLG1hcmdpblRvcDp0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIm1hcmdpblRvcCIpLG1hcmdpblJpZ2h0OnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcygibWFyZ2luUmlnaHQiKSxtYXJnaW5Cb3R0b206dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJtYXJnaW5Cb3R0b20iKX0pO3RoaXMub3JpZ2luYWxFbGVtZW50LmNzcyh7bWFyZ2luTGVmdDowLG1hcmdpblRvcDowLG1hcmdpblJpZ2h0OjAsbWFyZ2luQm90dG9tOjB9KTt0aGlzLm9yaWdpbmFsUmVzaXplU3R5bGU9CnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcygicmVzaXplIik7dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJyZXNpemUiLCJub25lIik7dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5wdXNoKHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyh7cG9zaXRpb246InN0YXRpYyIsem9vbToxLGRpc3BsYXk6ImJsb2NrIn0pKTt0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3Moe21hcmdpbjp0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIm1hcmdpbiIpfSk7dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemUoKX10aGlzLmhhbmRsZXM9YS5oYW5kbGVzfHwoIWUoIi51aS1yZXNpemFibGUtaGFuZGxlIix0aGlzLmVsZW1lbnQpLmxlbmd0aD8iZSxzLHNlIjp7bjoiLnVpLXJlc2l6YWJsZS1uIixlOiIudWktcmVzaXphYmxlLWUiLHM6Ii51aS1yZXNpemFibGUtcyIsdzoiLnVpLXJlc2l6YWJsZS13IixzZToiLnVpLXJlc2l6YWJsZS1zZSIsc3c6Ii51aS1yZXNpemFibGUtc3ciLG5lOiIudWktcmVzaXphYmxlLW5lIiwKbnc6Ii51aS1yZXNpemFibGUtbncifSk7aWYodGhpcy5oYW5kbGVzLmNvbnN0cnVjdG9yPT1TdHJpbmcpe2lmKHRoaXMuaGFuZGxlcz09ImFsbCIpdGhpcy5oYW5kbGVzPSJuLGUscyx3LHNlLHN3LG5lLG53Ijt2YXIgYz10aGlzLmhhbmRsZXMuc3BsaXQoIiwiKTt0aGlzLmhhbmRsZXM9e307Zm9yKHZhciBkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBmPWUudHJpbShjW2RdKSxnPWUoJzxkaXYgY2xhc3M9InVpLXJlc2l6YWJsZS1oYW5kbGUgJysoInVpLXJlc2l6YWJsZS0iK2YpKyciPjwvZGl2PicpOy9zd3xzZXxuZXxudy8udGVzdChmKSYmZy5jc3Moe3pJbmRleDorK2EuekluZGV4fSk7InNlIj09ZiYmZy5hZGRDbGFzcygidWktaWNvbiB1aS1pY29uLWdyaXBzbWFsbC1kaWFnb25hbC1zZSIpO3RoaXMuaGFuZGxlc1tmXT0iLnVpLXJlc2l6YWJsZS0iK2Y7dGhpcy5lbGVtZW50LmFwcGVuZChnKX19dGhpcy5fcmVuZGVyQXhpcz1mdW5jdGlvbihoKXtoPWh8fHRoaXMuZWxlbWVudDtmb3IodmFyIGkgaW4gdGhpcy5oYW5kbGVzKXtpZih0aGlzLmhhbmRsZXNbaV0uY29uc3RydWN0b3I9PQpTdHJpbmcpdGhpcy5oYW5kbGVzW2ldPWUodGhpcy5oYW5kbGVzW2ldLHRoaXMuZWxlbWVudCkuc2hvdygpO2lmKHRoaXMuZWxlbWVudElzV3JhcHBlciYmdGhpcy5vcmlnaW5hbEVsZW1lbnRbMF0ubm9kZU5hbWUubWF0Y2goL3RleHRhcmVhfGlucHV0fHNlbGVjdHxidXR0b24vaSkpe3ZhciBqPWUodGhpcy5oYW5kbGVzW2ldLHRoaXMuZWxlbWVudCksaz0wO2s9L3N3fG5lfG53fHNlfG58cy8udGVzdChpKT9qLm91dGVySGVpZ2h0KCk6ai5vdXRlcldpZHRoKCk7aj1bInBhZGRpbmciLC9uZXxud3xuLy50ZXN0KGkpPyJUb3AiOi9zZXxzd3xzLy50ZXN0KGkpPyJCb3R0b20iOi9eZSQvLnRlc3QoaSk/IlJpZ2h0IjoiTGVmdCJdLmpvaW4oIiIpO2guY3NzKGosayk7dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemUoKX1lKHRoaXMuaGFuZGxlc1tpXSl9fTt0aGlzLl9yZW5kZXJBeGlzKHRoaXMuZWxlbWVudCk7dGhpcy5faGFuZGxlcz1lKCIudWktcmVzaXphYmxlLWhhbmRsZSIsdGhpcy5lbGVtZW50KS5kaXNhYmxlU2VsZWN0aW9uKCk7CnRoaXMuX2hhbmRsZXMubW91c2VvdmVyKGZ1bmN0aW9uKCl7aWYoIWIucmVzaXppbmcpe2lmKHRoaXMuY2xhc3NOYW1lKXZhciBoPXRoaXMuY2xhc3NOYW1lLm1hdGNoKC91aS1yZXNpemFibGUtKHNlfHN3fG5lfG53fG58ZXxzfHcpL2kpO2IuYXhpcz1oJiZoWzFdP2hbMV06InNlIn19KTtpZihhLmF1dG9IaWRlKXt0aGlzLl9oYW5kbGVzLmhpZGUoKTtlKHRoaXMuZWxlbWVudCkuYWRkQ2xhc3MoInVpLXJlc2l6YWJsZS1hdXRvaGlkZSIpLmhvdmVyKGZ1bmN0aW9uKCl7ZSh0aGlzKS5yZW1vdmVDbGFzcygidWktcmVzaXphYmxlLWF1dG9oaWRlIik7Yi5faGFuZGxlcy5zaG93KCl9LGZ1bmN0aW9uKCl7aWYoIWIucmVzaXppbmcpe2UodGhpcykuYWRkQ2xhc3MoInVpLXJlc2l6YWJsZS1hdXRvaGlkZSIpO2IuX2hhbmRsZXMuaGlkZSgpfX0pfXRoaXMuX21vdXNlSW5pdCgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5fbW91c2VEZXN0cm95KCk7dmFyIGI9ZnVuY3Rpb24oYyl7ZShjKS5yZW1vdmVDbGFzcygidWktcmVzaXphYmxlIHVpLXJlc2l6YWJsZS1kaXNhYmxlZCB1aS1yZXNpemFibGUtcmVzaXppbmciKS5yZW1vdmVEYXRhKCJyZXNpemFibGUiKS51bmJpbmQoIi5yZXNpemFibGUiKS5maW5kKCIudWktcmVzaXphYmxlLWhhbmRsZSIpLnJlbW92ZSgpfTsKaWYodGhpcy5lbGVtZW50SXNXcmFwcGVyKXtiKHRoaXMuZWxlbWVudCk7dmFyIGE9dGhpcy5lbGVtZW50O2EuYWZ0ZXIodGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKHtwb3NpdGlvbjphLmNzcygicG9zaXRpb24iKSx3aWR0aDphLm91dGVyV2lkdGgoKSxoZWlnaHQ6YS5vdXRlckhlaWdodCgpLHRvcDphLmNzcygidG9wIiksbGVmdDphLmNzcygibGVmdCIpfSkpLnJlbW92ZSgpfXRoaXMub3JpZ2luYWxFbGVtZW50LmNzcygicmVzaXplIix0aGlzLm9yaWdpbmFsUmVzaXplU3R5bGUpO2IodGhpcy5vcmlnaW5hbEVsZW1lbnQpO3JldHVybiB0aGlzfSxfbW91c2VDYXB0dXJlOmZ1bmN0aW9uKGIpe3ZhciBhPWZhbHNlO2Zvcih2YXIgYyBpbiB0aGlzLmhhbmRsZXMpaWYoZSh0aGlzLmhhbmRsZXNbY10pWzBdPT1iLnRhcmdldClhPXRydWU7cmV0dXJuIXRoaXMub3B0aW9ucy5kaXNhYmxlZCYmYX0sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5vcHRpb25zLGM9dGhpcy5lbGVtZW50LnBvc2l0aW9uKCksCmQ9dGhpcy5lbGVtZW50O3RoaXMucmVzaXppbmc9dHJ1ZTt0aGlzLmRvY3VtZW50U2Nyb2xsPXt0b3A6ZShkb2N1bWVudCkuc2Nyb2xsVG9wKCksbGVmdDplKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCl9O2lmKGQuaXMoIi51aS1kcmFnZ2FibGUiKXx8L2Fic29sdXRlLy50ZXN0KGQuY3NzKCJwb3NpdGlvbiIpKSlkLmNzcyh7cG9zaXRpb246ImFic29sdXRlIix0b3A6Yy50b3AsbGVmdDpjLmxlZnR9KTtlLmJyb3dzZXIub3BlcmEmJi9yZWxhdGl2ZS8udGVzdChkLmNzcygicG9zaXRpb24iKSkmJmQuY3NzKHtwb3NpdGlvbjoicmVsYXRpdmUiLHRvcDoiYXV0byIsbGVmdDoiYXV0byJ9KTt0aGlzLl9yZW5kZXJQcm94eSgpO2M9bSh0aGlzLmhlbHBlci5jc3MoImxlZnQiKSk7dmFyIGY9bSh0aGlzLmhlbHBlci5jc3MoInRvcCIpKTtpZihhLmNvbnRhaW5tZW50KXtjKz1lKGEuY29udGFpbm1lbnQpLnNjcm9sbExlZnQoKXx8MDtmKz1lKGEuY29udGFpbm1lbnQpLnNjcm9sbFRvcCgpfHwwfXRoaXMub2Zmc2V0PQp0aGlzLmhlbHBlci5vZmZzZXQoKTt0aGlzLnBvc2l0aW9uPXtsZWZ0OmMsdG9wOmZ9O3RoaXMuc2l6ZT10aGlzLl9oZWxwZXI/e3dpZHRoOmQub3V0ZXJXaWR0aCgpLGhlaWdodDpkLm91dGVySGVpZ2h0KCl9Ont3aWR0aDpkLndpZHRoKCksaGVpZ2h0OmQuaGVpZ2h0KCl9O3RoaXMub3JpZ2luYWxTaXplPXRoaXMuX2hlbHBlcj97d2lkdGg6ZC5vdXRlcldpZHRoKCksaGVpZ2h0OmQub3V0ZXJIZWlnaHQoKX06e3dpZHRoOmQud2lkdGgoKSxoZWlnaHQ6ZC5oZWlnaHQoKX07dGhpcy5vcmlnaW5hbFBvc2l0aW9uPXtsZWZ0OmMsdG9wOmZ9O3RoaXMuc2l6ZURpZmY9e3dpZHRoOmQub3V0ZXJXaWR0aCgpLWQud2lkdGgoKSxoZWlnaHQ6ZC5vdXRlckhlaWdodCgpLWQuaGVpZ2h0KCl9O3RoaXMub3JpZ2luYWxNb3VzZVBvc2l0aW9uPXtsZWZ0OmIucGFnZVgsdG9wOmIucGFnZVl9O3RoaXMuYXNwZWN0UmF0aW89dHlwZW9mIGEuYXNwZWN0UmF0aW89PSJudW1iZXIiP2EuYXNwZWN0UmF0aW86CnRoaXMub3JpZ2luYWxTaXplLndpZHRoL3RoaXMub3JpZ2luYWxTaXplLmhlaWdodHx8MTthPWUoIi51aS1yZXNpemFibGUtIit0aGlzLmF4aXMpLmNzcygiY3Vyc29yIik7ZSgiYm9keSIpLmNzcygiY3Vyc29yIixhPT0iYXV0byI/dGhpcy5heGlzKyItcmVzaXplIjphKTtkLmFkZENsYXNzKCJ1aS1yZXNpemFibGUtcmVzaXppbmciKTt0aGlzLl9wcm9wYWdhdGUoInN0YXJ0IixiKTtyZXR1cm4gdHJ1ZX0sX21vdXNlRHJhZzpmdW5jdGlvbihiKXt2YXIgYT10aGlzLmhlbHBlcixjPXRoaXMub3JpZ2luYWxNb3VzZVBvc2l0aW9uLGQ9dGhpcy5fY2hhbmdlW3RoaXMuYXhpc107aWYoIWQpcmV0dXJuIGZhbHNlO2M9ZC5hcHBseSh0aGlzLFtiLGIucGFnZVgtYy5sZWZ0fHwwLGIucGFnZVktYy50b3B8fDBdKTtpZih0aGlzLl9hc3BlY3RSYXRpb3x8Yi5zaGlmdEtleSljPXRoaXMuX3VwZGF0ZVJhdGlvKGMsYik7Yz10aGlzLl9yZXNwZWN0U2l6ZShjLGIpO3RoaXMuX3Byb3BhZ2F0ZSgicmVzaXplIiwKYik7YS5jc3Moe3RvcDp0aGlzLnBvc2l0aW9uLnRvcCsicHgiLGxlZnQ6dGhpcy5wb3NpdGlvbi5sZWZ0KyJweCIsd2lkdGg6dGhpcy5zaXplLndpZHRoKyJweCIsaGVpZ2h0OnRoaXMuc2l6ZS5oZWlnaHQrInB4In0pOyF0aGlzLl9oZWxwZXImJnRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHMubGVuZ3RoJiZ0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpO3RoaXMuX3VwZGF0ZUNhY2hlKGMpO3RoaXMuX3RyaWdnZXIoInJlc2l6ZSIsYix0aGlzLnVpKCkpO3JldHVybiBmYWxzZX0sX21vdXNlU3RvcDpmdW5jdGlvbihiKXt0aGlzLnJlc2l6aW5nPWZhbHNlO3ZhciBhPXRoaXMub3B0aW9ucyxjPXRoaXM7aWYodGhpcy5faGVscGVyKXt2YXIgZD10aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLGY9ZC5sZW5ndGgmJi90ZXh0YXJlYS9pLnRlc3QoZFswXS5ub2RlTmFtZSk7ZD1mJiZlLnVpLmhhc1Njcm9sbChkWzBdLCJsZWZ0Iik/MDpjLnNpemVEaWZmLmhlaWdodDsKZj17d2lkdGg6Yy5zaXplLndpZHRoLShmPzA6Yy5zaXplRGlmZi53aWR0aCksaGVpZ2h0OmMuc2l6ZS5oZWlnaHQtZH07ZD1wYXJzZUludChjLmVsZW1lbnQuY3NzKCJsZWZ0IiksMTApKyhjLnBvc2l0aW9uLmxlZnQtYy5vcmlnaW5hbFBvc2l0aW9uLmxlZnQpfHxudWxsO3ZhciBnPXBhcnNlSW50KGMuZWxlbWVudC5jc3MoInRvcCIpLDEwKSsoYy5wb3NpdGlvbi50b3AtYy5vcmlnaW5hbFBvc2l0aW9uLnRvcCl8fG51bGw7YS5hbmltYXRlfHx0aGlzLmVsZW1lbnQuY3NzKGUuZXh0ZW5kKGYse3RvcDpnLGxlZnQ6ZH0pKTtjLmhlbHBlci5oZWlnaHQoYy5zaXplLmhlaWdodCk7Yy5oZWxwZXIud2lkdGgoYy5zaXplLndpZHRoKTt0aGlzLl9oZWxwZXImJiFhLmFuaW1hdGUmJnRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCl9ZSgiYm9keSIpLmNzcygiY3Vyc29yIiwiYXV0byIpO3RoaXMuZWxlbWVudC5yZW1vdmVDbGFzcygidWktcmVzaXphYmxlLXJlc2l6aW5nIik7dGhpcy5fcHJvcGFnYXRlKCJzdG9wIiwKYik7dGhpcy5faGVscGVyJiZ0aGlzLmhlbHBlci5yZW1vdmUoKTtyZXR1cm4gZmFsc2V9LF91cGRhdGVDYWNoZTpmdW5jdGlvbihiKXt0aGlzLm9mZnNldD10aGlzLmhlbHBlci5vZmZzZXQoKTtpZihsKGIubGVmdCkpdGhpcy5wb3NpdGlvbi5sZWZ0PWIubGVmdDtpZihsKGIudG9wKSl0aGlzLnBvc2l0aW9uLnRvcD1iLnRvcDtpZihsKGIuaGVpZ2h0KSl0aGlzLnNpemUuaGVpZ2h0PWIuaGVpZ2h0O2lmKGwoYi53aWR0aCkpdGhpcy5zaXplLndpZHRoPWIud2lkdGh9LF91cGRhdGVSYXRpbzpmdW5jdGlvbihiKXt2YXIgYT10aGlzLnBvc2l0aW9uLGM9dGhpcy5zaXplLGQ9dGhpcy5heGlzO2lmKGIuaGVpZ2h0KWIud2lkdGg9Yy5oZWlnaHQqdGhpcy5hc3BlY3RSYXRpbztlbHNlIGlmKGIud2lkdGgpYi5oZWlnaHQ9Yy53aWR0aC90aGlzLmFzcGVjdFJhdGlvO2lmKGQ9PSJzdyIpe2IubGVmdD1hLmxlZnQrKGMud2lkdGgtYi53aWR0aCk7Yi50b3A9bnVsbH1pZihkPT0ibnciKXtiLnRvcD0KYS50b3ArKGMuaGVpZ2h0LWIuaGVpZ2h0KTtiLmxlZnQ9YS5sZWZ0KyhjLndpZHRoLWIud2lkdGgpfXJldHVybiBifSxfcmVzcGVjdFNpemU6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5vcHRpb25zLGM9dGhpcy5heGlzLGQ9bChiLndpZHRoKSYmYS5tYXhXaWR0aCYmYS5tYXhXaWR0aDxiLndpZHRoLGY9bChiLmhlaWdodCkmJmEubWF4SGVpZ2h0JiZhLm1heEhlaWdodDxiLmhlaWdodCxnPWwoYi53aWR0aCkmJmEubWluV2lkdGgmJmEubWluV2lkdGg+Yi53aWR0aCxoPWwoYi5oZWlnaHQpJiZhLm1pbkhlaWdodCYmYS5taW5IZWlnaHQ+Yi5oZWlnaHQ7aWYoZyliLndpZHRoPWEubWluV2lkdGg7aWYoaCliLmhlaWdodD1hLm1pbkhlaWdodDtpZihkKWIud2lkdGg9YS5tYXhXaWR0aDtpZihmKWIuaGVpZ2h0PWEubWF4SGVpZ2h0O3ZhciBpPXRoaXMub3JpZ2luYWxQb3NpdGlvbi5sZWZ0K3RoaXMub3JpZ2luYWxTaXplLndpZHRoLGo9dGhpcy5wb3NpdGlvbi50b3ArdGhpcy5zaXplLmhlaWdodCwKaz0vc3d8bnd8dy8udGVzdChjKTtjPS9ud3xuZXxuLy50ZXN0KGMpO2lmKGcmJmspYi5sZWZ0PWktYS5taW5XaWR0aDtpZihkJiZrKWIubGVmdD1pLWEubWF4V2lkdGg7aWYoaCYmYyliLnRvcD1qLWEubWluSGVpZ2h0O2lmKGYmJmMpYi50b3A9ai1hLm1heEhlaWdodDtpZigoYT0hYi53aWR0aCYmIWIuaGVpZ2h0KSYmIWIubGVmdCYmYi50b3ApYi50b3A9bnVsbDtlbHNlIGlmKGEmJiFiLnRvcCYmYi5sZWZ0KWIubGVmdD1udWxsO3JldHVybiBifSxfcHJvcG9ydGlvbmFsbHlSZXNpemU6ZnVuY3Rpb24oKXtpZih0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aClmb3IodmFyIGI9dGhpcy5oZWxwZXJ8fHRoaXMuZWxlbWVudCxhPTA7YTx0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aDthKyspe3ZhciBjPXRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHNbYV07aWYoIXRoaXMuYm9yZGVyRGlmKXt2YXIgZD1bYy5jc3MoImJvcmRlclRvcFdpZHRoIiksCmMuY3NzKCJib3JkZXJSaWdodFdpZHRoIiksYy5jc3MoImJvcmRlckJvdHRvbVdpZHRoIiksYy5jc3MoImJvcmRlckxlZnRXaWR0aCIpXSxmPVtjLmNzcygicGFkZGluZ1RvcCIpLGMuY3NzKCJwYWRkaW5nUmlnaHQiKSxjLmNzcygicGFkZGluZ0JvdHRvbSIpLGMuY3NzKCJwYWRkaW5nTGVmdCIpXTt0aGlzLmJvcmRlckRpZj1lLm1hcChkLGZ1bmN0aW9uKGcsaCl7Zz1wYXJzZUludChnLDEwKXx8MDtoPXBhcnNlSW50KGZbaF0sMTApfHwwO3JldHVybiBnK2h9KX1lLmJyb3dzZXIubXNpZSYmKGUoYikuaXMoIjpoaWRkZW4iKXx8ZShiKS5wYXJlbnRzKCI6aGlkZGVuIikubGVuZ3RoKXx8Yy5jc3Moe2hlaWdodDpiLmhlaWdodCgpLXRoaXMuYm9yZGVyRGlmWzBdLXRoaXMuYm9yZGVyRGlmWzJdfHwwLHdpZHRoOmIud2lkdGgoKS10aGlzLmJvcmRlckRpZlsxXS10aGlzLmJvcmRlckRpZlszXXx8MH0pfX0sX3JlbmRlclByb3h5OmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5vcHRpb25zO3RoaXMuZWxlbWVudE9mZnNldD0KdGhpcy5lbGVtZW50Lm9mZnNldCgpO2lmKHRoaXMuX2hlbHBlcil7dGhpcy5oZWxwZXI9dGhpcy5oZWxwZXJ8fGUoJzxkaXYgc3R5bGU9Im92ZXJmbG93OmhpZGRlbjsiPjwvZGl2PicpO3ZhciBhPWUuYnJvd3Nlci5tc2llJiZlLmJyb3dzZXIudmVyc2lvbjw3LGM9YT8xOjA7YT1hPzI6LTE7dGhpcy5oZWxwZXIuYWRkQ2xhc3ModGhpcy5faGVscGVyKS5jc3Moe3dpZHRoOnRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCkrYSxoZWlnaHQ6dGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCkrYSxwb3NpdGlvbjoiYWJzb2x1dGUiLGxlZnQ6dGhpcy5lbGVtZW50T2Zmc2V0LmxlZnQtYysicHgiLHRvcDp0aGlzLmVsZW1lbnRPZmZzZXQudG9wLWMrInB4Iix6SW5kZXg6KytiLnpJbmRleH0pO3RoaXMuaGVscGVyLmFwcGVuZFRvKCJib2R5IikuZGlzYWJsZVNlbGVjdGlvbigpfWVsc2UgdGhpcy5oZWxwZXI9dGhpcy5lbGVtZW50fSxfY2hhbmdlOntlOmZ1bmN0aW9uKGIsYSl7cmV0dXJue3dpZHRoOnRoaXMub3JpZ2luYWxTaXplLndpZHRoKwphfX0sdzpmdW5jdGlvbihiLGEpe3JldHVybntsZWZ0OnRoaXMub3JpZ2luYWxQb3NpdGlvbi5sZWZ0K2Esd2lkdGg6dGhpcy5vcmlnaW5hbFNpemUud2lkdGgtYX19LG46ZnVuY3Rpb24oYixhLGMpe3JldHVybnt0b3A6dGhpcy5vcmlnaW5hbFBvc2l0aW9uLnRvcCtjLGhlaWdodDp0aGlzLm9yaWdpbmFsU2l6ZS5oZWlnaHQtY319LHM6ZnVuY3Rpb24oYixhLGMpe3JldHVybntoZWlnaHQ6dGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0K2N9fSxzZTpmdW5jdGlvbihiLGEsYyl7cmV0dXJuIGUuZXh0ZW5kKHRoaXMuX2NoYW5nZS5zLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9jaGFuZ2UuZS5hcHBseSh0aGlzLFtiLGEsY10pKX0sc3c6ZnVuY3Rpb24oYixhLGMpe3JldHVybiBlLmV4dGVuZCh0aGlzLl9jaGFuZ2Uucy5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fY2hhbmdlLncuYXBwbHkodGhpcyxbYixhLGNdKSl9LG5lOmZ1bmN0aW9uKGIsYSxjKXtyZXR1cm4gZS5leHRlbmQodGhpcy5fY2hhbmdlLm4uYXBwbHkodGhpcywKYXJndW1lbnRzKSx0aGlzLl9jaGFuZ2UuZS5hcHBseSh0aGlzLFtiLGEsY10pKX0sbnc6ZnVuY3Rpb24oYixhLGMpe3JldHVybiBlLmV4dGVuZCh0aGlzLl9jaGFuZ2Uubi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fY2hhbmdlLncuYXBwbHkodGhpcyxbYixhLGNdKSl9fSxfcHJvcGFnYXRlOmZ1bmN0aW9uKGIsYSl7ZS51aS5wbHVnaW4uY2FsbCh0aGlzLGIsW2EsdGhpcy51aSgpXSk7YiE9InJlc2l6ZSImJnRoaXMuX3RyaWdnZXIoYixhLHRoaXMudWkoKSl9LHBsdWdpbnM6e30sdWk6ZnVuY3Rpb24oKXtyZXR1cm57b3JpZ2luYWxFbGVtZW50OnRoaXMub3JpZ2luYWxFbGVtZW50LGVsZW1lbnQ6dGhpcy5lbGVtZW50LGhlbHBlcjp0aGlzLmhlbHBlcixwb3NpdGlvbjp0aGlzLnBvc2l0aW9uLHNpemU6dGhpcy5zaXplLG9yaWdpbmFsU2l6ZTp0aGlzLm9yaWdpbmFsU2l6ZSxvcmlnaW5hbFBvc2l0aW9uOnRoaXMub3JpZ2luYWxQb3NpdGlvbn19fSk7ZS5leHRlbmQoZS51aS5yZXNpemFibGUsCnt2ZXJzaW9uOiIxLjguNiJ9KTtlLnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImFsc29SZXNpemUiLHtzdGFydDpmdW5jdGlvbigpe3ZhciBiPWUodGhpcykuZGF0YSgicmVzaXphYmxlIikub3B0aW9ucyxhPWZ1bmN0aW9uKGMpe2UoYykuZWFjaChmdW5jdGlvbigpe3ZhciBkPWUodGhpcyk7ZC5kYXRhKCJyZXNpemFibGUtYWxzb3Jlc2l6ZSIse3dpZHRoOnBhcnNlSW50KGQud2lkdGgoKSwxMCksaGVpZ2h0OnBhcnNlSW50KGQuaGVpZ2h0KCksMTApLGxlZnQ6cGFyc2VJbnQoZC5jc3MoImxlZnQiKSwxMCksdG9wOnBhcnNlSW50KGQuY3NzKCJ0b3AiKSwxMCkscG9zaXRpb246ZC5jc3MoInBvc2l0aW9uIil9KX0pfTtpZih0eXBlb2YgYi5hbHNvUmVzaXplPT0ib2JqZWN0IiYmIWIuYWxzb1Jlc2l6ZS5wYXJlbnROb2RlKWlmKGIuYWxzb1Jlc2l6ZS5sZW5ndGgpe2IuYWxzb1Jlc2l6ZT1iLmFsc29SZXNpemVbMF07YShiLmFsc29SZXNpemUpfWVsc2UgZS5lYWNoKGIuYWxzb1Jlc2l6ZSwKZnVuY3Rpb24oYyl7YShjKX0pO2Vsc2UgYShiLmFsc29SZXNpemUpfSxyZXNpemU6ZnVuY3Rpb24oYixhKXt2YXIgYz1lKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpO2I9Yy5vcHRpb25zO3ZhciBkPWMub3JpZ2luYWxTaXplLGY9Yy5vcmlnaW5hbFBvc2l0aW9uLGc9e2hlaWdodDpjLnNpemUuaGVpZ2h0LWQuaGVpZ2h0fHwwLHdpZHRoOmMuc2l6ZS53aWR0aC1kLndpZHRofHwwLHRvcDpjLnBvc2l0aW9uLnRvcC1mLnRvcHx8MCxsZWZ0OmMucG9zaXRpb24ubGVmdC1mLmxlZnR8fDB9LGg9ZnVuY3Rpb24oaSxqKXtlKGkpLmVhY2goZnVuY3Rpb24oKXt2YXIgaz1lKHRoaXMpLHE9ZSh0aGlzKS5kYXRhKCJyZXNpemFibGUtYWxzb3Jlc2l6ZSIpLHA9e30scj1qJiZqLmxlbmd0aD9qOmsucGFyZW50cyhhLm9yaWdpbmFsRWxlbWVudFswXSkubGVuZ3RoP1sid2lkdGgiLCJoZWlnaHQiXTpbIndpZHRoIiwiaGVpZ2h0IiwidG9wIiwibGVmdCJdO2UuZWFjaChyLGZ1bmN0aW9uKG4sbyl7aWYoKG49CihxW29dfHwwKSsoZ1tvXXx8MCkpJiZuPj0wKXBbb109bnx8bnVsbH0pO2lmKGUuYnJvd3Nlci5vcGVyYSYmL3JlbGF0aXZlLy50ZXN0KGsuY3NzKCJwb3NpdGlvbiIpKSl7Yy5fcmV2ZXJ0VG9SZWxhdGl2ZVBvc2l0aW9uPXRydWU7ay5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdG9wOiJhdXRvIixsZWZ0OiJhdXRvIn0pfWsuY3NzKHApfSl9O3R5cGVvZiBiLmFsc29SZXNpemU9PSJvYmplY3QiJiYhYi5hbHNvUmVzaXplLm5vZGVUeXBlP2UuZWFjaChiLmFsc29SZXNpemUsZnVuY3Rpb24oaSxqKXtoKGksail9KTpoKGIuYWxzb1Jlc2l6ZSl9LHN0b3A6ZnVuY3Rpb24oKXt2YXIgYj1lKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGE9Yi5vcHRpb25zLGM9ZnVuY3Rpb24oZCl7ZShkKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGY9ZSh0aGlzKTtmLmNzcyh7cG9zaXRpb246Zi5kYXRhKCJyZXNpemFibGUtYWxzb3Jlc2l6ZSIpLnBvc2l0aW9ufSl9KX07aWYoYi5fcmV2ZXJ0VG9SZWxhdGl2ZVBvc2l0aW9uKXtiLl9yZXZlcnRUb1JlbGF0aXZlUG9zaXRpb249CmZhbHNlO3R5cGVvZiBhLmFsc29SZXNpemU9PSJvYmplY3QiJiYhYS5hbHNvUmVzaXplLm5vZGVUeXBlP2UuZWFjaChhLmFsc29SZXNpemUsZnVuY3Rpb24oZCl7YyhkKX0pOmMoYS5hbHNvUmVzaXplKX1lKHRoaXMpLnJlbW92ZURhdGEoInJlc2l6YWJsZS1hbHNvcmVzaXplIil9fSk7ZS51aS5wbHVnaW4uYWRkKCJyZXNpemFibGUiLCJhbmltYXRlIix7c3RvcDpmdW5jdGlvbihiKXt2YXIgYT1lKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGM9YS5vcHRpb25zLGQ9YS5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cyxmPWQubGVuZ3RoJiYvdGV4dGFyZWEvaS50ZXN0KGRbMF0ubm9kZU5hbWUpLGc9ZiYmZS51aS5oYXNTY3JvbGwoZFswXSwibGVmdCIpPzA6YS5zaXplRGlmZi5oZWlnaHQ7Zj17d2lkdGg6YS5zaXplLndpZHRoLShmPzA6YS5zaXplRGlmZi53aWR0aCksaGVpZ2h0OmEuc2l6ZS5oZWlnaHQtZ307Zz1wYXJzZUludChhLmVsZW1lbnQuY3NzKCJsZWZ0IiksMTApKyhhLnBvc2l0aW9uLmxlZnQtCmEub3JpZ2luYWxQb3NpdGlvbi5sZWZ0KXx8bnVsbDt2YXIgaD1wYXJzZUludChhLmVsZW1lbnQuY3NzKCJ0b3AiKSwxMCkrKGEucG9zaXRpb24udG9wLWEub3JpZ2luYWxQb3NpdGlvbi50b3ApfHxudWxsO2EuZWxlbWVudC5hbmltYXRlKGUuZXh0ZW5kKGYsaCYmZz97dG9wOmgsbGVmdDpnfTp7fSkse2R1cmF0aW9uOmMuYW5pbWF0ZUR1cmF0aW9uLGVhc2luZzpjLmFuaW1hdGVFYXNpbmcsc3RlcDpmdW5jdGlvbigpe3ZhciBpPXt3aWR0aDpwYXJzZUludChhLmVsZW1lbnQuY3NzKCJ3aWR0aCIpLDEwKSxoZWlnaHQ6cGFyc2VJbnQoYS5lbGVtZW50LmNzcygiaGVpZ2h0IiksMTApLHRvcDpwYXJzZUludChhLmVsZW1lbnQuY3NzKCJ0b3AiKSwxMCksbGVmdDpwYXJzZUludChhLmVsZW1lbnQuY3NzKCJsZWZ0IiksMTApfTtkJiZkLmxlbmd0aCYmZShkWzBdKS5jc3Moe3dpZHRoOmkud2lkdGgsaGVpZ2h0OmkuaGVpZ2h0fSk7YS5fdXBkYXRlQ2FjaGUoaSk7YS5fcHJvcGFnYXRlKCJyZXNpemUiLApiKX19KX19KTtlLnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImNvbnRhaW5tZW50Iix7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgYj1lKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGE9Yi5lbGVtZW50LGM9Yi5vcHRpb25zLmNvbnRhaW5tZW50O2lmKGE9YyBpbnN0YW5jZW9mIGU/Yy5nZXQoMCk6L3BhcmVudC8udGVzdChjKT9hLnBhcmVudCgpLmdldCgwKTpjKXtiLmNvbnRhaW5lckVsZW1lbnQ9ZShhKTtpZigvZG9jdW1lbnQvLnRlc3QoYyl8fGM9PWRvY3VtZW50KXtiLmNvbnRhaW5lck9mZnNldD17bGVmdDowLHRvcDowfTtiLmNvbnRhaW5lclBvc2l0aW9uPXtsZWZ0OjAsdG9wOjB9O2IucGFyZW50RGF0YT17ZWxlbWVudDplKGRvY3VtZW50KSxsZWZ0OjAsdG9wOjAsd2lkdGg6ZShkb2N1bWVudCkud2lkdGgoKSxoZWlnaHQ6ZShkb2N1bWVudCkuaGVpZ2h0KCl8fGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHR9fWVsc2V7dmFyIGQ9ZShhKSxmPVtdO2UoWyJUb3AiLAoiUmlnaHQiLCJMZWZ0IiwiQm90dG9tIl0pLmVhY2goZnVuY3Rpb24oaSxqKXtmW2ldPW0oZC5jc3MoInBhZGRpbmciK2opKX0pO2IuY29udGFpbmVyT2Zmc2V0PWQub2Zmc2V0KCk7Yi5jb250YWluZXJQb3NpdGlvbj1kLnBvc2l0aW9uKCk7Yi5jb250YWluZXJTaXplPXtoZWlnaHQ6ZC5pbm5lckhlaWdodCgpLWZbM10sd2lkdGg6ZC5pbm5lcldpZHRoKCktZlsxXX07Yz1iLmNvbnRhaW5lck9mZnNldDt2YXIgZz1iLmNvbnRhaW5lclNpemUuaGVpZ2h0LGg9Yi5jb250YWluZXJTaXplLndpZHRoO2g9ZS51aS5oYXNTY3JvbGwoYSwibGVmdCIpP2Euc2Nyb2xsV2lkdGg6aDtnPWUudWkuaGFzU2Nyb2xsKGEpP2Euc2Nyb2xsSGVpZ2h0Omc7Yi5wYXJlbnREYXRhPXtlbGVtZW50OmEsbGVmdDpjLmxlZnQsdG9wOmMudG9wLHdpZHRoOmgsaGVpZ2h0Omd9fX19LHJlc2l6ZTpmdW5jdGlvbihiKXt2YXIgYT1lKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGM9YS5vcHRpb25zLGQ9YS5jb250YWluZXJPZmZzZXQsCmY9YS5wb3NpdGlvbjtiPWEuX2FzcGVjdFJhdGlvfHxiLnNoaWZ0S2V5O3ZhciBnPXt0b3A6MCxsZWZ0OjB9LGg9YS5jb250YWluZXJFbGVtZW50O2lmKGhbMF0hPWRvY3VtZW50JiYvc3RhdGljLy50ZXN0KGguY3NzKCJwb3NpdGlvbiIpKSlnPWQ7aWYoZi5sZWZ0PChhLl9oZWxwZXI/ZC5sZWZ0OjApKXthLnNpemUud2lkdGgrPWEuX2hlbHBlcj9hLnBvc2l0aW9uLmxlZnQtZC5sZWZ0OmEucG9zaXRpb24ubGVmdC1nLmxlZnQ7aWYoYilhLnNpemUuaGVpZ2h0PWEuc2l6ZS53aWR0aC9jLmFzcGVjdFJhdGlvO2EucG9zaXRpb24ubGVmdD1jLmhlbHBlcj9kLmxlZnQ6MH1pZihmLnRvcDwoYS5faGVscGVyP2QudG9wOjApKXthLnNpemUuaGVpZ2h0Kz1hLl9oZWxwZXI/YS5wb3NpdGlvbi50b3AtZC50b3A6YS5wb3NpdGlvbi50b3A7aWYoYilhLnNpemUud2lkdGg9YS5zaXplLmhlaWdodCpjLmFzcGVjdFJhdGlvO2EucG9zaXRpb24udG9wPWEuX2hlbHBlcj9kLnRvcDowfWEub2Zmc2V0LmxlZnQ9CmEucGFyZW50RGF0YS5sZWZ0K2EucG9zaXRpb24ubGVmdDthLm9mZnNldC50b3A9YS5wYXJlbnREYXRhLnRvcCthLnBvc2l0aW9uLnRvcDtjPU1hdGguYWJzKChhLl9oZWxwZXI/YS5vZmZzZXQubGVmdC1nLmxlZnQ6YS5vZmZzZXQubGVmdC1nLmxlZnQpK2Euc2l6ZURpZmYud2lkdGgpO2Q9TWF0aC5hYnMoKGEuX2hlbHBlcj9hLm9mZnNldC50b3AtZy50b3A6YS5vZmZzZXQudG9wLWQudG9wKSthLnNpemVEaWZmLmhlaWdodCk7Zj1hLmNvbnRhaW5lckVsZW1lbnQuZ2V0KDApPT1hLmVsZW1lbnQucGFyZW50KCkuZ2V0KDApO2c9L3JlbGF0aXZlfGFic29sdXRlLy50ZXN0KGEuY29udGFpbmVyRWxlbWVudC5jc3MoInBvc2l0aW9uIikpO2lmKGYmJmcpYy09YS5wYXJlbnREYXRhLmxlZnQ7aWYoYythLnNpemUud2lkdGg+PWEucGFyZW50RGF0YS53aWR0aCl7YS5zaXplLndpZHRoPWEucGFyZW50RGF0YS53aWR0aC1jO2lmKGIpYS5zaXplLmhlaWdodD1hLnNpemUud2lkdGgvYS5hc3BlY3RSYXRpb31pZihkKwphLnNpemUuaGVpZ2h0Pj1hLnBhcmVudERhdGEuaGVpZ2h0KXthLnNpemUuaGVpZ2h0PWEucGFyZW50RGF0YS5oZWlnaHQtZDtpZihiKWEuc2l6ZS53aWR0aD1hLnNpemUuaGVpZ2h0KmEuYXNwZWN0UmF0aW99fSxzdG9wOmZ1bmN0aW9uKCl7dmFyIGI9ZSh0aGlzKS5kYXRhKCJyZXNpemFibGUiKSxhPWIub3B0aW9ucyxjPWIuY29udGFpbmVyT2Zmc2V0LGQ9Yi5jb250YWluZXJQb3NpdGlvbixmPWIuY29udGFpbmVyRWxlbWVudCxnPWUoYi5oZWxwZXIpLGg9Zy5vZmZzZXQoKSxpPWcub3V0ZXJXaWR0aCgpLWIuc2l6ZURpZmYud2lkdGg7Zz1nLm91dGVySGVpZ2h0KCktYi5zaXplRGlmZi5oZWlnaHQ7Yi5faGVscGVyJiYhYS5hbmltYXRlJiYvcmVsYXRpdmUvLnRlc3QoZi5jc3MoInBvc2l0aW9uIikpJiZlKHRoaXMpLmNzcyh7bGVmdDpoLmxlZnQtZC5sZWZ0LWMubGVmdCx3aWR0aDppLGhlaWdodDpnfSk7Yi5faGVscGVyJiYhYS5hbmltYXRlJiYvc3RhdGljLy50ZXN0KGYuY3NzKCJwb3NpdGlvbiIpKSYmCmUodGhpcykuY3NzKHtsZWZ0OmgubGVmdC1kLmxlZnQtYy5sZWZ0LHdpZHRoOmksaGVpZ2h0Omd9KX19KTtlLnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImdob3N0Iix7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgYj1lKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGE9Yi5vcHRpb25zLGM9Yi5zaXplO2IuZ2hvc3Q9Yi5vcmlnaW5hbEVsZW1lbnQuY2xvbmUoKTtiLmdob3N0LmNzcyh7b3BhY2l0eTowLjI1LGRpc3BsYXk6ImJsb2NrIixwb3NpdGlvbjoicmVsYXRpdmUiLGhlaWdodDpjLmhlaWdodCx3aWR0aDpjLndpZHRoLG1hcmdpbjowLGxlZnQ6MCx0b3A6MH0pLmFkZENsYXNzKCJ1aS1yZXNpemFibGUtZ2hvc3QiKS5hZGRDbGFzcyh0eXBlb2YgYS5naG9zdD09InN0cmluZyI/YS5naG9zdDoiIik7Yi5naG9zdC5hcHBlbmRUbyhiLmhlbHBlcil9LHJlc2l6ZTpmdW5jdGlvbigpe3ZhciBiPWUodGhpcykuZGF0YSgicmVzaXphYmxlIik7Yi5naG9zdCYmYi5naG9zdC5jc3Moe3Bvc2l0aW9uOiJyZWxhdGl2ZSIsCmhlaWdodDpiLnNpemUuaGVpZ2h0LHdpZHRoOmIuc2l6ZS53aWR0aH0pfSxzdG9wOmZ1bmN0aW9uKCl7dmFyIGI9ZSh0aGlzKS5kYXRhKCJyZXNpemFibGUiKTtiLmdob3N0JiZiLmhlbHBlciYmYi5oZWxwZXIuZ2V0KDApLnJlbW92ZUNoaWxkKGIuZ2hvc3QuZ2V0KDApKX19KTtlLnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImdyaWQiLHtyZXNpemU6ZnVuY3Rpb24oKXt2YXIgYj1lKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGE9Yi5vcHRpb25zLGM9Yi5zaXplLGQ9Yi5vcmlnaW5hbFNpemUsZj1iLm9yaWdpbmFsUG9zaXRpb24sZz1iLmF4aXM7YS5ncmlkPXR5cGVvZiBhLmdyaWQ9PSJudW1iZXIiP1thLmdyaWQsYS5ncmlkXTphLmdyaWQ7dmFyIGg9TWF0aC5yb3VuZCgoYy53aWR0aC1kLndpZHRoKS8oYS5ncmlkWzBdfHwxKSkqKGEuZ3JpZFswXXx8MSk7YT1NYXRoLnJvdW5kKChjLmhlaWdodC1kLmhlaWdodCkvKGEuZ3JpZFsxXXx8MSkpKihhLmdyaWRbMV18fDEpO2lmKC9eKHNlfHN8ZSkkLy50ZXN0KGcpKXtiLnNpemUud2lkdGg9CmQud2lkdGgraDtiLnNpemUuaGVpZ2h0PWQuaGVpZ2h0K2F9ZWxzZSBpZigvXihuZSkkLy50ZXN0KGcpKXtiLnNpemUud2lkdGg9ZC53aWR0aCtoO2Iuc2l6ZS5oZWlnaHQ9ZC5oZWlnaHQrYTtiLnBvc2l0aW9uLnRvcD1mLnRvcC1hfWVsc2V7aWYoL14oc3cpJC8udGVzdChnKSl7Yi5zaXplLndpZHRoPWQud2lkdGgraDtiLnNpemUuaGVpZ2h0PWQuaGVpZ2h0K2F9ZWxzZXtiLnNpemUud2lkdGg9ZC53aWR0aCtoO2Iuc2l6ZS5oZWlnaHQ9ZC5oZWlnaHQrYTtiLnBvc2l0aW9uLnRvcD1mLnRvcC1hfWIucG9zaXRpb24ubGVmdD1mLmxlZnQtaH19fSk7dmFyIG09ZnVuY3Rpb24oYil7cmV0dXJuIHBhcnNlSW50KGIsMTApfHwwfSxsPWZ1bmN0aW9uKGIpe3JldHVybiFpc05hTihwYXJzZUludChiLDEwKSl9fSkoalF1ZXJ5KTsKOw==",
	"jquery.js": "LyohCiAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuNC40CiAqIGh0dHA6Ly9qcXVlcnkuY29tLwogKgogKiBDb3B5cmlnaHQgMjAxMCwgSm9obiBSZXNpZwogKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgb3IgR1BMIFZlcnNpb24gMiBsaWNlbnNlcy4KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQogKgogKiBJbmNsdWRlcyBTaXp6bGUuanMKICogaHR0cDovL3NpenpsZWpzLmNvbS8KICogQ29weXJpZ2h0IDIwMTAsIFRoZSBEb2pvIEZvdW5kYXRpb24KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCwgQlNELCBhbmQgR1BMIExpY2Vuc2VzLgogKgogKiBEYXRlOiBUaHUgTm92IDExIDE5OjA0OjUzIDIwMTAgLTA1MDAKICovCihmdW5jdGlvbihFLEIpe2Z1bmN0aW9uIGthKGEsYixkKXtpZihkPT09QiYmYS5ub2RlVHlwZT09PTEpe2Q9YS5nZXRBdHRyaWJ1dGUoImRhdGEtIitiKTtpZih0eXBlb2YgZD09PSJzdHJpbmciKXt0cnl7ZD1kPT09InRydWUiP3RydWU6ZD09PSJmYWxzZSI/ZmFsc2U6ZD09PSJudWxsIj9udWxsOiFjLmlzTmFOKGQpP3BhcnNlRmxvYXQoZCk6SmEudGVzdChkKT9jLnBhcnNlSlNPTihkKTpkfWNhdGNoKGUpe31jLmRhdGEoYSxiLGQpfWVsc2UgZD1CfXJldHVybiBkfWZ1bmN0aW9uIFUoKXtyZXR1cm4gZmFsc2V9ZnVuY3Rpb24gY2EoKXtyZXR1cm4gdHJ1ZX1mdW5jdGlvbiBsYShhLGIsZCl7ZFswXS50eXBlPWE7cmV0dXJuIGMuZXZlbnQuaGFuZGxlLmFwcGx5KGIsZCl9ZnVuY3Rpb24gS2EoYSl7dmFyIGIsZCxlLGYsaCxsLGssbyx4LHIsQSxDPVtdO2Y9W107aD1jLmRhdGEodGhpcyx0aGlzLm5vZGVUeXBlPyJldmVudHMiOiJfX2V2ZW50c19fIik7aWYodHlwZW9mIGg9PT0iZnVuY3Rpb24iKWg9CmguZXZlbnRzO2lmKCEoYS5saXZlRmlyZWQ9PT10aGlzfHwhaHx8IWgubGl2ZXx8YS5idXR0b24mJmEudHlwZT09PSJjbGljayIpKXtpZihhLm5hbWVzcGFjZSlBPVJlZ0V4cCgiKF58XFwuKSIrYS5uYW1lc3BhY2Uuc3BsaXQoIi4iKS5qb2luKCJcXC4oPzouKlxcLik/IikrIihcXC58JCkiKTthLmxpdmVGaXJlZD10aGlzO3ZhciBKPWgubGl2ZS5zbGljZSgwKTtmb3Ioaz0wO2s8Si5sZW5ndGg7aysrKXtoPUpba107aC5vcmlnVHlwZS5yZXBsYWNlKFgsIiIpPT09YS50eXBlP2YucHVzaChoLnNlbGVjdG9yKTpKLnNwbGljZShrLS0sMSl9Zj1jKGEudGFyZ2V0KS5jbG9zZXN0KGYsYS5jdXJyZW50VGFyZ2V0KTtvPTA7Zm9yKHg9Zi5sZW5ndGg7bzx4O28rKyl7cj1mW29dO2ZvcihrPTA7azxKLmxlbmd0aDtrKyspe2g9SltrXTtpZihyLnNlbGVjdG9yPT09aC5zZWxlY3RvciYmKCFBfHxBLnRlc3QoaC5uYW1lc3BhY2UpKSl7bD1yLmVsZW07ZT1udWxsO2lmKGgucHJlVHlwZT09PSJtb3VzZWVudGVyInx8CmgucHJlVHlwZT09PSJtb3VzZWxlYXZlIil7YS50eXBlPWgucHJlVHlwZTtlPWMoYS5yZWxhdGVkVGFyZ2V0KS5jbG9zZXN0KGguc2VsZWN0b3IpWzBdfWlmKCFlfHxlIT09bClDLnB1c2goe2VsZW06bCxoYW5kbGVPYmo6aCxsZXZlbDpyLmxldmVsfSl9fX1vPTA7Zm9yKHg9Qy5sZW5ndGg7bzx4O28rKyl7Zj1DW29dO2lmKGQmJmYubGV2ZWw+ZClicmVhazthLmN1cnJlbnRUYXJnZXQ9Zi5lbGVtO2EuZGF0YT1mLmhhbmRsZU9iai5kYXRhO2EuaGFuZGxlT2JqPWYuaGFuZGxlT2JqO0E9Zi5oYW5kbGVPYmoub3JpZ0hhbmRsZXIuYXBwbHkoZi5lbGVtLGFyZ3VtZW50cyk7aWYoQT09PWZhbHNlfHxhLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe2Q9Zi5sZXZlbDtpZihBPT09ZmFsc2UpYj1mYWxzZTtpZihhLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpYnJlYWt9fXJldHVybiBifX1mdW5jdGlvbiBZKGEsYil7cmV0dXJuKGEmJmEhPT0iKiI/YSsiLiI6IiIpK2IucmVwbGFjZShMYSwKImAiKS5yZXBsYWNlKE1hLCImIil9ZnVuY3Rpb24gbWEoYSxiLGQpe2lmKGMuaXNGdW5jdGlvbihiKSlyZXR1cm4gYy5ncmVwKGEsZnVuY3Rpb24oZixoKXtyZXR1cm4hIWIuY2FsbChmLGgsZik9PT1kfSk7ZWxzZSBpZihiLm5vZGVUeXBlKXJldHVybiBjLmdyZXAoYSxmdW5jdGlvbihmKXtyZXR1cm4gZj09PWI9PT1kfSk7ZWxzZSBpZih0eXBlb2YgYj09PSJzdHJpbmciKXt2YXIgZT1jLmdyZXAoYSxmdW5jdGlvbihmKXtyZXR1cm4gZi5ub2RlVHlwZT09PTF9KTtpZihOYS50ZXN0KGIpKXJldHVybiBjLmZpbHRlcihiLGUsIWQpO2Vsc2UgYj1jLmZpbHRlcihiLGUpfXJldHVybiBjLmdyZXAoYSxmdW5jdGlvbihmKXtyZXR1cm4gYy5pbkFycmF5KGYsYik+PTA9PT1kfSl9ZnVuY3Rpb24gbmEoYSxiKXt2YXIgZD0wO2IuZWFjaChmdW5jdGlvbigpe2lmKHRoaXMubm9kZU5hbWU9PT0oYVtkXSYmYVtkXS5ub2RlTmFtZSkpe3ZhciBlPWMuZGF0YShhW2QrK10pLGY9Yy5kYXRhKHRoaXMsCmUpO2lmKGU9ZSYmZS5ldmVudHMpe2RlbGV0ZSBmLmhhbmRsZTtmLmV2ZW50cz17fTtmb3IodmFyIGggaW4gZSlmb3IodmFyIGwgaW4gZVtoXSljLmV2ZW50LmFkZCh0aGlzLGgsZVtoXVtsXSxlW2hdW2xdLmRhdGEpfX19KX1mdW5jdGlvbiBPYShhLGIpe2Iuc3JjP2MuYWpheCh7dXJsOmIuc3JjLGFzeW5jOmZhbHNlLGRhdGFUeXBlOiJzY3JpcHQifSk6Yy5nbG9iYWxFdmFsKGIudGV4dHx8Yi50ZXh0Q29udGVudHx8Yi5pbm5lckhUTUx8fCIiKTtiLnBhcmVudE5vZGUmJmIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKX1mdW5jdGlvbiBvYShhLGIsZCl7dmFyIGU9Yj09PSJ3aWR0aCI/YS5vZmZzZXRXaWR0aDphLm9mZnNldEhlaWdodDtpZihkPT09ImJvcmRlciIpcmV0dXJuIGU7Yy5lYWNoKGI9PT0id2lkdGgiP1BhOlFhLGZ1bmN0aW9uKCl7ZHx8KGUtPXBhcnNlRmxvYXQoYy5jc3MoYSwicGFkZGluZyIrdGhpcykpfHwwKTtpZihkPT09Im1hcmdpbiIpZSs9cGFyc2VGbG9hdChjLmNzcyhhLAoibWFyZ2luIit0aGlzKSl8fDA7ZWxzZSBlLT1wYXJzZUZsb2F0KGMuY3NzKGEsImJvcmRlciIrdGhpcysiV2lkdGgiKSl8fDB9KTtyZXR1cm4gZX1mdW5jdGlvbiBkYShhLGIsZCxlKXtpZihjLmlzQXJyYXkoYikmJmIubGVuZ3RoKWMuZWFjaChiLGZ1bmN0aW9uKGYsaCl7ZHx8UmEudGVzdChhKT9lKGEsaCk6ZGEoYSsiWyIrKHR5cGVvZiBoPT09Im9iamVjdCJ8fGMuaXNBcnJheShoKT9mOiIiKSsiXSIsaCxkLGUpfSk7ZWxzZSBpZighZCYmYiE9bnVsbCYmdHlwZW9mIGI9PT0ib2JqZWN0IiljLmlzRW1wdHlPYmplY3QoYik/ZShhLCIiKTpjLmVhY2goYixmdW5jdGlvbihmLGgpe2RhKGErIlsiK2YrIl0iLGgsZCxlKX0pO2Vsc2UgZShhLGIpfWZ1bmN0aW9uIFMoYSxiKXt2YXIgZD17fTtjLmVhY2gocGEuY29uY2F0LmFwcGx5KFtdLHBhLnNsaWNlKDAsYikpLGZ1bmN0aW9uKCl7ZFt0aGlzXT1hfSk7cmV0dXJuIGR9ZnVuY3Rpb24gcWEoYSl7aWYoIWVhW2FdKXt2YXIgYj1jKCI8IisKYSsiPiIpLmFwcGVuZFRvKCJib2R5IiksZD1iLmNzcygiZGlzcGxheSIpO2IucmVtb3ZlKCk7aWYoZD09PSJub25lInx8ZD09PSIiKWQ9ImJsb2NrIjtlYVthXT1kfXJldHVybiBlYVthXX1mdW5jdGlvbiBmYShhKXtyZXR1cm4gYy5pc1dpbmRvdyhhKT9hOmEubm9kZVR5cGU9PT05P2EuZGVmYXVsdFZpZXd8fGEucGFyZW50V2luZG93OmZhbHNlfXZhciB0PUUuZG9jdW1lbnQsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXtpZighYi5pc1JlYWR5KXt0cnl7dC5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwoImxlZnQiKX1jYXRjaChqKXtzZXRUaW1lb3V0KGEsMSk7cmV0dXJufWIucmVhZHkoKX19dmFyIGI9ZnVuY3Rpb24oaixzKXtyZXR1cm4gbmV3IGIuZm4uaW5pdChqLHMpfSxkPUUualF1ZXJ5LGU9RS4kLGYsaD0vXig/OltePF0qKDxbXHdcV10rPilbXj5dKiR8IyhbXHdcLV0rKSQpLyxsPS9cUy8saz0vXlxzKy8sbz0vXHMrJC8seD0vXFcvLHI9L1xkLyxBPS9ePChcdyspXHMqXC8/Pig/OjxcL1wxPik/JC8sCkM9L15bXF0sOnt9XHNdKiQvLEo9L1xcKD86WyJcXFwvYmZucnRdfHVbMC05YS1mQS1GXXs0fSkvZyx3PS8iW14iXFxcblxyXSoifHRydWV8ZmFsc2V8bnVsbHwtP1xkKyg/OlwuXGQqKT8oPzpbZUVdWytcLV0/XGQrKT8vZyxJPS8oPzpefDp8LCkoPzpccypcWykrL2csTD0vKHdlYmtpdClbIFwvXShbXHcuXSspLyxnPS8ob3BlcmEpKD86Lip2ZXJzaW9uKT9bIFwvXShbXHcuXSspLyxpPS8obXNpZSkgKFtcdy5dKykvLG49Lyhtb3ppbGxhKSg/Oi4qPyBydjooW1x3Ll0rKSk/LyxtPW5hdmlnYXRvci51c2VyQWdlbnQscD1mYWxzZSxxPVtdLHUseT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLEY9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxNPUFycmF5LnByb3RvdHlwZS5wdXNoLE49QXJyYXkucHJvdG90eXBlLnNsaWNlLE89U3RyaW5nLnByb3RvdHlwZS50cmltLEQ9QXJyYXkucHJvdG90eXBlLmluZGV4T2YsUj17fTtiLmZuPWIucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGosCnMpe3ZhciB2LHosSDtpZighailyZXR1cm4gdGhpcztpZihqLm5vZGVUeXBlKXt0aGlzLmNvbnRleHQ9dGhpc1swXT1qO3RoaXMubGVuZ3RoPTE7cmV0dXJuIHRoaXN9aWYoaj09PSJib2R5IiYmIXMmJnQuYm9keSl7dGhpcy5jb250ZXh0PXQ7dGhpc1swXT10LmJvZHk7dGhpcy5zZWxlY3Rvcj0iYm9keSI7dGhpcy5sZW5ndGg9MTtyZXR1cm4gdGhpc31pZih0eXBlb2Ygaj09PSJzdHJpbmciKWlmKCh2PWguZXhlYyhqKSkmJih2WzFdfHwhcykpaWYodlsxXSl7SD1zP3Mub3duZXJEb2N1bWVudHx8czp0O2lmKHo9QS5leGVjKGopKWlmKGIuaXNQbGFpbk9iamVjdChzKSl7aj1bdC5jcmVhdGVFbGVtZW50KHpbMV0pXTtiLmZuLmF0dHIuY2FsbChqLHMsdHJ1ZSl9ZWxzZSBqPVtILmNyZWF0ZUVsZW1lbnQoelsxXSldO2Vsc2V7ej1iLmJ1aWxkRnJhZ21lbnQoW3ZbMV1dLFtIXSk7aj0oei5jYWNoZWFibGU/ei5mcmFnbWVudC5jbG9uZU5vZGUodHJ1ZSk6ei5mcmFnbWVudCkuY2hpbGROb2Rlc31yZXR1cm4gYi5tZXJnZSh0aGlzLApqKX1lbHNle2lmKCh6PXQuZ2V0RWxlbWVudEJ5SWQodlsyXSkpJiZ6LnBhcmVudE5vZGUpe2lmKHouaWQhPT12WzJdKXJldHVybiBmLmZpbmQoaik7dGhpcy5sZW5ndGg9MTt0aGlzWzBdPXp9dGhpcy5jb250ZXh0PXQ7dGhpcy5zZWxlY3Rvcj1qO3JldHVybiB0aGlzfWVsc2UgaWYoIXMmJiF4LnRlc3Qoaikpe3RoaXMuc2VsZWN0b3I9ajt0aGlzLmNvbnRleHQ9dDtqPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoaik7cmV0dXJuIGIubWVyZ2UodGhpcyxqKX1lbHNlIHJldHVybiFzfHxzLmpxdWVyeT8oc3x8ZikuZmluZChqKTpiKHMpLmZpbmQoaik7ZWxzZSBpZihiLmlzRnVuY3Rpb24oaikpcmV0dXJuIGYucmVhZHkoaik7aWYoai5zZWxlY3RvciE9PUIpe3RoaXMuc2VsZWN0b3I9ai5zZWxlY3Rvcjt0aGlzLmNvbnRleHQ9ai5jb250ZXh0fXJldHVybiBiLm1ha2VBcnJheShqLHRoaXMpfSxzZWxlY3RvcjoiIixqcXVlcnk6IjEuNC40IixsZW5ndGg6MCxzaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RofSwKdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBOLmNhbGwodGhpcywwKX0sZ2V0OmZ1bmN0aW9uKGope3JldHVybiBqPT1udWxsP3RoaXMudG9BcnJheSgpOmo8MD90aGlzLnNsaWNlKGopWzBdOnRoaXNbal19LHB1c2hTdGFjazpmdW5jdGlvbihqLHMsdil7dmFyIHo9YigpO2IuaXNBcnJheShqKT9NLmFwcGx5KHosaik6Yi5tZXJnZSh6LGopO3oucHJldk9iamVjdD10aGlzO3ouY29udGV4dD10aGlzLmNvbnRleHQ7aWYocz09PSJmaW5kIil6LnNlbGVjdG9yPXRoaXMuc2VsZWN0b3IrKHRoaXMuc2VsZWN0b3I/IiAiOiIiKSt2O2Vsc2UgaWYocyl6LnNlbGVjdG9yPXRoaXMuc2VsZWN0b3IrIi4iK3MrIigiK3YrIikiO3JldHVybiB6fSxlYWNoOmZ1bmN0aW9uKGoscyl7cmV0dXJuIGIuZWFjaCh0aGlzLGoscyl9LHJlYWR5OmZ1bmN0aW9uKGope2IuYmluZFJlYWR5KCk7aWYoYi5pc1JlYWR5KWouY2FsbCh0LGIpO2Vsc2UgcSYmcS5wdXNoKGopO3JldHVybiB0aGlzfSxlcTpmdW5jdGlvbihqKXtyZXR1cm4gaj09PQotMT90aGlzLnNsaWNlKGopOnRoaXMuc2xpY2UoaiwraisxKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soTi5hcHBseSh0aGlzLGFyZ3VtZW50cyksInNsaWNlIixOLmNhbGwoYXJndW1lbnRzKS5qb2luKCIsIikpfSxtYXA6ZnVuY3Rpb24oail7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGIubWFwKHRoaXMsZnVuY3Rpb24ocyx2KXtyZXR1cm4gai5jYWxsKHMsdixzKX0pKX0sZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldk9iamVjdHx8YihudWxsKX0scHVzaDpNLHNvcnQ6W10uc29ydCxzcGxpY2U6W10uc3BsaWNlfTtiLmZuLmluaXQucHJvdG90eXBlPWIuZm47Yi5leHRlbmQ9Yi5mbi5leHRlbmQ9ZnVuY3Rpb24oKXt2YXIgaixzLHYseixILEc9YXJndW1lbnRzWzBdfHx7fSxLPTEsUT1hcmd1bWVudHMubGVuZ3RoLGdhPWZhbHNlOwppZih0eXBlb2YgRz09PSJib29sZWFuIil7Z2E9RztHPWFyZ3VtZW50c1sxXXx8e307Sz0yfWlmKHR5cGVvZiBHIT09Im9iamVjdCImJiFiLmlzRnVuY3Rpb24oRykpRz17fTtpZihRPT09Syl7Rz10aGlzOy0tS31mb3IoO0s8UTtLKyspaWYoKGo9YXJndW1lbnRzW0tdKSE9bnVsbClmb3IocyBpbiBqKXt2PUdbc107ej1qW3NdO2lmKEchPT16KWlmKGdhJiZ6JiYoYi5pc1BsYWluT2JqZWN0KHopfHwoSD1iLmlzQXJyYXkoeikpKSl7aWYoSCl7SD1mYWxzZTt2PXYmJmIuaXNBcnJheSh2KT92OltdfWVsc2Ugdj12JiZiLmlzUGxhaW5PYmplY3Qodik/djp7fTtHW3NdPWIuZXh0ZW5kKGdhLHYseil9ZWxzZSBpZih6IT09QilHW3NdPXp9cmV0dXJuIEd9O2IuZXh0ZW5kKHtub0NvbmZsaWN0OmZ1bmN0aW9uKGope0UuJD1lO2lmKGopRS5qUXVlcnk9ZDtyZXR1cm4gYn0saXNSZWFkeTpmYWxzZSxyZWFkeVdhaXQ6MSxyZWFkeTpmdW5jdGlvbihqKXtqPT09dHJ1ZSYmYi5yZWFkeVdhaXQtLTsKaWYoIWIucmVhZHlXYWl0fHxqIT09dHJ1ZSYmIWIuaXNSZWFkeSl7aWYoIXQuYm9keSlyZXR1cm4gc2V0VGltZW91dChiLnJlYWR5LDEpO2IuaXNSZWFkeT10cnVlO2lmKCEoaiE9PXRydWUmJi0tYi5yZWFkeVdhaXQ+MCkpaWYocSl7dmFyIHM9MCx2PXE7Zm9yKHE9bnVsbDtqPXZbcysrXTspai5jYWxsKHQsYik7Yi5mbi50cmlnZ2VyJiZiKHQpLnRyaWdnZXIoInJlYWR5IikudW5iaW5kKCJyZWFkeSIpfX19LGJpbmRSZWFkeTpmdW5jdGlvbigpe2lmKCFwKXtwPXRydWU7aWYodC5yZWFkeVN0YXRlPT09ImNvbXBsZXRlIilyZXR1cm4gc2V0VGltZW91dChiLnJlYWR5LDEpO2lmKHQuYWRkRXZlbnRMaXN0ZW5lcil7dC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIix1LGZhbHNlKTtFLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLGIucmVhZHksZmFsc2UpfWVsc2UgaWYodC5hdHRhY2hFdmVudCl7dC5hdHRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIix1KTtFLmF0dGFjaEV2ZW50KCJvbmxvYWQiLApiLnJlYWR5KTt2YXIgaj1mYWxzZTt0cnl7aj1FLmZyYW1lRWxlbWVudD09bnVsbH1jYXRjaChzKXt9dC5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwmJmomJmEoKX19fSxpc0Z1bmN0aW9uOmZ1bmN0aW9uKGope3JldHVybiBiLnR5cGUoaik9PT0iZnVuY3Rpb24ifSxpc0FycmF5OkFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKGope3JldHVybiBiLnR5cGUoaik9PT0iYXJyYXkifSxpc1dpbmRvdzpmdW5jdGlvbihqKXtyZXR1cm4gaiYmdHlwZW9mIGo9PT0ib2JqZWN0IiYmInNldEludGVydmFsImluIGp9LGlzTmFOOmZ1bmN0aW9uKGope3JldHVybiBqPT1udWxsfHwhci50ZXN0KGopfHxpc05hTihqKX0sdHlwZTpmdW5jdGlvbihqKXtyZXR1cm4gaj09bnVsbD9TdHJpbmcoaik6Ult5LmNhbGwoaildfHwib2JqZWN0In0saXNQbGFpbk9iamVjdDpmdW5jdGlvbihqKXtpZighanx8Yi50eXBlKGopIT09Im9iamVjdCJ8fGoubm9kZVR5cGV8fGIuaXNXaW5kb3coaikpcmV0dXJuIGZhbHNlO2lmKGouY29uc3RydWN0b3ImJgohRi5jYWxsKGosImNvbnN0cnVjdG9yIikmJiFGLmNhbGwoai5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsImlzUHJvdG90eXBlT2YiKSlyZXR1cm4gZmFsc2U7Zm9yKHZhciBzIGluIGopO3JldHVybiBzPT09Qnx8Ri5jYWxsKGoscyl9LGlzRW1wdHlPYmplY3Q6ZnVuY3Rpb24oail7Zm9yKHZhciBzIGluIGopcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlfSxlcnJvcjpmdW5jdGlvbihqKXt0aHJvdyBqO30scGFyc2VKU09OOmZ1bmN0aW9uKGope2lmKHR5cGVvZiBqIT09InN0cmluZyJ8fCFqKXJldHVybiBudWxsO2o9Yi50cmltKGopO2lmKEMudGVzdChqLnJlcGxhY2UoSiwiQCIpLnJlcGxhY2UodywiXSIpLnJlcGxhY2UoSSwiIikpKXJldHVybiBFLkpTT04mJkUuSlNPTi5wYXJzZT9FLkpTT04ucGFyc2Uoaik6KG5ldyBGdW5jdGlvbigicmV0dXJuICIraikpKCk7ZWxzZSBiLmVycm9yKCJJbnZhbGlkIEpTT046ICIrail9LG5vb3A6ZnVuY3Rpb24oKXt9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oail7aWYoaiYmCmwudGVzdChqKSl7dmFyIHM9dC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdfHx0LmRvY3VtZW50RWxlbWVudCx2PXQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7di50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiO2lmKGIuc3VwcG9ydC5zY3JpcHRFdmFsKXYuYXBwZW5kQ2hpbGQodC5jcmVhdGVUZXh0Tm9kZShqKSk7ZWxzZSB2LnRleHQ9ajtzLmluc2VydEJlZm9yZSh2LHMuZmlyc3RDaGlsZCk7cy5yZW1vdmVDaGlsZCh2KX19LG5vZGVOYW1lOmZ1bmN0aW9uKGoscyl7cmV0dXJuIGoubm9kZU5hbWUmJmoubm9kZU5hbWUudG9VcHBlckNhc2UoKT09PXMudG9VcHBlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihqLHMsdil7dmFyIHosSD0wLEc9ai5sZW5ndGgsSz1HPT09Qnx8Yi5pc0Z1bmN0aW9uKGopO2lmKHYpaWYoSylmb3IoeiBpbiBqKXtpZihzLmFwcGx5KGpbel0sdik9PT1mYWxzZSlicmVha31lbHNlIGZvcig7SDxHOyl7aWYocy5hcHBseShqW0grK10sdik9PT1mYWxzZSlicmVha31lbHNlIGlmKEspZm9yKHogaW4gail7aWYocy5jYWxsKGpbel0sCnosalt6XSk9PT1mYWxzZSlicmVha31lbHNlIGZvcih2PWpbMF07SDxHJiZzLmNhbGwodixILHYpIT09ZmFsc2U7dj1qWysrSF0pO3JldHVybiBqfSx0cmltOk8/ZnVuY3Rpb24oail7cmV0dXJuIGo9PW51bGw/IiI6Ty5jYWxsKGopfTpmdW5jdGlvbihqKXtyZXR1cm4gaj09bnVsbD8iIjpqLnRvU3RyaW5nKCkucmVwbGFjZShrLCIiKS5yZXBsYWNlKG8sIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oaixzKXt2YXIgdj1zfHxbXTtpZihqIT1udWxsKXt2YXIgej1iLnR5cGUoaik7ai5sZW5ndGg9PW51bGx8fHo9PT0ic3RyaW5nInx8ej09PSJmdW5jdGlvbiJ8fHo9PT0icmVnZXhwInx8Yi5pc1dpbmRvdyhqKT9NLmNhbGwodixqKTpiLm1lcmdlKHYsail9cmV0dXJuIHZ9LGluQXJyYXk6ZnVuY3Rpb24oaixzKXtpZihzLmluZGV4T2YpcmV0dXJuIHMuaW5kZXhPZihqKTtmb3IodmFyIHY9MCx6PXMubGVuZ3RoO3Y8ejt2KyspaWYoc1t2XT09PWopcmV0dXJuIHY7cmV0dXJuLTF9LG1lcmdlOmZ1bmN0aW9uKGosCnMpe3ZhciB2PWoubGVuZ3RoLHo9MDtpZih0eXBlb2Ygcy5sZW5ndGg9PT0ibnVtYmVyIilmb3IodmFyIEg9cy5sZW5ndGg7ejxIO3orKylqW3YrK109c1t6XTtlbHNlIGZvcig7c1t6XSE9PUI7KWpbdisrXT1zW3orK107ai5sZW5ndGg9djtyZXR1cm4gan0sZ3JlcDpmdW5jdGlvbihqLHMsdil7dmFyIHo9W10sSDt2PSEhdjtmb3IodmFyIEc9MCxLPWoubGVuZ3RoO0c8SztHKyspe0g9ISFzKGpbR10sRyk7diE9PUgmJnoucHVzaChqW0ddKX1yZXR1cm4gen0sbWFwOmZ1bmN0aW9uKGoscyx2KXtmb3IodmFyIHo9W10sSCxHPTAsSz1qLmxlbmd0aDtHPEs7RysrKXtIPXMoaltHXSxHLHYpO2lmKEghPW51bGwpelt6Lmxlbmd0aF09SH1yZXR1cm4gei5jb25jYXQuYXBwbHkoW10seil9LGd1aWQ6MSxwcm94eTpmdW5jdGlvbihqLHMsdil7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpaWYodHlwZW9mIHM9PT0ic3RyaW5nIil7dj1qO2o9dltzXTtzPUJ9ZWxzZSBpZihzJiYhYi5pc0Z1bmN0aW9uKHMpKXt2PQpzO3M9Qn1pZighcyYmailzPWZ1bmN0aW9uKCl7cmV0dXJuIGouYXBwbHkodnx8dGhpcyxhcmd1bWVudHMpfTtpZihqKXMuZ3VpZD1qLmd1aWQ9ai5ndWlkfHxzLmd1aWR8fGIuZ3VpZCsrO3JldHVybiBzfSxhY2Nlc3M6ZnVuY3Rpb24oaixzLHYseixILEcpe3ZhciBLPWoubGVuZ3RoO2lmKHR5cGVvZiBzPT09Im9iamVjdCIpe2Zvcih2YXIgUSBpbiBzKWIuYWNjZXNzKGosUSxzW1FdLHosSCx2KTtyZXR1cm4gan1pZih2IT09Qil7ej0hRyYmeiYmYi5pc0Z1bmN0aW9uKHYpO2ZvcihRPTA7UTxLO1ErKylIKGpbUV0scyx6P3YuY2FsbChqW1FdLFEsSChqW1FdLHMpKTp2LEcpO3JldHVybiBqfXJldHVybiBLP0goalswXSxzKTpCfSxub3c6ZnVuY3Rpb24oKXtyZXR1cm4obmV3IERhdGUpLmdldFRpbWUoKX0sdWFNYXRjaDpmdW5jdGlvbihqKXtqPWoudG9Mb3dlckNhc2UoKTtqPUwuZXhlYyhqKXx8Zy5leGVjKGopfHxpLmV4ZWMoail8fGouaW5kZXhPZigiY29tcGF0aWJsZSIpPDAmJm4uZXhlYyhqKXx8CltdO3JldHVybnticm93c2VyOmpbMV18fCIiLHZlcnNpb246alsyXXx8IjAifX0sYnJvd3Nlcjp7fX0pO2IuZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCIuc3BsaXQoIiAiKSxmdW5jdGlvbihqLHMpe1JbIltvYmplY3QgIitzKyJdIl09cy50b0xvd2VyQ2FzZSgpfSk7bT1iLnVhTWF0Y2gobSk7aWYobS5icm93c2VyKXtiLmJyb3dzZXJbbS5icm93c2VyXT10cnVlO2IuYnJvd3Nlci52ZXJzaW9uPW0udmVyc2lvbn1pZihiLmJyb3dzZXIud2Via2l0KWIuYnJvd3Nlci5zYWZhcmk9dHJ1ZTtpZihEKWIuaW5BcnJheT1mdW5jdGlvbihqLHMpe3JldHVybiBELmNhbGwocyxqKX07aWYoIS9ccy8udGVzdCgiXHUwMGEwIikpe2s9L15bXHNceEEwXSsvO289L1tcc1x4QTBdKyQvfWY9Yih0KTtpZih0LmFkZEV2ZW50TGlzdGVuZXIpdT1mdW5jdGlvbigpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsdSwKZmFsc2UpO2IucmVhZHkoKX07ZWxzZSBpZih0LmF0dGFjaEV2ZW50KXU9ZnVuY3Rpb24oKXtpZih0LnJlYWR5U3RhdGU9PT0iY29tcGxldGUiKXt0LmRldGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLHUpO2IucmVhZHkoKX19O3JldHVybiBFLmpRdWVyeT1FLiQ9Yn0oKTsoZnVuY3Rpb24oKXtjLnN1cHBvcnQ9e307dmFyIGE9dC5kb2N1bWVudEVsZW1lbnQsYj10LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpLGQ9dC5jcmVhdGVFbGVtZW50KCJkaXYiKSxlPSJzY3JpcHQiK2Mubm93KCk7ZC5zdHlsZS5kaXNwbGF5PSJub25lIjtkLmlubmVySFRNTD0iICAgPGxpbmsvPjx0YWJsZT48L3RhYmxlPjxhIGhyZWY9Jy9hJyBzdHlsZT0nY29sb3I6cmVkO2Zsb2F0OmxlZnQ7b3BhY2l0eTouNTU7Jz5hPC9hPjxpbnB1dCB0eXBlPSdjaGVja2JveCcvPiI7dmFyIGY9ZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLGg9ZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpWzBdLGw9dC5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKSwKaz1sLmFwcGVuZENoaWxkKHQuY3JlYXRlRWxlbWVudCgib3B0aW9uIikpO2lmKCEoIWZ8fCFmLmxlbmd0aHx8IWgpKXtjLnN1cHBvcnQ9e2xlYWRpbmdXaGl0ZXNwYWNlOmQuZmlyc3RDaGlsZC5ub2RlVHlwZT09PTMsdGJvZHk6IWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRib2R5IikubGVuZ3RoLGh0bWxTZXJpYWxpemU6ISFkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJsaW5rIikubGVuZ3RoLHN0eWxlOi9yZWQvLnRlc3QoaC5nZXRBdHRyaWJ1dGUoInN0eWxlIikpLGhyZWZOb3JtYWxpemVkOmguZ2V0QXR0cmlidXRlKCJocmVmIik9PT0iL2EiLG9wYWNpdHk6L14wLjU1JC8udGVzdChoLnN0eWxlLm9wYWNpdHkpLGNzc0Zsb2F0OiEhaC5zdHlsZS5jc3NGbG9hdCxjaGVja09uOmQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbMF0udmFsdWU9PT0ib24iLG9wdFNlbGVjdGVkOmsuc2VsZWN0ZWQsZGVsZXRlRXhwYW5kbzp0cnVlLG9wdERpc2FibGVkOmZhbHNlLGNoZWNrQ2xvbmU6ZmFsc2UsCnNjcmlwdEV2YWw6ZmFsc2Usbm9DbG9uZUV2ZW50OnRydWUsYm94TW9kZWw6bnVsbCxpbmxpbmVCbG9ja05lZWRzTGF5b3V0OmZhbHNlLHNocmlua1dyYXBCbG9ja3M6ZmFsc2UscmVsaWFibGVIaWRkZW5PZmZzZXRzOnRydWV9O2wuZGlzYWJsZWQ9dHJ1ZTtjLnN1cHBvcnQub3B0RGlzYWJsZWQ9IWsuZGlzYWJsZWQ7Yi50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiO3RyeXtiLmFwcGVuZENoaWxkKHQuY3JlYXRlVGV4dE5vZGUoIndpbmRvdy4iK2UrIj0xOyIpKX1jYXRjaChvKXt9YS5pbnNlcnRCZWZvcmUoYixhLmZpcnN0Q2hpbGQpO2lmKEVbZV0pe2Muc3VwcG9ydC5zY3JpcHRFdmFsPXRydWU7ZGVsZXRlIEVbZV19dHJ5e2RlbGV0ZSBiLnRlc3R9Y2F0Y2goeCl7Yy5zdXBwb3J0LmRlbGV0ZUV4cGFuZG89ZmFsc2V9YS5yZW1vdmVDaGlsZChiKTtpZihkLmF0dGFjaEV2ZW50JiZkLmZpcmVFdmVudCl7ZC5hdHRhY2hFdmVudCgib25jbGljayIsZnVuY3Rpb24gcigpe2Muc3VwcG9ydC5ub0Nsb25lRXZlbnQ9CmZhbHNlO2QuZGV0YWNoRXZlbnQoIm9uY2xpY2siLHIpfSk7ZC5jbG9uZU5vZGUodHJ1ZSkuZmlyZUV2ZW50KCJvbmNsaWNrIil9ZD10LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2QuaW5uZXJIVE1MPSI8aW5wdXQgdHlwZT0ncmFkaW8nIG5hbWU9J3JhZGlvdGVzdCcgY2hlY2tlZD0nY2hlY2tlZCcvPiI7YT10LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTthLmFwcGVuZENoaWxkKGQuZmlyc3RDaGlsZCk7Yy5zdXBwb3J0LmNoZWNrQ2xvbmU9YS5jbG9uZU5vZGUodHJ1ZSkuY2xvbmVOb2RlKHRydWUpLmxhc3RDaGlsZC5jaGVja2VkO2MoZnVuY3Rpb24oKXt2YXIgcj10LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3Iuc3R5bGUud2lkdGg9ci5zdHlsZS5wYWRkaW5nTGVmdD0iMXB4Ijt0LmJvZHkuYXBwZW5kQ2hpbGQocik7Yy5ib3hNb2RlbD1jLnN1cHBvcnQuYm94TW9kZWw9ci5vZmZzZXRXaWR0aD09PTI7aWYoInpvb20iaW4gci5zdHlsZSl7ci5zdHlsZS5kaXNwbGF5PSJpbmxpbmUiO3Iuc3R5bGUuem9vbT0KMTtjLnN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dD1yLm9mZnNldFdpZHRoPT09MjtyLnN0eWxlLmRpc3BsYXk9IiI7ci5pbm5lckhUTUw9IjxkaXYgc3R5bGU9J3dpZHRoOjRweDsnPjwvZGl2PiI7Yy5zdXBwb3J0LnNocmlua1dyYXBCbG9ja3M9ci5vZmZzZXRXaWR0aCE9PTJ9ci5pbm5lckhUTUw9Ijx0YWJsZT48dHI+PHRkIHN0eWxlPSdwYWRkaW5nOjA7ZGlzcGxheTpub25lJz48L3RkPjx0ZD50PC90ZD48L3RyPjwvdGFibGU+Ijt2YXIgQT1yLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpO2Muc3VwcG9ydC5yZWxpYWJsZUhpZGRlbk9mZnNldHM9QVswXS5vZmZzZXRIZWlnaHQ9PT0wO0FbMF0uc3R5bGUuZGlzcGxheT0iIjtBWzFdLnN0eWxlLmRpc3BsYXk9Im5vbmUiO2Muc3VwcG9ydC5yZWxpYWJsZUhpZGRlbk9mZnNldHM9Yy5zdXBwb3J0LnJlbGlhYmxlSGlkZGVuT2Zmc2V0cyYmQVswXS5vZmZzZXRIZWlnaHQ9PT0wO3IuaW5uZXJIVE1MPSIiO3QuYm9keS5yZW1vdmVDaGlsZChyKS5zdHlsZS5kaXNwbGF5PQoibm9uZSJ9KTthPWZ1bmN0aW9uKHIpe3ZhciBBPXQuY3JlYXRlRWxlbWVudCgiZGl2Iik7cj0ib24iK3I7dmFyIEM9ciBpbiBBO2lmKCFDKXtBLnNldEF0dHJpYnV0ZShyLCJyZXR1cm47Iik7Qz10eXBlb2YgQVtyXT09PSJmdW5jdGlvbiJ9cmV0dXJuIEN9O2Muc3VwcG9ydC5zdWJtaXRCdWJibGVzPWEoInN1Ym1pdCIpO2Muc3VwcG9ydC5jaGFuZ2VCdWJibGVzPWEoImNoYW5nZSIpO2E9Yj1kPWY9aD1udWxsfX0pKCk7dmFyIHJhPXt9LEphPS9eKD86XHsuKlx9fFxbLipcXSkkLztjLmV4dGVuZCh7Y2FjaGU6e30sdXVpZDowLGV4cGFuZG86ImpRdWVyeSIrYy5ub3coKSxub0RhdGE6e2VtYmVkOnRydWUsb2JqZWN0OiJjbHNpZDpEMjdDREI2RS1BRTZELTExY2YtOTZCOC00NDQ1NTM1NDAwMDAiLGFwcGxldDp0cnVlfSxkYXRhOmZ1bmN0aW9uKGEsYixkKXtpZihjLmFjY2VwdERhdGEoYSkpe2E9YT09RT9yYTphO3ZhciBlPWEubm9kZVR5cGUsZj1lP2FbYy5leHBhbmRvXTpudWxsLGg9CmMuY2FjaGU7aWYoIShlJiYhZiYmdHlwZW9mIGI9PT0ic3RyaW5nIiYmZD09PUIpKXtpZihlKWZ8fChhW2MuZXhwYW5kb109Zj0rK2MudXVpZCk7ZWxzZSBoPWE7aWYodHlwZW9mIGI9PT0ib2JqZWN0IilpZihlKWhbZl09Yy5leHRlbmQoaFtmXSxiKTtlbHNlIGMuZXh0ZW5kKGgsYik7ZWxzZSBpZihlJiYhaFtmXSloW2ZdPXt9O2E9ZT9oW2ZdOmg7aWYoZCE9PUIpYVtiXT1kO3JldHVybiB0eXBlb2YgYj09PSJzdHJpbmciP2FbYl06YX19fSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEsYil7aWYoYy5hY2NlcHREYXRhKGEpKXthPWE9PUU/cmE6YTt2YXIgZD1hLm5vZGVUeXBlLGU9ZD9hW2MuZXhwYW5kb106YSxmPWMuY2FjaGUsaD1kP2ZbZV06ZTtpZihiKXtpZihoKXtkZWxldGUgaFtiXTtkJiZjLmlzRW1wdHlPYmplY3QoaCkmJmMucmVtb3ZlRGF0YShhKX19ZWxzZSBpZihkJiZjLnN1cHBvcnQuZGVsZXRlRXhwYW5kbylkZWxldGUgYVtjLmV4cGFuZG9dO2Vsc2UgaWYoYS5yZW1vdmVBdHRyaWJ1dGUpYS5yZW1vdmVBdHRyaWJ1dGUoYy5leHBhbmRvKTsKZWxzZSBpZihkKWRlbGV0ZSBmW2VdO2Vsc2UgZm9yKHZhciBsIGluIGEpZGVsZXRlIGFbbF19fSxhY2NlcHREYXRhOmZ1bmN0aW9uKGEpe2lmKGEubm9kZU5hbWUpe3ZhciBiPWMubm9EYXRhW2Eubm9kZU5hbWUudG9Mb3dlckNhc2UoKV07aWYoYilyZXR1cm4hKGI9PT10cnVlfHxhLmdldEF0dHJpYnV0ZSgiY2xhc3NpZCIpIT09Yil9cmV0dXJuIHRydWV9fSk7Yy5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oYSxiKXt2YXIgZD1udWxsO2lmKHR5cGVvZiBhPT09InVuZGVmaW5lZCIpe2lmKHRoaXMubGVuZ3RoKXt2YXIgZT10aGlzWzBdLmF0dHJpYnV0ZXMsZjtkPWMuZGF0YSh0aGlzWzBdKTtmb3IodmFyIGg9MCxsPWUubGVuZ3RoO2g8bDtoKyspe2Y9ZVtoXS5uYW1lO2lmKGYuaW5kZXhPZigiZGF0YS0iKT09PTApe2Y9Zi5zdWJzdHIoNSk7a2EodGhpc1swXSxmLGRbZl0pfX19cmV0dXJuIGR9ZWxzZSBpZih0eXBlb2YgYT09PSJvYmplY3QiKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjLmRhdGEodGhpcywKYSl9KTt2YXIgaz1hLnNwbGl0KCIuIik7a1sxXT1rWzFdPyIuIitrWzFdOiIiO2lmKGI9PT1CKXtkPXRoaXMudHJpZ2dlckhhbmRsZXIoImdldERhdGEiK2tbMV0rIiEiLFtrWzBdXSk7aWYoZD09PUImJnRoaXMubGVuZ3RoKXtkPWMuZGF0YSh0aGlzWzBdLGEpO2Q9a2EodGhpc1swXSxhLGQpfXJldHVybiBkPT09QiYma1sxXT90aGlzLmRhdGEoa1swXSk6ZH1lbHNlIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgbz1jKHRoaXMpLHg9W2tbMF0sYl07by50cmlnZ2VySGFuZGxlcigic2V0RGF0YSIra1sxXSsiISIseCk7Yy5kYXRhKHRoaXMsYSxiKTtvLnRyaWdnZXJIYW5kbGVyKCJjaGFuZ2VEYXRhIitrWzFdKyIhIix4KX0pfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjLnJlbW92ZURhdGEodGhpcyxhKX0pfX0pO2MuZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIsZCl7aWYoYSl7Yj0oYnx8ImZ4IikrInF1ZXVlIjt2YXIgZT0KYy5kYXRhKGEsYik7aWYoIWQpcmV0dXJuIGV8fFtdO2lmKCFlfHxjLmlzQXJyYXkoZCkpZT1jLmRhdGEoYSxiLGMubWFrZUFycmF5KGQpKTtlbHNlIGUucHVzaChkKTtyZXR1cm4gZX19LGRlcXVldWU6ZnVuY3Rpb24oYSxiKXtiPWJ8fCJmeCI7dmFyIGQ9Yy5xdWV1ZShhLGIpLGU9ZC5zaGlmdCgpO2lmKGU9PT0iaW5wcm9ncmVzcyIpZT1kLnNoaWZ0KCk7aWYoZSl7Yj09PSJmeCImJmQudW5zaGlmdCgiaW5wcm9ncmVzcyIpO2UuY2FsbChhLGZ1bmN0aW9uKCl7Yy5kZXF1ZXVlKGEsYil9KX19fSk7Yy5mbi5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYil7aWYodHlwZW9mIGEhPT0ic3RyaW5nIil7Yj1hO2E9ImZ4In1pZihiPT09QilyZXR1cm4gYy5xdWV1ZSh0aGlzWzBdLGEpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZD1jLnF1ZXVlKHRoaXMsYSxiKTthPT09ImZ4IiYmZFswXSE9PSJpbnByb2dyZXNzIiYmYy5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yy5kZXF1ZXVlKHRoaXMsCmEpfSl9LGRlbGF5OmZ1bmN0aW9uKGEsYil7YT1jLmZ4P2MuZnguc3BlZWRzW2FdfHxhOmE7Yj1ifHwiZngiO3JldHVybiB0aGlzLnF1ZXVlKGIsZnVuY3Rpb24oKXt2YXIgZD10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtjLmRlcXVldWUoZCxiKX0sYSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShhfHwiZngiLFtdKX19KTt2YXIgc2E9L1tcblx0XS9nLGhhPS9ccysvLFNhPS9cci9nLFRhPS9eKD86aHJlZnxzcmN8c3R5bGUpJC8sVWE9L14oPzpidXR0b258aW5wdXQpJC9pLFZhPS9eKD86YnV0dG9ufGlucHV0fG9iamVjdHxzZWxlY3R8dGV4dGFyZWEpJC9pLFdhPS9eYSg/OnJlYSk/JC9pLHRhPS9eKD86cmFkaW98Y2hlY2tib3gpJC9pO2MucHJvcHM9eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUiLHJlYWRvbmx5OiJyZWFkT25seSIsbWF4bGVuZ3RoOiJtYXhMZW5ndGgiLGNlbGxzcGFjaW5nOiJjZWxsU3BhY2luZyIscm93c3Bhbjoicm93U3BhbiIsCmNvbHNwYW46ImNvbFNwYW4iLHRhYmluZGV4OiJ0YWJJbmRleCIsdXNlbWFwOiJ1c2VNYXAiLGZyYW1lYm9yZGVyOiJmcmFtZUJvcmRlciJ9O2MuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuYWNjZXNzKHRoaXMsYSxiLHRydWUsYy5hdHRyKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yy5hdHRyKHRoaXMsYSwiIik7dGhpcy5ub2RlVHlwZT09PTEmJnRoaXMucmVtb3ZlQXR0cmlidXRlKGEpfSl9LGFkZENsYXNzOmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKHgpe3ZhciByPWModGhpcyk7ci5hZGRDbGFzcyhhLmNhbGwodGhpcyx4LHIuYXR0cigiY2xhc3MiKSkpfSk7aWYoYSYmdHlwZW9mIGE9PT0ic3RyaW5nIilmb3IodmFyIGI9KGF8fCIiKS5zcGxpdChoYSksZD0wLGU9dGhpcy5sZW5ndGg7ZDxlO2QrKyl7dmFyIGY9dGhpc1tkXTtpZihmLm5vZGVUeXBlPT09CjEpaWYoZi5jbGFzc05hbWUpe2Zvcih2YXIgaD0iICIrZi5jbGFzc05hbWUrIiAiLGw9Zi5jbGFzc05hbWUsaz0wLG89Yi5sZW5ndGg7azxvO2srKylpZihoLmluZGV4T2YoIiAiK2Jba10rIiAiKTwwKWwrPSIgIitiW2tdO2YuY2xhc3NOYW1lPWMudHJpbShsKX1lbHNlIGYuY2xhc3NOYW1lPWF9cmV0dXJuIHRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKG8pe3ZhciB4PWModGhpcyk7eC5yZW1vdmVDbGFzcyhhLmNhbGwodGhpcyxvLHguYXR0cigiY2xhc3MiKSkpfSk7aWYoYSYmdHlwZW9mIGE9PT0ic3RyaW5nInx8YT09PUIpZm9yKHZhciBiPShhfHwiIikuc3BsaXQoaGEpLGQ9MCxlPXRoaXMubGVuZ3RoO2Q8ZTtkKyspe3ZhciBmPXRoaXNbZF07aWYoZi5ub2RlVHlwZT09PTEmJmYuY2xhc3NOYW1lKWlmKGEpe2Zvcih2YXIgaD0oIiAiK2YuY2xhc3NOYW1lKyIgIikucmVwbGFjZShzYSwiICIpLApsPTAsaz1iLmxlbmd0aDtsPGs7bCsrKWg9aC5yZXBsYWNlKCIgIitiW2xdKyIgIiwiICIpO2YuY2xhc3NOYW1lPWMudHJpbShoKX1lbHNlIGYuY2xhc3NOYW1lPSIifXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihhLGIpe3ZhciBkPXR5cGVvZiBhLGU9dHlwZW9mIGI9PT0iYm9vbGVhbiI7aWYoYy5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oZil7dmFyIGg9Yyh0aGlzKTtoLnRvZ2dsZUNsYXNzKGEuY2FsbCh0aGlzLGYsaC5hdHRyKCJjbGFzcyIpLGIpLGIpfSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKGQ9PT0ic3RyaW5nIilmb3IodmFyIGYsaD0wLGw9Yyh0aGlzKSxrPWIsbz1hLnNwbGl0KGhhKTtmPW9baCsrXTspe2s9ZT9rOiFsLmhhc0NsYXNzKGYpO2xbaz8iYWRkQ2xhc3MiOiJyZW1vdmVDbGFzcyJdKGYpfWVsc2UgaWYoZD09PSJ1bmRlZmluZWQifHxkPT09ImJvb2xlYW4iKXt0aGlzLmNsYXNzTmFtZSYmYy5kYXRhKHRoaXMsCiJfX2NsYXNzTmFtZV9fIix0aGlzLmNsYXNzTmFtZSk7dGhpcy5jbGFzc05hbWU9dGhpcy5jbGFzc05hbWV8fGE9PT1mYWxzZT8iIjpjLmRhdGEodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIn19KX0saGFzQ2xhc3M6ZnVuY3Rpb24oYSl7YT0iICIrYSsiICI7Zm9yKHZhciBiPTAsZD10aGlzLmxlbmd0aDtiPGQ7YisrKWlmKCgiICIrdGhpc1tiXS5jbGFzc05hbWUrIiAiKS5yZXBsYWNlKHNhLCIgIikuaW5kZXhPZihhKT4tMSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2V9LHZhbDpmdW5jdGlvbihhKXtpZighYXJndW1lbnRzLmxlbmd0aCl7dmFyIGI9dGhpc1swXTtpZihiKXtpZihjLm5vZGVOYW1lKGIsIm9wdGlvbiIpKXt2YXIgZD1iLmF0dHJpYnV0ZXMudmFsdWU7cmV0dXJuIWR8fGQuc3BlY2lmaWVkP2IudmFsdWU6Yi50ZXh0fWlmKGMubm9kZU5hbWUoYiwic2VsZWN0Iikpe3ZhciBlPWIuc2VsZWN0ZWRJbmRleDtkPVtdO3ZhciBmPWIub3B0aW9ucztiPWIudHlwZT09PSJzZWxlY3Qtb25lIjsKaWYoZTwwKXJldHVybiBudWxsO3ZhciBoPWI/ZTowO2ZvcihlPWI/ZSsxOmYubGVuZ3RoO2g8ZTtoKyspe3ZhciBsPWZbaF07aWYobC5zZWxlY3RlZCYmKGMuc3VwcG9ydC5vcHREaXNhYmxlZD8hbC5kaXNhYmxlZDpsLmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKT09PW51bGwpJiYoIWwucGFyZW50Tm9kZS5kaXNhYmxlZHx8IWMubm9kZU5hbWUobC5wYXJlbnROb2RlLCJvcHRncm91cCIpKSl7YT1jKGwpLnZhbCgpO2lmKGIpcmV0dXJuIGE7ZC5wdXNoKGEpfX1yZXR1cm4gZH1pZih0YS50ZXN0KGIudHlwZSkmJiFjLnN1cHBvcnQuY2hlY2tPbilyZXR1cm4gYi5nZXRBdHRyaWJ1dGUoInZhbHVlIik9PT1udWxsPyJvbiI6Yi52YWx1ZTtyZXR1cm4oYi52YWx1ZXx8IiIpLnJlcGxhY2UoU2EsIiIpfXJldHVybiBCfXZhciBrPWMuaXNGdW5jdGlvbihhKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKG8pe3ZhciB4PWModGhpcykscj1hO2lmKHRoaXMubm9kZVR5cGU9PT0xKXtpZihrKXI9CmEuY2FsbCh0aGlzLG8seC52YWwoKSk7aWYocj09bnVsbClyPSIiO2Vsc2UgaWYodHlwZW9mIHI9PT0ibnVtYmVyIilyKz0iIjtlbHNlIGlmKGMuaXNBcnJheShyKSlyPWMubWFwKHIsZnVuY3Rpb24oQyl7cmV0dXJuIEM9PW51bGw/IiI6QysiIn0pO2lmKGMuaXNBcnJheShyKSYmdGEudGVzdCh0aGlzLnR5cGUpKXRoaXMuY2hlY2tlZD1jLmluQXJyYXkoeC52YWwoKSxyKT49MDtlbHNlIGlmKGMubm9kZU5hbWUodGhpcywic2VsZWN0Iikpe3ZhciBBPWMubWFrZUFycmF5KHIpO2MoIm9wdGlvbiIsdGhpcykuZWFjaChmdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWQ9Yy5pbkFycmF5KGModGhpcykudmFsKCksQSk+PTB9KTtpZighQS5sZW5ndGgpdGhpcy5zZWxlY3RlZEluZGV4PS0xfWVsc2UgdGhpcy52YWx1ZT1yfX0pfX0pO2MuZXh0ZW5kKHthdHRyRm46e3ZhbDp0cnVlLGNzczp0cnVlLGh0bWw6dHJ1ZSx0ZXh0OnRydWUsZGF0YTp0cnVlLHdpZHRoOnRydWUsaGVpZ2h0OnRydWUsb2Zmc2V0OnRydWV9LAphdHRyOmZ1bmN0aW9uKGEsYixkLGUpe2lmKCFhfHxhLm5vZGVUeXBlPT09M3x8YS5ub2RlVHlwZT09PTgpcmV0dXJuIEI7aWYoZSYmYiBpbiBjLmF0dHJGbilyZXR1cm4gYyhhKVtiXShkKTtlPWEubm9kZVR5cGUhPT0xfHwhYy5pc1hNTERvYyhhKTt2YXIgZj1kIT09QjtiPWUmJmMucHJvcHNbYl18fGI7dmFyIGg9VGEudGVzdChiKTtpZigoYiBpbiBhfHxhW2JdIT09QikmJmUmJiFoKXtpZihmKXtiPT09InR5cGUiJiZVYS50ZXN0KGEubm9kZU5hbWUpJiZhLnBhcmVudE5vZGUmJmMuZXJyb3IoInR5cGUgcHJvcGVydHkgY2FuJ3QgYmUgY2hhbmdlZCIpO2lmKGQ9PT1udWxsKWEubm9kZVR5cGU9PT0xJiZhLnJlbW92ZUF0dHJpYnV0ZShiKTtlbHNlIGFbYl09ZH1pZihjLm5vZGVOYW1lKGEsImZvcm0iKSYmYS5nZXRBdHRyaWJ1dGVOb2RlKGIpKXJldHVybiBhLmdldEF0dHJpYnV0ZU5vZGUoYikubm9kZVZhbHVlO2lmKGI9PT0idGFiSW5kZXgiKXJldHVybihiPWEuZ2V0QXR0cmlidXRlTm9kZSgidGFiSW5kZXgiKSkmJgpiLnNwZWNpZmllZD9iLnZhbHVlOlZhLnRlc3QoYS5ub2RlTmFtZSl8fFdhLnRlc3QoYS5ub2RlTmFtZSkmJmEuaHJlZj8wOkI7cmV0dXJuIGFbYl19aWYoIWMuc3VwcG9ydC5zdHlsZSYmZSYmYj09PSJzdHlsZSIpe2lmKGYpYS5zdHlsZS5jc3NUZXh0PSIiK2Q7cmV0dXJuIGEuc3R5bGUuY3NzVGV4dH1mJiZhLnNldEF0dHJpYnV0ZShiLCIiK2QpO2lmKCFhLmF0dHJpYnV0ZXNbYl0mJmEuaGFzQXR0cmlidXRlJiYhYS5oYXNBdHRyaWJ1dGUoYikpcmV0dXJuIEI7YT0hYy5zdXBwb3J0LmhyZWZOb3JtYWxpemVkJiZlJiZoP2EuZ2V0QXR0cmlidXRlKGIsMik6YS5nZXRBdHRyaWJ1dGUoYik7cmV0dXJuIGE9PT1udWxsP0I6YX19KTt2YXIgWD0vXC4oLiopJC8saWE9L14oPzp0ZXh0YXJlYXxpbnB1dHxzZWxlY3QpJC9pLExhPS9cLi9nLE1hPS8gL2csWGE9L1teXHdccy58YF0vZyxZYT1mdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKFhhLCJcXCQmIil9LHVhPXtmb2N1c2luOjAsZm9jdXNvdXQ6MH07CmMuZXZlbnQ9e2FkZDpmdW5jdGlvbihhLGIsZCxlKXtpZighKGEubm9kZVR5cGU9PT0zfHxhLm5vZGVUeXBlPT09OCkpe2lmKGMuaXNXaW5kb3coYSkmJmEhPT1FJiYhYS5mcmFtZUVsZW1lbnQpYT1FO2lmKGQ9PT1mYWxzZSlkPVU7ZWxzZSBpZighZClyZXR1cm47dmFyIGYsaDtpZihkLmhhbmRsZXIpe2Y9ZDtkPWYuaGFuZGxlcn1pZighZC5ndWlkKWQuZ3VpZD1jLmd1aWQrKztpZihoPWMuZGF0YShhKSl7dmFyIGw9YS5ub2RlVHlwZT8iZXZlbnRzIjoiX19ldmVudHNfXyIsaz1oW2xdLG89aC5oYW5kbGU7aWYodHlwZW9mIGs9PT0iZnVuY3Rpb24iKXtvPWsuaGFuZGxlO2s9ay5ldmVudHN9ZWxzZSBpZighayl7YS5ub2RlVHlwZXx8KGhbbF09aD1mdW5jdGlvbigpe30pO2guZXZlbnRzPWs9e319aWYoIW8paC5oYW5kbGU9bz1mdW5jdGlvbigpe3JldHVybiB0eXBlb2YgYyE9PSJ1bmRlZmluZWQiJiYhYy5ldmVudC50cmlnZ2VyZWQ/Yy5ldmVudC5oYW5kbGUuYXBwbHkoby5lbGVtLAphcmd1bWVudHMpOkJ9O28uZWxlbT1hO2I9Yi5zcGxpdCgiICIpO2Zvcih2YXIgeD0wLHI7bD1iW3grK107KXtoPWY/Yy5leHRlbmQoe30sZik6e2hhbmRsZXI6ZCxkYXRhOmV9O2lmKGwuaW5kZXhPZigiLiIpPi0xKXtyPWwuc3BsaXQoIi4iKTtsPXIuc2hpZnQoKTtoLm5hbWVzcGFjZT1yLnNsaWNlKDApLnNvcnQoKS5qb2luKCIuIil9ZWxzZXtyPVtdO2gubmFtZXNwYWNlPSIifWgudHlwZT1sO2lmKCFoLmd1aWQpaC5ndWlkPWQuZ3VpZDt2YXIgQT1rW2xdLEM9Yy5ldmVudC5zcGVjaWFsW2xdfHx7fTtpZighQSl7QT1rW2xdPVtdO2lmKCFDLnNldHVwfHxDLnNldHVwLmNhbGwoYSxlLHIsbyk9PT1mYWxzZSlpZihhLmFkZEV2ZW50TGlzdGVuZXIpYS5hZGRFdmVudExpc3RlbmVyKGwsbyxmYWxzZSk7ZWxzZSBhLmF0dGFjaEV2ZW50JiZhLmF0dGFjaEV2ZW50KCJvbiIrbCxvKX1pZihDLmFkZCl7Qy5hZGQuY2FsbChhLGgpO2lmKCFoLmhhbmRsZXIuZ3VpZCloLmhhbmRsZXIuZ3VpZD0KZC5ndWlkfUEucHVzaChoKTtjLmV2ZW50Lmdsb2JhbFtsXT10cnVlfWE9bnVsbH19fSxnbG9iYWw6e30scmVtb3ZlOmZ1bmN0aW9uKGEsYixkLGUpe2lmKCEoYS5ub2RlVHlwZT09PTN8fGEubm9kZVR5cGU9PT04KSl7aWYoZD09PWZhbHNlKWQ9VTt2YXIgZixoLGw9MCxrLG8seCxyLEEsQyxKPWEubm9kZVR5cGU/ImV2ZW50cyI6Il9fZXZlbnRzX18iLHc9Yy5kYXRhKGEpLEk9dyYmd1tKXTtpZih3JiZJKXtpZih0eXBlb2YgST09PSJmdW5jdGlvbiIpe3c9STtJPUkuZXZlbnRzfWlmKGImJmIudHlwZSl7ZD1iLmhhbmRsZXI7Yj1iLnR5cGV9aWYoIWJ8fHR5cGVvZiBiPT09InN0cmluZyImJmIuY2hhckF0KDApPT09Ii4iKXtiPWJ8fCIiO2ZvcihmIGluIEkpYy5ldmVudC5yZW1vdmUoYSxmK2IpfWVsc2V7Zm9yKGI9Yi5zcGxpdCgiICIpO2Y9YltsKytdOyl7cj1mO2s9Zi5pbmRleE9mKCIuIik8MDtvPVtdO2lmKCFrKXtvPWYuc3BsaXQoIi4iKTtmPW8uc2hpZnQoKTt4PVJlZ0V4cCgiKF58XFwuKSIrCmMubWFwKG8uc2xpY2UoMCkuc29ydCgpLFlhKS5qb2luKCJcXC4oPzouKlxcLik/IikrIihcXC58JCkiKX1pZihBPUlbZl0paWYoZCl7cj1jLmV2ZW50LnNwZWNpYWxbZl18fHt9O2ZvcihoPWV8fDA7aDxBLmxlbmd0aDtoKyspe0M9QVtoXTtpZihkLmd1aWQ9PT1DLmd1aWQpe2lmKGt8fHgudGVzdChDLm5hbWVzcGFjZSkpe2U9PW51bGwmJkEuc3BsaWNlKGgtLSwxKTtyLnJlbW92ZSYmci5yZW1vdmUuY2FsbChhLEMpfWlmKGUhPW51bGwpYnJlYWt9fWlmKEEubGVuZ3RoPT09MHx8ZSE9bnVsbCYmQS5sZW5ndGg9PT0xKXtpZighci50ZWFyZG93bnx8ci50ZWFyZG93bi5jYWxsKGEsbyk9PT1mYWxzZSljLnJlbW92ZUV2ZW50KGEsZix3LmhhbmRsZSk7ZGVsZXRlIElbZl19fWVsc2UgZm9yKGg9MDtoPEEubGVuZ3RoO2grKyl7Qz1BW2hdO2lmKGt8fHgudGVzdChDLm5hbWVzcGFjZSkpe2MuZXZlbnQucmVtb3ZlKGEscixDLmhhbmRsZXIsaCk7QS5zcGxpY2UoaC0tLDEpfX19aWYoYy5pc0VtcHR5T2JqZWN0KEkpKXtpZihiPQp3LmhhbmRsZSliLmVsZW09bnVsbDtkZWxldGUgdy5ldmVudHM7ZGVsZXRlIHcuaGFuZGxlO2lmKHR5cGVvZiB3PT09ImZ1bmN0aW9uIiljLnJlbW92ZURhdGEoYSxKKTtlbHNlIGMuaXNFbXB0eU9iamVjdCh3KSYmYy5yZW1vdmVEYXRhKGEpfX19fX0sdHJpZ2dlcjpmdW5jdGlvbihhLGIsZCxlKXt2YXIgZj1hLnR5cGV8fGE7aWYoIWUpe2E9dHlwZW9mIGE9PT0ib2JqZWN0Ij9hW2MuZXhwYW5kb10/YTpjLmV4dGVuZChjLkV2ZW50KGYpLGEpOmMuRXZlbnQoZik7aWYoZi5pbmRleE9mKCIhIik+PTApe2EudHlwZT1mPWYuc2xpY2UoMCwtMSk7YS5leGNsdXNpdmU9dHJ1ZX1pZighZCl7YS5zdG9wUHJvcGFnYXRpb24oKTtjLmV2ZW50Lmdsb2JhbFtmXSYmYy5lYWNoKGMuY2FjaGUsZnVuY3Rpb24oKXt0aGlzLmV2ZW50cyYmdGhpcy5ldmVudHNbZl0mJmMuZXZlbnQudHJpZ2dlcihhLGIsdGhpcy5oYW5kbGUuZWxlbSl9KX1pZighZHx8ZC5ub2RlVHlwZT09PTN8fGQubm9kZVR5cGU9PT0KOClyZXR1cm4gQjthLnJlc3VsdD1CO2EudGFyZ2V0PWQ7Yj1jLm1ha2VBcnJheShiKTtiLnVuc2hpZnQoYSl9YS5jdXJyZW50VGFyZ2V0PWQ7KGU9ZC5ub2RlVHlwZT9jLmRhdGEoZCwiaGFuZGxlIik6KGMuZGF0YShkLCJfX2V2ZW50c19fIil8fHt9KS5oYW5kbGUpJiZlLmFwcGx5KGQsYik7ZT1kLnBhcmVudE5vZGV8fGQub3duZXJEb2N1bWVudDt0cnl7aWYoIShkJiZkLm5vZGVOYW1lJiZjLm5vRGF0YVtkLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSlpZihkWyJvbiIrZl0mJmRbIm9uIitmXS5hcHBseShkLGIpPT09ZmFsc2Upe2EucmVzdWx0PWZhbHNlO2EucHJldmVudERlZmF1bHQoKX19Y2F0Y2goaCl7fWlmKCFhLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkmJmUpYy5ldmVudC50cmlnZ2VyKGEsYixlLHRydWUpO2Vsc2UgaWYoIWEuaXNEZWZhdWx0UHJldmVudGVkKCkpe3ZhciBsO2U9YS50YXJnZXQ7dmFyIGs9Zi5yZXBsYWNlKFgsIiIpLG89Yy5ub2RlTmFtZShlLCJhIikmJms9PT0KImNsaWNrIix4PWMuZXZlbnQuc3BlY2lhbFtrXXx8e307aWYoKCF4Ll9kZWZhdWx0fHx4Ll9kZWZhdWx0LmNhbGwoZCxhKT09PWZhbHNlKSYmIW8mJiEoZSYmZS5ub2RlTmFtZSYmYy5ub0RhdGFbZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkpe3RyeXtpZihlW2tdKXtpZihsPWVbIm9uIitrXSllWyJvbiIra109bnVsbDtjLmV2ZW50LnRyaWdnZXJlZD10cnVlO2Vba10oKX19Y2F0Y2gocil7fWlmKGwpZVsib24iK2tdPWw7Yy5ldmVudC50cmlnZ2VyZWQ9ZmFsc2V9fX0saGFuZGxlOmZ1bmN0aW9uKGEpe3ZhciBiLGQsZSxmO2Q9W107dmFyIGg9Yy5tYWtlQXJyYXkoYXJndW1lbnRzKTthPWhbMF09Yy5ldmVudC5maXgoYXx8RS5ldmVudCk7YS5jdXJyZW50VGFyZ2V0PXRoaXM7Yj1hLnR5cGUuaW5kZXhPZigiLiIpPDAmJiFhLmV4Y2x1c2l2ZTtpZighYil7ZT1hLnR5cGUuc3BsaXQoIi4iKTthLnR5cGU9ZS5zaGlmdCgpO2Q9ZS5zbGljZSgwKS5zb3J0KCk7ZT1SZWdFeHAoIihefFxcLikiKwpkLmpvaW4oIlxcLig/Oi4qXFwuKT8iKSsiKFxcLnwkKSIpfWEubmFtZXNwYWNlPWEubmFtZXNwYWNlfHxkLmpvaW4oIi4iKTtmPWMuZGF0YSh0aGlzLHRoaXMubm9kZVR5cGU/ImV2ZW50cyI6Il9fZXZlbnRzX18iKTtpZih0eXBlb2YgZj09PSJmdW5jdGlvbiIpZj1mLmV2ZW50cztkPShmfHx7fSlbYS50eXBlXTtpZihmJiZkKXtkPWQuc2xpY2UoMCk7Zj0wO2Zvcih2YXIgbD1kLmxlbmd0aDtmPGw7ZisrKXt2YXIgaz1kW2ZdO2lmKGJ8fGUudGVzdChrLm5hbWVzcGFjZSkpe2EuaGFuZGxlcj1rLmhhbmRsZXI7YS5kYXRhPWsuZGF0YTthLmhhbmRsZU9iaj1rO2s9ay5oYW5kbGVyLmFwcGx5KHRoaXMsaCk7aWYoayE9PUIpe2EucmVzdWx0PWs7aWYoaz09PWZhbHNlKXthLnByZXZlbnREZWZhdWx0KCk7YS5zdG9wUHJvcGFnYXRpb24oKX19aWYoYS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKWJyZWFrfX19cmV0dXJuIGEucmVzdWx0fSxwcm9wczoiYWx0S2V5IGF0dHJDaGFuZ2UgYXR0ck5hbWUgYnViYmxlcyBidXR0b24gY2FuY2VsYWJsZSBjaGFyQ29kZSBjbGllbnRYIGNsaWVudFkgY3RybEtleSBjdXJyZW50VGFyZ2V0IGRhdGEgZGV0YWlsIGV2ZW50UGhhc2UgZnJvbUVsZW1lbnQgaGFuZGxlciBrZXlDb2RlIGxheWVyWCBsYXllclkgbWV0YUtleSBuZXdWYWx1ZSBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgcHJldlZhbHVlIHJlbGF0ZWROb2RlIHJlbGF0ZWRUYXJnZXQgc2NyZWVuWCBzY3JlZW5ZIHNoaWZ0S2V5IHNyY0VsZW1lbnQgdGFyZ2V0IHRvRWxlbWVudCB2aWV3IHdoZWVsRGVsdGEgd2hpY2giLnNwbGl0KCIgIiksCmZpeDpmdW5jdGlvbihhKXtpZihhW2MuZXhwYW5kb10pcmV0dXJuIGE7dmFyIGI9YTthPWMuRXZlbnQoYik7Zm9yKHZhciBkPXRoaXMucHJvcHMubGVuZ3RoLGU7ZDspe2U9dGhpcy5wcm9wc1stLWRdO2FbZV09YltlXX1pZighYS50YXJnZXQpYS50YXJnZXQ9YS5zcmNFbGVtZW50fHx0O2lmKGEudGFyZ2V0Lm5vZGVUeXBlPT09MylhLnRhcmdldD1hLnRhcmdldC5wYXJlbnROb2RlO2lmKCFhLnJlbGF0ZWRUYXJnZXQmJmEuZnJvbUVsZW1lbnQpYS5yZWxhdGVkVGFyZ2V0PWEuZnJvbUVsZW1lbnQ9PT1hLnRhcmdldD9hLnRvRWxlbWVudDphLmZyb21FbGVtZW50O2lmKGEucGFnZVg9PW51bGwmJmEuY2xpZW50WCE9bnVsbCl7Yj10LmRvY3VtZW50RWxlbWVudDtkPXQuYm9keTthLnBhZ2VYPWEuY2xpZW50WCsoYiYmYi5zY3JvbGxMZWZ0fHxkJiZkLnNjcm9sbExlZnR8fDApLShiJiZiLmNsaWVudExlZnR8fGQmJmQuY2xpZW50TGVmdHx8MCk7YS5wYWdlWT1hLmNsaWVudFkrKGImJmIuc2Nyb2xsVG9wfHwKZCYmZC5zY3JvbGxUb3B8fDApLShiJiZiLmNsaWVudFRvcHx8ZCYmZC5jbGllbnRUb3B8fDApfWlmKGEud2hpY2g9PW51bGwmJihhLmNoYXJDb2RlIT1udWxsfHxhLmtleUNvZGUhPW51bGwpKWEud2hpY2g9YS5jaGFyQ29kZSE9bnVsbD9hLmNoYXJDb2RlOmEua2V5Q29kZTtpZighYS5tZXRhS2V5JiZhLmN0cmxLZXkpYS5tZXRhS2V5PWEuY3RybEtleTtpZighYS53aGljaCYmYS5idXR0b24hPT1CKWEud2hpY2g9YS5idXR0b24mMT8xOmEuYnV0dG9uJjI/MzphLmJ1dHRvbiY0PzI6MDtyZXR1cm4gYX0sZ3VpZDoxRTgscHJveHk6Yy5wcm94eSxzcGVjaWFsOntyZWFkeTp7c2V0dXA6Yy5iaW5kUmVhZHksdGVhcmRvd246Yy5ub29wfSxsaXZlOnthZGQ6ZnVuY3Rpb24oYSl7Yy5ldmVudC5hZGQodGhpcyxZKGEub3JpZ1R5cGUsYS5zZWxlY3RvciksYy5leHRlbmQoe30sYSx7aGFuZGxlcjpLYSxndWlkOmEuaGFuZGxlci5ndWlkfSkpfSxyZW1vdmU6ZnVuY3Rpb24oYSl7Yy5ldmVudC5yZW1vdmUodGhpcywKWShhLm9yaWdUeXBlLGEuc2VsZWN0b3IpLGEpfX0sYmVmb3JldW5sb2FkOntzZXR1cDpmdW5jdGlvbihhLGIsZCl7aWYoYy5pc1dpbmRvdyh0aGlzKSl0aGlzLm9uYmVmb3JldW5sb2FkPWR9LHRlYXJkb3duOmZ1bmN0aW9uKGEsYil7aWYodGhpcy5vbmJlZm9yZXVubG9hZD09PWIpdGhpcy5vbmJlZm9yZXVubG9hZD1udWxsfX19fTtjLnJlbW92ZUV2ZW50PXQucmVtb3ZlRXZlbnRMaXN0ZW5lcj9mdW5jdGlvbihhLGIsZCl7YS5yZW1vdmVFdmVudExpc3RlbmVyJiZhLnJlbW92ZUV2ZW50TGlzdGVuZXIoYixkLGZhbHNlKX06ZnVuY3Rpb24oYSxiLGQpe2EuZGV0YWNoRXZlbnQmJmEuZGV0YWNoRXZlbnQoIm9uIitiLGQpfTtjLkV2ZW50PWZ1bmN0aW9uKGEpe2lmKCF0aGlzLnByZXZlbnREZWZhdWx0KXJldHVybiBuZXcgYy5FdmVudChhKTtpZihhJiZhLnR5cGUpe3RoaXMub3JpZ2luYWxFdmVudD1hO3RoaXMudHlwZT1hLnR5cGV9ZWxzZSB0aGlzLnR5cGU9YTt0aGlzLnRpbWVTdGFtcD0KYy5ub3coKTt0aGlzW2MuZXhwYW5kb109dHJ1ZX07Yy5FdmVudC5wcm90b3R5cGU9e3ByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9Y2E7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O2lmKGEpaWYoYS5wcmV2ZW50RGVmYXVsdClhLnByZXZlbnREZWZhdWx0KCk7ZWxzZSBhLnJldHVyblZhbHVlPWZhbHNlfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkPWNhO3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDtpZihhKXthLnN0b3BQcm9wYWdhdGlvbiYmYS5zdG9wUHJvcGFnYXRpb24oKTthLmNhbmNlbEJ1YmJsZT10cnVlfX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1jYTt0aGlzLnN0b3BQcm9wYWdhdGlvbigpfSxpc0RlZmF1bHRQcmV2ZW50ZWQ6VSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDpVLGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOlV9Owp2YXIgdmE9ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZWxhdGVkVGFyZ2V0O3RyeXtmb3IoO2ImJmIhPT10aGlzOyliPWIucGFyZW50Tm9kZTtpZihiIT09dGhpcyl7YS50eXBlPWEuZGF0YTtjLmV2ZW50LmhhbmRsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fWNhdGNoKGQpe319LHdhPWZ1bmN0aW9uKGEpe2EudHlwZT1hLmRhdGE7Yy5ldmVudC5oYW5kbGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtjLmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQifSxmdW5jdGlvbihhLGIpe2MuZXZlbnQuc3BlY2lhbFthXT17c2V0dXA6ZnVuY3Rpb24oZCl7Yy5ldmVudC5hZGQodGhpcyxiLGQmJmQuc2VsZWN0b3I/d2E6dmEsYSl9LHRlYXJkb3duOmZ1bmN0aW9uKGQpe2MuZXZlbnQucmVtb3ZlKHRoaXMsYixkJiZkLnNlbGVjdG9yP3dhOnZhKX19fSk7aWYoIWMuc3VwcG9ydC5zdWJtaXRCdWJibGVzKWMuZXZlbnQuc3BlY2lhbC5zdWJtaXQ9e3NldHVwOmZ1bmN0aW9uKCl7aWYodGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIT09CiJmb3JtIil7Yy5ldmVudC5hZGQodGhpcywiY2xpY2suc3BlY2lhbFN1Ym1pdCIsZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsZD1iLnR5cGU7aWYoKGQ9PT0ic3VibWl0Inx8ZD09PSJpbWFnZSIpJiZjKGIpLmNsb3Nlc3QoImZvcm0iKS5sZW5ndGgpe2EubGl2ZUZpcmVkPUI7cmV0dXJuIGxhKCJzdWJtaXQiLHRoaXMsYXJndW1lbnRzKX19KTtjLmV2ZW50LmFkZCh0aGlzLCJrZXlwcmVzcy5zcGVjaWFsU3VibWl0IixmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldCxkPWIudHlwZTtpZigoZD09PSJ0ZXh0Inx8ZD09PSJwYXNzd29yZCIpJiZjKGIpLmNsb3Nlc3QoImZvcm0iKS5sZW5ndGgmJmEua2V5Q29kZT09PTEzKXthLmxpdmVGaXJlZD1CO3JldHVybiBsYSgic3VibWl0Iix0aGlzLGFyZ3VtZW50cyl9fSl9ZWxzZSByZXR1cm4gZmFsc2V9LHRlYXJkb3duOmZ1bmN0aW9uKCl7Yy5ldmVudC5yZW1vdmUodGhpcywiLnNwZWNpYWxTdWJtaXQiKX19O2lmKCFjLnN1cHBvcnQuY2hhbmdlQnViYmxlcyl7dmFyIFYsCnhhPWZ1bmN0aW9uKGEpe3ZhciBiPWEudHlwZSxkPWEudmFsdWU7aWYoYj09PSJyYWRpbyJ8fGI9PT0iY2hlY2tib3giKWQ9YS5jaGVja2VkO2Vsc2UgaWYoYj09PSJzZWxlY3QtbXVsdGlwbGUiKWQ9YS5zZWxlY3RlZEluZGV4Pi0xP2MubWFwKGEub3B0aW9ucyxmdW5jdGlvbihlKXtyZXR1cm4gZS5zZWxlY3RlZH0pLmpvaW4oIi0iKToiIjtlbHNlIGlmKGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJzZWxlY3QiKWQ9YS5zZWxlY3RlZEluZGV4O3JldHVybiBkfSxaPWZ1bmN0aW9uKGEsYil7dmFyIGQ9YS50YXJnZXQsZSxmO2lmKCEoIWlhLnRlc3QoZC5ub2RlTmFtZSl8fGQucmVhZE9ubHkpKXtlPWMuZGF0YShkLCJfY2hhbmdlX2RhdGEiKTtmPXhhKGQpO2lmKGEudHlwZSE9PSJmb2N1c291dCJ8fGQudHlwZSE9PSJyYWRpbyIpYy5kYXRhKGQsIl9jaGFuZ2VfZGF0YSIsZik7aWYoIShlPT09Qnx8Zj09PWUpKWlmKGUhPW51bGx8fGYpe2EudHlwZT0iY2hhbmdlIjthLmxpdmVGaXJlZD0KQjtyZXR1cm4gYy5ldmVudC50cmlnZ2VyKGEsYixkKX19fTtjLmV2ZW50LnNwZWNpYWwuY2hhbmdlPXtmaWx0ZXJzOntmb2N1c291dDpaLGJlZm9yZWRlYWN0aXZhdGU6WixjbGljazpmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldCxkPWIudHlwZTtpZihkPT09InJhZGlvInx8ZD09PSJjaGVja2JveCJ8fGIubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJzZWxlY3QiKXJldHVybiBaLmNhbGwodGhpcyxhKX0sa2V5ZG93bjpmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldCxkPWIudHlwZTtpZihhLmtleUNvZGU9PT0xMyYmYi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIT09InRleHRhcmVhInx8YS5rZXlDb2RlPT09MzImJihkPT09ImNoZWNrYm94Inx8ZD09PSJyYWRpbyIpfHxkPT09InNlbGVjdC1tdWx0aXBsZSIpcmV0dXJuIFouY2FsbCh0aGlzLGEpfSxiZWZvcmVhY3RpdmF0ZTpmdW5jdGlvbihhKXthPWEudGFyZ2V0O2MuZGF0YShhLCJfY2hhbmdlX2RhdGEiLHhhKGEpKX19LHNldHVwOmZ1bmN0aW9uKCl7aWYodGhpcy50eXBlPT09CiJmaWxlIilyZXR1cm4gZmFsc2U7Zm9yKHZhciBhIGluIFYpYy5ldmVudC5hZGQodGhpcyxhKyIuc3BlY2lhbENoYW5nZSIsVlthXSk7cmV0dXJuIGlhLnRlc3QodGhpcy5ub2RlTmFtZSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7Yy5ldmVudC5yZW1vdmUodGhpcywiLnNwZWNpYWxDaGFuZ2UiKTtyZXR1cm4gaWEudGVzdCh0aGlzLm5vZGVOYW1lKX19O1Y9Yy5ldmVudC5zcGVjaWFsLmNoYW5nZS5maWx0ZXJzO1YuZm9jdXM9Vi5iZWZvcmVhY3RpdmF0ZX10LmFkZEV2ZW50TGlzdGVuZXImJmMuZWFjaCh7Zm9jdXM6ImZvY3VzaW4iLGJsdXI6ImZvY3Vzb3V0In0sZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBkKGUpe2U9Yy5ldmVudC5maXgoZSk7ZS50eXBlPWI7cmV0dXJuIGMuZXZlbnQudHJpZ2dlcihlLG51bGwsZS50YXJnZXQpfWMuZXZlbnQuc3BlY2lhbFtiXT17c2V0dXA6ZnVuY3Rpb24oKXt1YVtiXSsrPT09MCYmdC5hZGRFdmVudExpc3RlbmVyKGEsZCx0cnVlKX0sdGVhcmRvd246ZnVuY3Rpb24oKXstLXVhW2JdPT09CjAmJnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGQsdHJ1ZSl9fX0pO2MuZWFjaChbImJpbmQiLCJvbmUiXSxmdW5jdGlvbihhLGIpe2MuZm5bYl09ZnVuY3Rpb24oZCxlLGYpe2lmKHR5cGVvZiBkPT09Im9iamVjdCIpe2Zvcih2YXIgaCBpbiBkKXRoaXNbYl0oaCxlLGRbaF0sZik7cmV0dXJuIHRoaXN9aWYoYy5pc0Z1bmN0aW9uKGUpfHxlPT09ZmFsc2Upe2Y9ZTtlPUJ9dmFyIGw9Yj09PSJvbmUiP2MucHJveHkoZixmdW5jdGlvbihvKXtjKHRoaXMpLnVuYmluZChvLGwpO3JldHVybiBmLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pOmY7aWYoZD09PSJ1bmxvYWQiJiZiIT09Im9uZSIpdGhpcy5vbmUoZCxlLGYpO2Vsc2V7aD0wO2Zvcih2YXIgaz10aGlzLmxlbmd0aDtoPGs7aCsrKWMuZXZlbnQuYWRkKHRoaXNbaF0sZCxsLGUpfXJldHVybiB0aGlzfX0pO2MuZm4uZXh0ZW5kKHt1bmJpbmQ6ZnVuY3Rpb24oYSxiKXtpZih0eXBlb2YgYT09PSJvYmplY3QiJiYhYS5wcmV2ZW50RGVmYXVsdClmb3IodmFyIGQgaW4gYSl0aGlzLnVuYmluZChkLAphW2RdKTtlbHNle2Q9MDtmb3IodmFyIGU9dGhpcy5sZW5ndGg7ZDxlO2QrKyljLmV2ZW50LnJlbW92ZSh0aGlzW2RdLGEsYil9cmV0dXJuIHRoaXN9LGRlbGVnYXRlOmZ1bmN0aW9uKGEsYixkLGUpe3JldHVybiB0aGlzLmxpdmUoYixkLGUsYSl9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPT09MD90aGlzLnVuYmluZCgibGl2ZSIpOnRoaXMuZGllKGIsbnVsbCxkLGEpfSx0cmlnZ2VyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2MuZXZlbnQudHJpZ2dlcihhLGIsdGhpcyl9KX0sdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxiKXtpZih0aGlzWzBdKXt2YXIgZD1jLkV2ZW50KGEpO2QucHJldmVudERlZmF1bHQoKTtkLnN0b3BQcm9wYWdhdGlvbigpO2MuZXZlbnQudHJpZ2dlcihkLGIsdGhpc1swXSk7cmV0dXJuIGQucmVzdWx0fX0sdG9nZ2xlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hcmd1bWVudHMsZD0KMTtkPGIubGVuZ3RoOyljLnByb3h5KGEsYltkKytdKTtyZXR1cm4gdGhpcy5jbGljayhjLnByb3h5KGEsZnVuY3Rpb24oZSl7dmFyIGY9KGMuZGF0YSh0aGlzLCJsYXN0VG9nZ2xlIithLmd1aWQpfHwwKSVkO2MuZGF0YSh0aGlzLCJsYXN0VG9nZ2xlIithLmd1aWQsZisxKTtlLnByZXZlbnREZWZhdWx0KCk7cmV0dXJuIGJbZl0uYXBwbHkodGhpcyxhcmd1bWVudHMpfHxmYWxzZX0pKX0saG92ZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5tb3VzZWVudGVyKGEpLm1vdXNlbGVhdmUoYnx8YSl9fSk7dmFyIHlhPXtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQiLG1vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQifTtjLmVhY2goWyJsaXZlIiwiZGllIl0sZnVuY3Rpb24oYSxiKXtjLmZuW2JdPWZ1bmN0aW9uKGQsZSxmLGgpe3ZhciBsLGs9MCxvLHgscj1ofHx0aGlzLnNlbGVjdG9yO2g9aD90aGlzOmModGhpcy5jb250ZXh0KTtpZih0eXBlb2YgZD09PQoib2JqZWN0IiYmIWQucHJldmVudERlZmF1bHQpe2ZvcihsIGluIGQpaFtiXShsLGUsZFtsXSxyKTtyZXR1cm4gdGhpc31pZihjLmlzRnVuY3Rpb24oZSkpe2Y9ZTtlPUJ9Zm9yKGQ9KGR8fCIiKS5zcGxpdCgiICIpOyhsPWRbaysrXSkhPW51bGw7KXtvPVguZXhlYyhsKTt4PSIiO2lmKG8pe3g9b1swXTtsPWwucmVwbGFjZShYLCIiKX1pZihsPT09ImhvdmVyIilkLnB1c2goIm1vdXNlZW50ZXIiK3gsIm1vdXNlbGVhdmUiK3gpO2Vsc2V7bz1sO2lmKGw9PT0iZm9jdXMifHxsPT09ImJsdXIiKXtkLnB1c2goeWFbbF0reCk7bCs9eH1lbHNlIGw9KHlhW2xdfHxsKSt4O2lmKGI9PT0ibGl2ZSIpe3g9MDtmb3IodmFyIEE9aC5sZW5ndGg7eDxBO3grKyljLmV2ZW50LmFkZChoW3hdLCJsaXZlLiIrWShsLHIpLHtkYXRhOmUsc2VsZWN0b3I6cixoYW5kbGVyOmYsb3JpZ1R5cGU6bCxvcmlnSGFuZGxlcjpmLHByZVR5cGU6b30pfWVsc2UgaC51bmJpbmQoImxpdmUuIitZKGwsciksZil9fXJldHVybiB0aGlzfX0pOwpjLmVhY2goImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIGNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IiLnNwbGl0KCIgIiksZnVuY3Rpb24oYSxiKXtjLmZuW2JdPWZ1bmN0aW9uKGQsZSl7aWYoZT09bnVsbCl7ZT1kO2Q9bnVsbH1yZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMuYmluZChiLGQsZSk6dGhpcy50cmlnZ2VyKGIpfTtpZihjLmF0dHJGbiljLmF0dHJGbltiXT10cnVlfSk7RS5hdHRhY2hFdmVudCYmIUUuYWRkRXZlbnRMaXN0ZW5lciYmYyhFKS5iaW5kKCJ1bmxvYWQiLGZ1bmN0aW9uKCl7Zm9yKHZhciBhIGluIGMuY2FjaGUpaWYoYy5jYWNoZVthXS5oYW5kbGUpdHJ5e2MuZXZlbnQucmVtb3ZlKGMuY2FjaGVbYV0uaGFuZGxlLmVsZW0pfWNhdGNoKGIpe319KTsKKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShnLGksbixtLHAscSl7cD0wO2Zvcih2YXIgdT1tLmxlbmd0aDtwPHU7cCsrKXt2YXIgeT1tW3BdO2lmKHkpe3ZhciBGPWZhbHNlO2Zvcih5PXlbZ107eTspe2lmKHkuc2l6Y2FjaGU9PT1uKXtGPW1beS5zaXpzZXRdO2JyZWFrfWlmKHkubm9kZVR5cGU9PT0xJiYhcSl7eS5zaXpjYWNoZT1uO3kuc2l6c2V0PXB9aWYoeS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09aSl7Rj15O2JyZWFrfXk9eVtnXX1tW3BdPUZ9fX1mdW5jdGlvbiBiKGcsaSxuLG0scCxxKXtwPTA7Zm9yKHZhciB1PW0ubGVuZ3RoO3A8dTtwKyspe3ZhciB5PW1bcF07aWYoeSl7dmFyIEY9ZmFsc2U7Zm9yKHk9eVtnXTt5Oyl7aWYoeS5zaXpjYWNoZT09PW4pe0Y9bVt5LnNpenNldF07YnJlYWt9aWYoeS5ub2RlVHlwZT09PTEpe2lmKCFxKXt5LnNpemNhY2hlPW47eS5zaXpzZXQ9cH1pZih0eXBlb2YgaSE9PSJzdHJpbmciKXtpZih5PT09aSl7Rj10cnVlO2JyZWFrfX1lbHNlIGlmKGsuZmlsdGVyKGksClt5XSkubGVuZ3RoPjApe0Y9eTticmVha319eT15W2ddfW1bcF09Rn19fXZhciBkPS8oKD86XCgoPzpcKFteKCldK1wpfFteKCldKykrXCl8XFsoPzpcW1teXFtcXV0qXF18WyciXVteJyJdKlsnIl18W15cW1xdJyJdKykrXF18XFwufFteID4rfiwoXFtcXF0rKSt8Wz4rfl0pKFxzKixccyopPygoPzoufFxyfFxuKSopL2csZT0wLGY9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxoPWZhbHNlLGw9dHJ1ZTtbMCwwXS5zb3J0KGZ1bmN0aW9uKCl7bD1mYWxzZTtyZXR1cm4gMH0pO3ZhciBrPWZ1bmN0aW9uKGcsaSxuLG0pe249bnx8W107dmFyIHA9aT1pfHx0O2lmKGkubm9kZVR5cGUhPT0xJiZpLm5vZGVUeXBlIT09OSlyZXR1cm5bXTtpZighZ3x8dHlwZW9mIGchPT0ic3RyaW5nIilyZXR1cm4gbjt2YXIgcSx1LHksRixNLE49dHJ1ZSxPPWsuaXNYTUwoaSksRD1bXSxSPWc7ZG97ZC5leGVjKCIiKTtpZihxPWQuZXhlYyhSKSl7Uj1xWzNdO0QucHVzaChxWzFdKTtpZihxWzJdKXtGPXFbM107CmJyZWFrfX19d2hpbGUocSk7aWYoRC5sZW5ndGg+MSYmeC5leGVjKGcpKWlmKEQubGVuZ3RoPT09MiYmby5yZWxhdGl2ZVtEWzBdXSl1PUwoRFswXStEWzFdLGkpO2Vsc2UgZm9yKHU9by5yZWxhdGl2ZVtEWzBdXT9baV06ayhELnNoaWZ0KCksaSk7RC5sZW5ndGg7KXtnPUQuc2hpZnQoKTtpZihvLnJlbGF0aXZlW2ddKWcrPUQuc2hpZnQoKTt1PUwoZyx1KX1lbHNle2lmKCFtJiZELmxlbmd0aD4xJiZpLm5vZGVUeXBlPT09OSYmIU8mJm8ubWF0Y2guSUQudGVzdChEWzBdKSYmIW8ubWF0Y2guSUQudGVzdChEW0QubGVuZ3RoLTFdKSl7cT1rLmZpbmQoRC5zaGlmdCgpLGksTyk7aT1xLmV4cHI/ay5maWx0ZXIocS5leHByLHEuc2V0KVswXTpxLnNldFswXX1pZihpKXtxPW0/e2V4cHI6RC5wb3AoKSxzZXQ6QyhtKX06ay5maW5kKEQucG9wKCksRC5sZW5ndGg9PT0xJiYoRFswXT09PSJ+Inx8RFswXT09PSIrIikmJmkucGFyZW50Tm9kZT9pLnBhcmVudE5vZGU6aSxPKTt1PXEuZXhwcj9rLmZpbHRlcihxLmV4cHIsCnEuc2V0KTpxLnNldDtpZihELmxlbmd0aD4wKXk9Qyh1KTtlbHNlIE49ZmFsc2U7Zm9yKDtELmxlbmd0aDspe3E9TT1ELnBvcCgpO2lmKG8ucmVsYXRpdmVbTV0pcT1ELnBvcCgpO2Vsc2UgTT0iIjtpZihxPT1udWxsKXE9aTtvLnJlbGF0aXZlW01dKHkscSxPKX19ZWxzZSB5PVtdfXl8fCh5PXUpO3l8fGsuZXJyb3IoTXx8Zyk7aWYoZi5jYWxsKHkpPT09IltvYmplY3QgQXJyYXldIilpZihOKWlmKGkmJmkubm9kZVR5cGU9PT0xKWZvcihnPTA7eVtnXSE9bnVsbDtnKyspe2lmKHlbZ10mJih5W2ddPT09dHJ1ZXx8eVtnXS5ub2RlVHlwZT09PTEmJmsuY29udGFpbnMoaSx5W2ddKSkpbi5wdXNoKHVbZ10pfWVsc2UgZm9yKGc9MDt5W2ddIT1udWxsO2crKyl5W2ddJiZ5W2ddLm5vZGVUeXBlPT09MSYmbi5wdXNoKHVbZ10pO2Vsc2Ugbi5wdXNoLmFwcGx5KG4seSk7ZWxzZSBDKHksbik7aWYoRil7ayhGLHAsbixtKTtrLnVuaXF1ZVNvcnQobil9cmV0dXJuIG59O2sudW5pcXVlU29ydD1mdW5jdGlvbihnKXtpZih3KXtoPQpsO2cuc29ydCh3KTtpZihoKWZvcih2YXIgaT0xO2k8Zy5sZW5ndGg7aSsrKWdbaV09PT1nW2ktMV0mJmcuc3BsaWNlKGktLSwxKX1yZXR1cm4gZ307ay5tYXRjaGVzPWZ1bmN0aW9uKGcsaSl7cmV0dXJuIGsoZyxudWxsLG51bGwsaSl9O2subWF0Y2hlc1NlbGVjdG9yPWZ1bmN0aW9uKGcsaSl7cmV0dXJuIGsoaSxudWxsLG51bGwsW2ddKS5sZW5ndGg+MH07ay5maW5kPWZ1bmN0aW9uKGcsaSxuKXt2YXIgbTtpZighZylyZXR1cm5bXTtmb3IodmFyIHA9MCxxPW8ub3JkZXIubGVuZ3RoO3A8cTtwKyspe3ZhciB1LHk9by5vcmRlcltwXTtpZih1PW8ubGVmdE1hdGNoW3ldLmV4ZWMoZykpe3ZhciBGPXVbMV07dS5zcGxpY2UoMSwxKTtpZihGLnN1YnN0cihGLmxlbmd0aC0xKSE9PSJcXCIpe3VbMV09KHVbMV18fCIiKS5yZXBsYWNlKC9cXC9nLCIiKTttPW8uZmluZFt5XSh1LGksbik7aWYobSE9bnVsbCl7Zz1nLnJlcGxhY2Uoby5tYXRjaFt5XSwiIik7YnJlYWt9fX19bXx8KG09aS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKTsKcmV0dXJue3NldDptLGV4cHI6Z319O2suZmlsdGVyPWZ1bmN0aW9uKGcsaSxuLG0pe2Zvcih2YXIgcCxxLHU9Zyx5PVtdLEY9aSxNPWkmJmlbMF0mJmsuaXNYTUwoaVswXSk7ZyYmaS5sZW5ndGg7KXtmb3IodmFyIE4gaW4gby5maWx0ZXIpaWYoKHA9by5sZWZ0TWF0Y2hbTl0uZXhlYyhnKSkhPW51bGwmJnBbMl0pe3ZhciBPLEQsUj1vLmZpbHRlcltOXTtEPXBbMV07cT1mYWxzZTtwLnNwbGljZSgxLDEpO2lmKEQuc3Vic3RyKEQubGVuZ3RoLTEpIT09IlxcIil7aWYoRj09PXkpeT1bXTtpZihvLnByZUZpbHRlcltOXSlpZihwPW8ucHJlRmlsdGVyW05dKHAsRixuLHksbSxNKSl7aWYocD09PXRydWUpY29udGludWV9ZWxzZSBxPU89dHJ1ZTtpZihwKWZvcih2YXIgaj0wOyhEPUZbal0pIT1udWxsO2orKylpZihEKXtPPVIoRCxwLGosRik7dmFyIHM9bV4hIU87aWYobiYmTyE9bnVsbClpZihzKXE9dHJ1ZTtlbHNlIEZbal09ZmFsc2U7ZWxzZSBpZihzKXt5LnB1c2goRCk7cT10cnVlfX1pZihPIT09CkIpe258fChGPXkpO2c9Zy5yZXBsYWNlKG8ubWF0Y2hbTl0sIiIpO2lmKCFxKXJldHVybltdO2JyZWFrfX19aWYoZz09PXUpaWYocT09bnVsbClrLmVycm9yKGcpO2Vsc2UgYnJlYWs7dT1nfXJldHVybiBGfTtrLmVycm9yPWZ1bmN0aW9uKGcpe3Rocm93IlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrZzt9O3ZhciBvPWsuc2VsZWN0b3JzPXtvcmRlcjpbIklEIiwiTkFNRSIsIlRBRyJdLG1hdGNoOntJRDovIygoPzpbXHdcdTAwYzAtXHVGRkZGXC1dfFxcLikrKS8sQ0xBU1M6L1wuKCg/Oltcd1x1MDBjMC1cdUZGRkZcLV18XFwuKSspLyxOQU1FOi9cW25hbWU9WyciXSooKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKylbJyJdKlxdLyxBVFRSOi9cW1xzKigoPzpbXHdcdTAwYzAtXHVGRkZGXC1dfFxcLikrKVxzKig/OihcUz89KVxzKihbJyJdKikoLio/KVwzfClccypcXS8sVEFHOi9eKCg/Oltcd1x1MDBjMC1cdUZGRkZcKlwtXXxcXC4pKykvLENISUxEOi86KG9ubHl8bnRofGxhc3R8Zmlyc3QpLWNoaWxkKD86XCgoZXZlbnxvZGR8W1xkbitcLV0qKVwpKT8vLApQT1M6LzoobnRofGVxfGd0fGx0fGZpcnN0fGxhc3R8ZXZlbnxvZGQpKD86XCgoXGQqKVwpKT8oPz1bXlwtXXwkKS8sUFNFVURPOi86KCg/Oltcd1x1MDBjMC1cdUZGRkZcLV18XFwuKSspKD86XCgoWyciXT8pKCg/OlwoW15cKV0rXCl8W15cKFwpXSopKylcMlwpKT8vfSxsZWZ0TWF0Y2g6e30sYXR0ck1hcDp7ImNsYXNzIjoiY2xhc3NOYW1lIiwiZm9yIjoiaHRtbEZvciJ9LGF0dHJIYW5kbGU6e2hyZWY6ZnVuY3Rpb24oZyl7cmV0dXJuIGcuZ2V0QXR0cmlidXRlKCJocmVmIil9fSxyZWxhdGl2ZTp7IisiOmZ1bmN0aW9uKGcsaSl7dmFyIG49dHlwZW9mIGk9PT0ic3RyaW5nIixtPW4mJiEvXFcvLnRlc3QoaSk7bj1uJiYhbTtpZihtKWk9aS50b0xvd2VyQ2FzZSgpO209MDtmb3IodmFyIHA9Zy5sZW5ndGgscTttPHA7bSsrKWlmKHE9Z1ttXSl7Zm9yKDsocT1xLnByZXZpb3VzU2libGluZykmJnEubm9kZVR5cGUhPT0xOyk7Z1ttXT1ufHxxJiZxLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT0KaT9xfHxmYWxzZTpxPT09aX1uJiZrLmZpbHRlcihpLGcsdHJ1ZSl9LCI+IjpmdW5jdGlvbihnLGkpe3ZhciBuLG09dHlwZW9mIGk9PT0ic3RyaW5nIixwPTAscT1nLmxlbmd0aDtpZihtJiYhL1xXLy50ZXN0KGkpKWZvcihpPWkudG9Mb3dlckNhc2UoKTtwPHE7cCsrKXtpZihuPWdbcF0pe249bi5wYXJlbnROb2RlO2dbcF09bi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09aT9uOmZhbHNlfX1lbHNle2Zvcig7cDxxO3ArKylpZihuPWdbcF0pZ1twXT1tP24ucGFyZW50Tm9kZTpuLnBhcmVudE5vZGU9PT1pO20mJmsuZmlsdGVyKGksZyx0cnVlKX19LCIiOmZ1bmN0aW9uKGcsaSxuKXt2YXIgbSxwPWUrKyxxPWI7aWYodHlwZW9mIGk9PT0ic3RyaW5nIiYmIS9cVy8udGVzdChpKSl7bT1pPWkudG9Mb3dlckNhc2UoKTtxPWF9cSgicGFyZW50Tm9kZSIsaSxwLGcsbSxuKX0sIn4iOmZ1bmN0aW9uKGcsaSxuKXt2YXIgbSxwPWUrKyxxPWI7aWYodHlwZW9mIGk9PT0ic3RyaW5nIiYmIS9cVy8udGVzdChpKSl7bT0KaT1pLnRvTG93ZXJDYXNlKCk7cT1hfXEoInByZXZpb3VzU2libGluZyIsaSxwLGcsbSxuKX19LGZpbmQ6e0lEOmZ1bmN0aW9uKGcsaSxuKXtpZih0eXBlb2YgaS5nZXRFbGVtZW50QnlJZCE9PSJ1bmRlZmluZWQiJiYhbilyZXR1cm4oZz1pLmdldEVsZW1lbnRCeUlkKGdbMV0pKSYmZy5wYXJlbnROb2RlP1tnXTpbXX0sTkFNRTpmdW5jdGlvbihnLGkpe2lmKHR5cGVvZiBpLmdldEVsZW1lbnRzQnlOYW1lIT09InVuZGVmaW5lZCIpe2Zvcih2YXIgbj1bXSxtPWkuZ2V0RWxlbWVudHNCeU5hbWUoZ1sxXSkscD0wLHE9bS5sZW5ndGg7cDxxO3ArKyltW3BdLmdldEF0dHJpYnV0ZSgibmFtZSIpPT09Z1sxXSYmbi5wdXNoKG1bcF0pO3JldHVybiBuLmxlbmd0aD09PTA/bnVsbDpufX0sVEFHOmZ1bmN0aW9uKGcsaSl7cmV0dXJuIGkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZ1sxXSl9fSxwcmVGaWx0ZXI6e0NMQVNTOmZ1bmN0aW9uKGcsaSxuLG0scCxxKXtnPSIgIitnWzFdLnJlcGxhY2UoL1xcL2csCiIiKSsiICI7aWYocSlyZXR1cm4gZztxPTA7Zm9yKHZhciB1Oyh1PWlbcV0pIT1udWxsO3ErKylpZih1KWlmKHBeKHUuY2xhc3NOYW1lJiYoIiAiK3UuY2xhc3NOYW1lKyIgIikucmVwbGFjZSgvW1x0XG5dL2csIiAiKS5pbmRleE9mKGcpPj0wKSlufHxtLnB1c2godSk7ZWxzZSBpZihuKWlbcV09ZmFsc2U7cmV0dXJuIGZhbHNlfSxJRDpmdW5jdGlvbihnKXtyZXR1cm4gZ1sxXS5yZXBsYWNlKC9cXC9nLCIiKX0sVEFHOmZ1bmN0aW9uKGcpe3JldHVybiBnWzFdLnRvTG93ZXJDYXNlKCl9LENISUxEOmZ1bmN0aW9uKGcpe2lmKGdbMV09PT0ibnRoIil7dmFyIGk9LygtPykoXGQqKW4oKD86XCt8LSk/XGQqKS8uZXhlYyhnWzJdPT09ImV2ZW4iJiYiMm4ifHxnWzJdPT09Im9kZCImJiIybisxInx8IS9cRC8udGVzdChnWzJdKSYmIjBuKyIrZ1syXXx8Z1syXSk7Z1syXT1pWzFdKyhpWzJdfHwxKS0wO2dbM109aVszXS0wfWdbMF09ZSsrO3JldHVybiBnfSxBVFRSOmZ1bmN0aW9uKGcsaSxuLAptLHAscSl7aT1nWzFdLnJlcGxhY2UoL1xcL2csIiIpO2lmKCFxJiZvLmF0dHJNYXBbaV0pZ1sxXT1vLmF0dHJNYXBbaV07aWYoZ1syXT09PSJ+PSIpZ1s0XT0iICIrZ1s0XSsiICI7cmV0dXJuIGd9LFBTRVVETzpmdW5jdGlvbihnLGksbixtLHApe2lmKGdbMV09PT0ibm90IilpZigoZC5leGVjKGdbM10pfHwiIikubGVuZ3RoPjF8fC9eXHcvLnRlc3QoZ1szXSkpZ1szXT1rKGdbM10sbnVsbCxudWxsLGkpO2Vsc2V7Zz1rLmZpbHRlcihnWzNdLGksbix0cnVlXnApO258fG0ucHVzaC5hcHBseShtLGcpO3JldHVybiBmYWxzZX1lbHNlIGlmKG8ubWF0Y2guUE9TLnRlc3QoZ1swXSl8fG8ubWF0Y2guQ0hJTEQudGVzdChnWzBdKSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZ30sUE9TOmZ1bmN0aW9uKGcpe2cudW5zaGlmdCh0cnVlKTtyZXR1cm4gZ319LGZpbHRlcnM6e2VuYWJsZWQ6ZnVuY3Rpb24oZyl7cmV0dXJuIGcuZGlzYWJsZWQ9PT1mYWxzZSYmZy50eXBlIT09ImhpZGRlbiJ9LGRpc2FibGVkOmZ1bmN0aW9uKGcpe3JldHVybiBnLmRpc2FibGVkPT09CnRydWV9LGNoZWNrZWQ6ZnVuY3Rpb24oZyl7cmV0dXJuIGcuY2hlY2tlZD09PXRydWV9LHNlbGVjdGVkOmZ1bmN0aW9uKGcpe3JldHVybiBnLnNlbGVjdGVkPT09dHJ1ZX0scGFyZW50OmZ1bmN0aW9uKGcpe3JldHVybiEhZy5maXJzdENoaWxkfSxlbXB0eTpmdW5jdGlvbihnKXtyZXR1cm4hZy5maXJzdENoaWxkfSxoYXM6ZnVuY3Rpb24oZyxpLG4pe3JldHVybiEhayhuWzNdLGcpLmxlbmd0aH0saGVhZGVyOmZ1bmN0aW9uKGcpe3JldHVybi9oXGQvaS50ZXN0KGcubm9kZU5hbWUpfSx0ZXh0OmZ1bmN0aW9uKGcpe3JldHVybiJ0ZXh0Ij09PWcudHlwZX0scmFkaW86ZnVuY3Rpb24oZyl7cmV0dXJuInJhZGlvIj09PWcudHlwZX0sY2hlY2tib3g6ZnVuY3Rpb24oZyl7cmV0dXJuImNoZWNrYm94Ij09PWcudHlwZX0sZmlsZTpmdW5jdGlvbihnKXtyZXR1cm4iZmlsZSI9PT1nLnR5cGV9LHBhc3N3b3JkOmZ1bmN0aW9uKGcpe3JldHVybiJwYXNzd29yZCI9PT1nLnR5cGV9LHN1Ym1pdDpmdW5jdGlvbihnKXtyZXR1cm4ic3VibWl0Ij09PQpnLnR5cGV9LGltYWdlOmZ1bmN0aW9uKGcpe3JldHVybiJpbWFnZSI9PT1nLnR5cGV9LHJlc2V0OmZ1bmN0aW9uKGcpe3JldHVybiJyZXNldCI9PT1nLnR5cGV9LGJ1dHRvbjpmdW5jdGlvbihnKXtyZXR1cm4iYnV0dG9uIj09PWcudHlwZXx8Zy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09ImJ1dHRvbiJ9LGlucHV0OmZ1bmN0aW9uKGcpe3JldHVybi9pbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uL2kudGVzdChnLm5vZGVOYW1lKX19LHNldEZpbHRlcnM6e2ZpcnN0OmZ1bmN0aW9uKGcsaSl7cmV0dXJuIGk9PT0wfSxsYXN0OmZ1bmN0aW9uKGcsaSxuLG0pe3JldHVybiBpPT09bS5sZW5ndGgtMX0sZXZlbjpmdW5jdGlvbihnLGkpe3JldHVybiBpJTI9PT0wfSxvZGQ6ZnVuY3Rpb24oZyxpKXtyZXR1cm4gaSUyPT09MX0sbHQ6ZnVuY3Rpb24oZyxpLG4pe3JldHVybiBpPG5bM10tMH0sZ3Q6ZnVuY3Rpb24oZyxpLG4pe3JldHVybiBpPm5bM10tMH0sbnRoOmZ1bmN0aW9uKGcsaSxuKXtyZXR1cm4gblszXS0KMD09PWl9LGVxOmZ1bmN0aW9uKGcsaSxuKXtyZXR1cm4gblszXS0wPT09aX19LGZpbHRlcjp7UFNFVURPOmZ1bmN0aW9uKGcsaSxuLG0pe3ZhciBwPWlbMV0scT1vLmZpbHRlcnNbcF07aWYocSlyZXR1cm4gcShnLG4saSxtKTtlbHNlIGlmKHA9PT0iY29udGFpbnMiKXJldHVybihnLnRleHRDb250ZW50fHxnLmlubmVyVGV4dHx8ay5nZXRUZXh0KFtnXSl8fCIiKS5pbmRleE9mKGlbM10pPj0wO2Vsc2UgaWYocD09PSJub3QiKXtpPWlbM107bj0wO2ZvcihtPWkubGVuZ3RoO248bTtuKyspaWYoaVtuXT09PWcpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlfWVsc2Ugay5lcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIitwKX0sQ0hJTEQ6ZnVuY3Rpb24oZyxpKXt2YXIgbj1pWzFdLG09Zztzd2l0Y2gobil7Y2FzZSAib25seSI6Y2FzZSAiZmlyc3QiOmZvcig7bT1tLnByZXZpb3VzU2libGluZzspaWYobS5ub2RlVHlwZT09PTEpcmV0dXJuIGZhbHNlO2lmKG49PT0KImZpcnN0IilyZXR1cm4gdHJ1ZTttPWc7Y2FzZSAibGFzdCI6Zm9yKDttPW0ubmV4dFNpYmxpbmc7KWlmKG0ubm9kZVR5cGU9PT0xKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZTtjYXNlICJudGgiOm49aVsyXTt2YXIgcD1pWzNdO2lmKG49PT0xJiZwPT09MClyZXR1cm4gdHJ1ZTt2YXIgcT1pWzBdLHU9Zy5wYXJlbnROb2RlO2lmKHUmJih1LnNpemNhY2hlIT09cXx8IWcubm9kZUluZGV4KSl7dmFyIHk9MDtmb3IobT11LmZpcnN0Q2hpbGQ7bTttPW0ubmV4dFNpYmxpbmcpaWYobS5ub2RlVHlwZT09PTEpbS5ub2RlSW5kZXg9Kyt5O3Uuc2l6Y2FjaGU9cX1tPWcubm9kZUluZGV4LXA7cmV0dXJuIG49PT0wP209PT0wOm0lbj09PTAmJm0vbj49MH19LElEOmZ1bmN0aW9uKGcsaSl7cmV0dXJuIGcubm9kZVR5cGU9PT0xJiZnLmdldEF0dHJpYnV0ZSgiaWQiKT09PWl9LFRBRzpmdW5jdGlvbihnLGkpe3JldHVybiBpPT09IioiJiZnLm5vZGVUeXBlPT09MXx8Zy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Cml9LENMQVNTOmZ1bmN0aW9uKGcsaSl7cmV0dXJuKCIgIisoZy5jbGFzc05hbWV8fGcuZ2V0QXR0cmlidXRlKCJjbGFzcyIpKSsiICIpLmluZGV4T2YoaSk+LTF9LEFUVFI6ZnVuY3Rpb24oZyxpKXt2YXIgbj1pWzFdO249by5hdHRySGFuZGxlW25dP28uYXR0ckhhbmRsZVtuXShnKTpnW25dIT1udWxsP2dbbl06Zy5nZXRBdHRyaWJ1dGUobik7dmFyIG09bisiIixwPWlbMl0scT1pWzRdO3JldHVybiBuPT1udWxsP3A9PT0iIT0iOnA9PT0iPSI/bT09PXE6cD09PSIqPSI/bS5pbmRleE9mKHEpPj0wOnA9PT0ifj0iPygiICIrbSsiICIpLmluZGV4T2YocSk+PTA6IXE/bSYmbiE9PWZhbHNlOnA9PT0iIT0iP20hPT1xOnA9PT0iXj0iP20uaW5kZXhPZihxKT09PTA6cD09PSIkPSI/bS5zdWJzdHIobS5sZW5ndGgtcS5sZW5ndGgpPT09cTpwPT09Inw9Ij9tPT09cXx8bS5zdWJzdHIoMCxxLmxlbmd0aCsxKT09PXErIi0iOmZhbHNlfSxQT1M6ZnVuY3Rpb24oZyxpLG4sbSl7dmFyIHA9by5zZXRGaWx0ZXJzW2lbMl1dOwppZihwKXJldHVybiBwKGcsbixpLG0pfX19LHg9by5tYXRjaC5QT1Mscj1mdW5jdGlvbihnLGkpe3JldHVybiJcXCIrKGktMCsxKX0sQTtmb3IoQSBpbiBvLm1hdGNoKXtvLm1hdGNoW0FdPVJlZ0V4cChvLm1hdGNoW0FdLnNvdXJjZSsvKD8hW15cW10qXF0pKD8hW15cKF0qXCkpLy5zb3VyY2UpO28ubGVmdE1hdGNoW0FdPVJlZ0V4cCgvKF4oPzoufFxyfFxuKSo/KS8uc291cmNlK28ubWF0Y2hbQV0uc291cmNlLnJlcGxhY2UoL1xcKFxkKykvZyxyKSl9dmFyIEM9ZnVuY3Rpb24oZyxpKXtnPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGcsMCk7aWYoaSl7aS5wdXNoLmFwcGx5KGksZyk7cmV0dXJuIGl9cmV0dXJuIGd9O3RyeXtBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0LmRvY3VtZW50RWxlbWVudC5jaGlsZE5vZGVzLDApfWNhdGNoKEope0M9ZnVuY3Rpb24oZyxpKXt2YXIgbj0wLG09aXx8W107aWYoZi5jYWxsKGcpPT09IltvYmplY3QgQXJyYXldIilBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShtLApnKTtlbHNlIGlmKHR5cGVvZiBnLmxlbmd0aD09PSJudW1iZXIiKWZvcih2YXIgcD1nLmxlbmd0aDtuPHA7bisrKW0ucHVzaChnW25dKTtlbHNlIGZvcig7Z1tuXTtuKyspbS5wdXNoKGdbbl0pO3JldHVybiBtfX12YXIgdyxJO2lmKHQuZG9jdW1lbnRFbGVtZW50LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKXc9ZnVuY3Rpb24oZyxpKXtpZihnPT09aSl7aD10cnVlO3JldHVybiAwfWlmKCFnLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9ufHwhaS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbilyZXR1cm4gZy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbj8tMToxO3JldHVybiBnLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGkpJjQ/LTE6MX07ZWxzZXt3PWZ1bmN0aW9uKGcsaSl7dmFyIG4sbSxwPVtdLHE9W107bj1nLnBhcmVudE5vZGU7bT1pLnBhcmVudE5vZGU7dmFyIHU9bjtpZihnPT09aSl7aD10cnVlO3JldHVybiAwfWVsc2UgaWYobj09PW0pcmV0dXJuIEkoZyxpKTtlbHNlIGlmKG4pe2lmKCFtKXJldHVybiAxfWVsc2UgcmV0dXJuLTE7CmZvcig7dTspe3AudW5zaGlmdCh1KTt1PXUucGFyZW50Tm9kZX1mb3IodT1tO3U7KXtxLnVuc2hpZnQodSk7dT11LnBhcmVudE5vZGV9bj1wLmxlbmd0aDttPXEubGVuZ3RoO2Zvcih1PTA7dTxuJiZ1PG07dSsrKWlmKHBbdV0hPT1xW3VdKXJldHVybiBJKHBbdV0scVt1XSk7cmV0dXJuIHU9PT1uP0koZyxxW3VdLC0xKTpJKHBbdV0saSwxKX07ST1mdW5jdGlvbihnLGksbil7aWYoZz09PWkpcmV0dXJuIG47Zm9yKGc9Zy5uZXh0U2libGluZztnOyl7aWYoZz09PWkpcmV0dXJuLTE7Zz1nLm5leHRTaWJsaW5nfXJldHVybiAxfX1rLmdldFRleHQ9ZnVuY3Rpb24oZyl7Zm9yKHZhciBpPSIiLG4sbT0wO2dbbV07bSsrKXtuPWdbbV07aWYobi5ub2RlVHlwZT09PTN8fG4ubm9kZVR5cGU9PT00KWkrPW4ubm9kZVZhbHVlO2Vsc2UgaWYobi5ub2RlVHlwZSE9PTgpaSs9ay5nZXRUZXh0KG4uY2hpbGROb2Rlcyl9cmV0dXJuIGl9OyhmdW5jdGlvbigpe3ZhciBnPXQuY3JlYXRlRWxlbWVudCgiZGl2IiksCmk9InNjcmlwdCIrKG5ldyBEYXRlKS5nZXRUaW1lKCksbj10LmRvY3VtZW50RWxlbWVudDtnLmlubmVySFRNTD0iPGEgbmFtZT0nIitpKyInLz4iO24uaW5zZXJ0QmVmb3JlKGcsbi5maXJzdENoaWxkKTtpZih0LmdldEVsZW1lbnRCeUlkKGkpKXtvLmZpbmQuSUQ9ZnVuY3Rpb24obSxwLHEpe2lmKHR5cGVvZiBwLmdldEVsZW1lbnRCeUlkIT09InVuZGVmaW5lZCImJiFxKXJldHVybihwPXAuZ2V0RWxlbWVudEJ5SWQobVsxXSkpP3AuaWQ9PT1tWzFdfHx0eXBlb2YgcC5nZXRBdHRyaWJ1dGVOb2RlIT09InVuZGVmaW5lZCImJnAuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWU9PT1tWzFdP1twXTpCOltdfTtvLmZpbHRlci5JRD1mdW5jdGlvbihtLHApe3ZhciBxPXR5cGVvZiBtLmdldEF0dHJpYnV0ZU5vZGUhPT0idW5kZWZpbmVkIiYmbS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpO3JldHVybiBtLm5vZGVUeXBlPT09MSYmcSYmcS5ub2RlVmFsdWU9PT1wfX1uLnJlbW92ZUNoaWxkKGcpOwpuPWc9bnVsbH0pKCk7KGZ1bmN0aW9uKCl7dmFyIGc9dC5jcmVhdGVFbGVtZW50KCJkaXYiKTtnLmFwcGVuZENoaWxkKHQuY3JlYXRlQ29tbWVudCgiIikpO2lmKGcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKS5sZW5ndGg+MClvLmZpbmQuVEFHPWZ1bmN0aW9uKGksbil7dmFyIG09bi5nZXRFbGVtZW50c0J5VGFnTmFtZShpWzFdKTtpZihpWzFdPT09IioiKXtmb3IodmFyIHA9W10scT0wO21bcV07cSsrKW1bcV0ubm9kZVR5cGU9PT0xJiZwLnB1c2gobVtxXSk7bT1wfXJldHVybiBtfTtnLmlubmVySFRNTD0iPGEgaHJlZj0nIyc+PC9hPiI7aWYoZy5maXJzdENoaWxkJiZ0eXBlb2YgZy5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSE9PSJ1bmRlZmluZWQiJiZnLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJocmVmIikhPT0iIyIpby5hdHRySGFuZGxlLmhyZWY9ZnVuY3Rpb24oaSl7cmV0dXJuIGkuZ2V0QXR0cmlidXRlKCJocmVmIiwyKX07Zz1udWxsfSkoKTt0LnF1ZXJ5U2VsZWN0b3JBbGwmJgpmdW5jdGlvbigpe3ZhciBnPWssaT10LmNyZWF0ZUVsZW1lbnQoImRpdiIpO2kuaW5uZXJIVE1MPSI8cCBjbGFzcz0nVEVTVCc+PC9wPiI7aWYoIShpLnF1ZXJ5U2VsZWN0b3JBbGwmJmkucXVlcnlTZWxlY3RvckFsbCgiLlRFU1QiKS5sZW5ndGg9PT0wKSl7az1mdW5jdGlvbihtLHAscSx1KXtwPXB8fHQ7bT1tLnJlcGxhY2UoL1w9XHMqKFteJyJcXV0qKVxzKlxdL2csIj0nJDEnXSIpO2lmKCF1JiYhay5pc1hNTChwKSlpZihwLm5vZGVUeXBlPT09OSl0cnl7cmV0dXJuIEMocC5xdWVyeVNlbGVjdG9yQWxsKG0pLHEpfWNhdGNoKHkpe31lbHNlIGlmKHAubm9kZVR5cGU9PT0xJiZwLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkhPT0ib2JqZWN0Iil7dmFyIEY9cC5nZXRBdHRyaWJ1dGUoImlkIiksTT1GfHwiX19zaXp6bGVfXyI7Rnx8cC5zZXRBdHRyaWJ1dGUoImlkIixNKTt0cnl7cmV0dXJuIEMocC5xdWVyeVNlbGVjdG9yQWxsKCIjIitNKyIgIittKSxxKX1jYXRjaChOKXt9ZmluYWxseXtGfHwKcC5yZW1vdmVBdHRyaWJ1dGUoImlkIil9fXJldHVybiBnKG0scCxxLHUpfTtmb3IodmFyIG4gaW4gZylrW25dPWdbbl07aT1udWxsfX0oKTsoZnVuY3Rpb24oKXt2YXIgZz10LmRvY3VtZW50RWxlbWVudCxpPWcubWF0Y2hlc1NlbGVjdG9yfHxnLm1vek1hdGNoZXNTZWxlY3Rvcnx8Zy53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fGcubXNNYXRjaGVzU2VsZWN0b3Isbj1mYWxzZTt0cnl7aS5jYWxsKHQuZG9jdW1lbnRFbGVtZW50LCJbdGVzdCE9JyddOnNpenpsZSIpfWNhdGNoKG0pe249dHJ1ZX1pZihpKWsubWF0Y2hlc1NlbGVjdG9yPWZ1bmN0aW9uKHAscSl7cT1xLnJlcGxhY2UoL1w9XHMqKFteJyJcXV0qKVxzKlxdL2csIj0nJDEnXSIpO2lmKCFrLmlzWE1MKHApKXRyeXtpZihufHwhby5tYXRjaC5QU0VVRE8udGVzdChxKSYmIS8hPS8udGVzdChxKSlyZXR1cm4gaS5jYWxsKHAscSl9Y2F0Y2godSl7fXJldHVybiBrKHEsbnVsbCxudWxsLFtwXSkubGVuZ3RoPjB9fSkoKTsoZnVuY3Rpb24oKXt2YXIgZz0KdC5jcmVhdGVFbGVtZW50KCJkaXYiKTtnLmlubmVySFRNTD0iPGRpdiBjbGFzcz0ndGVzdCBlJz48L2Rpdj48ZGl2IGNsYXNzPSd0ZXN0Jz48L2Rpdj4iO2lmKCEoIWcuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZXx8Zy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlIikubGVuZ3RoPT09MCkpe2cubGFzdENoaWxkLmNsYXNzTmFtZT0iZSI7aWYoZy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlIikubGVuZ3RoIT09MSl7by5vcmRlci5zcGxpY2UoMSwwLCJDTEFTUyIpO28uZmluZC5DTEFTUz1mdW5jdGlvbihpLG4sbSl7aWYodHlwZW9mIG4uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSE9PSJ1bmRlZmluZWQiJiYhbSlyZXR1cm4gbi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGlbMV0pfTtnPW51bGx9fX0pKCk7ay5jb250YWlucz10LmRvY3VtZW50RWxlbWVudC5jb250YWlucz9mdW5jdGlvbihnLGkpe3JldHVybiBnIT09aSYmKGcuY29udGFpbnM/Zy5jb250YWlucyhpKTp0cnVlKX06dC5kb2N1bWVudEVsZW1lbnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24/CmZ1bmN0aW9uKGcsaSl7cmV0dXJuISEoZy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihpKSYxNil9OmZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlfTtrLmlzWE1MPWZ1bmN0aW9uKGcpe3JldHVybihnPShnP2cub3duZXJEb2N1bWVudHx8ZzowKS5kb2N1bWVudEVsZW1lbnQpP2cubm9kZU5hbWUhPT0iSFRNTCI6ZmFsc2V9O3ZhciBMPWZ1bmN0aW9uKGcsaSl7Zm9yKHZhciBuLG09W10scD0iIixxPWkubm9kZVR5cGU/W2ldOmk7bj1vLm1hdGNoLlBTRVVETy5leGVjKGcpOyl7cCs9blswXTtnPWcucmVwbGFjZShvLm1hdGNoLlBTRVVETywiIil9Zz1vLnJlbGF0aXZlW2ddP2crIioiOmc7bj0wO2Zvcih2YXIgdT1xLmxlbmd0aDtuPHU7bisrKWsoZyxxW25dLG0pO3JldHVybiBrLmZpbHRlcihwLG0pfTtjLmZpbmQ9aztjLmV4cHI9ay5zZWxlY3RvcnM7Yy5leHByWyI6Il09Yy5leHByLmZpbHRlcnM7Yy51bmlxdWU9ay51bmlxdWVTb3J0O2MudGV4dD1rLmdldFRleHQ7Yy5pc1hNTERvYz1rLmlzWE1MOwpjLmNvbnRhaW5zPWsuY29udGFpbnN9KSgpO3ZhciBaYT0vVW50aWwkLywkYT0vXig/OnBhcmVudHN8cHJldlVudGlsfHByZXZBbGwpLyxhYj0vLC8sTmE9L14uW146I1xbXC4sXSokLyxiYj1BcnJheS5wcm90b3R5cGUuc2xpY2UsY2I9Yy5leHByLm1hdGNoLlBPUztjLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5wdXNoU3RhY2soIiIsImZpbmQiLGEpLGQ9MCxlPTAsZj10aGlzLmxlbmd0aDtlPGY7ZSsrKXtkPWIubGVuZ3RoO2MuZmluZChhLHRoaXNbZV0sYik7aWYoZT4wKWZvcih2YXIgaD1kO2g8Yi5sZW5ndGg7aCsrKWZvcih2YXIgbD0wO2w8ZDtsKyspaWYoYltsXT09PWJbaF0pe2Iuc3BsaWNlKGgtLSwxKTticmVha319cmV0dXJuIGJ9LGhhczpmdW5jdGlvbihhKXt2YXIgYj1jKGEpO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2Zvcih2YXIgZD0wLGU9Yi5sZW5ndGg7ZDxlO2QrKylpZihjLmNvbnRhaW5zKHRoaXMsYltkXSkpcmV0dXJuIHRydWV9KX0sCm5vdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sobWEodGhpcyxhLGZhbHNlKSwibm90IixhKX0sZmlsdGVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhtYSh0aGlzLGEsdHJ1ZSksImZpbHRlciIsYSl9LGlzOmZ1bmN0aW9uKGEpe3JldHVybiEhYSYmYy5maWx0ZXIoYSx0aGlzKS5sZW5ndGg+MH0sY2xvc2VzdDpmdW5jdGlvbihhLGIpe3ZhciBkPVtdLGUsZixoPXRoaXNbMF07aWYoYy5pc0FycmF5KGEpKXt2YXIgbCxrPXt9LG89MTtpZihoJiZhLmxlbmd0aCl7ZT0wO2ZvcihmPWEubGVuZ3RoO2U8ZjtlKyspe2w9YVtlXTtrW2xdfHwoa1tsXT1jLmV4cHIubWF0Y2guUE9TLnRlc3QobCk/YyhsLGJ8fHRoaXMuY29udGV4dCk6bCl9Zm9yKDtoJiZoLm93bmVyRG9jdW1lbnQmJmghPT1iOyl7Zm9yKGwgaW4gayl7ZT1rW2xdO2lmKGUuanF1ZXJ5P2UuaW5kZXgoaCk+LTE6YyhoKS5pcyhlKSlkLnB1c2goe3NlbGVjdG9yOmwsZWxlbTpoLGxldmVsOm99KX1oPQpoLnBhcmVudE5vZGU7bysrfX1yZXR1cm4gZH1sPWNiLnRlc3QoYSk/YyhhLGJ8fHRoaXMuY29udGV4dCk6bnVsbDtlPTA7Zm9yKGY9dGhpcy5sZW5ndGg7ZTxmO2UrKylmb3IoaD10aGlzW2VdO2g7KWlmKGw/bC5pbmRleChoKT4tMTpjLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGgsYSkpe2QucHVzaChoKTticmVha31lbHNle2g9aC5wYXJlbnROb2RlO2lmKCFofHwhaC5vd25lckRvY3VtZW50fHxoPT09YilicmVha31kPWQubGVuZ3RoPjE/Yy51bmlxdWUoZCk6ZDtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZCwiY2xvc2VzdCIsYSl9LGluZGV4OmZ1bmN0aW9uKGEpe2lmKCFhfHx0eXBlb2YgYT09PSJzdHJpbmciKXJldHVybiBjLmluQXJyYXkodGhpc1swXSxhP2MoYSk6dGhpcy5wYXJlbnQoKS5jaGlsZHJlbigpKTtyZXR1cm4gYy5pbkFycmF5KGEuanF1ZXJ5P2FbMF06YSx0aGlzKX0sYWRkOmZ1bmN0aW9uKGEsYil7dmFyIGQ9dHlwZW9mIGE9PT0ic3RyaW5nIj9jKGEsYnx8dGhpcy5jb250ZXh0KToKYy5tYWtlQXJyYXkoYSksZT1jLm1lcmdlKHRoaXMuZ2V0KCksZCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKCFkWzBdfHwhZFswXS5wYXJlbnROb2RlfHxkWzBdLnBhcmVudE5vZGUubm9kZVR5cGU9PT0xMXx8IWVbMF18fCFlWzBdLnBhcmVudE5vZGV8fGVbMF0ucGFyZW50Tm9kZS5ub2RlVHlwZT09PTExP2U6Yy51bmlxdWUoZSkpfSxhbmRTZWxmOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKHRoaXMucHJldk9iamVjdCl9fSk7Yy5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuKGE9YS5wYXJlbnROb2RlKSYmYS5ub2RlVHlwZSE9PTExP2E6bnVsbH0scGFyZW50czpmdW5jdGlvbihhKXtyZXR1cm4gYy5kaXIoYSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBjLmRpcihhLCJwYXJlbnROb2RlIixkKX0sbmV4dDpmdW5jdGlvbihhKXtyZXR1cm4gYy5udGgoYSwyLCJuZXh0U2libGluZyIpfSxwcmV2OmZ1bmN0aW9uKGEpe3JldHVybiBjLm50aChhLAoyLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dEFsbDpmdW5jdGlvbihhKXtyZXR1cm4gYy5kaXIoYSwibmV4dFNpYmxpbmciKX0scHJldkFsbDpmdW5jdGlvbihhKXtyZXR1cm4gYy5kaXIoYSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRVbnRpbDpmdW5jdGlvbihhLGIsZCl7cmV0dXJuIGMuZGlyKGEsIm5leHRTaWJsaW5nIixkKX0scHJldlVudGlsOmZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gYy5kaXIoYSwicHJldmlvdXNTaWJsaW5nIixkKX0sc2libGluZ3M6ZnVuY3Rpb24oYSl7cmV0dXJuIGMuc2libGluZyhhLnBhcmVudE5vZGUuZmlyc3RDaGlsZCxhKX0sY2hpbGRyZW46ZnVuY3Rpb24oYSl7cmV0dXJuIGMuc2libGluZyhhLmZpcnN0Q2hpbGQpfSxjb250ZW50czpmdW5jdGlvbihhKXtyZXR1cm4gYy5ub2RlTmFtZShhLCJpZnJhbWUiKT9hLmNvbnRlbnREb2N1bWVudHx8YS5jb250ZW50V2luZG93LmRvY3VtZW50OmMubWFrZUFycmF5KGEuY2hpbGROb2Rlcyl9fSxmdW5jdGlvbihhLApiKXtjLmZuW2FdPWZ1bmN0aW9uKGQsZSl7dmFyIGY9Yy5tYXAodGhpcyxiLGQpO1phLnRlc3QoYSl8fChlPWQpO2lmKGUmJnR5cGVvZiBlPT09InN0cmluZyIpZj1jLmZpbHRlcihlLGYpO2Y9dGhpcy5sZW5ndGg+MT9jLnVuaXF1ZShmKTpmO2lmKCh0aGlzLmxlbmd0aD4xfHxhYi50ZXN0KGUpKSYmJGEudGVzdChhKSlmPWYucmV2ZXJzZSgpO3JldHVybiB0aGlzLnB1c2hTdGFjayhmLGEsYmIuY2FsbChhcmd1bWVudHMpLmpvaW4oIiwiKSl9fSk7Yy5leHRlbmQoe2ZpbHRlcjpmdW5jdGlvbihhLGIsZCl7aWYoZClhPSI6bm90KCIrYSsiKSI7cmV0dXJuIGIubGVuZ3RoPT09MT9jLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGJbMF0sYSk/W2JbMF1dOltdOmMuZmluZC5tYXRjaGVzKGEsYil9LGRpcjpmdW5jdGlvbihhLGIsZCl7dmFyIGU9W107Zm9yKGE9YVtiXTthJiZhLm5vZGVUeXBlIT09OSYmKGQ9PT1CfHxhLm5vZGVUeXBlIT09MXx8IWMoYSkuaXMoZCkpOyl7YS5ub2RlVHlwZT09PTEmJgplLnB1c2goYSk7YT1hW2JdfXJldHVybiBlfSxudGg6ZnVuY3Rpb24oYSxiLGQpe2I9Ynx8MTtmb3IodmFyIGU9MDthO2E9YVtkXSlpZihhLm5vZGVUeXBlPT09MSYmKytlPT09YilicmVhaztyZXR1cm4gYX0sc2libGluZzpmdW5jdGlvbihhLGIpe2Zvcih2YXIgZD1bXTthO2E9YS5uZXh0U2libGluZylhLm5vZGVUeXBlPT09MSYmYSE9PWImJmQucHVzaChhKTtyZXR1cm4gZH19KTt2YXIgemE9LyBqUXVlcnlcZCs9Iig/OlxkK3xudWxsKSIvZywkPS9eXHMrLyxBYT0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXHc6XSspW14+XSopXC8+L2lnLEJhPS88KFtcdzpdKykvLGRiPS88dGJvZHkvaSxlYj0vPHwmIz9cdys7LyxDYT0vPCg/OnNjcmlwdHxvYmplY3R8ZW1iZWR8b3B0aW9ufHN0eWxlKS9pLERhPS9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLGZiPS9cPShbXj0iJz5cc10rXC8pPi9nLFA9e29wdGlvbjpbMSwKIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCI8L3NlbGVjdD4iXSxsZWdlbmQ6WzEsIjxmaWVsZHNldD4iLCI8L2ZpZWxkc2V0PiJdLHRoZWFkOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSx0cjpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLGNvbDpbMiwiPHRhYmxlPjx0Ym9keT48L3Rib2R5Pjxjb2xncm91cD4iLCI8L2NvbGdyb3VwPjwvdGFibGU+Il0sYXJlYTpbMSwiPG1hcD4iLCI8L21hcD4iXSxfZGVmYXVsdDpbMCwiIiwiIl19O1Aub3B0Z3JvdXA9UC5vcHRpb247UC50Ym9keT1QLnRmb290PVAuY29sZ3JvdXA9UC5jYXB0aW9uPVAudGhlYWQ7UC50aD1QLnRkO2lmKCFjLnN1cHBvcnQuaHRtbFNlcmlhbGl6ZSlQLl9kZWZhdWx0PVsxLCJkaXY8ZGl2PiIsIjwvZGl2PiJdO2MuZm4uZXh0ZW5kKHt0ZXh0OmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBkPQpjKHRoaXMpO2QudGV4dChhLmNhbGwodGhpcyxiLGQudGV4dCgpKSl9KTtpZih0eXBlb2YgYSE9PSJvYmplY3QiJiZhIT09QilyZXR1cm4gdGhpcy5lbXB0eSgpLmFwcGVuZCgodGhpc1swXSYmdGhpc1swXS5vd25lckRvY3VtZW50fHx0KS5jcmVhdGVUZXh0Tm9kZShhKSk7cmV0dXJuIGMudGV4dCh0aGlzKX0sd3JhcEFsbDpmdW5jdGlvbihhKXtpZihjLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihkKXtjKHRoaXMpLndyYXBBbGwoYS5jYWxsKHRoaXMsZCkpfSk7aWYodGhpc1swXSl7dmFyIGI9YyhhLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUodHJ1ZSk7dGhpc1swXS5wYXJlbnROb2RlJiZiLmluc2VydEJlZm9yZSh0aGlzWzBdKTtiLm1hcChmdW5jdGlvbigpe2Zvcih2YXIgZD10aGlzO2QuZmlyc3RDaGlsZCYmZC5maXJzdENoaWxkLm5vZGVUeXBlPT09MTspZD1kLmZpcnN0Q2hpbGQ7cmV0dXJuIGR9KS5hcHBlbmQodGhpcyl9cmV0dXJuIHRoaXN9LAp3cmFwSW5uZXI6ZnVuY3Rpb24oYSl7aWYoYy5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7Yyh0aGlzKS53cmFwSW5uZXIoYS5jYWxsKHRoaXMsYikpfSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPWModGhpcyksZD1iLmNvbnRlbnRzKCk7ZC5sZW5ndGg/ZC53cmFwQWxsKGEpOmIuYXBwZW5kKGEpfSl9LHdyYXA6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2ModGhpcykud3JhcEFsbChhKX0pfSx1bndyYXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQoKS5lYWNoKGZ1bmN0aW9uKCl7Yy5ub2RlTmFtZSh0aGlzLCJib2R5Iil8fGModGhpcykucmVwbGFjZVdpdGgodGhpcy5jaGlsZE5vZGVzKX0pLmVuZCgpfSxhcHBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsdHJ1ZSxmdW5jdGlvbihhKXt0aGlzLm5vZGVUeXBlPT09MSYmdGhpcy5hcHBlbmRDaGlsZChhKX0pfSwKcHJlcGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyx0cnVlLGZ1bmN0aW9uKGEpe3RoaXMubm9kZVR5cGU9PT0xJiZ0aGlzLmluc2VydEJlZm9yZShhLHRoaXMuZmlyc3RDaGlsZCl9KX0sYmVmb3JlOmZ1bmN0aW9uKCl7aWYodGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlKXJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmYWxzZSxmdW5jdGlvbihiKXt0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGIsdGhpcyl9KTtlbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBhPWMoYXJndW1lbnRzWzBdKTthLnB1c2guYXBwbHkoYSx0aGlzLnRvQXJyYXkoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGEsImJlZm9yZSIsYXJndW1lbnRzKX19LGFmdGVyOmZ1bmN0aW9uKCl7aWYodGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlKXJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmYWxzZSxmdW5jdGlvbihiKXt0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGIsCnRoaXMubmV4dFNpYmxpbmcpfSk7ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoKXt2YXIgYT10aGlzLnB1c2hTdGFjayh0aGlzLCJhZnRlciIsYXJndW1lbnRzKTthLnB1c2guYXBwbHkoYSxjKGFyZ3VtZW50c1swXSkudG9BcnJheSgpKTtyZXR1cm4gYX19LHJlbW92ZTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgZD0wLGU7KGU9dGhpc1tkXSkhPW51bGw7ZCsrKWlmKCFhfHxjLmZpbHRlcihhLFtlXSkubGVuZ3RoKXtpZighYiYmZS5ub2RlVHlwZT09PTEpe2MuY2xlYW5EYXRhKGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSk7Yy5jbGVhbkRhdGEoW2VdKX1lLnBhcmVudE5vZGUmJmUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlKX1yZXR1cm4gdGhpc30sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGE9MCxiOyhiPXRoaXNbYV0pIT1udWxsO2ErKylmb3IoYi5ub2RlVHlwZT09PTEmJmMuY2xlYW5EYXRhKGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSk7Yi5maXJzdENoaWxkOyliLnJlbW92ZUNoaWxkKGIuZmlyc3RDaGlsZCk7CnJldHVybiB0aGlzfSxjbG9uZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm1hcChmdW5jdGlvbigpe2lmKCFjLnN1cHBvcnQubm9DbG9uZUV2ZW50JiYhYy5pc1hNTERvYyh0aGlzKSl7dmFyIGQ9dGhpcy5vdXRlckhUTUwsZT10aGlzLm93bmVyRG9jdW1lbnQ7aWYoIWQpe2Q9ZS5jcmVhdGVFbGVtZW50KCJkaXYiKTtkLmFwcGVuZENoaWxkKHRoaXMuY2xvbmVOb2RlKHRydWUpKTtkPWQuaW5uZXJIVE1MfXJldHVybiBjLmNsZWFuKFtkLnJlcGxhY2UoemEsIiIpLnJlcGxhY2UoZmIsJz0iJDEiPicpLnJlcGxhY2UoJCwiIildLGUpWzBdfWVsc2UgcmV0dXJuIHRoaXMuY2xvbmVOb2RlKHRydWUpfSk7aWYoYT09PXRydWUpe25hKHRoaXMsYik7bmEodGhpcy5maW5kKCIqIiksYi5maW5kKCIqIikpfXJldHVybiBifSxodG1sOmZ1bmN0aW9uKGEpe2lmKGE9PT1CKXJldHVybiB0aGlzWzBdJiZ0aGlzWzBdLm5vZGVUeXBlPT09MT90aGlzWzBdLmlubmVySFRNTC5yZXBsYWNlKHphLCIiKTpudWxsOwplbHNlIGlmKHR5cGVvZiBhPT09InN0cmluZyImJiFDYS50ZXN0KGEpJiYoYy5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlfHwhJC50ZXN0KGEpKSYmIVBbKEJhLmV4ZWMoYSl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCldKXthPWEucmVwbGFjZShBYSwiPCQxPjwvJDI+Iik7dHJ5e2Zvcih2YXIgYj0wLGQ9dGhpcy5sZW5ndGg7YjxkO2IrKylpZih0aGlzW2JdLm5vZGVUeXBlPT09MSl7Yy5jbGVhbkRhdGEodGhpc1tiXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKTt0aGlzW2JdLmlubmVySFRNTD1hfX1jYXRjaChlKXt0aGlzLmVtcHR5KCkuYXBwZW5kKGEpfX1lbHNlIGMuaXNGdW5jdGlvbihhKT90aGlzLmVhY2goZnVuY3Rpb24oZil7dmFyIGg9Yyh0aGlzKTtoLmh0bWwoYS5jYWxsKHRoaXMsZixoLmh0bWwoKSkpfSk6dGhpcy5lbXB0eSgpLmFwcGVuZChhKTtyZXR1cm4gdGhpc30scmVwbGFjZVdpdGg6ZnVuY3Rpb24oYSl7aWYodGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlKXtpZihjLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXt2YXIgZD0KYyh0aGlzKSxlPWQuaHRtbCgpO2QucmVwbGFjZVdpdGgoYS5jYWxsKHRoaXMsYixlKSl9KTtpZih0eXBlb2YgYSE9PSJzdHJpbmciKWE9YyhhKS5kZXRhY2goKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5uZXh0U2libGluZyxkPXRoaXMucGFyZW50Tm9kZTtjKHRoaXMpLnJlbW92ZSgpO2I/YyhiKS5iZWZvcmUoYSk6YyhkKS5hcHBlbmQoYSl9KX1lbHNlIHJldHVybiB0aGlzLnB1c2hTdGFjayhjKGMuaXNGdW5jdGlvbihhKT9hKCk6YSksInJlcGxhY2VXaXRoIixhKX0sZGV0YWNoOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJlbW92ZShhLHRydWUpfSxkb21NYW5pcDpmdW5jdGlvbihhLGIsZCl7dmFyIGUsZixoLGw9YVswXSxrPVtdO2lmKCFjLnN1cHBvcnQuY2hlY2tDbG9uZSYmYXJndW1lbnRzLmxlbmd0aD09PTMmJnR5cGVvZiBsPT09InN0cmluZyImJkRhLnRlc3QobCkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2ModGhpcykuZG9tTWFuaXAoYSwKYixkLHRydWUpfSk7aWYoYy5pc0Z1bmN0aW9uKGwpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oeCl7dmFyIHI9Yyh0aGlzKTthWzBdPWwuY2FsbCh0aGlzLHgsYj9yLmh0bWwoKTpCKTtyLmRvbU1hbmlwKGEsYixkKX0pO2lmKHRoaXNbMF0pe2U9bCYmbC5wYXJlbnROb2RlO2U9Yy5zdXBwb3J0LnBhcmVudE5vZGUmJmUmJmUubm9kZVR5cGU9PT0xMSYmZS5jaGlsZE5vZGVzLmxlbmd0aD09PXRoaXMubGVuZ3RoP3tmcmFnbWVudDplfTpjLmJ1aWxkRnJhZ21lbnQoYSx0aGlzLGspO2g9ZS5mcmFnbWVudDtpZihmPWguY2hpbGROb2Rlcy5sZW5ndGg9PT0xP2g9aC5maXJzdENoaWxkOmguZmlyc3RDaGlsZCl7Yj1iJiZjLm5vZGVOYW1lKGYsInRyIik7Zj0wO2Zvcih2YXIgbz10aGlzLmxlbmd0aDtmPG87ZisrKWQuY2FsbChiP2Mubm9kZU5hbWUodGhpc1tmXSwidGFibGUiKT90aGlzW2ZdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdfHx0aGlzW2ZdLmFwcGVuZENoaWxkKHRoaXNbZl0ub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0Ym9keSIpKToKdGhpc1tmXTp0aGlzW2ZdLGY+MHx8ZS5jYWNoZWFibGV8fHRoaXMubGVuZ3RoPjE/aC5jbG9uZU5vZGUodHJ1ZSk6aCl9ay5sZW5ndGgmJmMuZWFjaChrLE9hKX1yZXR1cm4gdGhpc319KTtjLmJ1aWxkRnJhZ21lbnQ9ZnVuY3Rpb24oYSxiLGQpe3ZhciBlLGYsaDtiPWImJmJbMF0/YlswXS5vd25lckRvY3VtZW50fHxiWzBdOnQ7aWYoYS5sZW5ndGg9PT0xJiZ0eXBlb2YgYVswXT09PSJzdHJpbmciJiZhWzBdLmxlbmd0aDw1MTImJmI9PT10JiYhQ2EudGVzdChhWzBdKSYmKGMuc3VwcG9ydC5jaGVja0Nsb25lfHwhRGEudGVzdChhWzBdKSkpe2Y9dHJ1ZTtpZihoPWMuZnJhZ21lbnRzW2FbMF1dKWlmKGghPT0xKWU9aH1pZighZSl7ZT1iLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtjLmNsZWFuKGEsYixlLGQpfWlmKGYpYy5mcmFnbWVudHNbYVswXV09aD9lOjE7cmV0dXJue2ZyYWdtZW50OmUsY2FjaGVhYmxlOmZ9fTtjLmZyYWdtZW50cz17fTtjLmVhY2goe2FwcGVuZFRvOiJhcHBlbmQiLApwcmVwZW5kVG86InByZXBlbmQiLGluc2VydEJlZm9yZToiYmVmb3JlIixpbnNlcnRBZnRlcjoiYWZ0ZXIiLHJlcGxhY2VBbGw6InJlcGxhY2VXaXRoIn0sZnVuY3Rpb24oYSxiKXtjLmZuW2FdPWZ1bmN0aW9uKGQpe3ZhciBlPVtdO2Q9YyhkKTt2YXIgZj10aGlzLmxlbmd0aD09PTEmJnRoaXNbMF0ucGFyZW50Tm9kZTtpZihmJiZmLm5vZGVUeXBlPT09MTEmJmYuY2hpbGROb2Rlcy5sZW5ndGg9PT0xJiZkLmxlbmd0aD09PTEpe2RbYl0odGhpc1swXSk7cmV0dXJuIHRoaXN9ZWxzZXtmPTA7Zm9yKHZhciBoPWQubGVuZ3RoO2Y8aDtmKyspe3ZhciBsPShmPjA/dGhpcy5jbG9uZSh0cnVlKTp0aGlzKS5nZXQoKTtjKGRbZl0pW2JdKGwpO2U9ZS5jb25jYXQobCl9cmV0dXJuIHRoaXMucHVzaFN0YWNrKGUsYSxkLnNlbGVjdG9yKX19fSk7Yy5leHRlbmQoe2NsZWFuOmZ1bmN0aW9uKGEsYixkLGUpe2I9Ynx8dDtpZih0eXBlb2YgYi5jcmVhdGVFbGVtZW50PT09InVuZGVmaW5lZCIpYj1iLm93bmVyRG9jdW1lbnR8fApiWzBdJiZiWzBdLm93bmVyRG9jdW1lbnR8fHQ7Zm9yKHZhciBmPVtdLGg9MCxsOyhsPWFbaF0pIT1udWxsO2grKyl7aWYodHlwZW9mIGw9PT0ibnVtYmVyIilsKz0iIjtpZihsKXtpZih0eXBlb2YgbD09PSJzdHJpbmciJiYhZWIudGVzdChsKSlsPWIuY3JlYXRlVGV4dE5vZGUobCk7ZWxzZSBpZih0eXBlb2YgbD09PSJzdHJpbmciKXtsPWwucmVwbGFjZShBYSwiPCQxPjwvJDI+Iik7dmFyIGs9KEJhLmV4ZWMobCl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCksbz1QW2tdfHxQLl9kZWZhdWx0LHg9b1swXSxyPWIuY3JlYXRlRWxlbWVudCgiZGl2Iik7Zm9yKHIuaW5uZXJIVE1MPW9bMV0rbCtvWzJdO3gtLTspcj1yLmxhc3RDaGlsZDtpZighYy5zdXBwb3J0LnRib2R5KXt4PWRiLnRlc3QobCk7az1rPT09InRhYmxlIiYmIXg/ci5maXJzdENoaWxkJiZyLmZpcnN0Q2hpbGQuY2hpbGROb2RlczpvWzFdPT09Ijx0YWJsZT4iJiYheD9yLmNoaWxkTm9kZXM6W107Zm9yKG89ay5sZW5ndGgtCjE7bz49MDstLW8pYy5ub2RlTmFtZShrW29dLCJ0Ym9keSIpJiYha1tvXS5jaGlsZE5vZGVzLmxlbmd0aCYma1tvXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGtbb10pfSFjLnN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2UmJiQudGVzdChsKSYmci5pbnNlcnRCZWZvcmUoYi5jcmVhdGVUZXh0Tm9kZSgkLmV4ZWMobClbMF0pLHIuZmlyc3RDaGlsZCk7bD1yLmNoaWxkTm9kZXN9aWYobC5ub2RlVHlwZSlmLnB1c2gobCk7ZWxzZSBmPWMubWVyZ2UoZixsKX19aWYoZClmb3IoaD0wO2ZbaF07aCsrKWlmKGUmJmMubm9kZU5hbWUoZltoXSwic2NyaXB0IikmJighZltoXS50eXBlfHxmW2hdLnR5cGUudG9Mb3dlckNhc2UoKT09PSJ0ZXh0L2phdmFzY3JpcHQiKSllLnB1c2goZltoXS5wYXJlbnROb2RlP2ZbaF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmW2hdKTpmW2hdKTtlbHNle2ZbaF0ubm9kZVR5cGU9PT0xJiZmLnNwbGljZS5hcHBseShmLFtoKzEsMF0uY29uY2F0KGMubWFrZUFycmF5KGZbaF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNjcmlwdCIpKSkpOwpkLmFwcGVuZENoaWxkKGZbaF0pfXJldHVybiBmfSxjbGVhbkRhdGE6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiLGQsZT1jLmNhY2hlLGY9Yy5ldmVudC5zcGVjaWFsLGg9Yy5zdXBwb3J0LmRlbGV0ZUV4cGFuZG8sbD0wLGs7KGs9YVtsXSkhPW51bGw7bCsrKWlmKCEoay5ub2RlTmFtZSYmYy5ub0RhdGFbay5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkpaWYoZD1rW2MuZXhwYW5kb10pe2lmKChiPWVbZF0pJiZiLmV2ZW50cylmb3IodmFyIG8gaW4gYi5ldmVudHMpZltvXT9jLmV2ZW50LnJlbW92ZShrLG8pOmMucmVtb3ZlRXZlbnQoayxvLGIuaGFuZGxlKTtpZihoKWRlbGV0ZSBrW2MuZXhwYW5kb107ZWxzZSBrLnJlbW92ZUF0dHJpYnV0ZSYmay5yZW1vdmVBdHRyaWJ1dGUoYy5leHBhbmRvKTtkZWxldGUgZVtkXX19fSk7dmFyIEVhPS9hbHBoYVwoW14pXSpcKS9pLGdiPS9vcGFjaXR5PShbXildKikvLGhiPS8tKFthLXpdKS9pZyxpYj0vKFtBLVpdKS9nLEZhPS9eLT9cZCsoPzpweCk/JC9pLApqYj0vXi0/XGQvLGtiPXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxQYT1bIkxlZnQiLCJSaWdodCJdLFFhPVsiVG9wIiwiQm90dG9tIl0sVyxHYSxhYSxsYj1mdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9O2MuZm4uY3NzPWZ1bmN0aW9uKGEsYil7aWYoYXJndW1lbnRzLmxlbmd0aD09PTImJmI9PT1CKXJldHVybiB0aGlzO3JldHVybiBjLmFjY2Vzcyh0aGlzLGEsYix0cnVlLGZ1bmN0aW9uKGQsZSxmKXtyZXR1cm4gZiE9PUI/Yy5zdHlsZShkLGUsZik6Yy5jc3MoZCxlKX0pfTtjLmV4dGVuZCh7Y3NzSG9va3M6e29wYWNpdHk6e2dldDpmdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBkPVcoYSwib3BhY2l0eSIsIm9wYWNpdHkiKTtyZXR1cm4gZD09PSIiPyIxIjpkfWVsc2UgcmV0dXJuIGEuc3R5bGUub3BhY2l0eX19fSxjc3NOdW1iZXI6e3pJbmRleDp0cnVlLGZvbnRXZWlnaHQ6dHJ1ZSxvcGFjaXR5OnRydWUsCnpvb206dHJ1ZSxsaW5lSGVpZ2h0OnRydWV9LGNzc1Byb3BzOnsiZmxvYXQiOmMuc3VwcG9ydC5jc3NGbG9hdD8iY3NzRmxvYXQiOiJzdHlsZUZsb2F0In0sc3R5bGU6ZnVuY3Rpb24oYSxiLGQsZSl7aWYoISghYXx8YS5ub2RlVHlwZT09PTN8fGEubm9kZVR5cGU9PT04fHwhYS5zdHlsZSkpe3ZhciBmLGg9Yy5jYW1lbENhc2UoYiksbD1hLnN0eWxlLGs9Yy5jc3NIb29rc1toXTtiPWMuY3NzUHJvcHNbaF18fGg7aWYoZCE9PUIpe2lmKCEodHlwZW9mIGQ9PT0ibnVtYmVyIiYmaXNOYU4oZCl8fGQ9PW51bGwpKXtpZih0eXBlb2YgZD09PSJudW1iZXIiJiYhYy5jc3NOdW1iZXJbaF0pZCs9InB4IjtpZigha3x8ISgic2V0ImluIGspfHwoZD1rLnNldChhLGQpKSE9PUIpdHJ5e2xbYl09ZH1jYXRjaChvKXt9fX1lbHNle2lmKGsmJiJnZXQiaW4gayYmKGY9ay5nZXQoYSxmYWxzZSxlKSkhPT1CKXJldHVybiBmO3JldHVybiBsW2JdfX19LGNzczpmdW5jdGlvbihhLGIsZCl7dmFyIGUsZj1jLmNhbWVsQ2FzZShiKSwKaD1jLmNzc0hvb2tzW2ZdO2I9Yy5jc3NQcm9wc1tmXXx8ZjtpZihoJiYiZ2V0ImluIGgmJihlPWguZ2V0KGEsdHJ1ZSxkKSkhPT1CKXJldHVybiBlO2Vsc2UgaWYoVylyZXR1cm4gVyhhLGIsZil9LHN3YXA6ZnVuY3Rpb24oYSxiLGQpe3ZhciBlPXt9LGY7Zm9yKGYgaW4gYil7ZVtmXT1hLnN0eWxlW2ZdO2Euc3R5bGVbZl09YltmXX1kLmNhbGwoYSk7Zm9yKGYgaW4gYilhLnN0eWxlW2ZdPWVbZl19LGNhbWVsQ2FzZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKGhiLGxiKX19KTtjLmN1ckNTUz1jLmNzcztjLmVhY2goWyJoZWlnaHQiLCJ3aWR0aCJdLGZ1bmN0aW9uKGEsYil7Yy5jc3NIb29rc1tiXT17Z2V0OmZ1bmN0aW9uKGQsZSxmKXt2YXIgaDtpZihlKXtpZihkLm9mZnNldFdpZHRoIT09MCloPW9hKGQsYixmKTtlbHNlIGMuc3dhcChkLGtiLGZ1bmN0aW9uKCl7aD1vYShkLGIsZil9KTtpZihoPD0wKXtoPVcoZCxiLGIpO2lmKGg9PT0iMHB4IiYmYWEpaD1hYShkLGIsYik7CmlmKGghPW51bGwpcmV0dXJuIGg9PT0iInx8aD09PSJhdXRvIj8iMHB4IjpofWlmKGg8MHx8aD09bnVsbCl7aD1kLnN0eWxlW2JdO3JldHVybiBoPT09IiJ8fGg9PT0iYXV0byI/IjBweCI6aH1yZXR1cm4gdHlwZW9mIGg9PT0ic3RyaW5nIj9oOmgrInB4In19LHNldDpmdW5jdGlvbihkLGUpe2lmKEZhLnRlc3QoZSkpe2U9cGFyc2VGbG9hdChlKTtpZihlPj0wKXJldHVybiBlKyJweCJ9ZWxzZSByZXR1cm4gZX19fSk7aWYoIWMuc3VwcG9ydC5vcGFjaXR5KWMuY3NzSG9va3Mub3BhY2l0eT17Z2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGdiLnRlc3QoKGImJmEuY3VycmVudFN0eWxlP2EuY3VycmVudFN0eWxlLmZpbHRlcjphLnN0eWxlLmZpbHRlcil8fCIiKT9wYXJzZUZsb2F0KFJlZ0V4cC4kMSkvMTAwKyIiOmI/IjEiOiIifSxzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgZD1hLnN0eWxlO2Quem9vbT0xO3ZhciBlPWMuaXNOYU4oYik/IiI6ImFscGhhKG9wYWNpdHk9IitiKjEwMCsiKSIsZj0KZC5maWx0ZXJ8fCIiO2QuZmlsdGVyPUVhLnRlc3QoZik/Zi5yZXBsYWNlKEVhLGUpOmQuZmlsdGVyKyIgIitlfX07aWYodC5kZWZhdWx0VmlldyYmdC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKUdhPWZ1bmN0aW9uKGEsYixkKXt2YXIgZTtkPWQucmVwbGFjZShpYiwiLSQxIikudG9Mb3dlckNhc2UoKTtpZighKGI9YS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KSlyZXR1cm4gQjtpZihiPWIuZ2V0Q29tcHV0ZWRTdHlsZShhLG51bGwpKXtlPWIuZ2V0UHJvcGVydHlWYWx1ZShkKTtpZihlPT09IiImJiFjLmNvbnRhaW5zKGEub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsYSkpZT1jLnN0eWxlKGEsZCl9cmV0dXJuIGV9O2lmKHQuZG9jdW1lbnRFbGVtZW50LmN1cnJlbnRTdHlsZSlhYT1mdW5jdGlvbihhLGIpe3ZhciBkLGUsZj1hLmN1cnJlbnRTdHlsZSYmYS5jdXJyZW50U3R5bGVbYl0saD1hLnN0eWxlO2lmKCFGYS50ZXN0KGYpJiZqYi50ZXN0KGYpKXtkPWgubGVmdDsKZT1hLnJ1bnRpbWVTdHlsZS5sZWZ0O2EucnVudGltZVN0eWxlLmxlZnQ9YS5jdXJyZW50U3R5bGUubGVmdDtoLmxlZnQ9Yj09PSJmb250U2l6ZSI/IjFlbSI6Znx8MDtmPWgucGl4ZWxMZWZ0KyJweCI7aC5sZWZ0PWQ7YS5ydW50aW1lU3R5bGUubGVmdD1lfXJldHVybiBmPT09IiI/ImF1dG8iOmZ9O1c9R2F8fGFhO2lmKGMuZXhwciYmYy5leHByLmZpbHRlcnMpe2MuZXhwci5maWx0ZXJzLmhpZGRlbj1mdW5jdGlvbihhKXt2YXIgYj1hLm9mZnNldEhlaWdodDtyZXR1cm4gYS5vZmZzZXRXaWR0aD09PTAmJmI9PT0wfHwhYy5zdXBwb3J0LnJlbGlhYmxlSGlkZGVuT2Zmc2V0cyYmKGEuc3R5bGUuZGlzcGxheXx8Yy5jc3MoYSwiZGlzcGxheSIpKT09PSJub25lIn07Yy5leHByLmZpbHRlcnMudmlzaWJsZT1mdW5jdGlvbihhKXtyZXR1cm4hYy5leHByLmZpbHRlcnMuaGlkZGVuKGEpfX12YXIgbWI9Yy5ub3coKSxuYj0vPHNjcmlwdFxiW148XSooPzooPyE8XC9zY3JpcHQ+KTxbXjxdKikqPFwvc2NyaXB0Pi9naSwKb2I9L14oPzpzZWxlY3R8dGV4dGFyZWEpL2kscGI9L14oPzpjb2xvcnxkYXRlfGRhdGV0aW1lfGVtYWlsfGhpZGRlbnxtb250aHxudW1iZXJ8cGFzc3dvcmR8cmFuZ2V8c2VhcmNofHRlbHx0ZXh0fHRpbWV8dXJsfHdlZWspJC9pLHFiPS9eKD86R0VUfEhFQUQpJC8sUmE9L1xbXF0kLyxUPS9cPVw/KCZ8JCkvLGphPS9cPy8scmI9LyhbPyZdKV89W14mXSovLHNiPS9eKFx3KzopP1wvXC8oW15cLz8jXSspLyx0Yj0vJTIwL2csdWI9LyMuKiQvLEhhPWMuZm4ubG9hZDtjLmZuLmV4dGVuZCh7bG9hZDpmdW5jdGlvbihhLGIsZCl7aWYodHlwZW9mIGEhPT0ic3RyaW5nIiYmSGEpcmV0dXJuIEhhLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtlbHNlIGlmKCF0aGlzLmxlbmd0aClyZXR1cm4gdGhpczt2YXIgZT1hLmluZGV4T2YoIiAiKTtpZihlPj0wKXt2YXIgZj1hLnNsaWNlKGUsYS5sZW5ndGgpO2E9YS5zbGljZSgwLGUpfWU9IkdFVCI7aWYoYilpZihjLmlzRnVuY3Rpb24oYikpe2Q9YjtiPW51bGx9ZWxzZSBpZih0eXBlb2YgYj09PQoib2JqZWN0Iil7Yj1jLnBhcmFtKGIsYy5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWwpO2U9IlBPU1QifXZhciBoPXRoaXM7Yy5hamF4KHt1cmw6YSx0eXBlOmUsZGF0YVR5cGU6Imh0bWwiLGRhdGE6Yixjb21wbGV0ZTpmdW5jdGlvbihsLGspe2lmKGs9PT0ic3VjY2VzcyJ8fGs9PT0ibm90bW9kaWZpZWQiKWguaHRtbChmP2MoIjxkaXY+IikuYXBwZW5kKGwucmVzcG9uc2VUZXh0LnJlcGxhY2UobmIsIiIpKS5maW5kKGYpOmwucmVzcG9uc2VUZXh0KTtkJiZoLmVhY2goZCxbbC5yZXNwb25zZVRleHQsayxsXSl9fSk7cmV0dXJuIHRoaXN9LHNlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiBjLnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudHM/Yy5tYWtlQXJyYXkodGhpcy5lbGVtZW50cyk6dGhpc30pLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWUmJgohdGhpcy5kaXNhYmxlZCYmKHRoaXMuY2hlY2tlZHx8b2IudGVzdCh0aGlzLm5vZGVOYW1lKXx8cGIudGVzdCh0aGlzLnR5cGUpKX0pLm1hcChmdW5jdGlvbihhLGIpe3ZhciBkPWModGhpcykudmFsKCk7cmV0dXJuIGQ9PW51bGw/bnVsbDpjLmlzQXJyYXkoZCk/Yy5tYXAoZCxmdW5jdGlvbihlKXtyZXR1cm57bmFtZTpiLm5hbWUsdmFsdWU6ZX19KTp7bmFtZTpiLm5hbWUsdmFsdWU6ZH19KS5nZXQoKX19KTtjLmVhY2goImFqYXhTdGFydCBhamF4U3RvcCBhamF4Q29tcGxldGUgYWpheEVycm9yIGFqYXhTdWNjZXNzIGFqYXhTZW5kIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGEsYil7Yy5mbltiXT1mdW5jdGlvbihkKXtyZXR1cm4gdGhpcy5iaW5kKGIsZCl9fSk7Yy5leHRlbmQoe2dldDpmdW5jdGlvbihhLGIsZCxlKXtpZihjLmlzRnVuY3Rpb24oYikpe2U9ZXx8ZDtkPWI7Yj1udWxsfXJldHVybiBjLmFqYXgoe3R5cGU6IkdFVCIsdXJsOmEsZGF0YTpiLHN1Y2Nlc3M6ZCxkYXRhVHlwZTplfSl9LApnZXRTY3JpcHQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYy5nZXQoYSxudWxsLGIsInNjcmlwdCIpfSxnZXRKU09OOmZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gYy5nZXQoYSxiLGQsImpzb24iKX0scG9zdDpmdW5jdGlvbihhLGIsZCxlKXtpZihjLmlzRnVuY3Rpb24oYikpe2U9ZXx8ZDtkPWI7Yj17fX1yZXR1cm4gYy5hamF4KHt0eXBlOiJQT1NUIix1cmw6YSxkYXRhOmIsc3VjY2VzczpkLGRhdGFUeXBlOmV9KX0sYWpheFNldHVwOmZ1bmN0aW9uKGEpe2MuZXh0ZW5kKGMuYWpheFNldHRpbmdzLGEpfSxhamF4U2V0dGluZ3M6e3VybDpsb2NhdGlvbi5ocmVmLGdsb2JhbDp0cnVlLHR5cGU6IkdFVCIsY29udGVudFR5cGU6ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIscHJvY2Vzc0RhdGE6dHJ1ZSxhc3luYzp0cnVlLHhocjpmdW5jdGlvbigpe3JldHVybiBuZXcgRS5YTUxIdHRwUmVxdWVzdH0sYWNjZXB0czp7eG1sOiJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIixodG1sOiJ0ZXh0L2h0bWwiLApzY3JpcHQ6InRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0Iix0ZXh0OiJ0ZXh0L3BsYWluIixfZGVmYXVsdDoiKi8qIn19LGFqYXg6ZnVuY3Rpb24oYSl7dmFyIGI9Yy5leHRlbmQodHJ1ZSx7fSxjLmFqYXhTZXR0aW5ncyxhKSxkLGUsZixoPWIudHlwZS50b1VwcGVyQ2FzZSgpLGw9cWIudGVzdChoKTtiLnVybD1iLnVybC5yZXBsYWNlKHViLCIiKTtiLmNvbnRleHQ9YSYmYS5jb250ZXh0IT1udWxsP2EuY29udGV4dDpiO2lmKGIuZGF0YSYmYi5wcm9jZXNzRGF0YSYmdHlwZW9mIGIuZGF0YSE9PSJzdHJpbmciKWIuZGF0YT1jLnBhcmFtKGIuZGF0YSxiLnRyYWRpdGlvbmFsKTtpZihiLmRhdGFUeXBlPT09Impzb25wIil7aWYoaD09PSJHRVQiKVQudGVzdChiLnVybCl8fChiLnVybCs9KGphLnRlc3QoYi51cmwpPyImIjoiPyIpKyhiLmpzb25wfHwiY2FsbGJhY2siKSsiPT8iKTtlbHNlIGlmKCFiLmRhdGF8fAohVC50ZXN0KGIuZGF0YSkpYi5kYXRhPShiLmRhdGE/Yi5kYXRhKyImIjoiIikrKGIuanNvbnB8fCJjYWxsYmFjayIpKyI9PyI7Yi5kYXRhVHlwZT0ianNvbiJ9aWYoYi5kYXRhVHlwZT09PSJqc29uIiYmKGIuZGF0YSYmVC50ZXN0KGIuZGF0YSl8fFQudGVzdChiLnVybCkpKXtkPWIuanNvbnBDYWxsYmFja3x8Impzb25wIittYisrO2lmKGIuZGF0YSliLmRhdGE9KGIuZGF0YSsiIikucmVwbGFjZShULCI9IitkKyIkMSIpO2IudXJsPWIudXJsLnJlcGxhY2UoVCwiPSIrZCsiJDEiKTtiLmRhdGFUeXBlPSJzY3JpcHQiO3ZhciBrPUVbZF07RVtkXT1mdW5jdGlvbihtKXtpZihjLmlzRnVuY3Rpb24oaykpayhtKTtlbHNle0VbZF09Qjt0cnl7ZGVsZXRlIEVbZF19Y2F0Y2gocCl7fX1mPW07Yy5oYW5kbGVTdWNjZXNzKGIsdyxlLGYpO2MuaGFuZGxlQ29tcGxldGUoYix3LGUsZik7ciYmci5yZW1vdmVDaGlsZChBKX19aWYoYi5kYXRhVHlwZT09PSJzY3JpcHQiJiZiLmNhY2hlPT09bnVsbCliLmNhY2hlPQpmYWxzZTtpZihiLmNhY2hlPT09ZmFsc2UmJmwpe3ZhciBvPWMubm93KCkseD1iLnVybC5yZXBsYWNlKHJiLCIkMV89IitvKTtiLnVybD14Kyh4PT09Yi51cmw/KGphLnRlc3QoYi51cmwpPyImIjoiPyIpKyJfPSIrbzoiIil9aWYoYi5kYXRhJiZsKWIudXJsKz0oamEudGVzdChiLnVybCk/IiYiOiI/IikrYi5kYXRhO2IuZ2xvYmFsJiZjLmFjdGl2ZSsrPT09MCYmYy5ldmVudC50cmlnZ2VyKCJhamF4U3RhcnQiKTtvPShvPXNiLmV4ZWMoYi51cmwpKSYmKG9bMV0mJm9bMV0udG9Mb3dlckNhc2UoKSE9PWxvY2F0aW9uLnByb3RvY29sfHxvWzJdLnRvTG93ZXJDYXNlKCkhPT1sb2NhdGlvbi5ob3N0KTtpZihiLmRhdGFUeXBlPT09InNjcmlwdCImJmg9PT0iR0VUIiYmbyl7dmFyIHI9dC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdfHx0LmRvY3VtZW50RWxlbWVudCxBPXQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7aWYoYi5zY3JpcHRDaGFyc2V0KUEuY2hhcnNldD1iLnNjcmlwdENoYXJzZXQ7CkEuc3JjPWIudXJsO2lmKCFkKXt2YXIgQz1mYWxzZTtBLm9ubG9hZD1BLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2lmKCFDJiYoIXRoaXMucmVhZHlTdGF0ZXx8dGhpcy5yZWFkeVN0YXRlPT09ImxvYWRlZCJ8fHRoaXMucmVhZHlTdGF0ZT09PSJjb21wbGV0ZSIpKXtDPXRydWU7Yy5oYW5kbGVTdWNjZXNzKGIsdyxlLGYpO2MuaGFuZGxlQ29tcGxldGUoYix3LGUsZik7QS5vbmxvYWQ9QS5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDtyJiZBLnBhcmVudE5vZGUmJnIucmVtb3ZlQ2hpbGQoQSl9fX1yLmluc2VydEJlZm9yZShBLHIuZmlyc3RDaGlsZCk7cmV0dXJuIEJ9dmFyIEo9ZmFsc2Usdz1iLnhocigpO2lmKHcpe2IudXNlcm5hbWU/dy5vcGVuKGgsYi51cmwsYi5hc3luYyxiLnVzZXJuYW1lLGIucGFzc3dvcmQpOncub3BlbihoLGIudXJsLGIuYXN5bmMpO3RyeXtpZihiLmRhdGEhPW51bGwmJiFsfHxhJiZhLmNvbnRlbnRUeXBlKXcuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwKYi5jb250ZW50VHlwZSk7aWYoYi5pZk1vZGlmaWVkKXtjLmxhc3RNb2RpZmllZFtiLnVybF0mJncuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLGMubGFzdE1vZGlmaWVkW2IudXJsXSk7Yy5ldGFnW2IudXJsXSYmdy5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Ob25lLU1hdGNoIixjLmV0YWdbYi51cmxdKX1vfHx3LnNldFJlcXVlc3RIZWFkZXIoIlgtUmVxdWVzdGVkLVdpdGgiLCJYTUxIdHRwUmVxdWVzdCIpO3cuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixiLmRhdGFUeXBlJiZiLmFjY2VwdHNbYi5kYXRhVHlwZV0/Yi5hY2NlcHRzW2IuZGF0YVR5cGVdKyIsICovKjsgcT0wLjAxIjpiLmFjY2VwdHMuX2RlZmF1bHQpfWNhdGNoKEkpe31pZihiLmJlZm9yZVNlbmQmJmIuYmVmb3JlU2VuZC5jYWxsKGIuY29udGV4dCx3LGIpPT09ZmFsc2Upe2IuZ2xvYmFsJiZjLmFjdGl2ZS0tPT09MSYmYy5ldmVudC50cmlnZ2VyKCJhamF4U3RvcCIpO3cuYWJvcnQoKTtyZXR1cm4gZmFsc2V9Yi5nbG9iYWwmJgpjLnRyaWdnZXJHbG9iYWwoYiwiYWpheFNlbmQiLFt3LGJdKTt2YXIgTD13Lm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbihtKXtpZighd3x8dy5yZWFkeVN0YXRlPT09MHx8bT09PSJhYm9ydCIpe0p8fGMuaGFuZGxlQ29tcGxldGUoYix3LGUsZik7Sj10cnVlO2lmKHcpdy5vbnJlYWR5c3RhdGVjaGFuZ2U9Yy5ub29wfWVsc2UgaWYoIUomJncmJih3LnJlYWR5U3RhdGU9PT00fHxtPT09InRpbWVvdXQiKSl7Sj10cnVlO3cub25yZWFkeXN0YXRlY2hhbmdlPWMubm9vcDtlPW09PT0idGltZW91dCI/InRpbWVvdXQiOiFjLmh0dHBTdWNjZXNzKHcpPyJlcnJvciI6Yi5pZk1vZGlmaWVkJiZjLmh0dHBOb3RNb2RpZmllZCh3LGIudXJsKT8ibm90bW9kaWZpZWQiOiJzdWNjZXNzIjt2YXIgcDtpZihlPT09InN1Y2Nlc3MiKXRyeXtmPWMuaHR0cERhdGEodyxiLmRhdGFUeXBlLGIpfWNhdGNoKHEpe2U9InBhcnNlcmVycm9yIjtwPXF9aWYoZT09PSJzdWNjZXNzInx8ZT09PSJub3Rtb2RpZmllZCIpZHx8CmMuaGFuZGxlU3VjY2VzcyhiLHcsZSxmKTtlbHNlIGMuaGFuZGxlRXJyb3IoYix3LGUscCk7ZHx8Yy5oYW5kbGVDb21wbGV0ZShiLHcsZSxmKTttPT09InRpbWVvdXQiJiZ3LmFib3J0KCk7aWYoYi5hc3luYyl3PW51bGx9fTt0cnl7dmFyIGc9dy5hYm9ydDt3LmFib3J0PWZ1bmN0aW9uKCl7dyYmRnVuY3Rpb24ucHJvdG90eXBlLmNhbGwuY2FsbChnLHcpO0woImFib3J0Iil9fWNhdGNoKGkpe31iLmFzeW5jJiZiLnRpbWVvdXQ+MCYmc2V0VGltZW91dChmdW5jdGlvbigpe3cmJiFKJiZMKCJ0aW1lb3V0Iil9LGIudGltZW91dCk7dHJ5e3cuc2VuZChsfHxiLmRhdGE9PW51bGw/bnVsbDpiLmRhdGEpfWNhdGNoKG4pe2MuaGFuZGxlRXJyb3IoYix3LG51bGwsbik7Yy5oYW5kbGVDb21wbGV0ZShiLHcsZSxmKX1iLmFzeW5jfHxMKCk7cmV0dXJuIHd9fSxwYXJhbTpmdW5jdGlvbihhLGIpe3ZhciBkPVtdLGU9ZnVuY3Rpb24oaCxsKXtsPWMuaXNGdW5jdGlvbihsKT9sKCk6bDtkW2QubGVuZ3RoXT0KZW5jb2RlVVJJQ29tcG9uZW50KGgpKyI9IitlbmNvZGVVUklDb21wb25lbnQobCl9O2lmKGI9PT1CKWI9Yy5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7aWYoYy5pc0FycmF5KGEpfHxhLmpxdWVyeSljLmVhY2goYSxmdW5jdGlvbigpe2UodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IodmFyIGYgaW4gYSlkYShmLGFbZl0sYixlKTtyZXR1cm4gZC5qb2luKCImIikucmVwbGFjZSh0YiwiKyIpfX0pO2MuZXh0ZW5kKHthY3RpdmU6MCxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fSxoYW5kbGVFcnJvcjpmdW5jdGlvbihhLGIsZCxlKXthLmVycm9yJiZhLmVycm9yLmNhbGwoYS5jb250ZXh0LGIsZCxlKTthLmdsb2JhbCYmYy50cmlnZ2VyR2xvYmFsKGEsImFqYXhFcnJvciIsW2IsYSxlXSl9LGhhbmRsZVN1Y2Nlc3M6ZnVuY3Rpb24oYSxiLGQsZSl7YS5zdWNjZXNzJiZhLnN1Y2Nlc3MuY2FsbChhLmNvbnRleHQsZSxkLGIpO2EuZ2xvYmFsJiZjLnRyaWdnZXJHbG9iYWwoYSwiYWpheFN1Y2Nlc3MiLApbYixhXSl9LGhhbmRsZUNvbXBsZXRlOmZ1bmN0aW9uKGEsYixkKXthLmNvbXBsZXRlJiZhLmNvbXBsZXRlLmNhbGwoYS5jb250ZXh0LGIsZCk7YS5nbG9iYWwmJmMudHJpZ2dlckdsb2JhbChhLCJhamF4Q29tcGxldGUiLFtiLGFdKTthLmdsb2JhbCYmYy5hY3RpdmUtLT09PTEmJmMuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKX0sdHJpZ2dlckdsb2JhbDpmdW5jdGlvbihhLGIsZCl7KGEuY29udGV4dCYmYS5jb250ZXh0LnVybD09bnVsbD9jKGEuY29udGV4dCk6Yy5ldmVudCkudHJpZ2dlcihiLGQpfSxodHRwU3VjY2VzczpmdW5jdGlvbihhKXt0cnl7cmV0dXJuIWEuc3RhdHVzJiZsb2NhdGlvbi5wcm90b2NvbD09PSJmaWxlOiJ8fGEuc3RhdHVzPj0yMDAmJmEuc3RhdHVzPDMwMHx8YS5zdGF0dXM9PT0zMDR8fGEuc3RhdHVzPT09MTIyM31jYXRjaChiKXt9cmV0dXJuIGZhbHNlfSxodHRwTm90TW9kaWZpZWQ6ZnVuY3Rpb24oYSxiKXt2YXIgZD1hLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIiksCmU9YS5nZXRSZXNwb25zZUhlYWRlcigiRXRhZyIpO2lmKGQpYy5sYXN0TW9kaWZpZWRbYl09ZDtpZihlKWMuZXRhZ1tiXT1lO3JldHVybiBhLnN0YXR1cz09PTMwNH0saHR0cERhdGE6ZnVuY3Rpb24oYSxiLGQpe3ZhciBlPWEuZ2V0UmVzcG9uc2VIZWFkZXIoImNvbnRlbnQtdHlwZSIpfHwiIixmPWI9PT0ieG1sInx8IWImJmUuaW5kZXhPZigieG1sIik+PTA7YT1mP2EucmVzcG9uc2VYTUw6YS5yZXNwb25zZVRleHQ7ZiYmYS5kb2N1bWVudEVsZW1lbnQubm9kZU5hbWU9PT0icGFyc2VyZXJyb3IiJiZjLmVycm9yKCJwYXJzZXJlcnJvciIpO2lmKGQmJmQuZGF0YUZpbHRlcilhPWQuZGF0YUZpbHRlcihhLGIpO2lmKHR5cGVvZiBhPT09InN0cmluZyIpaWYoYj09PSJqc29uInx8IWImJmUuaW5kZXhPZigianNvbiIpPj0wKWE9Yy5wYXJzZUpTT04oYSk7ZWxzZSBpZihiPT09InNjcmlwdCJ8fCFiJiZlLmluZGV4T2YoImphdmFzY3JpcHQiKT49MCljLmdsb2JhbEV2YWwoYSk7cmV0dXJuIGF9fSk7CmlmKEUuQWN0aXZlWE9iamVjdCljLmFqYXhTZXR0aW5ncy54aHI9ZnVuY3Rpb24oKXtpZihFLmxvY2F0aW9uLnByb3RvY29sIT09ImZpbGU6Iil0cnl7cmV0dXJuIG5ldyBFLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGEpe310cnl7cmV0dXJuIG5ldyBFLkFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIil9Y2F0Y2goYil7fX07Yy5zdXBwb3J0LmFqYXg9ISFjLmFqYXhTZXR0aW5ncy54aHIoKTt2YXIgZWE9e30sdmI9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLHdiPS9eKFsrXC1dPSk/KFtcZCsuXC1dKykoLiopJC8sYmEscGE9W1siaGVpZ2h0IiwibWFyZ2luVG9wIiwibWFyZ2luQm90dG9tIiwicGFkZGluZ1RvcCIsInBhZGRpbmdCb3R0b20iXSxbIndpZHRoIiwibWFyZ2luTGVmdCIsIm1hcmdpblJpZ2h0IiwicGFkZGluZ0xlZnQiLCJwYWRkaW5nUmlnaHQiXSxbIm9wYWNpdHkiXV07Yy5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oYSxiLGQpe2lmKGF8fGE9PT0wKXJldHVybiB0aGlzLmFuaW1hdGUoUygic2hvdyIsCjMpLGEsYixkKTtlbHNle2Q9MDtmb3IodmFyIGU9dGhpcy5sZW5ndGg7ZDxlO2QrKyl7YT10aGlzW2RdO2I9YS5zdHlsZS5kaXNwbGF5O2lmKCFjLmRhdGEoYSwib2xkZGlzcGxheSIpJiZiPT09Im5vbmUiKWI9YS5zdHlsZS5kaXNwbGF5PSIiO2I9PT0iIiYmYy5jc3MoYSwiZGlzcGxheSIpPT09Im5vbmUiJiZjLmRhdGEoYSwib2xkZGlzcGxheSIscWEoYS5ub2RlTmFtZSkpfWZvcihkPTA7ZDxlO2QrKyl7YT10aGlzW2RdO2I9YS5zdHlsZS5kaXNwbGF5O2lmKGI9PT0iInx8Yj09PSJub25lIilhLnN0eWxlLmRpc3BsYXk9Yy5kYXRhKGEsIm9sZGRpc3BsYXkiKXx8IiJ9cmV0dXJuIHRoaXN9fSxoaWRlOmZ1bmN0aW9uKGEsYixkKXtpZihhfHxhPT09MClyZXR1cm4gdGhpcy5hbmltYXRlKFMoImhpZGUiLDMpLGEsYixkKTtlbHNle2E9MDtmb3IoYj10aGlzLmxlbmd0aDthPGI7YSsrKXtkPWMuY3NzKHRoaXNbYV0sImRpc3BsYXkiKTtkIT09Im5vbmUiJiZjLmRhdGEodGhpc1thXSwib2xkZGlzcGxheSIsCmQpfWZvcihhPTA7YTxiO2ErKyl0aGlzW2FdLnN0eWxlLmRpc3BsYXk9Im5vbmUiO3JldHVybiB0aGlzfX0sX3RvZ2dsZTpjLmZuLnRvZ2dsZSx0b2dnbGU6ZnVuY3Rpb24oYSxiLGQpe3ZhciBlPXR5cGVvZiBhPT09ImJvb2xlYW4iO2lmKGMuaXNGdW5jdGlvbihhKSYmYy5pc0Z1bmN0aW9uKGIpKXRoaXMuX3RvZ2dsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7ZWxzZSBhPT1udWxsfHxlP3RoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBmPWU/YTpjKHRoaXMpLmlzKCI6aGlkZGVuIik7Yyh0aGlzKVtmPyJzaG93IjoiaGlkZSJdKCl9KTp0aGlzLmFuaW1hdGUoUygidG9nZ2xlIiwzKSxhLGIsZCk7cmV0dXJuIHRoaXN9LGZhZGVUbzpmdW5jdGlvbihhLGIsZCxlKXtyZXR1cm4gdGhpcy5maWx0ZXIoIjpoaWRkZW4iKS5jc3MoIm9wYWNpdHkiLDApLnNob3coKS5lbmQoKS5hbmltYXRlKHtvcGFjaXR5OmJ9LGEsZCxlKX0sYW5pbWF0ZTpmdW5jdGlvbihhLGIsZCxlKXt2YXIgZj1jLnNwZWVkKGIsCmQsZSk7aWYoYy5pc0VtcHR5T2JqZWN0KGEpKXJldHVybiB0aGlzLmVhY2goZi5jb21wbGV0ZSk7cmV0dXJuIHRoaXNbZi5xdWV1ZT09PWZhbHNlPyJlYWNoIjoicXVldWUiXShmdW5jdGlvbigpe3ZhciBoPWMuZXh0ZW5kKHt9LGYpLGwsaz10aGlzLm5vZGVUeXBlPT09MSxvPWsmJmModGhpcykuaXMoIjpoaWRkZW4iKSx4PXRoaXM7Zm9yKGwgaW4gYSl7dmFyIHI9Yy5jYW1lbENhc2UobCk7aWYobCE9PXIpe2Fbcl09YVtsXTtkZWxldGUgYVtsXTtsPXJ9aWYoYVtsXT09PSJoaWRlIiYmb3x8YVtsXT09PSJzaG93IiYmIW8pcmV0dXJuIGguY29tcGxldGUuY2FsbCh0aGlzKTtpZihrJiYobD09PSJoZWlnaHQifHxsPT09IndpZHRoIikpe2gub3ZlcmZsb3c9W3RoaXMuc3R5bGUub3ZlcmZsb3csdGhpcy5zdHlsZS5vdmVyZmxvd1gsdGhpcy5zdHlsZS5vdmVyZmxvd1ldO2lmKGMuY3NzKHRoaXMsImRpc3BsYXkiKT09PSJpbmxpbmUiJiZjLmNzcyh0aGlzLCJmbG9hdCIpPT09Im5vbmUiKWlmKGMuc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0KWlmKHFhKHRoaXMubm9kZU5hbWUpPT09CiJpbmxpbmUiKXRoaXMuc3R5bGUuZGlzcGxheT0iaW5saW5lLWJsb2NrIjtlbHNle3RoaXMuc3R5bGUuZGlzcGxheT0iaW5saW5lIjt0aGlzLnN0eWxlLnpvb209MX1lbHNlIHRoaXMuc3R5bGUuZGlzcGxheT0iaW5saW5lLWJsb2NrIn1pZihjLmlzQXJyYXkoYVtsXSkpeyhoLnNwZWNpYWxFYXNpbmc9aC5zcGVjaWFsRWFzaW5nfHx7fSlbbF09YVtsXVsxXTthW2xdPWFbbF1bMF19fWlmKGgub3ZlcmZsb3chPW51bGwpdGhpcy5zdHlsZS5vdmVyZmxvdz0iaGlkZGVuIjtoLmN1ckFuaW09Yy5leHRlbmQoe30sYSk7Yy5lYWNoKGEsZnVuY3Rpb24oQSxDKXt2YXIgSj1uZXcgYy5meCh4LGgsQSk7aWYodmIudGVzdChDKSlKW0M9PT0idG9nZ2xlIj9vPyJzaG93IjoiaGlkZSI6Q10oYSk7ZWxzZXt2YXIgdz13Yi5leGVjKEMpLEk9Si5jdXIoKXx8MDtpZih3KXt2YXIgTD1wYXJzZUZsb2F0KHdbMl0pLGc9d1szXXx8InB4IjtpZihnIT09InB4Iil7Yy5zdHlsZSh4LEEsKEx8fDEpK2cpO0k9KEx8fAoxKS9KLmN1cigpKkk7Yy5zdHlsZSh4LEEsSStnKX1pZih3WzFdKUw9KHdbMV09PT0iLT0iPy0xOjEpKkwrSTtKLmN1c3RvbShJLEwsZyl9ZWxzZSBKLmN1c3RvbShJLEMsIiIpfX0pO3JldHVybiB0cnVlfSl9LHN0b3A6ZnVuY3Rpb24oYSxiKXt2YXIgZD1jLnRpbWVyczthJiZ0aGlzLnF1ZXVlKFtdKTt0aGlzLmVhY2goZnVuY3Rpb24oKXtmb3IodmFyIGU9ZC5sZW5ndGgtMTtlPj0wO2UtLSlpZihkW2VdLmVsZW09PT10aGlzKXtiJiZkW2VdKHRydWUpO2Quc3BsaWNlKGUsMSl9fSk7Ynx8dGhpcy5kZXF1ZXVlKCk7cmV0dXJuIHRoaXN9fSk7Yy5lYWNoKHtzbGlkZURvd246Uygic2hvdyIsMSksc2xpZGVVcDpTKCJoaWRlIiwxKSxzbGlkZVRvZ2dsZTpTKCJ0b2dnbGUiLDEpLGZhZGVJbjp7b3BhY2l0eToic2hvdyJ9LGZhZGVPdXQ6e29wYWNpdHk6ImhpZGUifSxmYWRlVG9nZ2xlOntvcGFjaXR5OiJ0b2dnbGUifX0sZnVuY3Rpb24oYSxiKXtjLmZuW2FdPWZ1bmN0aW9uKGQsZSxmKXtyZXR1cm4gdGhpcy5hbmltYXRlKGIsCmQsZSxmKX19KTtjLmV4dGVuZCh7c3BlZWQ6ZnVuY3Rpb24oYSxiLGQpe3ZhciBlPWEmJnR5cGVvZiBhPT09Im9iamVjdCI/Yy5leHRlbmQoe30sYSk6e2NvbXBsZXRlOmR8fCFkJiZifHxjLmlzRnVuY3Rpb24oYSkmJmEsZHVyYXRpb246YSxlYXNpbmc6ZCYmYnx8YiYmIWMuaXNGdW5jdGlvbihiKSYmYn07ZS5kdXJhdGlvbj1jLmZ4Lm9mZj8wOnR5cGVvZiBlLmR1cmF0aW9uPT09Im51bWJlciI/ZS5kdXJhdGlvbjplLmR1cmF0aW9uIGluIGMuZnguc3BlZWRzP2MuZnguc3BlZWRzW2UuZHVyYXRpb25dOmMuZnguc3BlZWRzLl9kZWZhdWx0O2Uub2xkPWUuY29tcGxldGU7ZS5jb21wbGV0ZT1mdW5jdGlvbigpe2UucXVldWUhPT1mYWxzZSYmYyh0aGlzKS5kZXF1ZXVlKCk7Yy5pc0Z1bmN0aW9uKGUub2xkKSYmZS5vbGQuY2FsbCh0aGlzKX07cmV0dXJuIGV9LGVhc2luZzp7bGluZWFyOmZ1bmN0aW9uKGEsYixkLGUpe3JldHVybiBkK2UqYX0sc3dpbmc6ZnVuY3Rpb24oYSxiLGQsZSl7cmV0dXJuKC1NYXRoLmNvcyhhKgpNYXRoLlBJKS8yKzAuNSkqZStkfX0sdGltZXJzOltdLGZ4OmZ1bmN0aW9uKGEsYixkKXt0aGlzLm9wdGlvbnM9Yjt0aGlzLmVsZW09YTt0aGlzLnByb3A9ZDtpZighYi5vcmlnKWIub3JpZz17fX19KTtjLmZ4LnByb3RvdHlwZT17dXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpOyhjLmZ4LnN0ZXBbdGhpcy5wcm9wXXx8Yy5meC5zdGVwLl9kZWZhdWx0KSh0aGlzKX0sY3VyOmZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtW3RoaXMucHJvcF0hPW51bGwmJighdGhpcy5lbGVtLnN0eWxlfHx0aGlzLmVsZW0uc3R5bGVbdGhpcy5wcm9wXT09bnVsbCkpcmV0dXJuIHRoaXMuZWxlbVt0aGlzLnByb3BdO3ZhciBhPXBhcnNlRmxvYXQoYy5jc3ModGhpcy5lbGVtLHRoaXMucHJvcCkpO3JldHVybiBhJiZhPi0xRTQ/YTowfSxjdXN0b206ZnVuY3Rpb24oYSxiLGQpe2Z1bmN0aW9uIGUobCl7cmV0dXJuIGYuc3RlcChsKX0KdmFyIGY9dGhpcyxoPWMuZng7dGhpcy5zdGFydFRpbWU9Yy5ub3coKTt0aGlzLnN0YXJ0PWE7dGhpcy5lbmQ9Yjt0aGlzLnVuaXQ9ZHx8dGhpcy51bml0fHwicHgiO3RoaXMubm93PXRoaXMuc3RhcnQ7dGhpcy5wb3M9dGhpcy5zdGF0ZT0wO2UuZWxlbT10aGlzLmVsZW07aWYoZSgpJiZjLnRpbWVycy5wdXNoKGUpJiYhYmEpYmE9c2V0SW50ZXJ2YWwoaC50aWNrLGguaW50ZXJ2YWwpfSxzaG93OmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLm9yaWdbdGhpcy5wcm9wXT1jLnN0eWxlKHRoaXMuZWxlbSx0aGlzLnByb3ApO3RoaXMub3B0aW9ucy5zaG93PXRydWU7dGhpcy5jdXN0b20odGhpcy5wcm9wPT09IndpZHRoInx8dGhpcy5wcm9wPT09ImhlaWdodCI/MTowLHRoaXMuY3VyKCkpO2ModGhpcy5lbGVtKS5zaG93KCl9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMub3JpZ1t0aGlzLnByb3BdPWMuc3R5bGUodGhpcy5lbGVtLHRoaXMucHJvcCk7dGhpcy5vcHRpb25zLmhpZGU9dHJ1ZTsKdGhpcy5jdXN0b20odGhpcy5jdXIoKSwwKX0sc3RlcDpmdW5jdGlvbihhKXt2YXIgYj1jLm5vdygpLGQ9dHJ1ZTtpZihhfHxiPj10aGlzLm9wdGlvbnMuZHVyYXRpb24rdGhpcy5zdGFydFRpbWUpe3RoaXMubm93PXRoaXMuZW5kO3RoaXMucG9zPXRoaXMuc3RhdGU9MTt0aGlzLnVwZGF0ZSgpO3RoaXMub3B0aW9ucy5jdXJBbmltW3RoaXMucHJvcF09dHJ1ZTtmb3IodmFyIGUgaW4gdGhpcy5vcHRpb25zLmN1ckFuaW0paWYodGhpcy5vcHRpb25zLmN1ckFuaW1bZV0hPT10cnVlKWQ9ZmFsc2U7aWYoZCl7aWYodGhpcy5vcHRpb25zLm92ZXJmbG93IT1udWxsJiYhYy5zdXBwb3J0LnNocmlua1dyYXBCbG9ja3Mpe3ZhciBmPXRoaXMuZWxlbSxoPXRoaXMub3B0aW9ucztjLmVhY2goWyIiLCJYIiwiWSJdLGZ1bmN0aW9uKGssbyl7Zi5zdHlsZVsib3ZlcmZsb3ciK29dPWgub3ZlcmZsb3dba119KX10aGlzLm9wdGlvbnMuaGlkZSYmYyh0aGlzLmVsZW0pLmhpZGUoKTtpZih0aGlzLm9wdGlvbnMuaGlkZXx8CnRoaXMub3B0aW9ucy5zaG93KWZvcih2YXIgbCBpbiB0aGlzLm9wdGlvbnMuY3VyQW5pbSljLnN0eWxlKHRoaXMuZWxlbSxsLHRoaXMub3B0aW9ucy5vcmlnW2xdKTt0aGlzLm9wdGlvbnMuY29tcGxldGUuY2FsbCh0aGlzLmVsZW0pfXJldHVybiBmYWxzZX1lbHNle2E9Yi10aGlzLnN0YXJ0VGltZTt0aGlzLnN0YXRlPWEvdGhpcy5vcHRpb25zLmR1cmF0aW9uO2I9dGhpcy5vcHRpb25zLmVhc2luZ3x8KGMuZWFzaW5nLnN3aW5nPyJzd2luZyI6ImxpbmVhciIpO3RoaXMucG9zPWMuZWFzaW5nW3RoaXMub3B0aW9ucy5zcGVjaWFsRWFzaW5nJiZ0aGlzLm9wdGlvbnMuc3BlY2lhbEVhc2luZ1t0aGlzLnByb3BdfHxiXSh0aGlzLnN0YXRlLGEsMCwxLHRoaXMub3B0aW9ucy5kdXJhdGlvbik7dGhpcy5ub3c9dGhpcy5zdGFydCsodGhpcy5lbmQtdGhpcy5zdGFydCkqdGhpcy5wb3M7dGhpcy51cGRhdGUoKX1yZXR1cm4gdHJ1ZX19O2MuZXh0ZW5kKGMuZngse3RpY2s6ZnVuY3Rpb24oKXtmb3IodmFyIGE9CmMudGltZXJzLGI9MDtiPGEubGVuZ3RoO2IrKylhW2JdKCl8fGEuc3BsaWNlKGItLSwxKTthLmxlbmd0aHx8Yy5meC5zdG9wKCl9LGludGVydmFsOjEzLHN0b3A6ZnVuY3Rpb24oKXtjbGVhckludGVydmFsKGJhKTtiYT1udWxsfSxzcGVlZHM6e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH0sc3RlcDp7b3BhY2l0eTpmdW5jdGlvbihhKXtjLnN0eWxlKGEuZWxlbSwib3BhY2l0eSIsYS5ub3cpfSxfZGVmYXVsdDpmdW5jdGlvbihhKXtpZihhLmVsZW0uc3R5bGUmJmEuZWxlbS5zdHlsZVthLnByb3BdIT1udWxsKWEuZWxlbS5zdHlsZVthLnByb3BdPShhLnByb3A9PT0id2lkdGgifHxhLnByb3A9PT0iaGVpZ2h0Ij9NYXRoLm1heCgwLGEubm93KTphLm5vdykrYS51bml0O2Vsc2UgYS5lbGVtW2EucHJvcF09YS5ub3d9fX0pO2lmKGMuZXhwciYmYy5leHByLmZpbHRlcnMpYy5leHByLmZpbHRlcnMuYW5pbWF0ZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIGMuZ3JlcChjLnRpbWVycyxmdW5jdGlvbihiKXtyZXR1cm4gYT09PQpiLmVsZW19KS5sZW5ndGh9O3ZhciB4Yj0vXnQoPzphYmxlfGR8aCkkL2ksSWE9L14oPzpib2R5fGh0bWwpJC9pO2MuZm4ub2Zmc2V0PSJnZXRCb3VuZGluZ0NsaWVudFJlY3QiaW4gdC5kb2N1bWVudEVsZW1lbnQ/ZnVuY3Rpb24oYSl7dmFyIGI9dGhpc1swXSxkO2lmKGEpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihsKXtjLm9mZnNldC5zZXRPZmZzZXQodGhpcyxhLGwpfSk7aWYoIWJ8fCFiLm93bmVyRG9jdW1lbnQpcmV0dXJuIG51bGw7aWYoYj09PWIub3duZXJEb2N1bWVudC5ib2R5KXJldHVybiBjLm9mZnNldC5ib2R5T2Zmc2V0KGIpO3RyeXtkPWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCl9Y2F0Y2goZSl7fXZhciBmPWIub3duZXJEb2N1bWVudCxoPWYuZG9jdW1lbnRFbGVtZW50O2lmKCFkfHwhYy5jb250YWlucyhoLGIpKXJldHVybiBkfHx7dG9wOjAsbGVmdDowfTtiPWYuYm9keTtmPWZhKGYpO3JldHVybnt0b3A6ZC50b3ArKGYucGFnZVlPZmZzZXR8fGMuc3VwcG9ydC5ib3hNb2RlbCYmCmguc2Nyb2xsVG9wfHxiLnNjcm9sbFRvcCktKGguY2xpZW50VG9wfHxiLmNsaWVudFRvcHx8MCksbGVmdDpkLmxlZnQrKGYucGFnZVhPZmZzZXR8fGMuc3VwcG9ydC5ib3hNb2RlbCYmaC5zY3JvbGxMZWZ0fHxiLnNjcm9sbExlZnQpLShoLmNsaWVudExlZnR8fGIuY2xpZW50TGVmdHx8MCl9fTpmdW5jdGlvbihhKXt2YXIgYj10aGlzWzBdO2lmKGEpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbih4KXtjLm9mZnNldC5zZXRPZmZzZXQodGhpcyxhLHgpfSk7aWYoIWJ8fCFiLm93bmVyRG9jdW1lbnQpcmV0dXJuIG51bGw7aWYoYj09PWIub3duZXJEb2N1bWVudC5ib2R5KXJldHVybiBjLm9mZnNldC5ib2R5T2Zmc2V0KGIpO2Mub2Zmc2V0LmluaXRpYWxpemUoKTt2YXIgZCxlPWIub2Zmc2V0UGFyZW50LGY9Yi5vd25lckRvY3VtZW50LGg9Zi5kb2N1bWVudEVsZW1lbnQsbD1mLmJvZHk7ZD0oZj1mLmRlZmF1bHRWaWV3KT9mLmdldENvbXB1dGVkU3R5bGUoYixudWxsKTpiLmN1cnJlbnRTdHlsZTsKZm9yKHZhciBrPWIub2Zmc2V0VG9wLG89Yi5vZmZzZXRMZWZ0OyhiPWIucGFyZW50Tm9kZSkmJmIhPT1sJiZiIT09aDspe2lmKGMub2Zmc2V0LnN1cHBvcnRzRml4ZWRQb3NpdGlvbiYmZC5wb3NpdGlvbj09PSJmaXhlZCIpYnJlYWs7ZD1mP2YuZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpOmIuY3VycmVudFN0eWxlO2stPWIuc2Nyb2xsVG9wO28tPWIuc2Nyb2xsTGVmdDtpZihiPT09ZSl7ays9Yi5vZmZzZXRUb3A7bys9Yi5vZmZzZXRMZWZ0O2lmKGMub2Zmc2V0LmRvZXNOb3RBZGRCb3JkZXImJiEoYy5vZmZzZXQuZG9lc0FkZEJvcmRlckZvclRhYmxlQW5kQ2VsbHMmJnhiLnRlc3QoYi5ub2RlTmFtZSkpKXtrKz1wYXJzZUZsb2F0KGQuYm9yZGVyVG9wV2lkdGgpfHwwO28rPXBhcnNlRmxvYXQoZC5ib3JkZXJMZWZ0V2lkdGgpfHwwfWU9Yi5vZmZzZXRQYXJlbnR9aWYoYy5vZmZzZXQuc3VidHJhY3RzQm9yZGVyRm9yT3ZlcmZsb3dOb3RWaXNpYmxlJiZkLm92ZXJmbG93IT09InZpc2libGUiKXtrKz0KcGFyc2VGbG9hdChkLmJvcmRlclRvcFdpZHRoKXx8MDtvKz1wYXJzZUZsb2F0KGQuYm9yZGVyTGVmdFdpZHRoKXx8MH1kPWR9aWYoZC5wb3NpdGlvbj09PSJyZWxhdGl2ZSJ8fGQucG9zaXRpb249PT0ic3RhdGljIil7ays9bC5vZmZzZXRUb3A7bys9bC5vZmZzZXRMZWZ0fWlmKGMub2Zmc2V0LnN1cHBvcnRzRml4ZWRQb3NpdGlvbiYmZC5wb3NpdGlvbj09PSJmaXhlZCIpe2srPU1hdGgubWF4KGguc2Nyb2xsVG9wLGwuc2Nyb2xsVG9wKTtvKz1NYXRoLm1heChoLnNjcm9sbExlZnQsbC5zY3JvbGxMZWZ0KX1yZXR1cm57dG9wOmssbGVmdDpvfX07Yy5vZmZzZXQ9e2luaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgYT10LmJvZHksYj10LmNyZWF0ZUVsZW1lbnQoImRpdiIpLGQsZSxmLGg9cGFyc2VGbG9hdChjLmNzcyhhLCJtYXJnaW5Ub3AiKSl8fDA7Yy5leHRlbmQoYi5zdHlsZSx7cG9zaXRpb246ImFic29sdXRlIix0b3A6MCxsZWZ0OjAsbWFyZ2luOjAsYm9yZGVyOjAsd2lkdGg6IjFweCIsCmhlaWdodDoiMXB4Iix2aXNpYmlsaXR5OiJoaWRkZW4ifSk7Yi5pbm5lckhUTUw9IjxkaXYgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDttYXJnaW46MDtib3JkZXI6NXB4IHNvbGlkICMwMDA7cGFkZGluZzowO3dpZHRoOjFweDtoZWlnaHQ6MXB4Oyc+PGRpdj48L2Rpdj48L2Rpdj48dGFibGUgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDttYXJnaW46MDtib3JkZXI6NXB4IHNvbGlkICMwMDA7cGFkZGluZzowO3dpZHRoOjFweDtoZWlnaHQ6MXB4OycgY2VsbHBhZGRpbmc9JzAnIGNlbGxzcGFjaW5nPScwJz48dHI+PHRkPjwvdGQ+PC90cj48L3RhYmxlPiI7YS5pbnNlcnRCZWZvcmUoYixhLmZpcnN0Q2hpbGQpO2Q9Yi5maXJzdENoaWxkO2U9ZC5maXJzdENoaWxkO2Y9ZC5uZXh0U2libGluZy5maXJzdENoaWxkLmZpcnN0Q2hpbGQ7dGhpcy5kb2VzTm90QWRkQm9yZGVyPWUub2Zmc2V0VG9wIT09NTt0aGlzLmRvZXNBZGRCb3JkZXJGb3JUYWJsZUFuZENlbGxzPQpmLm9mZnNldFRvcD09PTU7ZS5zdHlsZS5wb3NpdGlvbj0iZml4ZWQiO2Uuc3R5bGUudG9wPSIyMHB4Ijt0aGlzLnN1cHBvcnRzRml4ZWRQb3NpdGlvbj1lLm9mZnNldFRvcD09PTIwfHxlLm9mZnNldFRvcD09PTE1O2Uuc3R5bGUucG9zaXRpb249ZS5zdHlsZS50b3A9IiI7ZC5zdHlsZS5vdmVyZmxvdz0iaGlkZGVuIjtkLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSI7dGhpcy5zdWJ0cmFjdHNCb3JkZXJGb3JPdmVyZmxvd05vdFZpc2libGU9ZS5vZmZzZXRUb3A9PT0tNTt0aGlzLmRvZXNOb3RJbmNsdWRlTWFyZ2luSW5Cb2R5T2Zmc2V0PWEub2Zmc2V0VG9wIT09aDthLnJlbW92ZUNoaWxkKGIpO2Mub2Zmc2V0LmluaXRpYWxpemU9Yy5ub29wfSxib2R5T2Zmc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEub2Zmc2V0VG9wLGQ9YS5vZmZzZXRMZWZ0O2Mub2Zmc2V0LmluaXRpYWxpemUoKTtpZihjLm9mZnNldC5kb2VzTm90SW5jbHVkZU1hcmdpbkluQm9keU9mZnNldCl7Yis9cGFyc2VGbG9hdChjLmNzcyhhLAoibWFyZ2luVG9wIikpfHwwO2QrPXBhcnNlRmxvYXQoYy5jc3MoYSwibWFyZ2luTGVmdCIpKXx8MH1yZXR1cm57dG9wOmIsbGVmdDpkfX0sc2V0T2Zmc2V0OmZ1bmN0aW9uKGEsYixkKXt2YXIgZT1jLmNzcyhhLCJwb3NpdGlvbiIpO2lmKGU9PT0ic3RhdGljIilhLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSI7dmFyIGY9YyhhKSxoPWYub2Zmc2V0KCksbD1jLmNzcyhhLCJ0b3AiKSxrPWMuY3NzKGEsImxlZnQiKSxvPWU9PT0iYWJzb2x1dGUiJiZjLmluQXJyYXkoImF1dG8iLFtsLGtdKT4tMTtlPXt9O3ZhciB4PXt9O2lmKG8peD1mLnBvc2l0aW9uKCk7bD1vP3gudG9wOnBhcnNlSW50KGwsMTApfHwwO2s9bz94LmxlZnQ6cGFyc2VJbnQoaywxMCl8fDA7aWYoYy5pc0Z1bmN0aW9uKGIpKWI9Yi5jYWxsKGEsZCxoKTtpZihiLnRvcCE9bnVsbCllLnRvcD1iLnRvcC1oLnRvcCtsO2lmKGIubGVmdCE9bnVsbCllLmxlZnQ9Yi5sZWZ0LWgubGVmdCtrOyJ1c2luZyJpbiBiP2IudXNpbmcuY2FsbChhLAplKTpmLmNzcyhlKX19O2MuZm4uZXh0ZW5kKHtwb3NpdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzWzBdKXJldHVybiBudWxsO3ZhciBhPXRoaXNbMF0sYj10aGlzLm9mZnNldFBhcmVudCgpLGQ9dGhpcy5vZmZzZXQoKSxlPUlhLnRlc3QoYlswXS5ub2RlTmFtZSk/e3RvcDowLGxlZnQ6MH06Yi5vZmZzZXQoKTtkLnRvcC09cGFyc2VGbG9hdChjLmNzcyhhLCJtYXJnaW5Ub3AiKSl8fDA7ZC5sZWZ0LT1wYXJzZUZsb2F0KGMuY3NzKGEsIm1hcmdpbkxlZnQiKSl8fDA7ZS50b3ArPXBhcnNlRmxvYXQoYy5jc3MoYlswXSwiYm9yZGVyVG9wV2lkdGgiKSl8fDA7ZS5sZWZ0Kz1wYXJzZUZsb2F0KGMuY3NzKGJbMF0sImJvcmRlckxlZnRXaWR0aCIpKXx8MDtyZXR1cm57dG9wOmQudG9wLWUudG9wLGxlZnQ6ZC5sZWZ0LWUubGVmdH19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLm9mZnNldFBhcmVudHx8dC5ib2R5O2EmJiFJYS50ZXN0KGEubm9kZU5hbWUpJiYKYy5jc3MoYSwicG9zaXRpb24iKT09PSJzdGF0aWMiOylhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfSl9fSk7Yy5lYWNoKFsiTGVmdCIsIlRvcCJdLGZ1bmN0aW9uKGEsYil7dmFyIGQ9InNjcm9sbCIrYjtjLmZuW2RdPWZ1bmN0aW9uKGUpe3ZhciBmPXRoaXNbMF0saDtpZighZilyZXR1cm4gbnVsbDtpZihlIT09QilyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7aWYoaD1mYSh0aGlzKSloLnNjcm9sbFRvKCFhP2U6YyhoKS5zY3JvbGxMZWZ0KCksYT9lOmMoaCkuc2Nyb2xsVG9wKCkpO2Vsc2UgdGhpc1tkXT1lfSk7ZWxzZSByZXR1cm4oaD1mYShmKSk/InBhZ2VYT2Zmc2V0ImluIGg/aFthPyJwYWdlWU9mZnNldCI6InBhZ2VYT2Zmc2V0Il06Yy5zdXBwb3J0LmJveE1vZGVsJiZoLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFtkXXx8aC5kb2N1bWVudC5ib2R5W2RdOmZbZF19fSk7Yy5lYWNoKFsiSGVpZ2h0IiwiV2lkdGgiXSxmdW5jdGlvbihhLGIpe3ZhciBkPWIudG9Mb3dlckNhc2UoKTsKYy5mblsiaW5uZXIiK2JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbMF0/cGFyc2VGbG9hdChjLmNzcyh0aGlzWzBdLGQsInBhZGRpbmciKSk6bnVsbH07Yy5mblsib3V0ZXIiK2JdPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzWzBdP3BhcnNlRmxvYXQoYy5jc3ModGhpc1swXSxkLGU/Im1hcmdpbiI6ImJvcmRlciIpKTpudWxsfTtjLmZuW2RdPWZ1bmN0aW9uKGUpe3ZhciBmPXRoaXNbMF07aWYoIWYpcmV0dXJuIGU9PW51bGw/bnVsbDp0aGlzO2lmKGMuaXNGdW5jdGlvbihlKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGwpe3ZhciBrPWModGhpcyk7a1tkXShlLmNhbGwodGhpcyxsLGtbZF0oKSkpfSk7aWYoYy5pc1dpbmRvdyhmKSlyZXR1cm4gZi5kb2N1bWVudC5jb21wYXRNb2RlPT09IkNTUzFDb21wYXQiJiZmLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsiY2xpZW50IitiXXx8Zi5kb2N1bWVudC5ib2R5WyJjbGllbnQiK2JdO2Vsc2UgaWYoZi5ub2RlVHlwZT09PTkpcmV0dXJuIE1hdGgubWF4KGYuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQiKwpiXSxmLmJvZHlbInNjcm9sbCIrYl0sZi5kb2N1bWVudEVsZW1lbnRbInNjcm9sbCIrYl0sZi5ib2R5WyJvZmZzZXQiK2JdLGYuZG9jdW1lbnRFbGVtZW50WyJvZmZzZXQiK2JdKTtlbHNlIGlmKGU9PT1CKXtmPWMuY3NzKGYsZCk7dmFyIGg9cGFyc2VGbG9hdChmKTtyZXR1cm4gYy5pc05hTihoKT9mOmh9ZWxzZSByZXR1cm4gdGhpcy5jc3MoZCx0eXBlb2YgZT09PSJzdHJpbmciP2U6ZSsicHgiKX19KX0pKHdpbmRvdyk7Cg==",
	"json.js": "LyoKICAgIGpzb24uanMKICAgIDIwMTAtMDMtMjcKCiAgICBQdWJsaWMgRG9tYWluCgogICAgTm8gd2FycmFudHkgZXhwcmVzc2VkIG9yIGltcGxpZWQuIFVzZSBhdCB5b3VyIG93biByaXNrLgoKICAgIFRoaXMgZmlsZSBoYXMgYmVlbiBzdXBlcmNlZGVkIGJ5IGh0dHA6Ly93d3cuSlNPTi5vcmcvanNvbjIuanMKCiAgICBTZWUgaHR0cDovL3d3dy5KU09OLm9yZy9qcy5odG1sCgogICAgVGhpcyBjb2RlIHNob3VsZCBiZSBtaW5pZmllZCBiZWZvcmUgZGVwbG95bWVudC4KICAgIFNlZSBodHRwOi8vamF2YXNjcmlwdC5jcm9ja2ZvcmQuY29tL2pzbWluLmh0bWwKCiAgICBVU0UgWU9VUiBPV04gQ09QWS4gSVQgSVMgRVhUUkVNRUxZIFVOV0lTRSBUTyBMT0FEIENPREUgRlJPTSBTRVJWRVJTIFlPVSBETwogICAgTk9UIENPTlRST0wuCgogICAgVGhpcyBmaWxlIGFkZHMgdGhlc2UgbWV0aG9kcyB0byBKYXZhU2NyaXB0OgoKICAgICAgICBvYmplY3QudG9KU09OU3RyaW5nKHdoaXRlbGlzdCkKICAgICAgICAgICAgVGhpcyBtZXRob2QgcHJvZHVjZSBhIEpTT04gdGV4dCBmcm9tIGEgSmF2YVNjcmlwdCB2YWx1ZS4KICAgICAgICAgICAgSXQgbXVzdCBub3QgY29udGFpbiBhbnkgY3ljbGljYWwgcmVmZXJlbmNlcy4gSWxsZWdhbCB2YWx1ZXMKICAgICAgICAgICAgd2lsbCBiZSBleGNsdWRlZC4KCiAgICAgICAgICAgIFRoZSBkZWZhdWx0IGNvbnZlcnNpb24gZm9yIGRhdGVzIGlzIHRvIGFuIElTTyBzdHJpbmcuIFlvdSBjYW4KICAgICAgICAgICAgYWRkIGEgdG9KU09OU3RyaW5nIG1ldGhvZCB0byBhbnkgZGF0ZSBvYmplY3QgdG8gZ2V0IGEgZGlmZmVyZW50CiAgICAgICAgICAgIHJlcHJlc2VudGF0aW9uLgoKICAgICAgICAgICAgVGhlIG9iamVjdCBhbmQgYXJyYXkgbWV0aG9kcyBjYW4gdGFrZSBhbiBvcHRpb25hbCB3aGl0ZWxpc3QKICAgICAgICAgICAgYXJndW1lbnQuIEEgd2hpdGVsaXN0IGlzIGFuIGFycmF5IG9mIHN0cmluZ3MuIElmIGl0IGlzIHByb3ZpZGVkLAogICAgICAgICAgICBrZXlzIGluIG9iamVjdHMgbm90IGZvdW5kIGluIHRoZSB3aGl0ZWxpc3QgYXJlIGV4Y2x1ZGVkLgoKICAgICAgICBzdHJpbmcucGFyc2VKU09OKGZpbHRlcikKICAgICAgICAgICAgVGhpcyBtZXRob2QgcGFyc2VzIGEgSlNPTiB0ZXh0IHRvIHByb2R1Y2UgYW4gb2JqZWN0IG9yCiAgICAgICAgICAgIGFycmF5LiBJdCBjYW4gdGhyb3cgYSBTeW50YXhFcnJvciBleGNlcHRpb24uCgogICAgICAgICAgICBUaGUgb3B0aW9uYWwgZmlsdGVyIHBhcmFtZXRlciBpcyBhIGZ1bmN0aW9uIHdoaWNoIGNhbiBmaWx0ZXIgYW5kCiAgICAgICAgICAgIHRyYW5zZm9ybSB0aGUgcmVzdWx0cy4gSXQgcmVjZWl2ZXMgZWFjaCBvZiB0aGUga2V5cyBhbmQgdmFsdWVzLCBhbmQKICAgICAgICAgICAgaXRzIHJldHVybiB2YWx1ZSBpcyB1c2VkIGluc3RlYWQgb2YgdGhlIG9yaWdpbmFsIHZhbHVlLiBJZiBpdAogICAgICAgICAgICByZXR1cm5zIHdoYXQgaXQgcmVjZWl2ZWQsIHRoZW4gc3RydWN0dXJlIGlzIG5vdCBtb2RpZmllZC4gSWYgaXQKICAgICAgICAgICAgcmV0dXJucyB1bmRlZmluZWQgdGhlbiB0aGUgbWVtYmVyIGlzIGRlbGV0ZWQuCgogICAgICAgICAgICBFeGFtcGxlOgoKICAgICAgICAgICAgLy8gUGFyc2UgdGhlIHRleHQuIElmIGEga2V5IGNvbnRhaW5zIHRoZSBzdHJpbmcgJ2RhdGUnIHRoZW4KICAgICAgICAgICAgLy8gY29udmVydCB0aGUgdmFsdWUgdG8gYSBkYXRlLgoKICAgICAgICAgICAgbXlEYXRhID0gdGV4dC5wYXJzZUpTT04oZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBrZXkuaW5kZXhPZignZGF0ZScpID49IDAgPyBuZXcgRGF0ZSh2YWx1ZSkgOiB2YWx1ZTsKICAgICAgICAgICAgfSk7CgogICAgVGhpcyBmaWxlIHdpbGwgYnJlYWsgcHJvZ3JhbXMgd2l0aCBpbXByb3BlciBmb3IuLmluIGxvb3BzLiBTZWUKICAgIGh0dHA6Ly95dWlibG9nLmNvbS9ibG9nLzIwMDYvMDkvMjYvZm9yLWluLWludHJpZ3VlLwoKICAgIFRoaXMgZmlsZSBjcmVhdGVzIGEgZ2xvYmFsIEpTT04gb2JqZWN0IGNvbnRhaW5pbmcgdHdvIG1ldGhvZHM6IHN0cmluZ2lmeQogICAgYW5kIHBhcnNlLgoKICAgICAgICBKU09OLnN0cmluZ2lmeSh2YWx1ZSwgcmVwbGFjZXIsIHNwYWNlKQogICAgICAgICAgICB2YWx1ZSAgICAgICBhbnkgSmF2YVNjcmlwdCB2YWx1ZSwgdXN1YWxseSBhbiBvYmplY3Qgb3IgYXJyYXkuCgogICAgICAgICAgICByZXBsYWNlciAgICBhbiBvcHRpb25hbCBwYXJhbWV0ZXIgdGhhdCBkZXRlcm1pbmVzIGhvdyBvYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzIGFyZSBzdHJpbmdpZmllZCBmb3Igb2JqZWN0cy4gSXQgY2FuIGJlIGEKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gb3IgYW4gYXJyYXkgb2Ygc3RyaW5ncy4KCiAgICAgICAgICAgIHNwYWNlICAgICAgIGFuIG9wdGlvbmFsIHBhcmFtZXRlciB0aGF0IHNwZWNpZmllcyB0aGUgaW5kZW50YXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgb2YgbmVzdGVkIHN0cnVjdHVyZXMuIElmIGl0IGlzIG9taXR0ZWQsIHRoZSB0ZXh0IHdpbGwKICAgICAgICAgICAgICAgICAgICAgICAgYmUgcGFja2VkIHdpdGhvdXQgZXh0cmEgd2hpdGVzcGFjZS4gSWYgaXQgaXMgYSBudW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIGl0IHdpbGwgc3BlY2lmeSB0aGUgbnVtYmVyIG9mIHNwYWNlcyB0byBpbmRlbnQgYXQgZWFjaAogICAgICAgICAgICAgICAgICAgICAgICBsZXZlbC4gSWYgaXQgaXMgYSBzdHJpbmcgKHN1Y2ggYXMgJ1x0JyBvciAnJm5ic3A7JyksCiAgICAgICAgICAgICAgICAgICAgICAgIGl0IGNvbnRhaW5zIHRoZSBjaGFyYWN0ZXJzIHVzZWQgdG8gaW5kZW50IGF0IGVhY2ggbGV2ZWwuCgogICAgICAgICAgICBUaGlzIG1ldGhvZCBwcm9kdWNlcyBhIEpTT04gdGV4dCBmcm9tIGEgSmF2YVNjcmlwdCB2YWx1ZS4KCiAgICAgICAgICAgIFdoZW4gYW4gb2JqZWN0IHZhbHVlIGlzIGZvdW5kLCBpZiB0aGUgb2JqZWN0IGNvbnRhaW5zIGEgdG9KU09OCiAgICAgICAgICAgIG1ldGhvZCwgaXRzIHRvSlNPTiBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYW5kIHRoZSByZXN1bHQgd2lsbCBiZQogICAgICAgICAgICBzdHJpbmdpZmllZC4gQSB0b0pTT04gbWV0aG9kIGRvZXMgbm90IHNlcmlhbGl6ZTogaXQgcmV0dXJucyB0aGUKICAgICAgICAgICAgdmFsdWUgcmVwcmVzZW50ZWQgYnkgdGhlIG5hbWUvdmFsdWUgcGFpciB0aGF0IHNob3VsZCBiZSBzZXJpYWxpemVkLAogICAgICAgICAgICBvciB1bmRlZmluZWQgaWYgbm90aGluZyBzaG91bGQgYmUgc2VyaWFsaXplZC4gVGhlIHRvSlNPTiBtZXRob2QKICAgICAgICAgICAgd2lsbCBiZSBwYXNzZWQgdGhlIGtleSBhc3NvY2lhdGVkIHdpdGggdGhlIHZhbHVlLCBhbmQgdGhpcyB3aWxsIGJlCiAgICAgICAgICAgIGJvdW5kIHRvIHRoZSBvYmplY3QgaG9sZGluZyB0aGUga2V5LgoKICAgICAgICAgICAgRm9yIGV4YW1wbGUsIHRoaXMgd291bGQgc2VyaWFsaXplIERhdGVzIGFzIElTTyBzdHJpbmdzLgoKICAgICAgICAgICAgICAgIERhdGUucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBmKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9ybWF0IGludGVnZXJzIHRvIGhhdmUgYXQgbGVhc3QgdHdvIGRpZ2l0cy4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gPCAxMCA/ICcwJyArIG4gOiBuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VVRDRnVsbFllYXIoKSAgICsgJy0nICsKICAgICAgICAgICAgICAgICAgICAgICAgIGYodGhpcy5nZXRVVENNb250aCgpICsgMSkgKyAnLScgKwogICAgICAgICAgICAgICAgICAgICAgICAgZih0aGlzLmdldFVUQ0RhdGUoKSkgICAgICArICdUJyArCiAgICAgICAgICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDSG91cnMoKSkgICAgICsgJzonICsKICAgICAgICAgICAgICAgICAgICAgICAgIGYodGhpcy5nZXRVVENNaW51dGVzKCkpICAgKyAnOicgKwogICAgICAgICAgICAgICAgICAgICAgICAgZih0aGlzLmdldFVUQ1NlY29uZHMoKSkgICArICdaJzsKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICBZb3UgY2FuIHByb3ZpZGUgYW4gb3B0aW9uYWwgcmVwbGFjZXIgbWV0aG9kLiBJdCB3aWxsIGJlIHBhc3NlZCB0aGUKICAgICAgICAgICAga2V5IGFuZCB2YWx1ZSBvZiBlYWNoIG1lbWJlciwgd2l0aCB0aGlzIGJvdW5kIHRvIHRoZSBjb250YWluaW5nCiAgICAgICAgICAgIG9iamVjdC4gVGhlIHZhbHVlIHRoYXQgaXMgcmV0dXJuZWQgZnJvbSB5b3VyIG1ldGhvZCB3aWxsIGJlCiAgICAgICAgICAgIHNlcmlhbGl6ZWQuIElmIHlvdXIgbWV0aG9kIHJldHVybnMgdW5kZWZpbmVkLCB0aGVuIHRoZSBtZW1iZXIgd2lsbAogICAgICAgICAgICBiZSBleGNsdWRlZCBmcm9tIHRoZSBzZXJpYWxpemF0aW9uLgoKICAgICAgICAgICAgSWYgdGhlIHJlcGxhY2VyIHBhcmFtZXRlciBpcyBhbiBhcnJheSBvZiBzdHJpbmdzLCB0aGVuIGl0IHdpbGwgYmUKICAgICAgICAgICAgdXNlZCB0byBzZWxlY3QgdGhlIG1lbWJlcnMgdG8gYmUgc2VyaWFsaXplZC4gSXQgZmlsdGVycyB0aGUgcmVzdWx0cwogICAgICAgICAgICBzdWNoIHRoYXQgb25seSBtZW1iZXJzIHdpdGgga2V5cyBsaXN0ZWQgaW4gdGhlIHJlcGxhY2VyIGFycmF5IGFyZQogICAgICAgICAgICBzdHJpbmdpZmllZC4KCiAgICAgICAgICAgIFZhbHVlcyB0aGF0IGRvIG5vdCBoYXZlIEpTT04gcmVwcmVzZW50YXRpb25zLCBzdWNoIGFzIHVuZGVmaW5lZCBvcgogICAgICAgICAgICBmdW5jdGlvbnMsIHdpbGwgbm90IGJlIHNlcmlhbGl6ZWQuIFN1Y2ggdmFsdWVzIGluIG9iamVjdHMgd2lsbCBiZQogICAgICAgICAgICBkcm9wcGVkOyBpbiBhcnJheXMgdGhleSB3aWxsIGJlIHJlcGxhY2VkIHdpdGggbnVsbC4gWW91IGNhbiB1c2UKICAgICAgICAgICAgYSByZXBsYWNlciBmdW5jdGlvbiB0byByZXBsYWNlIHRob3NlIHdpdGggSlNPTiB2YWx1ZXMuCiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHVuZGVmaW5lZCkgcmV0dXJucyB1bmRlZmluZWQuCgogICAgICAgICAgICBUaGUgb3B0aW9uYWwgc3BhY2UgcGFyYW1ldGVyIHByb2R1Y2VzIGEgc3RyaW5naWZpY2F0aW9uIG9mIHRoZQogICAgICAgICAgICB2YWx1ZSB0aGF0IGlzIGZpbGxlZCB3aXRoIGxpbmUgYnJlYWtzIGFuZCBpbmRlbnRhdGlvbiB0byBtYWtlIGl0CiAgICAgICAgICAgIGVhc2llciB0byByZWFkLgoKICAgICAgICAgICAgSWYgdGhlIHNwYWNlIHBhcmFtZXRlciBpcyBhIG5vbi1lbXB0eSBzdHJpbmcsIHRoZW4gdGhhdCBzdHJpbmcgd2lsbAogICAgICAgICAgICBiZSB1c2VkIGZvciBpbmRlbnRhdGlvbi4gSWYgdGhlIHNwYWNlIHBhcmFtZXRlciBpcyBhIG51bWJlciwgdGhlbgogICAgICAgICAgICB0aGUgaW5kZW50YXRpb24gd2lsbCBiZSB0aGF0IG1hbnkgc3BhY2VzLgoKICAgICAgICAgICAgRXhhbXBsZToKCiAgICAgICAgICAgIHRleHQgPSBKU09OLnN0cmluZ2lmeShbJ2UnLCB7cGx1cmlidXM6ICd1bnVtJ31dKTsKICAgICAgICAgICAgLy8gdGV4dCBpcyAnWyJlIix7InBsdXJpYnVzIjoidW51bSJ9XScKCgogICAgICAgICAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkoWydlJywge3BsdXJpYnVzOiAndW51bSd9XSwgbnVsbCwgJ1x0Jyk7CiAgICAgICAgICAgIC8vIHRleHQgaXMgJ1tcblx0ImUiLFxuXHR7XG5cdFx0InBsdXJpYnVzIjogInVudW0iXG5cdH1cbl0nCgogICAgICAgICAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkoW25ldyBEYXRlKCldLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNba2V5XSBpbnN0YW5jZW9mIERhdGUgPwogICAgICAgICAgICAgICAgICAgICdEYXRlKCcgKyB0aGlzW2tleV0gKyAnKScgOiB2YWx1ZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIHRleHQgaXMgJ1siRGF0ZSgtLS1jdXJyZW50IHRpbWUtLS0pIl0nCgoKICAgICAgICBKU09OLnBhcnNlKHRleHQsIHJldml2ZXIpCiAgICAgICAgICAgIFRoaXMgbWV0aG9kIHBhcnNlcyBhIEpTT04gdGV4dCB0byBwcm9kdWNlIGFuIG9iamVjdCBvciBhcnJheS4KICAgICAgICAgICAgSXQgY2FuIHRocm93IGEgU3ludGF4RXJyb3IgZXhjZXB0aW9uLgoKICAgICAgICAgICAgVGhlIG9wdGlvbmFsIHJldml2ZXIgcGFyYW1ldGVyIGlzIGEgZnVuY3Rpb24gdGhhdCBjYW4gZmlsdGVyIGFuZAogICAgICAgICAgICB0cmFuc2Zvcm0gdGhlIHJlc3VsdHMuIEl0IHJlY2VpdmVzIGVhY2ggb2YgdGhlIGtleXMgYW5kIHZhbHVlcywKICAgICAgICAgICAgYW5kIGl0cyByZXR1cm4gdmFsdWUgaXMgdXNlZCBpbnN0ZWFkIG9mIHRoZSBvcmlnaW5hbCB2YWx1ZS4KICAgICAgICAgICAgSWYgaXQgcmV0dXJucyB3aGF0IGl0IHJlY2VpdmVkLCB0aGVuIHRoZSBzdHJ1Y3R1cmUgaXMgbm90IG1vZGlmaWVkLgogICAgICAgICAgICBJZiBpdCByZXR1cm5zIHVuZGVmaW5lZCB0aGVuIHRoZSBtZW1iZXIgaXMgZGVsZXRlZC4KCiAgICAgICAgICAgIEV4YW1wbGU6CgogICAgICAgICAgICAvLyBQYXJzZSB0aGUgdGV4dC4gVmFsdWVzIHRoYXQgbG9vayBsaWtlIElTTyBkYXRlIHN0cmluZ3Mgd2lsbAogICAgICAgICAgICAvLyBiZSBjb252ZXJ0ZWQgdG8gRGF0ZSBvYmplY3RzLgoKICAgICAgICAgICAgbXlEYXRhID0gSlNPTi5wYXJzZSh0ZXh0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgIGEgPQovXihcZHs0fSktKFxkezJ9KS0oXGR7Mn0pVChcZHsyfSk6KFxkezJ9KTooXGR7Mn0oPzpcLlxkKik/KVokLy5leGVjKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEMoK2FbMV0sICthWzJdIC0gMSwgK2FbM10sICthWzRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgK2FbNV0sICthWzZdKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIG15RGF0YSA9IEpTT04ucGFyc2UoJ1siRGF0ZSgwOS8wOS8yMDAxKSJdJywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIHZhciBkOwogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuc2xpY2UoMCwgNSkgPT09ICdEYXRlKCcgJiYKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuc2xpY2UoLTEpID09PSAnKScpIHsKICAgICAgICAgICAgICAgICAgICBkID0gbmV3IERhdGUodmFsdWUuc2xpY2UoNSwgLTEpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0pOwoKCiAgICBUaGlzIGlzIGEgcmVmZXJlbmNlIGltcGxlbWVudGF0aW9uLiBZb3UgYXJlIGZyZWUgdG8gY29weSwgbW9kaWZ5LCBvcgogICAgcmVkaXN0cmlidXRlLgoqLwoKLypqc2xpbnQgZXZpbDogdHJ1ZSAqLwoKLyptZW1iZXJzICIiLCAiXGIiLCAiXHQiLCAiXG4iLCAiXGYiLCAiXHIiLCAiXCIiLCBKU09OLCAiXFwiLCBhcHBseSwKICAgIGNhbGwsIGNoYXJDb2RlQXQsIGdldFVUQ0RhdGUsIGdldFVUQ0Z1bGxZZWFyLCBnZXRVVENIb3VycywKICAgIGdldFVUQ01pbnV0ZXMsIGdldFVUQ01vbnRoLCBnZXRVVENTZWNvbmRzLCBoYXNPd25Qcm9wZXJ0eSwgam9pbiwKICAgIGxhc3RJbmRleCwgbGVuZ3RoLCBwYXJzZSwgcGFyc2VKU09OLCBwcm90b3R5cGUsIHB1c2gsIHJlcGxhY2UsIHNsaWNlLAogICAgc3RyaW5naWZ5LCB0ZXN0LCB0b0pTT04sIHRvSlNPTlN0cmluZywgdG9TdHJpbmcsIHZhbHVlT2YKKi8KCgovLyBDcmVhdGUgYSBKU09OIG9iamVjdCBvbmx5IGlmIG9uZSBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0LiBXZSBjcmVhdGUgdGhlCi8vIG1ldGhvZHMgaW4gYSBjbG9zdXJlIHRvIGF2b2lkIGNyZWF0aW5nIGdsb2JhbCB2YXJpYWJsZXMuCgpKU09OID0gSlNPTiB8fCB7fTsKCihmdW5jdGlvbiAoKSB7CgogICAgZnVuY3Rpb24gZihuKSB7CiAgICAgICAgLy8gRm9ybWF0IGludGVnZXJzIHRvIGhhdmUgYXQgbGVhc3QgdHdvIGRpZ2l0cy4KICAgICAgICByZXR1cm4gbiA8IDEwID8gJzAnICsgbiA6IG47CiAgICB9CgogICAgaWYgKHR5cGVvZiBEYXRlLnByb3RvdHlwZS50b0pTT04gIT09ICdmdW5jdGlvbicpIHsKCiAgICAgICAgRGF0ZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGtleSkgewoKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VVRDRnVsbFllYXIoKSAgICsgJy0nICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDTW9udGgoKSArIDEpICsgJy0nICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDRGF0ZSgpKSAgICAgICsgJ1QnICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDSG91cnMoKSkgICAgICsgJzonICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDTWludXRlcygpKSAgICsgJzonICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDU2Vjb25kcygpKSAgICsgJ1onOwogICAgICAgIH07CgogICAgICAgIFN0cmluZy5wcm90b3R5cGUudG9KU09OID0KICAgICAgICBOdW1iZXIucHJvdG90eXBlLnRvSlNPTiA9CiAgICAgICAgQm9vbGVhbi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZU9mKCk7CiAgICAgICAgfTsKICAgIH0KCiAgICB2YXIgY3ggPSAvW1x1MDAwMFx1MDBhZFx1MDYwMC1cdTA2MDRcdTA3MGZcdTE3YjRcdTE3YjVcdTIwMGMtXHUyMDBmXHUyMDI4LVx1MjAyZlx1MjA2MC1cdTIwNmZcdWZlZmZcdWZmZjAtXHVmZmZmXS9nLAogICAgICAgIGVzY2FwYWJsZSA9IC9bXFxcIlx4MDAtXHgxZlx4N2YtXHg5Zlx1MDBhZFx1MDYwMC1cdTA2MDRcdTA3MGZcdTE3YjRcdTE3YjVcdTIwMGMtXHUyMDBmXHUyMDI4LVx1MjAyZlx1MjA2MC1cdTIwNmZcdWZlZmZcdWZmZjAtXHVmZmZmXS9nLAogICAgICAgIGdhcCwKICAgICAgICBpbmRlbnQsCiAgICAgICAgbWV0YSA9IHsgICAgLy8gdGFibGUgb2YgY2hhcmFjdGVyIHN1YnN0aXR1dGlvbnMKICAgICAgICAgICAgJ1xiJzogJ1xcYicsCiAgICAgICAgICAgICdcdCc6ICdcXHQnLAogICAgICAgICAgICAnXG4nOiAnXFxuJywKICAgICAgICAgICAgJ1xmJzogJ1xcZicsCiAgICAgICAgICAgICdccic6ICdcXHInLAogICAgICAgICAgICAnIicgOiAnXFwiJywKICAgICAgICAgICAgJ1xcJzogJ1xcXFwnCiAgICAgICAgfSwKICAgICAgICByZXA7CgoKICAgIGZ1bmN0aW9uIHF1b3RlKHN0cmluZykgewoKLy8gSWYgdGhlIHN0cmluZyBjb250YWlucyBubyBjb250cm9sIGNoYXJhY3RlcnMsIG5vIHF1b3RlIGNoYXJhY3RlcnMsIGFuZCBubwovLyBiYWNrc2xhc2ggY2hhcmFjdGVycywgdGhlbiB3ZSBjYW4gc2FmZWx5IHNsYXAgc29tZSBxdW90ZXMgYXJvdW5kIGl0LgovLyBPdGhlcndpc2Ugd2UgbXVzdCBhbHNvIHJlcGxhY2UgdGhlIG9mZmVuZGluZyBjaGFyYWN0ZXJzIHdpdGggc2FmZSBlc2NhcGUKLy8gc2VxdWVuY2VzLgoKICAgICAgICBlc2NhcGFibGUubGFzdEluZGV4ID0gMDsKICAgICAgICByZXR1cm4gZXNjYXBhYmxlLnRlc3Qoc3RyaW5nKSA/CiAgICAgICAgICAgICciJyArIHN0cmluZy5yZXBsYWNlKGVzY2FwYWJsZSwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIHZhciBjID0gbWV0YVthXTsKICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYyA9PT0gJ3N0cmluZycgPyBjIDoKICAgICAgICAgICAgICAgICAgICAnXFx1JyArICgnMDAwMCcgKyBhLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtNCk7CiAgICAgICAgICAgIH0pICsgJyInIDoKICAgICAgICAgICAgJyInICsgc3RyaW5nICsgJyInOwogICAgfQoKCiAgICBmdW5jdGlvbiBzdHIoa2V5LCBob2xkZXIpIHsKCi8vIFByb2R1Y2UgYSBzdHJpbmcgZnJvbSBob2xkZXJba2V5XS4KCiAgICAgICAgdmFyIGksICAgICAgICAgIC8vIFRoZSBsb29wIGNvdW50ZXIuCiAgICAgICAgICAgIGssICAgICAgICAgIC8vIFRoZSBtZW1iZXIga2V5LgogICAgICAgICAgICB2LCAgICAgICAgICAvLyBUaGUgbWVtYmVyIHZhbHVlLgogICAgICAgICAgICBsZW5ndGgsCiAgICAgICAgICAgIG1pbmQgPSBnYXAsCiAgICAgICAgICAgIHBhcnRpYWwsCiAgICAgICAgICAgIHZhbHVlID0gaG9sZGVyW2tleV07CgovLyBJZiB0aGUgdmFsdWUgaGFzIGEgdG9KU09OIG1ldGhvZCwgY2FsbCBpdCB0byBvYnRhaW4gYSByZXBsYWNlbWVudCB2YWx1ZS4KCiAgICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYKICAgICAgICAgICAgICAgIHR5cGVvZiB2YWx1ZS50b0pTT04gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50b0pTT04oa2V5KTsKICAgICAgICB9CgovLyBJZiB3ZSB3ZXJlIGNhbGxlZCB3aXRoIGEgcmVwbGFjZXIgZnVuY3Rpb24sIHRoZW4gY2FsbCB0aGUgcmVwbGFjZXIgdG8KLy8gb2J0YWluIGEgcmVwbGFjZW1lbnQgdmFsdWUuCgogICAgICAgIGlmICh0eXBlb2YgcmVwID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIHZhbHVlID0gcmVwLmNhbGwoaG9sZGVyLCBrZXksIHZhbHVlKTsKICAgICAgICB9CgovLyBXaGF0IGhhcHBlbnMgbmV4dCBkZXBlbmRzIG9uIHRoZSB2YWx1ZSdzIHR5cGUuCgogICAgICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7CiAgICAgICAgY2FzZSAnc3RyaW5nJzoKICAgICAgICAgICAgcmV0dXJuIHF1b3RlKHZhbHVlKTsKCiAgICAgICAgY2FzZSAnbnVtYmVyJzoKCi8vIEpTT04gbnVtYmVycyBtdXN0IGJlIGZpbml0ZS4gRW5jb2RlIG5vbi1maW5pdGUgbnVtYmVycyBhcyBudWxsLgoKICAgICAgICAgICAgcmV0dXJuIGlzRmluaXRlKHZhbHVlKSA/IFN0cmluZyh2YWx1ZSkgOiAnbnVsbCc7CgogICAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICAgIGNhc2UgJ251bGwnOgoKLy8gSWYgdGhlIHZhbHVlIGlzIGEgYm9vbGVhbiBvciBudWxsLCBjb252ZXJ0IGl0IHRvIGEgc3RyaW5nLiBOb3RlOgovLyB0eXBlb2YgbnVsbCBkb2VzIG5vdCBwcm9kdWNlICdudWxsJy4gVGhlIGNhc2UgaXMgaW5jbHVkZWQgaGVyZSBpbgovLyB0aGUgcmVtb3RlIGNoYW5jZSB0aGF0IHRoaXMgZ2V0cyBmaXhlZCBzb21lZGF5LgoKICAgICAgICAgICAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7CgovLyBJZiB0aGUgdHlwZSBpcyAnb2JqZWN0Jywgd2UgbWlnaHQgYmUgZGVhbGluZyB3aXRoIGFuIG9iamVjdCBvciBhbiBhcnJheSBvcgovLyBudWxsLgoKICAgICAgICBjYXNlICdvYmplY3QnOgoKLy8gRHVlIHRvIGEgc3BlY2lmaWNhdGlvbiBibHVuZGVyIGluIEVDTUFTY3JpcHQsIHR5cGVvZiBudWxsIGlzICdvYmplY3QnLAovLyBzbyB3YXRjaCBvdXQgZm9yIHRoYXQgY2FzZS4KCiAgICAgICAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnbnVsbCc7CiAgICAgICAgICAgIH0KCi8vIE1ha2UgYW4gYXJyYXkgdG8gaG9sZCB0aGUgcGFydGlhbCByZXN1bHRzIG9mIHN0cmluZ2lmeWluZyB0aGlzIG9iamVjdCB2YWx1ZS4KCiAgICAgICAgICAgIGdhcCArPSBpbmRlbnQ7CiAgICAgICAgICAgIHBhcnRpYWwgPSBbXTsKCi8vIElzIHRoZSB2YWx1ZSBhbiBhcnJheT8KCiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJyYXldJykgewoKLy8gVGhlIHZhbHVlIGlzIGFuIGFycmF5LiBTdHJpbmdpZnkgZXZlcnkgZWxlbWVudC4gVXNlIG51bGwgYXMgYSBwbGFjZWhvbGRlcgovLyBmb3Igbm9uLUpTT04gdmFsdWVzLgoKICAgICAgICAgICAgICAgIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgICAgICAgICAgIHBhcnRpYWxbaV0gPSBzdHIoaSwgdmFsdWUpIHx8ICdudWxsJzsKICAgICAgICAgICAgICAgIH0KCi8vIEpvaW4gYWxsIG9mIHRoZSBlbGVtZW50cyB0b2dldGhlciwgc2VwYXJhdGVkIHdpdGggY29tbWFzLCBhbmQgd3JhcCB0aGVtIGluCi8vIGJyYWNrZXRzLgoKICAgICAgICAgICAgICAgIHYgPSBwYXJ0aWFsLmxlbmd0aCA9PT0gMCA/ICdbXScgOgogICAgICAgICAgICAgICAgICAgIGdhcCA/ICdbXG4nICsgZ2FwICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwuam9pbignLFxuJyArIGdhcCkgKyAnXG4nICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5kICsgJ10nIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAnWycgKyBwYXJ0aWFsLmpvaW4oJywnKSArICddJzsKICAgICAgICAgICAgICAgIGdhcCA9IG1pbmQ7CiAgICAgICAgICAgICAgICByZXR1cm4gdjsKICAgICAgICAgICAgfQoKLy8gSWYgdGhlIHJlcGxhY2VyIGlzIGFuIGFycmF5LCB1c2UgaXQgdG8gc2VsZWN0IHRoZSBtZW1iZXJzIHRvIGJlIHN0cmluZ2lmaWVkLgoKICAgICAgICAgICAgaWYgKHJlcCAmJiB0eXBlb2YgcmVwID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgbGVuZ3RoID0gcmVwLmxlbmd0aDsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgICAgICAgICAgIGsgPSByZXBbaV07CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBrID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgICAgICB2ID0gc3RyKGssIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwucHVzaChxdW90ZShrKSArIChnYXAgPyAnOiAnIDogJzonKSArIHYpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewoKLy8gT3RoZXJ3aXNlLCBpdGVyYXRlIHRocm91Z2ggYWxsIG9mIHRoZSBrZXlzIGluIHRoZSBvYmplY3QuCgogICAgICAgICAgICAgICAgZm9yIChrIGluIHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBrKSkgewogICAgICAgICAgICAgICAgICAgICAgICB2ID0gc3RyKGssIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwucHVzaChxdW90ZShrKSArIChnYXAgPyAnOiAnIDogJzonKSArIHYpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgovLyBKb2luIGFsbCBvZiB0aGUgbWVtYmVyIHRleHRzIHRvZ2V0aGVyLCBzZXBhcmF0ZWQgd2l0aCBjb21tYXMsCi8vIGFuZCB3cmFwIHRoZW0gaW4gYnJhY2VzLgoKICAgICAgICAgICAgdiA9IHBhcnRpYWwubGVuZ3RoID09PSAwID8gJ3t9JyA6CiAgICAgICAgICAgICAgICBnYXAgPyAne1xuJyArIGdhcCArIHBhcnRpYWwuam9pbignLFxuJyArIGdhcCkgKyAnXG4nICsKICAgICAgICAgICAgICAgICAgICAgICAgbWluZCArICd9JyA6ICd7JyArIHBhcnRpYWwuam9pbignLCcpICsgJ30nOwogICAgICAgICAgICBnYXAgPSBtaW5kOwogICAgICAgICAgICByZXR1cm4gdjsKICAgICAgICB9CiAgICB9CgovLyBJZiB0aGUgSlNPTiBvYmplY3QgZG9lcyBub3QgeWV0IGhhdmUgYSBzdHJpbmdpZnkgbWV0aG9kLCBnaXZlIGl0IG9uZS4KCiAgICBpZiAodHlwZW9mIEpTT04uc3RyaW5naWZ5ICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgSlNPTi5zdHJpbmdpZnkgPSBmdW5jdGlvbiAodmFsdWUsIHJlcGxhY2VyLCBzcGFjZSkgewoKLy8gVGhlIHN0cmluZ2lmeSBtZXRob2QgdGFrZXMgYSB2YWx1ZSBhbmQgYW4gb3B0aW9uYWwgcmVwbGFjZXIsIGFuZCBhbiBvcHRpb25hbAovLyBzcGFjZSBwYXJhbWV0ZXIsIGFuZCByZXR1cm5zIGEgSlNPTiB0ZXh0LiBUaGUgcmVwbGFjZXIgY2FuIGJlIGEgZnVuY3Rpb24KLy8gdGhhdCBjYW4gcmVwbGFjZSB2YWx1ZXMsIG9yIGFuIGFycmF5IG9mIHN0cmluZ3MgdGhhdCB3aWxsIHNlbGVjdCB0aGUga2V5cy4KLy8gQSBkZWZhdWx0IHJlcGxhY2VyIG1ldGhvZCBjYW4gYmUgcHJvdmlkZWQuIFVzZSBvZiB0aGUgc3BhY2UgcGFyYW1ldGVyIGNhbgovLyBwcm9kdWNlIHRleHQgdGhhdCBpcyBtb3JlIGVhc2lseSByZWFkYWJsZS4KCiAgICAgICAgICAgIHZhciBpOwogICAgICAgICAgICBnYXAgPSAnJzsKICAgICAgICAgICAgaW5kZW50ID0gJyc7CgovLyBJZiB0aGUgc3BhY2UgcGFyYW1ldGVyIGlzIGEgbnVtYmVyLCBtYWtlIGFuIGluZGVudCBzdHJpbmcgY29udGFpbmluZyB0aGF0Ci8vIG1hbnkgc3BhY2VzLgoKICAgICAgICAgICAgaWYgKHR5cGVvZiBzcGFjZSA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGFjZTsgaSArPSAxKSB7CiAgICAgICAgICAgICAgICAgICAgaW5kZW50ICs9ICcgJzsKICAgICAgICAgICAgICAgIH0KCi8vIElmIHRoZSBzcGFjZSBwYXJhbWV0ZXIgaXMgYSBzdHJpbmcsIGl0IHdpbGwgYmUgdXNlZCBhcyB0aGUgaW5kZW50IHN0cmluZy4KCiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNwYWNlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgaW5kZW50ID0gc3BhY2U7CiAgICAgICAgICAgIH0KCi8vIElmIHRoZXJlIGlzIGEgcmVwbGFjZXIsIGl0IG11c3QgYmUgYSBmdW5jdGlvbiBvciBhbiBhcnJheS4KLy8gT3RoZXJ3aXNlLCB0aHJvdyBhbiBlcnJvci4KCiAgICAgICAgICAgIHJlcCA9IHJlcGxhY2VyOwogICAgICAgICAgICBpZiAocmVwbGFjZXIgJiYgdHlwZW9mIHJlcGxhY2VyICE9PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiByZXBsYWNlciAhPT0gJ29iamVjdCcgfHwKICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHJlcGxhY2VyLmxlbmd0aCAhPT0gJ251bWJlcicpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0pTT04uc3RyaW5naWZ5Jyk7CiAgICAgICAgICAgIH0KCi8vIE1ha2UgYSBmYWtlIHJvb3Qgb2JqZWN0IGNvbnRhaW5pbmcgb3VyIHZhbHVlIHVuZGVyIHRoZSBrZXkgb2YgJycuCi8vIFJldHVybiB0aGUgcmVzdWx0IG9mIHN0cmluZ2lmeWluZyB0aGUgdmFsdWUuCgogICAgICAgICAgICByZXR1cm4gc3RyKCcnLCB7Jyc6IHZhbHVlfSk7CiAgICAgICAgfTsKICAgIH0KCgovLyBJZiB0aGUgSlNPTiBvYmplY3QgZG9lcyBub3QgeWV0IGhhdmUgYSBwYXJzZSBtZXRob2QsIGdpdmUgaXQgb25lLgoKICAgIGlmICh0eXBlb2YgSlNPTi5wYXJzZSAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgIEpTT04ucGFyc2UgPSBmdW5jdGlvbiAodGV4dCwgcmV2aXZlcikgewoKLy8gVGhlIHBhcnNlIG1ldGhvZCB0YWtlcyBhIHRleHQgYW5kIGFuIG9wdGlvbmFsIHJldml2ZXIgZnVuY3Rpb24sIGFuZCByZXR1cm5zCi8vIGEgSmF2YVNjcmlwdCB2YWx1ZSBpZiB0aGUgdGV4dCBpcyBhIHZhbGlkIEpTT04gdGV4dC4KCiAgICAgICAgICAgIHZhciBqOwoKICAgICAgICAgICAgZnVuY3Rpb24gd2Fsayhob2xkZXIsIGtleSkgewoKLy8gVGhlIHdhbGsgbWV0aG9kIGlzIHVzZWQgdG8gcmVjdXJzaXZlbHkgd2FsayB0aGUgcmVzdWx0aW5nIHN0cnVjdHVyZSBzbwovLyB0aGF0IG1vZGlmaWNhdGlvbnMgY2FuIGJlIG1hZGUuCgogICAgICAgICAgICAgICAgdmFyIGssIHYsIHZhbHVlID0gaG9sZGVyW2tleV07CiAgICAgICAgICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgICAgIGZvciAoayBpbiB2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodmFsdWUsIGspKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID0gd2Fsayh2YWx1ZSwgayk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVba10gPSB2OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdmFsdWVba107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gcmV2aXZlci5jYWxsKGhvbGRlciwga2V5LCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGV4dCA9IFN0cmluZyh0ZXh0KTsKCi8vIFBhcnNpbmcgaGFwcGVucyBpbiBmb3VyIHN0YWdlcy4gSW4gdGhlIGZpcnN0IHN0YWdlLCB3ZSByZXBsYWNlIGNlcnRhaW4KLy8gVW5pY29kZSBjaGFyYWN0ZXJzIHdpdGggZXNjYXBlIHNlcXVlbmNlcy4gSmF2YVNjcmlwdCBoYW5kbGVzIG1hbnkgY2hhcmFjdGVycwovLyBpbmNvcnJlY3RseSwgZWl0aGVyIHNpbGVudGx5IGRlbGV0aW5nIHRoZW0sIG9yIHRyZWF0aW5nIHRoZW0gYXMgbGluZSBlbmRpbmdzLgoKICAgICAgICAgICAgY3gubGFzdEluZGV4ID0gMDsKICAgICAgICAgICAgaWYgKGN4LnRlc3QodGV4dCkpIHsKICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoY3gsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdcXHUnICsKICAgICAgICAgICAgICAgICAgICAgICAgKCcwMDAwJyArIGEuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgovLyBJbiB0aGUgc2Vjb25kIHN0YWdlLCB3ZSBydW4gdGhlIHRleHQgYWdhaW5zdCByZWd1bGFyIGV4cHJlc3Npb25zIHRoYXQgbG9vawovLyBmb3Igbm9uLUpTT04gcGF0dGVybnMuIFdlIGFyZSBlc3BlY2lhbGx5IGNvbmNlcm5lZCB3aXRoICcoKScgYW5kICduZXcnCi8vIGJlY2F1c2UgdGhleSBjYW4gY2F1c2UgaW52b2NhdGlvbiwgYW5kICc9JyBiZWNhdXNlIGl0IGNhbiBjYXVzZSBtdXRhdGlvbi4KLy8gQnV0IGp1c3QgdG8gYmUgc2FmZSwgd2Ugd2FudCB0byByZWplY3QgYWxsIHVuZXhwZWN0ZWQgZm9ybXMuCgovLyBXZSBzcGxpdCB0aGUgc2Vjb25kIHN0YWdlIGludG8gNCByZWdleHAgb3BlcmF0aW9ucyBpbiBvcmRlciB0byB3b3JrIGFyb3VuZAovLyBjcmlwcGxpbmcgaW5lZmZpY2llbmNpZXMgaW4gSUUncyBhbmQgU2FmYXJpJ3MgcmVnZXhwIGVuZ2luZXMuIEZpcnN0IHdlCi8vIHJlcGxhY2UgdGhlIEpTT04gYmFja3NsYXNoIHBhaXJzIHdpdGggJ0AnIChhIG5vbi1KU09OIGNoYXJhY3RlcikuIFNlY29uZCwgd2UKLy8gcmVwbGFjZSBhbGwgc2ltcGxlIHZhbHVlIHRva2VucyB3aXRoICddJyBjaGFyYWN0ZXJzLiBUaGlyZCwgd2UgZGVsZXRlIGFsbAovLyBvcGVuIGJyYWNrZXRzIHRoYXQgZm9sbG93IGEgY29sb24gb3IgY29tbWEgb3IgdGhhdCBiZWdpbiB0aGUgdGV4dC4gRmluYWxseSwKLy8gd2UgbG9vayB0byBzZWUgdGhhdCB0aGUgcmVtYWluaW5nIGNoYXJhY3RlcnMgYXJlIG9ubHkgd2hpdGVzcGFjZSBvciAnXScgb3IKLy8gJywnIG9yICc6JyBvciAneycgb3IgJ30nLiBJZiB0aGF0IGlzIHNvLCB0aGVuIHRoZSB0ZXh0IGlzIHNhZmUgZm9yIGV2YWwuCgogICAgICAgICAgICBpZiAoL15bXF0sOnt9XHNdKiQvLgp0ZXN0KHRleHQucmVwbGFjZSgvXFwoPzpbIlxcXC9iZm5ydF18dVswLTlhLWZBLUZdezR9KS9nLCAnQCcpLgpyZXBsYWNlKC8iW14iXFxcblxyXSoifHRydWV8ZmFsc2V8bnVsbHwtP1xkKyg/OlwuXGQqKT8oPzpbZUVdWytcLV0/XGQrKT8vZywgJ10nKS4KcmVwbGFjZSgvKD86Xnw6fCwpKD86XHMqXFspKy9nLCAnJykpKSB7CgovLyBJbiB0aGUgdGhpcmQgc3RhZ2Ugd2UgdXNlIHRoZSBldmFsIGZ1bmN0aW9uIHRvIGNvbXBpbGUgdGhlIHRleHQgaW50byBhCi8vIEphdmFTY3JpcHQgc3RydWN0dXJlLiBUaGUgJ3snIG9wZXJhdG9yIGlzIHN1YmplY3QgdG8gYSBzeW50YWN0aWMgYW1iaWd1aXR5Ci8vIGluIEphdmFTY3JpcHQ6IGl0IGNhbiBiZWdpbiBhIGJsb2NrIG9yIGFuIG9iamVjdCBsaXRlcmFsLiBXZSB3cmFwIHRoZSB0ZXh0Ci8vIGluIHBhcmVucyB0byBlbGltaW5hdGUgdGhlIGFtYmlndWl0eS4KCiAgICAgICAgICAgICAgICBqID0gZXZhbCgnKCcgKyB0ZXh0ICsgJyknKTsKCi8vIEluIHRoZSBvcHRpb25hbCBmb3VydGggc3RhZ2UsIHdlIHJlY3Vyc2l2ZWx5IHdhbGsgdGhlIG5ldyBzdHJ1Y3R1cmUsIHBhc3NpbmcKLy8gZWFjaCBuYW1lL3ZhbHVlIHBhaXIgdG8gYSByZXZpdmVyIGZ1bmN0aW9uIGZvciBwb3NzaWJsZSB0cmFuc2Zvcm1hdGlvbi4KCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHJldml2ZXIgPT09ICdmdW5jdGlvbicgPwogICAgICAgICAgICAgICAgICAgIHdhbGsoeycnOiBqfSwgJycpIDogajsKICAgICAgICAgICAgfQoKLy8gSWYgdGhlIHRleHQgaXMgbm90IEpTT04gcGFyc2VhYmxlLCB0aGVuIGEgU3ludGF4RXJyb3IgaXMgdGhyb3duLgoKICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCdKU09OLnBhcnNlJyk7CiAgICAgICAgfTsKICAgIH0KfSgpKTsKCgovLyBBdWdtZW50IHRoZSBiYXNpYyBwcm90b3R5cGVzIGlmIHRoZXkgaGF2ZSBub3QgYWxyZWFkeSBiZWVuIGF1Z21lbnRlZC4KLy8gVGhlc2UgZm9ybXMgYXJlIG9ic29sZXRlLiBJdCBpcyByZWNvbW1lbmRlZCB0aGF0IEpTT04uc3RyaW5naWZ5IGFuZAovLyBKU09OLnBhcnNlIGJlIHVzZWQgaW5zdGVhZC4KCmlmICghT2JqZWN0LnByb3RvdHlwZS50b0pTT05TdHJpbmcpIHsKICAgIE9iamVjdC5wcm90b3R5cGUudG9KU09OU3RyaW5nID0gZnVuY3Rpb24gKGZpbHRlcikgewogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLCBmaWx0ZXIpOwogICAgfTsKICAgIE9iamVjdC5wcm90b3R5cGUucGFyc2VKU09OID0gZnVuY3Rpb24gKGZpbHRlcikgewogICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMsIGZpbHRlcik7CiAgICB9Owp9",
	"list.css": "LyoKIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgR1BMdjMKIENvcHlyaWdodCAyMDEwLCBBbGVzc2FuZHJvIEFyemlsbGkKICovCgoqIHsKICAgIGZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOwp9CgoucG9wdXAgewogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7Cn0KCnRhYmxlIHsKICAgIGZvbnQtc2l6ZTogMTBwdDsKfQoKLnByY2hhbmdlID4gdGQgewogICAgcGFkZGluZy10b3A6IDEwcHg7CiAgICBmb250LXNpemU6IGxhcmdlOwogICAgZm9udC13ZWlnaHQ6IGJvbGQ7Cn0KCi5lbnRyeSB7CiAgICBiYWNrZ3JvdW5kOiBub25lIHJlcGVhdCBzY3JvbGwgMCAwICNGM0Y1RkM7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjQ0NDQ0NDOwp9CgouZW50cnkgPiB0ZCB7CiAgICBwYWRkaW5nOiA0cHg7Cn0KCi5ldGl0bGUgewogICAgd2lkdGg6IDY1JTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwp9CgouZXRpdGxlID4gYSB7CiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7CiAgICBjb2xvcjogYmxhY2s7Cn0KCi5wcmlvcml0eWJ1dHRvbiB7CiAgICB3aWR0aDogNjBweDsKICAgIGNvbG9yOiBibGFjazsKfQoKLnByaW9yaXR5Y2xhc3NfTk9XIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JlZW47Cn0KLnByaW9yaXR5Y2xhc3NfTEFURVIgewogICAgYmFja2dyb3VuZC1jb2xvcjogeWVsbG93Owp9Ci5wcmlvcml0eWNsYXNzX1RJTUVEIHsKICAgIGJhY2tncm91bmQtY29sb3I6IG9yYW5nZTsKfQoucHJpb3JpdHljbGFzc19ET05FIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JheTsKfQoucHJpb3JpdHljbGFzc19TVElDS1kgewogICAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRibHVlOwp9Ci5wcmlvcml0eWNsYXNzX05PVEVTIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Ymx1ZTsKfQoKLnNjcmVycm9yIHsKICAgIGNvbG9yOiByZWQ7CiAgICBmb250LXdlaWdodDogYm9sZDsKfQo=",
	"listcommon.css": "LmFkdm1lbnUgewogIGZsb2F0OiByaWdodDsKICBmb250LXNpemU6IHgtc21hbGw7CiAgdGV4dC1hbGlnbjogcmlnaHQ7Cn0KCi5tYWlubWVudSB7CiAgZm9udC1zaXplOiBzbWFsbDsKICBkaXNwbGF5OiBpbmxpbmU7Cn0KCi5tYWlubWVudV9pdGVtIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgcGFkZGluZy1sZWZ0OiAxMHB4OwogIGRpc3BsYXk6IGlubGluZTsKfQoKLnBvcHVwIHsKICBwYWRkaW5nOiA4cHg7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMjBweDsKICB6LWluZGV4OiA5MDAwOwogIGRpc3BsYXk6IG5vbmU7Cn0KCi5wb3BidXR0b25zIHsKICBmbG9hdDogcmlnaHQ7Cn0KCi5rZXlpbmZvIHsKICBmb250LXNpemU6IHgtc21hbGw7Cn0KCi5uYXZsaXN0IHsKICBsaXN0LXN0eWxlLWltYWdlOiBub25lOwogIGxpc3Qtc3R5bGUtdHlwZTogbm9uZTsKICBsaXN0LXN0eWxlLXBvc2l0aW9uOiBpbnNpZGU7CiAgcGFkZGluZy1sZWZ0OiAwcHg7Cn0KCi5tYWludGFibGUgewogIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgd2lkdGg6IDEwMCU7Cn0KCi5lZGl0b3Igewp9CgoKLmVkaXRvciBpbnB1dFtuYW1lPSJlZHRpdGxlIl0gewogIHdpZHRoOiA5OSU7CiAgbWFyZ2luLWJvdHRvbTogNXB4OwogIG1hcmdpbi10b3A6IDVweDsKfQoKLmVkaXRvciB0ZXh0YXJlYVtuYW1lPSJlZHRleHQiXSB7CiAgd2lkdGg6IDY1JTsKICBtYXJnaW4tcmlnaHQ6IDElOwogIGRpc3BsYXk6IGlubGluZTsKfQoKLmVkaXRvciB0ZXh0YXJlYVtuYW1lPSJlZGNvbHMiXSB7CiAgd2lkdGg6IDMyJTsKICBkaXNwbGF5OiBpbmxpbmU7Cn0KCi5zY3JlcnJvciB7CiAgcGFkZGluZzogMTVweDsKfQoK",
	"loading.gif": "R0lGODlhEAAQAPIAAP///xos9sjM/FVi+Bos9nF9+Y6X+p2k+iH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==",
	"static-test.html": "PCFET0NUWVBFIGh0bWw+CjxodG1sPgogIDxoZWFkPgogICAgPHRpdGxlPlRoaXMgaXMgYSB0ZXN0IGZvciBzZXJ2ZTwvdGl0bGU+CiAgPC9oZWFkPgogIDxib2R5PgogICAgVGhpcyBpcyBhIHRlc3QgZm9yIHNlcnZlCiAgPC9ib2R5Pgo8L2h0bWw+Cg==",
	"tlist.css": "LyoKICAgZm9yZWdyb3VuZDogc2lsdmVyCiAgIGJhY2tncm91bmQgbGlnaHQgMTogIzE2M0E1OQogICBiYWNrZ3JvdW5kIGxpZ2h0IDI6ICMwRjMwNEQKCiAgIGZvcmVncm91bmQgZGFyayAxOiAjNjdBQkU1CiAgIGZvcmVncm91bmQgZGFyayAyOiAjNEM4OUJFCiovCgoKLyoKIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgR1BMdjMKIENvcHlyaWdodCAyMDEwLCBBbGVzc2FuZHJvIEFyemlsbGkKICovCgoqIHsKICAgIGZvbnQtZmFtaWx5OiB1YnVudHUsIHNhbnMtc2VyaWY7Cn0KCmEgewogICAgY29sb3I6ICM0Qzg5QkU7Cn0KCmJvZHkgewogICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7CiAgICBjb2xvcjogc2lsdmVyOwogICAgZm9udC1zaXplOiAxMHB0Owp9CgoucG9wdXAgewogICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7CiAgICBib3JkZXI6IHRoaW4gc29saWQgd2hpdGU7Cn0KCnRhYmxlIHsKICAgIGZvbnQtc2l6ZTogMTBwdDsKfQoKLmNvbG5hbWUgewogICAgZm9udC1zaXplOiBub3JtYWw7CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIHBhZGRpbmctdG9wOiAxMHB4Owp9CgoucHJjaGFuZ2UgewogICAgcGFkZGluZy10b3A6IDEwcHg7CiAgICBmb250LXNpemU6IGxhcmdlOwogICAgZm9udC13ZWlnaHQ6IGJvbGQ7Cn0KCi5lbnRyeSB7CiAgICBiYWNrZ3JvdW5kOiBub25lIHJlcGVhdCBzY3JvbGwgMCAwICMxNjNBNTk7CiAgICBib3JkZXI6IDFweCBzb2xpZCBibGFjazsKfQoKLm9kZGVudHJ5IHsKICAgIGJhY2tncm91bmQtY29sb3I6ICMwRjMwNEQ7CiAgICBib3JkZXItY29sb3I6IGJsYWNrOwp9CgouZW50cnkgPiB0ZCB7CiAgICBwYWRkaW5nOiA0cHg7Cn0KCi5ldGl0bGUgewogICAgd2lkdGg6IDY1JTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwp9CgouZXRpdGxlID4gYSB7CiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7CiAgICBjb2xvcjogc2lsdmVyOwp9CgoucHJpb3JpdHlidXR0b24gewogICAgZm9udC13ZWlnaHQ6IGJvbGRlcjsKICAgIGZvbnQtc2l6ZTogeHgtc21hbGw7CiAgICB3aWR0aDogNjBweDsgCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsKfQoKLnByaW9yaXR5Y2xhc3NfTk9XIHsKICAgIGNvbG9yOiAjMEZENDAwOwp9Ci5wcmlvcml0eWNsYXNzX0xBVEVSIHsKICAgIGNvbG9yOiB5ZWxsb3c7Cn0KLnByaW9yaXR5Y2xhc3NfVElNRUQgewogICAgY29sb3I6IG9yYW5nZTsKfQoucHJpb3JpdHljbGFzc19ET05FIHsKICAgIGNvbG9yOiBsaWdodGJsdWU7Cn0KLnByaW9yaXR5Y2xhc3NfU1RJQ0tZIHsKICAgIGNvbG9yOiBsaWdodGJsdWU7Cn0KLnByaW9yaXR5Y2xhc3NfTk9URVMgewogICAgY29sb3I6IGxpZ2h0Ymx1ZTsKfQoKLnNjcmVycm9yIHsKICAgIGNvbG9yOiByZWQ7CiAgICBmb250LXdlaWdodDogYm9sZDsKfQoKLmNvZGUgewogICAgZm9udC1mYW1pbHk6IG9jcmExMCwgbW9ub3NwYWNlOwogICAgLW1vei1mb250LWZlYXR1cmUtc2V0dGluZ3M6ICJsaWdhPTAiOwp9Cgouc3RhdHN0YWJsZSB7CiAgICBtYXJnaW4tdG9wOiA0MHB4Owp9",
}

var SUMS map[string]string = map[string]string{
	"static-test.html": "a330454d4971fbf845449c94e79ccd2b",
	"json.js": "6e0f67dbbfc82ae0d7fe8500f501e426",
	"dlist.css": "e436d33207624ab54ead4597106935ef",
	"listcommon.css": "3b3c99eeabd58de3fdcc0f36f8a7c1af",
	"fullcalendar.js": "f045c36078c001ec90263d4b451cd4a6",
	"cal.css": "53b663269d3aae83e596517d9d8e16f0",
	"tlist.css": "4df38a3831ddd948cf0c353c929721bb",
	"advanced.html": "553cb724bfaea5297a58f2169e718910",
	"calendar.css": "2d71f637876918339d72c00b9d3e938c",
	"fullcalendar.css": "7848b967f5ce995416bcbb2352e0f8df",
	"jquery-ui-custom.js": "fcd09953f3ac46e9070a0703d29e4150",
	"cint.js": "251e4c45126c5244d860c8fecaead85c",
	"jquery.js": "73a9c334c5ca71d70d092b42064f6476",
	"int.js": "ffe1db70cc5e23d1c1fc6a5dc546dfb0",
	"list.css": "af9967ee55f543553627280b454eb515",
	"loading.gif": "114b90725e0e3a0b9bb1aeafef309eaf",
	"calendar.js": "dbceb8b1123c38cd14d76743f20b9d96",
}

