package main

var FILES map[string]string = map[string]string{
	"static-test.html": "PGh0bWw+CiAgPGhlYWQ+CiAgICA8dGl0bGU+VGhpcyBpcyBhIHRlc3QgZm9yIHNlcnZlPC90aXRsZT4KICA8L2hlYWQ+CiAgPGJvZHk+CiAgICBUaGlzIGlzIGEgdGVzdCBmb3Igc2VydmUKICA8L2JvZHk+CjwvaHRtbD4K",
	"list.css": "KiB7CiAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsKfQoKdGFibGUgewogICAgZm9udC1zaXplOiAxMHB0Owp9CgoucHJjaGFuZ2UgPiB0ZCB7CiAgICBwYWRkaW5nLXRvcDogMTBweDsKICAgIGZvbnQtc2l6ZTogbGFyZ2U7CiAgICBmb250LXdlaWdodDogYm9sZDsKfQoKLmVudHJ5IHsKICAgIGJhY2tncm91bmQ6IG5vbmUgcmVwZWF0IHNjcm9sbCAwIDAgI0YzRjVGQzsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNDQ0NDQ0M7Cn0KCi5lbnRyeSA+IHRkIHsKICAgIHBhZGRpbmc6IDRweDsKfQoKLmVpZCB7CiAgICB3aWR0aDogMTUlOwogICAgZm9udC1zaXplOiBzbWFsbDsKfQouZXRpdGxlIHsKICAgIHdpZHRoOiA1MCU7CiAgICBmb250LXdlaWdodDogYm9sZDsKfQouZXByIHsKICAgIHdpZHRoOiAxMCU7Cn0KLmV0aW1lIHsKICAgIHdpZHRoOiAyNSU7Cn0KCi5wcmlvcml0eWNsYXNzX25vdyB7CiAgICB3aWR0aDogNjBweDsKICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JlZW47Cn0KLnByaW9yaXR5Y2xhc3NfbGF0ZXIgewogICAgd2lkdGg6IDYwcHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7Cn0KLnByaW9yaXR5Y2xhc3NfdGltZWQgewogICAgd2lkdGg6IDYwcHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBvcmFuZ2U7Cn0KLnByaW9yaXR5Y2xhc3NfZG9uZSB7CiAgICB3aWR0aDogNjBweDsKICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JheTsKfQoucHJpb3JpdHljbGFzc19zdGlja3kgewogICAgd2lkdGg6IDYwcHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGJsdWU7Cn0KLnByaW9yaXR5Y2xhc3Nfbm90ZXMgewogICAgd2lkdGg6IDYwcHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGJsdWU7Cn0K",
	"dlist.css": "KiB7CiAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsKfQoKYSB7CiAgICBjb2xvcjogY3lhbjsKfQoKYm9keSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMkQyODI4OwogICAgY29sb3I6ICNFQUU4RTk7CiAgICBmb250LXNpemU6IDhwdDsKfQoKdGFibGUgewogICAgZm9udC1zaXplOiA4cHQ7Cn0KCi5wcmNoYW5nZSA+IHRkIHsKICAgIHBhZGRpbmctdG9wOiAxMHB4OwogICAgZm9udC1zaXplOiBsYXJnZTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwp9CgouZW50cnkgewogICAgYmFja2dyb3VuZDogbm9uZSByZXBlYXQgc2Nyb2xsIDAgMCAjNTU1NTU1OwogICAgYm9yZGVyOiAxcHggc29saWQgIzQ0NDQ0NDsKfQoKLmVudHJ5ID4gdGQgewogICAgcGFkZGluZzogNHB4Owp9CgouZWlkIHsKICAgIHdpZHRoOiAxNSU7CiAgICBmb250LXNpemU6IHNtYWxsOwp9Ci5ldGl0bGUgewogICAgd2lkdGg6IDUwJTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwp9Ci5lcHIgewogICAgd2lkdGg6IDEwJTsKfQouZXRpbWUgewogICAgd2lkdGg6IDI1JTsKfQoKLnByaW9yaXR5Y2xhc3Nfbm93IHsKICAgIHdpZHRoOiA2MHB4OwogICAgY29sb3I6IGJsYWNrOwogICAgYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47Cn0KLnByaW9yaXR5Y2xhc3NfbGF0ZXIgewogICAgd2lkdGg6IDYwcHg7CiAgICBjb2xvcjogYmxhY2s7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7Cn0KLnByaW9yaXR5Y2xhc3NfdGltZWQgewogICAgd2lkdGg6IDYwcHg7CiAgICBjb2xvcjogYmxhY2s7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBvcmFuZ2U7Cn0KLnByaW9yaXR5Y2xhc3NfZG9uZSB7CiAgICB3aWR0aDogNjBweDsKICAgIGNvbG9yOiBibGFjazsKICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JheTsKfQoucHJpb3JpdHljbGFzc19zdGlja3kgewogICAgd2lkdGg6IDYwcHg7CiAgICBjb2xvcjogYmxhY2s7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGJsdWU7Cn0KLnByaW9yaXR5Y2xhc3Nfbm90ZXMgewogICAgd2lkdGg6IDYwcHg7CiAgICBjb2xvcjogYmxhY2s7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGJsdWU7Cn0K",
	"int.js": "ZnVuY3Rpb24gc2V0dXAodGxuYW1lKSB7CiAgICBzaG9ydGN1dC5hZGQoIkFsdCtzIiwgZnVuY3Rpb24oKSB7IHNhdmVfb3Blbl9lZGl0b3IodGxuYW1lLCBmYWxzZSk7IH0pOwp9CgpmdW5jdGlvbiByZW1vdmVfZW50cnkodGFza2xpc3QsIG5hbWUpIHsKICAgIHZhciByZXEgPSBYTUxIdHRwUmVxdWVzdCgpOwogICAgcmVxLm9wZW4oIkdFVCIsICJyZW1vdmU/aWQ9IiArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICImdGw9IiArIGVuY29kZVVSSUNvbXBvbmVudCh0YXNrbGlzdCksIHRydWUpOwogICAgcmVxLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIGlmIChyZXEucmVhZHlTdGF0ZSA9PSA0KSB7CiAgICAgICAgICAgIGlmIChyZXEucmVzcG9uc2VUZXh0Lm1hdGNoKC9ecmVtb3ZlZC8pKSB7CiAgICAgICAgICAgICAgICB2YXIgbWFpbnRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1haW50YWJsZSIpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBtYWludGFibGUucm93cykgewogICAgICAgICAgICAgICAgICAgIGlmIChtYWludGFibGUucm93c1tpXSA9PSBudWxsKSBjb250aW51ZTsgLy8gZGVsZXRlZCByb3dzCiAgICAgICAgICAgICAgICAgICAgaWYgKG1haW50YWJsZS5yb3dzW2ldLmlkID09IG51bGwpIGNvbnRpbnVlOyAvLyByb3dzIHdpdGhvdXQgaWQKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAobWFpbnRhYmxlLnJvd3NbaV0uaWQgPT0gImVkaXRvcl8iICsgbmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBtYWludGFibGUuZGVsZXRlUm93KGkpOwogICAgICAgICAgICAgICAgICAgICAgICBtYWludGFibGUuZGVsZXRlUm93KGktMSk7IC8vIHRoaXMgaXMgdGhlIHRpdGxlCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHZhciB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0c18iICsgdi5pZCk7CiAgICAgICAgICAgICAgICB0cy5pbm5lckhUTUwgPSAiUmVtb3ZlIGZhaWxlZDogIiArIHJlcS5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgcmVxLnNlbmQobnVsbCk7Cn0KCmZ1bmN0aW9uIHNhdmVfZWRpdG9yKHRhc2tsaXN0LCBmb3JtKSB7CiAgICBvYmogPSBuZXcgT2JqZWN0KCk7CiAgICBvYmoudGl0bGUgPSBmb3JtLmVsZW1lbnRzWydlZHRpdGxlJ10udmFsdWU7CiAgICBvYmoudGV4dCA9IGZvcm0uZWxlbWVudHNbJ2VkdGV4dCddLnZhbHVlOwogICAgb2JqLnRyaWdnZXJBdCA9IGZvcm0uZWxlbWVudHNbJ2VkYXQnXS52YWx1ZTsKICAgIG9iai5zb3J0ID0gZm9ybS5lbGVtZW50c1snZWRzb3J0J10udmFsdWU7CiAgICBvYmouaWQgPSBmb3JtLmVsZW1lbnRzWydlZGlkJ10udmFsdWU7CiAgICBvYmoucHJpb3JpdHkgPSBwYXJzZUludChmb3JtLmVsZW1lbnRzWydlZHByaW8nXS52YWx1ZSk7CiAgICBvYmouZnJlcSA9IGZvcm0uZWxlbWVudHNbJ2VkZnJlcSddLnZhbHVlOwogICAgb2JqLnRhc2tsaXN0ID0gdGFza2xpc3Q7CiAgICAKICAgIHZhciB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0c18iK29iai5pZCk7CiAgICB2YXIgcmVxID0gWE1MSHR0cFJlcXVlc3QoKTsKICAgIHJlcS5vcGVuKCJQT1NUIiwgIi9zYXZlIiwgdHJ1ZSk7CiAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHJlcS5yZWFkeVN0YXRlID09IDQpIHsKICAgICAgICAgICAgaWYgKHJlcS5yZXNwb25zZVRleHQubWF0Y2goL15zYXZlZC1hdC10aW1lc3RhbXA6IC8pKSB7CiAgICAgICAgICAgICAgICB0cy5pbm5lckhUTUwgPSByZXEucmVzcG9uc2VUZXh0LnN1YnN0cigic2F2ZWQtYXQtdGltZXN0YW1wOiAiLmxlbmd0aCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRzLmlubmVySFRNTCA9ICIgTEFTVCBTQVZFIEZBSUxFRDogIiArIHJlcS5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgcmVxLnNlbmQob2JqLnRvSlNPTlN0cmluZygpKQp9CgpmdW5jdGlvbiBhZGRfcm93KHRhc2tsaXN0LCBpZCkgewogICAgdmFyIHJlcSA9IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICByZXEub3BlbigiR0VUIiwgImh0bWxnZXQ/dHlwZT1hZGQmdGw9IiArIGVuY29kZVVSSUNvbXBvbmVudCh0YXNrbGlzdCkgKyAiJmlkPSIgKyBlbmNvZGVVUklDb21wb25lbnQoaWQpLCB0cnVlKTsKICAgIHJlcS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICBpZiAocmVxLnJlYWR5U3RhdGUgPT0gNCkgewogICAgICAgICAgICB2YXIgbmV3cm93cyA9IHJlcS5yZXNwb25zZVRleHQuc3BsaXQoIlx1MjAyOSIsIDIpOwoKICAgICAgICAgICAgdmFyIG1haW50YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYWludGFibGUiKTsKCiAgICAgICAgICAgIHZhciBuZXdyb3cxID0gbWFpbnRhYmxlLmluc2VydFJvdygwKQogICAgICAgICAgICBuZXdyb3cxLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAiZW50cnkiKQogICAgICAgICAgICBuZXdyb3cxLmlubmVySFRNTCA9IG5ld3Jvd3NbMF0KCiAgICAgICAgICAgIHZhciBuZXdyb3cyID0gbWFpbnRhYmxlLmluc2VydFJvdygxKQogICAgICAgICAgICBuZXdyb3cyLnNldEF0dHJpYnV0ZSgiaWQiLCAiZWRpdG9yXyIrZW5jb2RlVVJJQ29tcG9uZW50KGlkKSkKICAgICAgICAgICAgbmV3cm93Mi5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImVkaXRvciIpCiAgICAgICAgICAgIG5ld3JvdzIuc2V0QXR0cmlidXRlKCJzdHlsZSIsICJkaXNwbGF5OiBub25lIikKICAgICAgICAgICAgbmV3cm93Mi5pbm5lckhUTUwgPSBuZXdyb3dzWzFdCgogICAgICAgICAgICBzYXZlX29wZW5fZWRpdG9yKHRhc2tsaXN0LCB0cnVlKTsKICAgICAgICAgICAgLy90b2dnbGVfZWRpdG9yKHRhc2tsaXN0LCBpZCwgbnVsbCk7CiAgICAgICAgfQogICAgfQogICAgcmVxLnNlbmQobnVsbCkKfQoKZnVuY3Rpb24gYWRkX2VudHJ5KHRhc2tsaXN0KSB7CiAgICB2YXIgbmV0ZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ld2VudHJ5JykudmFsdWU7CgogICAgdmFyIHJlcSA9IFhNTEh0dHBSZXF1ZXN0KCkKICAgIHJlcS5vcGVuKCJHRVQiLCAicWFkZD90bD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHRhc2tsaXN0KSArICImdGV4dD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KG5ldGV4dCksIHRydWUpOwogICAgcmVxLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIGlmIChyZXEucmVhZHlTdGF0ZSA9PSA0KSB7CiAgICAgICAgICAgIGlmIChyZXEucmVzcG9uc2VUZXh0Lm1hdGNoKC9eYWRkZWQ6IC8pKSB7CiAgICAgICAgICAgICAgICBuZXdpZCA9IHJlcS5yZXNwb25zZVRleHQuc3Vic3RyKCJhZGRlZDogIi5sZW5ndGgpOwogICAgICAgICAgICAgICAgYWRkX3Jvdyh0YXNrbGlzdCwgbmV3aWQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXdlbnRyeScpLnZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCJBREQgRkFJTEVEOiAiICsgcmVxLnJlc3BvbnNlVGV4dCkKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICB9CiAgICB9OwogICAgcmVxLnNlbmQobnVsbCk7CiAgICByZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIGZpbGxfZWRpdG9yKHRhc2tsaXN0LCBuYW1lKSB7CiAgICB2YXIgZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdl8iK25hbWUpOwogICAgdmFyIHJlcSA9IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICByZXEub3BlbigiR0VUIiwgImdldD9pZD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgIiZ0bD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHRhc2tsaXN0KSwgdHJ1ZSk7CiAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHJlcS5yZWFkeVN0YXRlID09IDQpIHsKICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IHJlcS5yZXNwb25zZVRleHQuc3BsaXQoIlxuIiwgMilbMF07CiAgICAgICAgICAgIHZhciBqc29uT2JqID0gcmVxLnJlc3BvbnNlVGV4dC5zdWJzdHIodGltZXN0YW1wLmxlbmd0aCk7CiAgICAgICAgICAgIHYgPSBqc29uT2JqLnBhcnNlSlNPTigpOwogICAgICAgICAgICBlZC5lbGVtZW50c1snZWR0aXRsZSddLnZhbHVlID0gdi5UaXRsZTsKICAgICAgICAgICAgZWQuZWxlbWVudHNbJ2VkdGV4dCddLnZhbHVlID0gdi5UZXh0OwogICAgICAgICAgICBlZC5lbGVtZW50c1snZWRhdCddLnZhbHVlID0gdi5UcmlnZ2VyQXQ7CiAgICAgICAgICAgIGVkLmVsZW1lbnRzWydlZHNvcnQnXS52YWx1ZSA9IHYuU29ydDsKICAgICAgICAgICAgZWQuZWxlbWVudHNbJ2VkaWQnXS52YWx1ZSA9IHYuSWQ7CiAgICAgICAgICAgIGVkLmVsZW1lbnRzWydlZHByaW8nXS52YWx1ZSA9IHYuUHJpb3JpdHk7CiAgICAgICAgICAgIGVkLmVsZW1lbnRzWydlZGZyZXEnXS52YWx1ZSA9IHYuRnJlcTsKICAgICAgICAgICAgdmFyIHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRzXyIgKyB2LklkKTsKICAgICAgICAgICAgdHMuaW5uZXJIVE1MID0gdGltZXN0YW1wOwogICAgICAgIH0KICAgIH0KICAgIHJlcS5zZW5kKG51bGwpCn0KCmZ1bmN0aW9uIGVkaXRvcl9mcm9tX3Jvdyhyb3cpIHsKICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdl8iK3Jvdy5pZC5zdWJzdHIoImVkaXRvcl8iLmxlbmd0aCkpCn0KCmZ1bmN0aW9uIHNhdmVfb3Blbl9lZGl0b3IodGFza2xpc3QsIHNob3VsZF9jbG9zZV9lZGl0b3IpIHsKICAgIG9yb3dzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRyIik7CiAgICBmb3IgKHZhciBpIGluIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ciIpKSB7CiAgICAgICAgb3JvdyA9IG9yb3dzW2ldOwoKICAgICAgICBpZiAob3JvdyA9PSBudWxsKSBjb250aW51ZTsgLy8gZGVsZXRlZCByb3dzCiAgICAgICAgaWYgKG9yb3cuc3R5bGUgPT0gbnVsbCkgY29udGludWU7CiAgICAgICAgaWYgKG9yb3cuaWQgPT0gbnVsbCkgY29udGludWU7CiAgICAgICAgCiAgICAgICAgaWYgKChvcm93LmlkLm1hdGNoKC9eZWRpdG9yXy8pKSAmJiAob3Jvdy5zdHlsZVsnZGlzcGxheSddICE9ICdub25lJykpIHsKICAgICAgICAgICAgaWYgKHNob3VsZF9jbG9zZV9lZGl0b3IpIHsKICAgICAgICAgICAgICAgIGNsb3NlX2VkaXRvcih0YXNrbGlzdCwgb3JvdykKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNhdmVfZWRpdG9yKHRhc2tsaXN0LCBlZGl0b3JfZnJvbV9yb3cob3JvdykpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBzYXZlX2VkaXRvcl9ieV9pZCh0YXNrbGlzdCwgbmFtZSwgZXZlbnQpIHsKICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVkaXZfIituYW1lKTsKICAgIHNhdmVfZWRpdG9yKHRhc2tsaXN0LCBmb3JtKTsKfQoKZnVuY3Rpb24gY2xvc2VfZWRpdG9yKHRhc2tsaXN0LCByb3cpIHsKICAgIHNhdmVfZWRpdG9yKHRhc2tsaXN0LCBlZGl0b3JfZnJvbV9yb3cocm93KSk7CiAgICByb3cuc3R5bGVbJ2Rpc3BsYXknXSA9ICdub25lJzsKfQoKZnVuY3Rpb24gdG9nZ2xlX2VkaXRvcih0YXNrbGlzdCwgbmFtZSwgZXZlbnQpIHsKICAgIHZhciByb3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZWRpdG9yXyIrbmFtZSk7CiAgICBpZiAocm93LnN0eWxlWydkaXNwbGF5J10gPT0gJ25vbmUnKSB7CiAgICAgICAgb3Jvd3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgidHIiKTsKICAgICAgICBmb3IgKHZhciBpIGluIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ciIpKSB7CiAgICAgICAgICAgIG9yb3cgPSBvcm93c1tpXTsKCiAgICAgICAgICAgIGlmIChvcm93ID09IG51bGwpIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAob3Jvdy5zdHlsZSA9PSBudWxsKSBjb250aW51ZTsKICAgICAgICAgICAgaWYgKG9yb3cuaWQgPT0gbnVsbCkgY29udGludWU7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoKG9yb3cuaWQubWF0Y2goL15lZGl0b3JfLykpICYmIChvcm93LnN0eWxlWydkaXNwbGF5J10gIT0gJ25vbmUnKSkgewogICAgICAgICAgICAgICAgY2xvc2VfZWRpdG9yKHRhc2tsaXN0LCBvcm93KQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByb3cuc3R5bGVbJ2Rpc3BsYXknXSA9ICcnOwoKICAgICAgICBmaWxsX2VkaXRvcih0YXNrbGlzdCwgbmFtZSk7CiAgICB9IGVsc2UgewogICAgICAgIGNsb3NlX2VkaXRvcih0YXNrbGlzdCwgcm93KQogICAgfQp9CgpmdW5jdGlvbiBjaGFuZ2VfcHJpb3JpdHkodGFza2xpc3QsIG5hbWUsIGV2ZW50KSB7CiAgICB2YXIgcmVxID0gWE1MSHR0cFJlcXVlc3QoKTsKICAgIHJlcS5vcGVuKCJHRVQiLCAiY2hhbmdlLXByaW9yaXR5P2lkPSIgKyBlbmNvZGVVUklDb21wb25lbnQobmFtZSkgKyAiJnRsPSIgKyBlbmNvZGVVUklDb21wb25lbnQodGFza2xpc3QpICsgIiZzcGVjaWFsPSIgKyBldmVudC5zaGlmdEtleSwgdHJ1ZSk7CiAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHJlcS5yZWFkeVN0YXRlID09IDQpIHsKICAgICAgICAgICAgaWYgKHJlcS5yZXNwb25zZVRleHQubWF0Y2goL15wcmlvcml0eS1jaGFuZ2UtdG86IC8pKSB7CiAgICAgICAgICAgICAgICBwcmlvcml0eSA9IHJlcS5yZXNwb25zZVRleHQuc3Vic3RyKCJwcmlvcml0eS1jaGFuZ2UtdG86ICIubGVuZ3RoKTsKICAgICAgICAgICAgICAgIHZhciBlcHIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXByXycrbmFtZSk7CiAgICAgICAgICAgICAgICBlcHIuaW5uZXJIVE1MID0gcHJpb3JpdHk7CiAgICAgICAgICAgICAgICBlcHIuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJwcmlvcml0eWNsYXNzXyIgKyBwcmlvcml0eSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhbGVydChyZXEucmVzcG9uc2VUZXh0KQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgcmVxLnNlbmQobnVsbCkKfQo=",
	"shortcut.js": "LyoqCiAqIGh0dHA6Ly93d3cub3BlbmpzLmNvbS9zY3JpcHRzL2V2ZW50cy9rZXlib2FyZF9zaG9ydGN1dHMvCiAqIFZlcnNpb24gOiAyLjAxLkIKICogQnkgQmlubnkgViBBCiAqIExpY2Vuc2UgOiBCU0QKICovCnNob3J0Y3V0ID0gewoJJ2FsbF9zaG9ydGN1dHMnOnt9LC8vQWxsIHRoZSBzaG9ydGN1dHMgYXJlIHN0b3JlZCBpbiB0aGlzIGFycmF5CgknYWRkJzogZnVuY3Rpb24oc2hvcnRjdXRfY29tYmluYXRpb24sY2FsbGJhY2ssb3B0KSB7CgkJLy9Qcm92aWRlIGEgc2V0IG9mIGRlZmF1bHQgb3B0aW9ucwoJCXZhciBkZWZhdWx0X29wdGlvbnMgPSB7CgkJCSd0eXBlJzona2V5ZG93bicsCgkJCSdwcm9wYWdhdGUnOmZhbHNlLAoJCQknZGlzYWJsZV9pbl9pbnB1dCc6ZmFsc2UsCgkJCSd0YXJnZXQnOmRvY3VtZW50LAoJCQkna2V5Y29kZSc6ZmFsc2UKCQl9CgkJaWYoIW9wdCkgb3B0ID0gZGVmYXVsdF9vcHRpb25zOwoJCWVsc2UgewoJCQlmb3IodmFyIGRmbyBpbiBkZWZhdWx0X29wdGlvbnMpIHsKCQkJCWlmKHR5cGVvZiBvcHRbZGZvXSA9PSAndW5kZWZpbmVkJykgb3B0W2Rmb10gPSBkZWZhdWx0X29wdGlvbnNbZGZvXTsKCQkJfQoJCX0KCgkJdmFyIGVsZSA9IG9wdC50YXJnZXQ7CgkJaWYodHlwZW9mIG9wdC50YXJnZXQgPT0gJ3N0cmluZycpIGVsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdC50YXJnZXQpOwoJCXZhciB0aHMgPSB0aGlzOwoJCXNob3J0Y3V0X2NvbWJpbmF0aW9uID0gc2hvcnRjdXRfY29tYmluYXRpb24udG9Mb3dlckNhc2UoKTsKCgkJLy9UaGUgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIGF0IGtleXByZXNzCgkJdmFyIGZ1bmMgPSBmdW5jdGlvbihlKSB7CgkJCWUgPSBlIHx8IHdpbmRvdy5ldmVudDsKCQkJCgkJCWlmKG9wdFsnZGlzYWJsZV9pbl9pbnB1dCddKSB7IC8vRG9uJ3QgZW5hYmxlIHNob3J0Y3V0IGtleXMgaW4gSW5wdXQsIFRleHRhcmVhIGZpZWxkcwoJCQkJdmFyIGVsZW1lbnQ7CgkJCQlpZihlLnRhcmdldCkgZWxlbWVudD1lLnRhcmdldDsKCQkJCWVsc2UgaWYoZS5zcmNFbGVtZW50KSBlbGVtZW50PWUuc3JjRWxlbWVudDsKCQkJCWlmKGVsZW1lbnQubm9kZVR5cGU9PTMpIGVsZW1lbnQ9ZWxlbWVudC5wYXJlbnROb2RlOwoKCQkJCWlmKGVsZW1lbnQudGFnTmFtZSA9PSAnSU5QVVQnIHx8IGVsZW1lbnQudGFnTmFtZSA9PSAnVEVYVEFSRUEnKSByZXR1cm47CgkJCX0KCQoJCQkvL0ZpbmQgV2hpY2gga2V5IGlzIHByZXNzZWQKCQkJaWYgKGUua2V5Q29kZSkgY29kZSA9IGUua2V5Q29kZTsKCQkJZWxzZSBpZiAoZS53aGljaCkgY29kZSA9IGUud2hpY2g7CgkJCXZhciBjaGFyYWN0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUpLnRvTG93ZXJDYXNlKCk7CgkJCQoJCQlpZihjb2RlID09IDE4OCkgY2hhcmFjdGVyPSIsIjsgLy9JZiB0aGUgdXNlciBwcmVzc2VzICwgd2hlbiB0aGUgdHlwZSBpcyBvbmtleWRvd24KCQkJaWYoY29kZSA9PSAxOTApIGNoYXJhY3Rlcj0iLiI7IC8vSWYgdGhlIHVzZXIgcHJlc3NlcyAsIHdoZW4gdGhlIHR5cGUgaXMgb25rZXlkb3duCgoJCQl2YXIga2V5cyA9IHNob3J0Y3V0X2NvbWJpbmF0aW9uLnNwbGl0KCIrIik7CgkJCS8vS2V5IFByZXNzZWQgLSBjb3VudHMgdGhlIG51bWJlciBvZiB2YWxpZCBrZXlwcmVzc2VzIC0gaWYgaXQgaXMgc2FtZSBhcyB0aGUgbnVtYmVyIG9mIGtleXMsIHRoZSBzaG9ydGN1dCBmdW5jdGlvbiBpcyBpbnZva2VkCgkJCXZhciBrcCA9IDA7CgkJCQoJCQkvL1dvcmsgYXJvdW5kIGZvciBzdHVwaWQgU2hpZnQga2V5IGJ1ZyBjcmVhdGVkIGJ5IHVzaW5nIGxvd2VyY2FzZSAtIGFzIGEgcmVzdWx0IHRoZSBzaGlmdCtudW0gY29tYmluYXRpb24gd2FzIGJyb2tlbgoJCQl2YXIgc2hpZnRfbnVtcyA9IHsKCQkJCSJgIjoifiIsCgkJCQkiMSI6IiEiLAoJCQkJIjIiOiJAIiwKCQkJCSIzIjoiIyIsCgkJCQkiNCI6IiQiLAoJCQkJIjUiOiIlIiwKCQkJCSI2IjoiXiIsCgkJCQkiNyI6IiYiLAoJCQkJIjgiOiIqIiwKCQkJCSI5IjoiKCIsCgkJCQkiMCI6IikiLAoJCQkJIi0iOiJfIiwKCQkJCSI9IjoiKyIsCgkJCQkiOyI6IjoiLAoJCQkJIiciOiJcIiIsCgkJCQkiLCI6IjwiLAoJCQkJIi4iOiI+IiwKCQkJCSIvIjoiPyIsCgkJCQkiXFwiOiJ8IgoJCQl9CgkJCS8vU3BlY2lhbCBLZXlzIC0gYW5kIHRoZWlyIGNvZGVzCgkJCXZhciBzcGVjaWFsX2tleXMgPSB7CgkJCQknZXNjJzoyNywKCQkJCSdlc2NhcGUnOjI3LAoJCQkJJ3RhYic6OSwKCQkJCSdzcGFjZSc6MzIsCgkJCQkncmV0dXJuJzoxMywKCQkJCSdlbnRlcic6MTMsCgkJCQknYmFja3NwYWNlJzo4LAoJCgkJCQknc2Nyb2xsbG9jayc6MTQ1LAoJCQkJJ3Njcm9sbF9sb2NrJzoxNDUsCgkJCQknc2Nyb2xsJzoxNDUsCgkJCQknY2Fwc2xvY2snOjIwLAoJCQkJJ2NhcHNfbG9jayc6MjAsCgkJCQknY2Fwcyc6MjAsCgkJCQknbnVtbG9jayc6MTQ0LAoJCQkJJ251bV9sb2NrJzoxNDQsCgkJCQknbnVtJzoxNDQsCgkJCQkKCQkJCSdwYXVzZSc6MTksCgkJCQknYnJlYWsnOjE5LAoJCQkJCgkJCQknaW5zZXJ0Jzo0NSwKCQkJCSdob21lJzozNiwKCQkJCSdkZWxldGUnOjQ2LAoJCQkJJ2VuZCc6MzUsCgkJCQkKCQkJCSdwYWdldXAnOjMzLAoJCQkJJ3BhZ2VfdXAnOjMzLAoJCQkJJ3B1JzozMywKCQoJCQkJJ3BhZ2Vkb3duJzozNCwKCQkJCSdwYWdlX2Rvd24nOjM0LAoJCQkJJ3BkJzozNCwKCQoJCQkJJ2xlZnQnOjM3LAoJCQkJJ3VwJzozOCwKCQkJCSdyaWdodCc6MzksCgkJCQknZG93bic6NDAsCgkKCQkJCSdmMSc6MTEyLAoJCQkJJ2YyJzoxMTMsCgkJCQknZjMnOjExNCwKCQkJCSdmNCc6MTE1LAoJCQkJJ2Y1JzoxMTYsCgkJCQknZjYnOjExNywKCQkJCSdmNyc6MTE4LAoJCQkJJ2Y4JzoxMTksCgkJCQknZjknOjEyMCwKCQkJCSdmMTAnOjEyMSwKCQkJCSdmMTEnOjEyMiwKCQkJCSdmMTInOjEyMwoJCQl9CgkKCQkJdmFyIG1vZGlmaWVycyA9IHsgCgkJCQlzaGlmdDogeyB3YW50ZWQ6ZmFsc2UsIHByZXNzZWQ6ZmFsc2V9LAoJCQkJY3RybCA6IHsgd2FudGVkOmZhbHNlLCBwcmVzc2VkOmZhbHNlfSwKCQkJCWFsdCAgOiB7IHdhbnRlZDpmYWxzZSwgcHJlc3NlZDpmYWxzZX0sCgkJCQltZXRhIDogeyB3YW50ZWQ6ZmFsc2UsIHByZXNzZWQ6ZmFsc2V9CS8vTWV0YSBpcyBNYWMgc3BlY2lmaWMKCQkJfTsKICAgICAgICAgICAgICAgICAgICAgICAgCgkJCWlmKGUuY3RybEtleSkJbW9kaWZpZXJzLmN0cmwucHJlc3NlZCA9IHRydWU7CgkJCWlmKGUuc2hpZnRLZXkpCW1vZGlmaWVycy5zaGlmdC5wcmVzc2VkID0gdHJ1ZTsKCQkJaWYoZS5hbHRLZXkpCW1vZGlmaWVycy5hbHQucHJlc3NlZCA9IHRydWU7CgkJCWlmKGUubWV0YUtleSkgICBtb2RpZmllcnMubWV0YS5wcmVzc2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgCgkJCWZvcih2YXIgaT0wOyBrPWtleXNbaV0saTxrZXlzLmxlbmd0aDsgaSsrKSB7CgkJCQkvL01vZGlmaWVycwoJCQkJaWYoayA9PSAnY3RybCcgfHwgayA9PSAnY29udHJvbCcpIHsKCQkJCQlrcCsrOwoJCQkJCW1vZGlmaWVycy5jdHJsLndhbnRlZCA9IHRydWU7CgoJCQkJfSBlbHNlIGlmKGsgPT0gJ3NoaWZ0JykgewoJCQkJCWtwKys7CgkJCQkJbW9kaWZpZXJzLnNoaWZ0LndhbnRlZCA9IHRydWU7CgoJCQkJfSBlbHNlIGlmKGsgPT0gJ2FsdCcpIHsKCQkJCQlrcCsrOwoJCQkJCW1vZGlmaWVycy5hbHQud2FudGVkID0gdHJ1ZTsKCQkJCX0gZWxzZSBpZihrID09ICdtZXRhJykgewoJCQkJCWtwKys7CgkJCQkJbW9kaWZpZXJzLm1ldGEud2FudGVkID0gdHJ1ZTsKCQkJCX0gZWxzZSBpZihrLmxlbmd0aCA+IDEpIHsgLy9JZiBpdCBpcyBhIHNwZWNpYWwga2V5CgkJCQkJaWYoc3BlY2lhbF9rZXlzW2tdID09IGNvZGUpIGtwKys7CgkJCQkJCgkJCQl9IGVsc2UgaWYob3B0WydrZXljb2RlJ10pIHsKCQkJCQlpZihvcHRbJ2tleWNvZGUnXSA9PSBjb2RlKSBrcCsrOwoKCQkJCX0gZWxzZSB7IC8vVGhlIHNwZWNpYWwga2V5cyBkaWQgbm90IG1hdGNoCgkJCQkJaWYoY2hhcmFjdGVyID09IGspIGtwKys7CgkJCQkJZWxzZSB7CgkJCQkJCWlmKHNoaWZ0X251bXNbY2hhcmFjdGVyXSAmJiBlLnNoaWZ0S2V5KSB7IC8vU3R1cGlkIFNoaWZ0IGtleSBidWcgY3JlYXRlZCBieSB1c2luZyBsb3dlcmNhc2UKCQkJCQkJCWNoYXJhY3RlciA9IHNoaWZ0X251bXNbY2hhcmFjdGVyXTsgCgkJCQkJCQlpZihjaGFyYWN0ZXIgPT0gaykga3ArKzsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCQkKCQkJaWYoa3AgPT0ga2V5cy5sZW5ndGggJiYgCgkJCQkJCW1vZGlmaWVycy5jdHJsLnByZXNzZWQgPT0gbW9kaWZpZXJzLmN0cmwud2FudGVkICYmCgkJCQkJCW1vZGlmaWVycy5zaGlmdC5wcmVzc2VkID09IG1vZGlmaWVycy5zaGlmdC53YW50ZWQgJiYKCQkJCQkJbW9kaWZpZXJzLmFsdC5wcmVzc2VkID09IG1vZGlmaWVycy5hbHQud2FudGVkICYmCgkJCQkJCW1vZGlmaWVycy5tZXRhLnByZXNzZWQgPT0gbW9kaWZpZXJzLm1ldGEud2FudGVkKSB7CgkJCQljYWxsYmFjayhlKTsKCQoJCQkJaWYoIW9wdFsncHJvcGFnYXRlJ10pIHsgLy9TdG9wIHRoZSBldmVudAoJCQkJCS8vZS5jYW5jZWxCdWJibGUgaXMgc3VwcG9ydGVkIGJ5IElFIC0gdGhpcyB3aWxsIGtpbGwgdGhlIGJ1YmJsaW5nIHByb2Nlc3MuCgkJCQkJZS5jYW5jZWxCdWJibGUgPSB0cnVlOwoJCQkJCWUucmV0dXJuVmFsdWUgPSBmYWxzZTsKCQoJCQkJCS8vZS5zdG9wUHJvcGFnYXRpb24gd29ya3MgaW4gRmlyZWZveC4KCQkJCQlpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHsKCQkJCQkJZS5zdG9wUHJvcGFnYXRpb24oKTsKCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCX0KCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0KCQl9CgkJdGhpcy5hbGxfc2hvcnRjdXRzW3Nob3J0Y3V0X2NvbWJpbmF0aW9uXSA9IHsKCQkJJ2NhbGxiYWNrJzpmdW5jLCAKCQkJJ3RhcmdldCc6ZWxlLCAKCQkJJ2V2ZW50Jzogb3B0Wyd0eXBlJ10KCQl9OwoJCS8vQXR0YWNoIHRoZSBmdW5jdGlvbiB3aXRoIHRoZSBldmVudAoJCWlmKGVsZS5hZGRFdmVudExpc3RlbmVyKSBlbGUuYWRkRXZlbnRMaXN0ZW5lcihvcHRbJ3R5cGUnXSwgZnVuYywgZmFsc2UpOwoJCWVsc2UgaWYoZWxlLmF0dGFjaEV2ZW50KSBlbGUuYXR0YWNoRXZlbnQoJ29uJytvcHRbJ3R5cGUnXSwgZnVuYyk7CgkJZWxzZSBlbGVbJ29uJytvcHRbJ3R5cGUnXV0gPSBmdW5jOwoJfSwKCgkvL1JlbW92ZSB0aGUgc2hvcnRjdXQgLSBqdXN0IHNwZWNpZnkgdGhlIHNob3J0Y3V0IGFuZCBJIHdpbGwgcmVtb3ZlIHRoZSBiaW5kaW5nCgkncmVtb3ZlJzpmdW5jdGlvbihzaG9ydGN1dF9jb21iaW5hdGlvbikgewoJCXNob3J0Y3V0X2NvbWJpbmF0aW9uID0gc2hvcnRjdXRfY29tYmluYXRpb24udG9Mb3dlckNhc2UoKTsKCQl2YXIgYmluZGluZyA9IHRoaXMuYWxsX3Nob3J0Y3V0c1tzaG9ydGN1dF9jb21iaW5hdGlvbl07CgkJZGVsZXRlKHRoaXMuYWxsX3Nob3J0Y3V0c1tzaG9ydGN1dF9jb21iaW5hdGlvbl0pCgkJaWYoIWJpbmRpbmcpIHJldHVybjsKCQl2YXIgdHlwZSA9IGJpbmRpbmdbJ2V2ZW50J107CgkJdmFyIGVsZSA9IGJpbmRpbmdbJ3RhcmdldCddOwoJCXZhciBjYWxsYmFjayA9IGJpbmRpbmdbJ2NhbGxiYWNrJ107CgoJCWlmKGVsZS5kZXRhY2hFdmVudCkgZWxlLmRldGFjaEV2ZW50KCdvbicrdHlwZSwgY2FsbGJhY2spOwoJCWVsc2UgaWYoZWxlLnJlbW92ZUV2ZW50TGlzdGVuZXIpIGVsZS5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGNhbGxiYWNrLCBmYWxzZSk7CgkJZWxzZSBlbGVbJ29uJyt0eXBlXSA9IGZhbHNlOwoJfQp9",
	"json.js": "LyoKICAgIGpzb24uanMKICAgIDIwMTAtMDMtMjcKCiAgICBQdWJsaWMgRG9tYWluCgogICAgTm8gd2FycmFudHkgZXhwcmVzc2VkIG9yIGltcGxpZWQuIFVzZSBhdCB5b3VyIG93biByaXNrLgoKICAgIFRoaXMgZmlsZSBoYXMgYmVlbiBzdXBlcmNlZGVkIGJ5IGh0dHA6Ly93d3cuSlNPTi5vcmcvanNvbjIuanMKCiAgICBTZWUgaHR0cDovL3d3dy5KU09OLm9yZy9qcy5odG1sCgogICAgVGhpcyBjb2RlIHNob3VsZCBiZSBtaW5pZmllZCBiZWZvcmUgZGVwbG95bWVudC4KICAgIFNlZSBodHRwOi8vamF2YXNjcmlwdC5jcm9ja2ZvcmQuY29tL2pzbWluLmh0bWwKCiAgICBVU0UgWU9VUiBPV04gQ09QWS4gSVQgSVMgRVhUUkVNRUxZIFVOV0lTRSBUTyBMT0FEIENPREUgRlJPTSBTRVJWRVJTIFlPVSBETwogICAgTk9UIENPTlRST0wuCgogICAgVGhpcyBmaWxlIGFkZHMgdGhlc2UgbWV0aG9kcyB0byBKYXZhU2NyaXB0OgoKICAgICAgICBvYmplY3QudG9KU09OU3RyaW5nKHdoaXRlbGlzdCkKICAgICAgICAgICAgVGhpcyBtZXRob2QgcHJvZHVjZSBhIEpTT04gdGV4dCBmcm9tIGEgSmF2YVNjcmlwdCB2YWx1ZS4KICAgICAgICAgICAgSXQgbXVzdCBub3QgY29udGFpbiBhbnkgY3ljbGljYWwgcmVmZXJlbmNlcy4gSWxsZWdhbCB2YWx1ZXMKICAgICAgICAgICAgd2lsbCBiZSBleGNsdWRlZC4KCiAgICAgICAgICAgIFRoZSBkZWZhdWx0IGNvbnZlcnNpb24gZm9yIGRhdGVzIGlzIHRvIGFuIElTTyBzdHJpbmcuIFlvdSBjYW4KICAgICAgICAgICAgYWRkIGEgdG9KU09OU3RyaW5nIG1ldGhvZCB0byBhbnkgZGF0ZSBvYmplY3QgdG8gZ2V0IGEgZGlmZmVyZW50CiAgICAgICAgICAgIHJlcHJlc2VudGF0aW9uLgoKICAgICAgICAgICAgVGhlIG9iamVjdCBhbmQgYXJyYXkgbWV0aG9kcyBjYW4gdGFrZSBhbiBvcHRpb25hbCB3aGl0ZWxpc3QKICAgICAgICAgICAgYXJndW1lbnQuIEEgd2hpdGVsaXN0IGlzIGFuIGFycmF5IG9mIHN0cmluZ3MuIElmIGl0IGlzIHByb3ZpZGVkLAogICAgICAgICAgICBrZXlzIGluIG9iamVjdHMgbm90IGZvdW5kIGluIHRoZSB3aGl0ZWxpc3QgYXJlIGV4Y2x1ZGVkLgoKICAgICAgICBzdHJpbmcucGFyc2VKU09OKGZpbHRlcikKICAgICAgICAgICAgVGhpcyBtZXRob2QgcGFyc2VzIGEgSlNPTiB0ZXh0IHRvIHByb2R1Y2UgYW4gb2JqZWN0IG9yCiAgICAgICAgICAgIGFycmF5LiBJdCBjYW4gdGhyb3cgYSBTeW50YXhFcnJvciBleGNlcHRpb24uCgogICAgICAgICAgICBUaGUgb3B0aW9uYWwgZmlsdGVyIHBhcmFtZXRlciBpcyBhIGZ1bmN0aW9uIHdoaWNoIGNhbiBmaWx0ZXIgYW5kCiAgICAgICAgICAgIHRyYW5zZm9ybSB0aGUgcmVzdWx0cy4gSXQgcmVjZWl2ZXMgZWFjaCBvZiB0aGUga2V5cyBhbmQgdmFsdWVzLCBhbmQKICAgICAgICAgICAgaXRzIHJldHVybiB2YWx1ZSBpcyB1c2VkIGluc3RlYWQgb2YgdGhlIG9yaWdpbmFsIHZhbHVlLiBJZiBpdAogICAgICAgICAgICByZXR1cm5zIHdoYXQgaXQgcmVjZWl2ZWQsIHRoZW4gc3RydWN0dXJlIGlzIG5vdCBtb2RpZmllZC4gSWYgaXQKICAgICAgICAgICAgcmV0dXJucyB1bmRlZmluZWQgdGhlbiB0aGUgbWVtYmVyIGlzIGRlbGV0ZWQuCgogICAgICAgICAgICBFeGFtcGxlOgoKICAgICAgICAgICAgLy8gUGFyc2UgdGhlIHRleHQuIElmIGEga2V5IGNvbnRhaW5zIHRoZSBzdHJpbmcgJ2RhdGUnIHRoZW4KICAgICAgICAgICAgLy8gY29udmVydCB0aGUgdmFsdWUgdG8gYSBkYXRlLgoKICAgICAgICAgICAgbXlEYXRhID0gdGV4dC5wYXJzZUpTT04oZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBrZXkuaW5kZXhPZignZGF0ZScpID49IDAgPyBuZXcgRGF0ZSh2YWx1ZSkgOiB2YWx1ZTsKICAgICAgICAgICAgfSk7CgogICAgVGhpcyBmaWxlIHdpbGwgYnJlYWsgcHJvZ3JhbXMgd2l0aCBpbXByb3BlciBmb3IuLmluIGxvb3BzLiBTZWUKICAgIGh0dHA6Ly95dWlibG9nLmNvbS9ibG9nLzIwMDYvMDkvMjYvZm9yLWluLWludHJpZ3VlLwoKICAgIFRoaXMgZmlsZSBjcmVhdGVzIGEgZ2xvYmFsIEpTT04gb2JqZWN0IGNvbnRhaW5pbmcgdHdvIG1ldGhvZHM6IHN0cmluZ2lmeQogICAgYW5kIHBhcnNlLgoKICAgICAgICBKU09OLnN0cmluZ2lmeSh2YWx1ZSwgcmVwbGFjZXIsIHNwYWNlKQogICAgICAgICAgICB2YWx1ZSAgICAgICBhbnkgSmF2YVNjcmlwdCB2YWx1ZSwgdXN1YWxseSBhbiBvYmplY3Qgb3IgYXJyYXkuCgogICAgICAgICAgICByZXBsYWNlciAgICBhbiBvcHRpb25hbCBwYXJhbWV0ZXIgdGhhdCBkZXRlcm1pbmVzIGhvdyBvYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzIGFyZSBzdHJpbmdpZmllZCBmb3Igb2JqZWN0cy4gSXQgY2FuIGJlIGEKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gb3IgYW4gYXJyYXkgb2Ygc3RyaW5ncy4KCiAgICAgICAgICAgIHNwYWNlICAgICAgIGFuIG9wdGlvbmFsIHBhcmFtZXRlciB0aGF0IHNwZWNpZmllcyB0aGUgaW5kZW50YXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgb2YgbmVzdGVkIHN0cnVjdHVyZXMuIElmIGl0IGlzIG9taXR0ZWQsIHRoZSB0ZXh0IHdpbGwKICAgICAgICAgICAgICAgICAgICAgICAgYmUgcGFja2VkIHdpdGhvdXQgZXh0cmEgd2hpdGVzcGFjZS4gSWYgaXQgaXMgYSBudW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIGl0IHdpbGwgc3BlY2lmeSB0aGUgbnVtYmVyIG9mIHNwYWNlcyB0byBpbmRlbnQgYXQgZWFjaAogICAgICAgICAgICAgICAgICAgICAgICBsZXZlbC4gSWYgaXQgaXMgYSBzdHJpbmcgKHN1Y2ggYXMgJ1x0JyBvciAnJm5ic3A7JyksCiAgICAgICAgICAgICAgICAgICAgICAgIGl0IGNvbnRhaW5zIHRoZSBjaGFyYWN0ZXJzIHVzZWQgdG8gaW5kZW50IGF0IGVhY2ggbGV2ZWwuCgogICAgICAgICAgICBUaGlzIG1ldGhvZCBwcm9kdWNlcyBhIEpTT04gdGV4dCBmcm9tIGEgSmF2YVNjcmlwdCB2YWx1ZS4KCiAgICAgICAgICAgIFdoZW4gYW4gb2JqZWN0IHZhbHVlIGlzIGZvdW5kLCBpZiB0aGUgb2JqZWN0IGNvbnRhaW5zIGEgdG9KU09OCiAgICAgICAgICAgIG1ldGhvZCwgaXRzIHRvSlNPTiBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYW5kIHRoZSByZXN1bHQgd2lsbCBiZQogICAgICAgICAgICBzdHJpbmdpZmllZC4gQSB0b0pTT04gbWV0aG9kIGRvZXMgbm90IHNlcmlhbGl6ZTogaXQgcmV0dXJucyB0aGUKICAgICAgICAgICAgdmFsdWUgcmVwcmVzZW50ZWQgYnkgdGhlIG5hbWUvdmFsdWUgcGFpciB0aGF0IHNob3VsZCBiZSBzZXJpYWxpemVkLAogICAgICAgICAgICBvciB1bmRlZmluZWQgaWYgbm90aGluZyBzaG91bGQgYmUgc2VyaWFsaXplZC4gVGhlIHRvSlNPTiBtZXRob2QKICAgICAgICAgICAgd2lsbCBiZSBwYXNzZWQgdGhlIGtleSBhc3NvY2lhdGVkIHdpdGggdGhlIHZhbHVlLCBhbmQgdGhpcyB3aWxsIGJlCiAgICAgICAgICAgIGJvdW5kIHRvIHRoZSBvYmplY3QgaG9sZGluZyB0aGUga2V5LgoKICAgICAgICAgICAgRm9yIGV4YW1wbGUsIHRoaXMgd291bGQgc2VyaWFsaXplIERhdGVzIGFzIElTTyBzdHJpbmdzLgoKICAgICAgICAgICAgICAgIERhdGUucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBmKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9ybWF0IGludGVnZXJzIHRvIGhhdmUgYXQgbGVhc3QgdHdvIGRpZ2l0cy4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gPCAxMCA/ICcwJyArIG4gOiBuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VVRDRnVsbFllYXIoKSAgICsgJy0nICsKICAgICAgICAgICAgICAgICAgICAgICAgIGYodGhpcy5nZXRVVENNb250aCgpICsgMSkgKyAnLScgKwogICAgICAgICAgICAgICAgICAgICAgICAgZih0aGlzLmdldFVUQ0RhdGUoKSkgICAgICArICdUJyArCiAgICAgICAgICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDSG91cnMoKSkgICAgICsgJzonICsKICAgICAgICAgICAgICAgICAgICAgICAgIGYodGhpcy5nZXRVVENNaW51dGVzKCkpICAgKyAnOicgKwogICAgICAgICAgICAgICAgICAgICAgICAgZih0aGlzLmdldFVUQ1NlY29uZHMoKSkgICArICdaJzsKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICBZb3UgY2FuIHByb3ZpZGUgYW4gb3B0aW9uYWwgcmVwbGFjZXIgbWV0aG9kLiBJdCB3aWxsIGJlIHBhc3NlZCB0aGUKICAgICAgICAgICAga2V5IGFuZCB2YWx1ZSBvZiBlYWNoIG1lbWJlciwgd2l0aCB0aGlzIGJvdW5kIHRvIHRoZSBjb250YWluaW5nCiAgICAgICAgICAgIG9iamVjdC4gVGhlIHZhbHVlIHRoYXQgaXMgcmV0dXJuZWQgZnJvbSB5b3VyIG1ldGhvZCB3aWxsIGJlCiAgICAgICAgICAgIHNlcmlhbGl6ZWQuIElmIHlvdXIgbWV0aG9kIHJldHVybnMgdW5kZWZpbmVkLCB0aGVuIHRoZSBtZW1iZXIgd2lsbAogICAgICAgICAgICBiZSBleGNsdWRlZCBmcm9tIHRoZSBzZXJpYWxpemF0aW9uLgoKICAgICAgICAgICAgSWYgdGhlIHJlcGxhY2VyIHBhcmFtZXRlciBpcyBhbiBhcnJheSBvZiBzdHJpbmdzLCB0aGVuIGl0IHdpbGwgYmUKICAgICAgICAgICAgdXNlZCB0byBzZWxlY3QgdGhlIG1lbWJlcnMgdG8gYmUgc2VyaWFsaXplZC4gSXQgZmlsdGVycyB0aGUgcmVzdWx0cwogICAgICAgICAgICBzdWNoIHRoYXQgb25seSBtZW1iZXJzIHdpdGgga2V5cyBsaXN0ZWQgaW4gdGhlIHJlcGxhY2VyIGFycmF5IGFyZQogICAgICAgICAgICBzdHJpbmdpZmllZC4KCiAgICAgICAgICAgIFZhbHVlcyB0aGF0IGRvIG5vdCBoYXZlIEpTT04gcmVwcmVzZW50YXRpb25zLCBzdWNoIGFzIHVuZGVmaW5lZCBvcgogICAgICAgICAgICBmdW5jdGlvbnMsIHdpbGwgbm90IGJlIHNlcmlhbGl6ZWQuIFN1Y2ggdmFsdWVzIGluIG9iamVjdHMgd2lsbCBiZQogICAgICAgICAgICBkcm9wcGVkOyBpbiBhcnJheXMgdGhleSB3aWxsIGJlIHJlcGxhY2VkIHdpdGggbnVsbC4gWW91IGNhbiB1c2UKICAgICAgICAgICAgYSByZXBsYWNlciBmdW5jdGlvbiB0byByZXBsYWNlIHRob3NlIHdpdGggSlNPTiB2YWx1ZXMuCiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHVuZGVmaW5lZCkgcmV0dXJucyB1bmRlZmluZWQuCgogICAgICAgICAgICBUaGUgb3B0aW9uYWwgc3BhY2UgcGFyYW1ldGVyIHByb2R1Y2VzIGEgc3RyaW5naWZpY2F0aW9uIG9mIHRoZQogICAgICAgICAgICB2YWx1ZSB0aGF0IGlzIGZpbGxlZCB3aXRoIGxpbmUgYnJlYWtzIGFuZCBpbmRlbnRhdGlvbiB0byBtYWtlIGl0CiAgICAgICAgICAgIGVhc2llciB0byByZWFkLgoKICAgICAgICAgICAgSWYgdGhlIHNwYWNlIHBhcmFtZXRlciBpcyBhIG5vbi1lbXB0eSBzdHJpbmcsIHRoZW4gdGhhdCBzdHJpbmcgd2lsbAogICAgICAgICAgICBiZSB1c2VkIGZvciBpbmRlbnRhdGlvbi4gSWYgdGhlIHNwYWNlIHBhcmFtZXRlciBpcyBhIG51bWJlciwgdGhlbgogICAgICAgICAgICB0aGUgaW5kZW50YXRpb24gd2lsbCBiZSB0aGF0IG1hbnkgc3BhY2VzLgoKICAgICAgICAgICAgRXhhbXBsZToKCiAgICAgICAgICAgIHRleHQgPSBKU09OLnN0cmluZ2lmeShbJ2UnLCB7cGx1cmlidXM6ICd1bnVtJ31dKTsKICAgICAgICAgICAgLy8gdGV4dCBpcyAnWyJlIix7InBsdXJpYnVzIjoidW51bSJ9XScKCgogICAgICAgICAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkoWydlJywge3BsdXJpYnVzOiAndW51bSd9XSwgbnVsbCwgJ1x0Jyk7CiAgICAgICAgICAgIC8vIHRleHQgaXMgJ1tcblx0ImUiLFxuXHR7XG5cdFx0InBsdXJpYnVzIjogInVudW0iXG5cdH1cbl0nCgogICAgICAgICAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkoW25ldyBEYXRlKCldLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNba2V5XSBpbnN0YW5jZW9mIERhdGUgPwogICAgICAgICAgICAgICAgICAgICdEYXRlKCcgKyB0aGlzW2tleV0gKyAnKScgOiB2YWx1ZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIHRleHQgaXMgJ1siRGF0ZSgtLS1jdXJyZW50IHRpbWUtLS0pIl0nCgoKICAgICAgICBKU09OLnBhcnNlKHRleHQsIHJldml2ZXIpCiAgICAgICAgICAgIFRoaXMgbWV0aG9kIHBhcnNlcyBhIEpTT04gdGV4dCB0byBwcm9kdWNlIGFuIG9iamVjdCBvciBhcnJheS4KICAgICAgICAgICAgSXQgY2FuIHRocm93IGEgU3ludGF4RXJyb3IgZXhjZXB0aW9uLgoKICAgICAgICAgICAgVGhlIG9wdGlvbmFsIHJldml2ZXIgcGFyYW1ldGVyIGlzIGEgZnVuY3Rpb24gdGhhdCBjYW4gZmlsdGVyIGFuZAogICAgICAgICAgICB0cmFuc2Zvcm0gdGhlIHJlc3VsdHMuIEl0IHJlY2VpdmVzIGVhY2ggb2YgdGhlIGtleXMgYW5kIHZhbHVlcywKICAgICAgICAgICAgYW5kIGl0cyByZXR1cm4gdmFsdWUgaXMgdXNlZCBpbnN0ZWFkIG9mIHRoZSBvcmlnaW5hbCB2YWx1ZS4KICAgICAgICAgICAgSWYgaXQgcmV0dXJucyB3aGF0IGl0IHJlY2VpdmVkLCB0aGVuIHRoZSBzdHJ1Y3R1cmUgaXMgbm90IG1vZGlmaWVkLgogICAgICAgICAgICBJZiBpdCByZXR1cm5zIHVuZGVmaW5lZCB0aGVuIHRoZSBtZW1iZXIgaXMgZGVsZXRlZC4KCiAgICAgICAgICAgIEV4YW1wbGU6CgogICAgICAgICAgICAvLyBQYXJzZSB0aGUgdGV4dC4gVmFsdWVzIHRoYXQgbG9vayBsaWtlIElTTyBkYXRlIHN0cmluZ3Mgd2lsbAogICAgICAgICAgICAvLyBiZSBjb252ZXJ0ZWQgdG8gRGF0ZSBvYmplY3RzLgoKICAgICAgICAgICAgbXlEYXRhID0gSlNPTi5wYXJzZSh0ZXh0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgIGEgPQovXihcZHs0fSktKFxkezJ9KS0oXGR7Mn0pVChcZHsyfSk6KFxkezJ9KTooXGR7Mn0oPzpcLlxkKik/KVokLy5leGVjKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEMoK2FbMV0sICthWzJdIC0gMSwgK2FbM10sICthWzRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgK2FbNV0sICthWzZdKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIG15RGF0YSA9IEpTT04ucGFyc2UoJ1siRGF0ZSgwOS8wOS8yMDAxKSJdJywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIHZhciBkOwogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuc2xpY2UoMCwgNSkgPT09ICdEYXRlKCcgJiYKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuc2xpY2UoLTEpID09PSAnKScpIHsKICAgICAgICAgICAgICAgICAgICBkID0gbmV3IERhdGUodmFsdWUuc2xpY2UoNSwgLTEpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0pOwoKCiAgICBUaGlzIGlzIGEgcmVmZXJlbmNlIGltcGxlbWVudGF0aW9uLiBZb3UgYXJlIGZyZWUgdG8gY29weSwgbW9kaWZ5LCBvcgogICAgcmVkaXN0cmlidXRlLgoqLwoKLypqc2xpbnQgZXZpbDogdHJ1ZSAqLwoKLyptZW1iZXJzICIiLCAiXGIiLCAiXHQiLCAiXG4iLCAiXGYiLCAiXHIiLCAiXCIiLCBKU09OLCAiXFwiLCBhcHBseSwKICAgIGNhbGwsIGNoYXJDb2RlQXQsIGdldFVUQ0RhdGUsIGdldFVUQ0Z1bGxZZWFyLCBnZXRVVENIb3VycywKICAgIGdldFVUQ01pbnV0ZXMsIGdldFVUQ01vbnRoLCBnZXRVVENTZWNvbmRzLCBoYXNPd25Qcm9wZXJ0eSwgam9pbiwKICAgIGxhc3RJbmRleCwgbGVuZ3RoLCBwYXJzZSwgcGFyc2VKU09OLCBwcm90b3R5cGUsIHB1c2gsIHJlcGxhY2UsIHNsaWNlLAogICAgc3RyaW5naWZ5LCB0ZXN0LCB0b0pTT04sIHRvSlNPTlN0cmluZywgdG9TdHJpbmcsIHZhbHVlT2YKKi8KCgovLyBDcmVhdGUgYSBKU09OIG9iamVjdCBvbmx5IGlmIG9uZSBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0LiBXZSBjcmVhdGUgdGhlCi8vIG1ldGhvZHMgaW4gYSBjbG9zdXJlIHRvIGF2b2lkIGNyZWF0aW5nIGdsb2JhbCB2YXJpYWJsZXMuCgpKU09OID0gSlNPTiB8fCB7fTsKCihmdW5jdGlvbiAoKSB7CgogICAgZnVuY3Rpb24gZihuKSB7CiAgICAgICAgLy8gRm9ybWF0IGludGVnZXJzIHRvIGhhdmUgYXQgbGVhc3QgdHdvIGRpZ2l0cy4KICAgICAgICByZXR1cm4gbiA8IDEwID8gJzAnICsgbiA6IG47CiAgICB9CgogICAgaWYgKHR5cGVvZiBEYXRlLnByb3RvdHlwZS50b0pTT04gIT09ICdmdW5jdGlvbicpIHsKCiAgICAgICAgRGF0ZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGtleSkgewoKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VVRDRnVsbFllYXIoKSAgICsgJy0nICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDTW9udGgoKSArIDEpICsgJy0nICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDRGF0ZSgpKSAgICAgICsgJ1QnICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDSG91cnMoKSkgICAgICsgJzonICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDTWludXRlcygpKSAgICsgJzonICsKICAgICAgICAgICAgICAgICBmKHRoaXMuZ2V0VVRDU2Vjb25kcygpKSAgICsgJ1onOwogICAgICAgIH07CgogICAgICAgIFN0cmluZy5wcm90b3R5cGUudG9KU09OID0KICAgICAgICBOdW1iZXIucHJvdG90eXBlLnRvSlNPTiA9CiAgICAgICAgQm9vbGVhbi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZU9mKCk7CiAgICAgICAgfTsKICAgIH0KCiAgICB2YXIgY3ggPSAvW1x1MDAwMFx1MDBhZFx1MDYwMC1cdTA2MDRcdTA3MGZcdTE3YjRcdTE3YjVcdTIwMGMtXHUyMDBmXHUyMDI4LVx1MjAyZlx1MjA2MC1cdTIwNmZcdWZlZmZcdWZmZjAtXHVmZmZmXS9nLAogICAgICAgIGVzY2FwYWJsZSA9IC9bXFxcIlx4MDAtXHgxZlx4N2YtXHg5Zlx1MDBhZFx1MDYwMC1cdTA2MDRcdTA3MGZcdTE3YjRcdTE3YjVcdTIwMGMtXHUyMDBmXHUyMDI4LVx1MjAyZlx1MjA2MC1cdTIwNmZcdWZlZmZcdWZmZjAtXHVmZmZmXS9nLAogICAgICAgIGdhcCwKICAgICAgICBpbmRlbnQsCiAgICAgICAgbWV0YSA9IHsgICAgLy8gdGFibGUgb2YgY2hhcmFjdGVyIHN1YnN0aXR1dGlvbnMKICAgICAgICAgICAgJ1xiJzogJ1xcYicsCiAgICAgICAgICAgICdcdCc6ICdcXHQnLAogICAgICAgICAgICAnXG4nOiAnXFxuJywKICAgICAgICAgICAgJ1xmJzogJ1xcZicsCiAgICAgICAgICAgICdccic6ICdcXHInLAogICAgICAgICAgICAnIicgOiAnXFwiJywKICAgICAgICAgICAgJ1xcJzogJ1xcXFwnCiAgICAgICAgfSwKICAgICAgICByZXA7CgoKICAgIGZ1bmN0aW9uIHF1b3RlKHN0cmluZykgewoKLy8gSWYgdGhlIHN0cmluZyBjb250YWlucyBubyBjb250cm9sIGNoYXJhY3RlcnMsIG5vIHF1b3RlIGNoYXJhY3RlcnMsIGFuZCBubwovLyBiYWNrc2xhc2ggY2hhcmFjdGVycywgdGhlbiB3ZSBjYW4gc2FmZWx5IHNsYXAgc29tZSBxdW90ZXMgYXJvdW5kIGl0LgovLyBPdGhlcndpc2Ugd2UgbXVzdCBhbHNvIHJlcGxhY2UgdGhlIG9mZmVuZGluZyBjaGFyYWN0ZXJzIHdpdGggc2FmZSBlc2NhcGUKLy8gc2VxdWVuY2VzLgoKICAgICAgICBlc2NhcGFibGUubGFzdEluZGV4ID0gMDsKICAgICAgICByZXR1cm4gZXNjYXBhYmxlLnRlc3Qoc3RyaW5nKSA/CiAgICAgICAgICAgICciJyArIHN0cmluZy5yZXBsYWNlKGVzY2FwYWJsZSwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIHZhciBjID0gbWV0YVthXTsKICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYyA9PT0gJ3N0cmluZycgPyBjIDoKICAgICAgICAgICAgICAgICAgICAnXFx1JyArICgnMDAwMCcgKyBhLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtNCk7CiAgICAgICAgICAgIH0pICsgJyInIDoKICAgICAgICAgICAgJyInICsgc3RyaW5nICsgJyInOwogICAgfQoKCiAgICBmdW5jdGlvbiBzdHIoa2V5LCBob2xkZXIpIHsKCi8vIFByb2R1Y2UgYSBzdHJpbmcgZnJvbSBob2xkZXJba2V5XS4KCiAgICAgICAgdmFyIGksICAgICAgICAgIC8vIFRoZSBsb29wIGNvdW50ZXIuCiAgICAgICAgICAgIGssICAgICAgICAgIC8vIFRoZSBtZW1iZXIga2V5LgogICAgICAgICAgICB2LCAgICAgICAgICAvLyBUaGUgbWVtYmVyIHZhbHVlLgogICAgICAgICAgICBsZW5ndGgsCiAgICAgICAgICAgIG1pbmQgPSBnYXAsCiAgICAgICAgICAgIHBhcnRpYWwsCiAgICAgICAgICAgIHZhbHVlID0gaG9sZGVyW2tleV07CgovLyBJZiB0aGUgdmFsdWUgaGFzIGEgdG9KU09OIG1ldGhvZCwgY2FsbCBpdCB0byBvYnRhaW4gYSByZXBsYWNlbWVudCB2YWx1ZS4KCiAgICAgICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYKICAgICAgICAgICAgICAgIHR5cGVvZiB2YWx1ZS50b0pTT04gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50b0pTT04oa2V5KTsKICAgICAgICB9CgovLyBJZiB3ZSB3ZXJlIGNhbGxlZCB3aXRoIGEgcmVwbGFjZXIgZnVuY3Rpb24sIHRoZW4gY2FsbCB0aGUgcmVwbGFjZXIgdG8KLy8gb2J0YWluIGEgcmVwbGFjZW1lbnQgdmFsdWUuCgogICAgICAgIGlmICh0eXBlb2YgcmVwID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIHZhbHVlID0gcmVwLmNhbGwoaG9sZGVyLCBrZXksIHZhbHVlKTsKICAgICAgICB9CgovLyBXaGF0IGhhcHBlbnMgbmV4dCBkZXBlbmRzIG9uIHRoZSB2YWx1ZSdzIHR5cGUuCgogICAgICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7CiAgICAgICAgY2FzZSAnc3RyaW5nJzoKICAgICAgICAgICAgcmV0dXJuIHF1b3RlKHZhbHVlKTsKCiAgICAgICAgY2FzZSAnbnVtYmVyJzoKCi8vIEpTT04gbnVtYmVycyBtdXN0IGJlIGZpbml0ZS4gRW5jb2RlIG5vbi1maW5pdGUgbnVtYmVycyBhcyBudWxsLgoKICAgICAgICAgICAgcmV0dXJuIGlzRmluaXRlKHZhbHVlKSA/IFN0cmluZyh2YWx1ZSkgOiAnbnVsbCc7CgogICAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICAgIGNhc2UgJ251bGwnOgoKLy8gSWYgdGhlIHZhbHVlIGlzIGEgYm9vbGVhbiBvciBudWxsLCBjb252ZXJ0IGl0IHRvIGEgc3RyaW5nLiBOb3RlOgovLyB0eXBlb2YgbnVsbCBkb2VzIG5vdCBwcm9kdWNlICdudWxsJy4gVGhlIGNhc2UgaXMgaW5jbHVkZWQgaGVyZSBpbgovLyB0aGUgcmVtb3RlIGNoYW5jZSB0aGF0IHRoaXMgZ2V0cyBmaXhlZCBzb21lZGF5LgoKICAgICAgICAgICAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7CgovLyBJZiB0aGUgdHlwZSBpcyAnb2JqZWN0Jywgd2UgbWlnaHQgYmUgZGVhbGluZyB3aXRoIGFuIG9iamVjdCBvciBhbiBhcnJheSBvcgovLyBudWxsLgoKICAgICAgICBjYXNlICdvYmplY3QnOgoKLy8gRHVlIHRvIGEgc3BlY2lmaWNhdGlvbiBibHVuZGVyIGluIEVDTUFTY3JpcHQsIHR5cGVvZiBudWxsIGlzICdvYmplY3QnLAovLyBzbyB3YXRjaCBvdXQgZm9yIHRoYXQgY2FzZS4KCiAgICAgICAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnbnVsbCc7CiAgICAgICAgICAgIH0KCi8vIE1ha2UgYW4gYXJyYXkgdG8gaG9sZCB0aGUgcGFydGlhbCByZXN1bHRzIG9mIHN0cmluZ2lmeWluZyB0aGlzIG9iamVjdCB2YWx1ZS4KCiAgICAgICAgICAgIGdhcCArPSBpbmRlbnQ7CiAgICAgICAgICAgIHBhcnRpYWwgPSBbXTsKCi8vIElzIHRoZSB2YWx1ZSBhbiBhcnJheT8KCiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJyYXldJykgewoKLy8gVGhlIHZhbHVlIGlzIGFuIGFycmF5LiBTdHJpbmdpZnkgZXZlcnkgZWxlbWVudC4gVXNlIG51bGwgYXMgYSBwbGFjZWhvbGRlcgovLyBmb3Igbm9uLUpTT04gdmFsdWVzLgoKICAgICAgICAgICAgICAgIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgICAgICAgICAgIHBhcnRpYWxbaV0gPSBzdHIoaSwgdmFsdWUpIHx8ICdudWxsJzsKICAgICAgICAgICAgICAgIH0KCi8vIEpvaW4gYWxsIG9mIHRoZSBlbGVtZW50cyB0b2dldGhlciwgc2VwYXJhdGVkIHdpdGggY29tbWFzLCBhbmQgd3JhcCB0aGVtIGluCi8vIGJyYWNrZXRzLgoKICAgICAgICAgICAgICAgIHYgPSBwYXJ0aWFsLmxlbmd0aCA9PT0gMCA/ICdbXScgOgogICAgICAgICAgICAgICAgICAgIGdhcCA/ICdbXG4nICsgZ2FwICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwuam9pbignLFxuJyArIGdhcCkgKyAnXG4nICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5kICsgJ10nIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAnWycgKyBwYXJ0aWFsLmpvaW4oJywnKSArICddJzsKICAgICAgICAgICAgICAgIGdhcCA9IG1pbmQ7CiAgICAgICAgICAgICAgICByZXR1cm4gdjsKICAgICAgICAgICAgfQoKLy8gSWYgdGhlIHJlcGxhY2VyIGlzIGFuIGFycmF5LCB1c2UgaXQgdG8gc2VsZWN0IHRoZSBtZW1iZXJzIHRvIGJlIHN0cmluZ2lmaWVkLgoKICAgICAgICAgICAgaWYgKHJlcCAmJiB0eXBlb2YgcmVwID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgbGVuZ3RoID0gcmVwLmxlbmd0aDsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgICAgICAgICAgIGsgPSByZXBbaV07CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBrID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgICAgICB2ID0gc3RyKGssIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwucHVzaChxdW90ZShrKSArIChnYXAgPyAnOiAnIDogJzonKSArIHYpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewoKLy8gT3RoZXJ3aXNlLCBpdGVyYXRlIHRocm91Z2ggYWxsIG9mIHRoZSBrZXlzIGluIHRoZSBvYmplY3QuCgogICAgICAgICAgICAgICAgZm9yIChrIGluIHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBrKSkgewogICAgICAgICAgICAgICAgICAgICAgICB2ID0gc3RyKGssIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpYWwucHVzaChxdW90ZShrKSArIChnYXAgPyAnOiAnIDogJzonKSArIHYpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgovLyBKb2luIGFsbCBvZiB0aGUgbWVtYmVyIHRleHRzIHRvZ2V0aGVyLCBzZXBhcmF0ZWQgd2l0aCBjb21tYXMsCi8vIGFuZCB3cmFwIHRoZW0gaW4gYnJhY2VzLgoKICAgICAgICAgICAgdiA9IHBhcnRpYWwubGVuZ3RoID09PSAwID8gJ3t9JyA6CiAgICAgICAgICAgICAgICBnYXAgPyAne1xuJyArIGdhcCArIHBhcnRpYWwuam9pbignLFxuJyArIGdhcCkgKyAnXG4nICsKICAgICAgICAgICAgICAgICAgICAgICAgbWluZCArICd9JyA6ICd7JyArIHBhcnRpYWwuam9pbignLCcpICsgJ30nOwogICAgICAgICAgICBnYXAgPSBtaW5kOwogICAgICAgICAgICByZXR1cm4gdjsKICAgICAgICB9CiAgICB9CgovLyBJZiB0aGUgSlNPTiBvYmplY3QgZG9lcyBub3QgeWV0IGhhdmUgYSBzdHJpbmdpZnkgbWV0aG9kLCBnaXZlIGl0IG9uZS4KCiAgICBpZiAodHlwZW9mIEpTT04uc3RyaW5naWZ5ICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgSlNPTi5zdHJpbmdpZnkgPSBmdW5jdGlvbiAodmFsdWUsIHJlcGxhY2VyLCBzcGFjZSkgewoKLy8gVGhlIHN0cmluZ2lmeSBtZXRob2QgdGFrZXMgYSB2YWx1ZSBhbmQgYW4gb3B0aW9uYWwgcmVwbGFjZXIsIGFuZCBhbiBvcHRpb25hbAovLyBzcGFjZSBwYXJhbWV0ZXIsIGFuZCByZXR1cm5zIGEgSlNPTiB0ZXh0LiBUaGUgcmVwbGFjZXIgY2FuIGJlIGEgZnVuY3Rpb24KLy8gdGhhdCBjYW4gcmVwbGFjZSB2YWx1ZXMsIG9yIGFuIGFycmF5IG9mIHN0cmluZ3MgdGhhdCB3aWxsIHNlbGVjdCB0aGUga2V5cy4KLy8gQSBkZWZhdWx0IHJlcGxhY2VyIG1ldGhvZCBjYW4gYmUgcHJvdmlkZWQuIFVzZSBvZiB0aGUgc3BhY2UgcGFyYW1ldGVyIGNhbgovLyBwcm9kdWNlIHRleHQgdGhhdCBpcyBtb3JlIGVhc2lseSByZWFkYWJsZS4KCiAgICAgICAgICAgIHZhciBpOwogICAgICAgICAgICBnYXAgPSAnJzsKICAgICAgICAgICAgaW5kZW50ID0gJyc7CgovLyBJZiB0aGUgc3BhY2UgcGFyYW1ldGVyIGlzIGEgbnVtYmVyLCBtYWtlIGFuIGluZGVudCBzdHJpbmcgY29udGFpbmluZyB0aGF0Ci8vIG1hbnkgc3BhY2VzLgoKICAgICAgICAgICAgaWYgKHR5cGVvZiBzcGFjZSA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGFjZTsgaSArPSAxKSB7CiAgICAgICAgICAgICAgICAgICAgaW5kZW50ICs9ICcgJzsKICAgICAgICAgICAgICAgIH0KCi8vIElmIHRoZSBzcGFjZSBwYXJhbWV0ZXIgaXMgYSBzdHJpbmcsIGl0IHdpbGwgYmUgdXNlZCBhcyB0aGUgaW5kZW50IHN0cmluZy4KCiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNwYWNlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgaW5kZW50ID0gc3BhY2U7CiAgICAgICAgICAgIH0KCi8vIElmIHRoZXJlIGlzIGEgcmVwbGFjZXIsIGl0IG11c3QgYmUgYSBmdW5jdGlvbiBvciBhbiBhcnJheS4KLy8gT3RoZXJ3aXNlLCB0aHJvdyBhbiBlcnJvci4KCiAgICAgICAgICAgIHJlcCA9IHJlcGxhY2VyOwogICAgICAgICAgICBpZiAocmVwbGFjZXIgJiYgdHlwZW9mIHJlcGxhY2VyICE9PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiByZXBsYWNlciAhPT0gJ29iamVjdCcgfHwKICAgICAgICAgICAgICAgICAgICAgdHlwZW9mIHJlcGxhY2VyLmxlbmd0aCAhPT0gJ251bWJlcicpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0pTT04uc3RyaW5naWZ5Jyk7CiAgICAgICAgICAgIH0KCi8vIE1ha2UgYSBmYWtlIHJvb3Qgb2JqZWN0IGNvbnRhaW5pbmcgb3VyIHZhbHVlIHVuZGVyIHRoZSBrZXkgb2YgJycuCi8vIFJldHVybiB0aGUgcmVzdWx0IG9mIHN0cmluZ2lmeWluZyB0aGUgdmFsdWUuCgogICAgICAgICAgICByZXR1cm4gc3RyKCcnLCB7Jyc6IHZhbHVlfSk7CiAgICAgICAgfTsKICAgIH0KCgovLyBJZiB0aGUgSlNPTiBvYmplY3QgZG9lcyBub3QgeWV0IGhhdmUgYSBwYXJzZSBtZXRob2QsIGdpdmUgaXQgb25lLgoKICAgIGlmICh0eXBlb2YgSlNPTi5wYXJzZSAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgIEpTT04ucGFyc2UgPSBmdW5jdGlvbiAodGV4dCwgcmV2aXZlcikgewoKLy8gVGhlIHBhcnNlIG1ldGhvZCB0YWtlcyBhIHRleHQgYW5kIGFuIG9wdGlvbmFsIHJldml2ZXIgZnVuY3Rpb24sIGFuZCByZXR1cm5zCi8vIGEgSmF2YVNjcmlwdCB2YWx1ZSBpZiB0aGUgdGV4dCBpcyBhIHZhbGlkIEpTT04gdGV4dC4KCiAgICAgICAgICAgIHZhciBqOwoKICAgICAgICAgICAgZnVuY3Rpb24gd2Fsayhob2xkZXIsIGtleSkgewoKLy8gVGhlIHdhbGsgbWV0aG9kIGlzIHVzZWQgdG8gcmVjdXJzaXZlbHkgd2FsayB0aGUgcmVzdWx0aW5nIHN0cnVjdHVyZSBzbwovLyB0aGF0IG1vZGlmaWNhdGlvbnMgY2FuIGJlIG1hZGUuCgogICAgICAgICAgICAgICAgdmFyIGssIHYsIHZhbHVlID0gaG9sZGVyW2tleV07CiAgICAgICAgICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgICAgIGZvciAoayBpbiB2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodmFsdWUsIGspKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID0gd2Fsayh2YWx1ZSwgayk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVba10gPSB2OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdmFsdWVba107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gcmV2aXZlci5jYWxsKGhvbGRlciwga2V5LCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGV4dCA9IFN0cmluZyh0ZXh0KTsKCi8vIFBhcnNpbmcgaGFwcGVucyBpbiBmb3VyIHN0YWdlcy4gSW4gdGhlIGZpcnN0IHN0YWdlLCB3ZSByZXBsYWNlIGNlcnRhaW4KLy8gVW5pY29kZSBjaGFyYWN0ZXJzIHdpdGggZXNjYXBlIHNlcXVlbmNlcy4gSmF2YVNjcmlwdCBoYW5kbGVzIG1hbnkgY2hhcmFjdGVycwovLyBpbmNvcnJlY3RseSwgZWl0aGVyIHNpbGVudGx5IGRlbGV0aW5nIHRoZW0sIG9yIHRyZWF0aW5nIHRoZW0gYXMgbGluZSBlbmRpbmdzLgoKICAgICAgICAgICAgY3gubGFzdEluZGV4ID0gMDsKICAgICAgICAgICAgaWYgKGN4LnRlc3QodGV4dCkpIHsKICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoY3gsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdcXHUnICsKICAgICAgICAgICAgICAgICAgICAgICAgKCcwMDAwJyArIGEuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgovLyBJbiB0aGUgc2Vjb25kIHN0YWdlLCB3ZSBydW4gdGhlIHRleHQgYWdhaW5zdCByZWd1bGFyIGV4cHJlc3Npb25zIHRoYXQgbG9vawovLyBmb3Igbm9uLUpTT04gcGF0dGVybnMuIFdlIGFyZSBlc3BlY2lhbGx5IGNvbmNlcm5lZCB3aXRoICcoKScgYW5kICduZXcnCi8vIGJlY2F1c2UgdGhleSBjYW4gY2F1c2UgaW52b2NhdGlvbiwgYW5kICc9JyBiZWNhdXNlIGl0IGNhbiBjYXVzZSBtdXRhdGlvbi4KLy8gQnV0IGp1c3QgdG8gYmUgc2FmZSwgd2Ugd2FudCB0byByZWplY3QgYWxsIHVuZXhwZWN0ZWQgZm9ybXMuCgovLyBXZSBzcGxpdCB0aGUgc2Vjb25kIHN0YWdlIGludG8gNCByZWdleHAgb3BlcmF0aW9ucyBpbiBvcmRlciB0byB3b3JrIGFyb3VuZAovLyBjcmlwcGxpbmcgaW5lZmZpY2llbmNpZXMgaW4gSUUncyBhbmQgU2FmYXJpJ3MgcmVnZXhwIGVuZ2luZXMuIEZpcnN0IHdlCi8vIHJlcGxhY2UgdGhlIEpTT04gYmFja3NsYXNoIHBhaXJzIHdpdGggJ0AnIChhIG5vbi1KU09OIGNoYXJhY3RlcikuIFNlY29uZCwgd2UKLy8gcmVwbGFjZSBhbGwgc2ltcGxlIHZhbHVlIHRva2VucyB3aXRoICddJyBjaGFyYWN0ZXJzLiBUaGlyZCwgd2UgZGVsZXRlIGFsbAovLyBvcGVuIGJyYWNrZXRzIHRoYXQgZm9sbG93IGEgY29sb24gb3IgY29tbWEgb3IgdGhhdCBiZWdpbiB0aGUgdGV4dC4gRmluYWxseSwKLy8gd2UgbG9vayB0byBzZWUgdGhhdCB0aGUgcmVtYWluaW5nIGNoYXJhY3RlcnMgYXJlIG9ubHkgd2hpdGVzcGFjZSBvciAnXScgb3IKLy8gJywnIG9yICc6JyBvciAneycgb3IgJ30nLiBJZiB0aGF0IGlzIHNvLCB0aGVuIHRoZSB0ZXh0IGlzIHNhZmUgZm9yIGV2YWwuCgogICAgICAgICAgICBpZiAoL15bXF0sOnt9XHNdKiQvLgp0ZXN0KHRleHQucmVwbGFjZSgvXFwoPzpbIlxcXC9iZm5ydF18dVswLTlhLWZBLUZdezR9KS9nLCAnQCcpLgpyZXBsYWNlKC8iW14iXFxcblxyXSoifHRydWV8ZmFsc2V8bnVsbHwtP1xkKyg/OlwuXGQqKT8oPzpbZUVdWytcLV0/XGQrKT8vZywgJ10nKS4KcmVwbGFjZSgvKD86Xnw6fCwpKD86XHMqXFspKy9nLCAnJykpKSB7CgovLyBJbiB0aGUgdGhpcmQgc3RhZ2Ugd2UgdXNlIHRoZSBldmFsIGZ1bmN0aW9uIHRvIGNvbXBpbGUgdGhlIHRleHQgaW50byBhCi8vIEphdmFTY3JpcHQgc3RydWN0dXJlLiBUaGUgJ3snIG9wZXJhdG9yIGlzIHN1YmplY3QgdG8gYSBzeW50YWN0aWMgYW1iaWd1aXR5Ci8vIGluIEphdmFTY3JpcHQ6IGl0IGNhbiBiZWdpbiBhIGJsb2NrIG9yIGFuIG9iamVjdCBsaXRlcmFsLiBXZSB3cmFwIHRoZSB0ZXh0Ci8vIGluIHBhcmVucyB0byBlbGltaW5hdGUgdGhlIGFtYmlndWl0eS4KCiAgICAgICAgICAgICAgICBqID0gZXZhbCgnKCcgKyB0ZXh0ICsgJyknKTsKCi8vIEluIHRoZSBvcHRpb25hbCBmb3VydGggc3RhZ2UsIHdlIHJlY3Vyc2l2ZWx5IHdhbGsgdGhlIG5ldyBzdHJ1Y3R1cmUsIHBhc3NpbmcKLy8gZWFjaCBuYW1lL3ZhbHVlIHBhaXIgdG8gYSByZXZpdmVyIGZ1bmN0aW9uIGZvciBwb3NzaWJsZSB0cmFuc2Zvcm1hdGlvbi4KCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHJldml2ZXIgPT09ICdmdW5jdGlvbicgPwogICAgICAgICAgICAgICAgICAgIHdhbGsoeycnOiBqfSwgJycpIDogajsKICAgICAgICAgICAgfQoKLy8gSWYgdGhlIHRleHQgaXMgbm90IEpTT04gcGFyc2VhYmxlLCB0aGVuIGEgU3ludGF4RXJyb3IgaXMgdGhyb3duLgoKICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCdKU09OLnBhcnNlJyk7CiAgICAgICAgfTsKICAgIH0KfSgpKTsKCgovLyBBdWdtZW50IHRoZSBiYXNpYyBwcm90b3R5cGVzIGlmIHRoZXkgaGF2ZSBub3QgYWxyZWFkeSBiZWVuIGF1Z21lbnRlZC4KLy8gVGhlc2UgZm9ybXMgYXJlIG9ic29sZXRlLiBJdCBpcyByZWNvbW1lbmRlZCB0aGF0IEpTT04uc3RyaW5naWZ5IGFuZAovLyBKU09OLnBhcnNlIGJlIHVzZWQgaW5zdGVhZC4KCmlmICghT2JqZWN0LnByb3RvdHlwZS50b0pTT05TdHJpbmcpIHsKICAgIE9iamVjdC5wcm90b3R5cGUudG9KU09OU3RyaW5nID0gZnVuY3Rpb24gKGZpbHRlcikgewogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLCBmaWx0ZXIpOwogICAgfTsKICAgIE9iamVjdC5wcm90b3R5cGUucGFyc2VKU09OID0gZnVuY3Rpb24gKGZpbHRlcikgewogICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMsIGZpbHRlcik7CiAgICB9Owp9",
	"calendar.css": "LmNhbGVuZGFyLWJveCB7CglkaXNwbGF5Om5vbmU7CgliYWNrZ3JvdW5kLWNvbG9yOiNmZmY7Cglib3JkZXI6MXB4IHNvbGlkICM0NDQ7Cglwb3NpdGlvbjphYnNvbHV0ZTsKCXdpZHRoOjI1MHB4OwoJcGFkZGluZzogMCA1cHg7Cn0KLmNhbGVuZGFyLWJveCBzZWxlY3QuY2FsZW5kYXItbW9udGggewoJd2lkdGg6OTBweDsKfQouY2FsZW5kYXItYm94IHNlbGVjdC5jYWxlbmRhci15ZWFyIHsKCXdpZHRoOjcwcHg7Cn0KLmNhbGVuZGFyLWJveCAuY2FsZW5kYXItY2FuY2VsIHsKCXdpZHRoOjEwMCU7Cn0KLmNhbGVuZGFyLWJveCB0YWJsZSB0ZCB7Cgl3aWR0aDoxNCU7Cn0KLmNhbGVuZGFyLWJveCAuY2FsZW5kYXItdGl0bGUgewoJdGV4dC1hbGlnbjpjZW50ZXI7Cn0KLmNhbGVuZGFyLWJveCBhIHsKCXRleHQtZGVjb3JhdGlvbjpub25lOwp9Ci5jYWxlbmRhci1ib3ggLnRvZGF5IGEgewoJcGFkZGluZzowIDVweDsKCW1hcmdpbi1sZWZ0Oi01cHg7CgliYWNrZ3JvdW5kLWNvbG9yOiNmZmU5YzY7Cn0gCi5jYWxlbmRhci1ib3ggLnNlbGVjdGVkIGEgewoJcGFkZGluZzowIDVweDsKCW1hcmdpbi1sZWZ0Oi01cHg7CgliYWNrZ3JvdW5kLWNvbG9yOiNjOWZmOGI7Cn0K",
	"calendar.js": "LyoqCiAqIENhbGVuZGFyIFNjcmlwdAogKiBDcmVhdGVzIGEgY2FsZW5kYXIgd2lkZ2V0IHdoaWNoIGNhbiBiZSB1c2VkIHRvIHNlbGVjdCB0aGUgZGF0ZSBtb3JlIGVhc2lseSB0aGFuIHVzaW5nIGp1c3QgYSB0ZXh0IGJveAogKiBodHRwOi8vd3d3Lm9wZW5qcy5jb20vc2NyaXB0cy91aS9jYWxlbmRhci8KICoKICogRXhhbXBsZToKICogPGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImRhdGUiIGlkPSJkYXRlIiAvPgogKiA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAqIAkJY2FsZW5kYXIuc2V0KCJkYXRlIik7CiAqIDwvc2NyaXB0PgogKi8KY2FsZW5kYXIgPSB7Cgltb250aF9uYW1lczogWyJKYW51YXJ5IiwiRmVicnVhcnkiLCJNYXJjaCIsIkFwcmlsIiwiTWF5IiwiSnVuZSIsIkp1bHkiLCJBdWdlc3QiLCJTZXB0ZW1iZXIiLCJPY3RvYmVyIiwiTm92ZW1iZXIiLCJEZWNlbWJlciJdLAoJd2Vla2RheXM6IFsiU3VuIiwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0Il0sCgltb250aF9kYXlzOiBbMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLAoJLy9HZXQgdG9kYXkncyBkYXRlIC0geWVhciwgbW9udGgsIGRheSBhbmQgZGF0ZQoJdG9kYXkgOiBuZXcgRGF0ZSgpLAoJb3B0IDoge30sCglkYXRhOiBbXSwKCgkvL0Z1bmN0aW9ucwoJLy8vIFVzZWQgdG8gY3JlYXRlIEhUTUwgaW4gYSBvcHRpbWl6ZWQgd2F5LgoJd3J0OmZ1bmN0aW9uKHR4dCkgewoJCXRoaXMuZGF0YS5wdXNoKHR4dCk7Cgl9LAoJCgkvKiBJbnNwaXJlZCBieSBodHRwOi8vd3d3LnF1aXJrc21vZGUub3JnL2RvbS9nZXRzdHlsZXMuaHRtbCAqLwoJZ2V0U3R5bGU6IGZ1bmN0aW9uKGVsZSwgcHJvcGVydHkpewoJCWlmIChlbGUuY3VycmVudFN0eWxlKSB7CgkJCXZhciBhbHRfcHJvcGVydHlfbmFtZSA9IHByb3BlcnR5LnJlcGxhY2UoL1wtKFx3KS9nLGZ1bmN0aW9uKG0sYyl7cmV0dXJuIGMudG9VcHBlckNhc2UoKTt9KTsvL2JhY2tncm91bmQtY29sb3IgYmVjb21lcyBiYWNrZ3JvdW5kQ29sb3IKCQkJdmFyIHZhbHVlID0gZWxlLmN1cnJlbnRTdHlsZVtwcm9wZXJ0eV18fGVsZS5jdXJyZW50U3R5bGVbYWx0X3Byb3BlcnR5X25hbWVdOwoJCQoJCX0gZWxzZSBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHsKCQkJcHJvcGVydHkgPSBwcm9wZXJ0eS5yZXBsYWNlKC8oW0EtWl0pL2csIi0kMSIpLnRvTG93ZXJDYXNlKCk7Ly9iYWNrZ3JvdW5kQ29sb3IgYmVjb21lcyBiYWNrZ3JvdW5kLWNvbG9yCgoJCQl2YXIgdmFsdWUgPSBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZSxudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKHByb3BlcnR5KTsKCQl9CgkJCgkJLy9Tb21lIHByb3BlcnRpZXMgYXJlIHNwZWNpYWwgY2FzZXMKCQlpZihwcm9wZXJ0eSA9PSAib3BhY2l0eSIgJiYgZWxlLmZpbHRlcikgdmFsdWUgPSAocGFyc2VGbG9hdCggZWxlLmZpbHRlci5tYXRjaCgvb3BhY2l0eVw9KFteKV0qKS8pWzFdICkgLyAxMDApOwoJCWVsc2UgaWYocHJvcGVydHkgPT0gIndpZHRoIiAmJiBpc05hTih2YWx1ZSkpIHZhbHVlID0gZWxlLmNsaWVudFdpZHRoIHx8IGVsZS5vZmZzZXRXaWR0aDsKCQllbHNlIGlmKHByb3BlcnR5ID09ICJoZWlnaHQiICYmIGlzTmFOKHZhbHVlKSkgdmFsdWUgPSBlbGUuY2xpZW50SGVpZ2h0IHx8IGVsZS5vZmZzZXRIZWlnaHQ7CgkJcmV0dXJuIHZhbHVlOwoJfSwKCWdldFBvc2l0aW9uOmZ1bmN0aW9uKGVsZSkgewoJCXZhciB4ID0gMDsKCQl2YXIgeSA9IDA7CgkJd2hpbGUgKGVsZSkgewoJCQl4ICs9IGVsZS5vZmZzZXRMZWZ0OwoJCQl5ICs9IGVsZS5vZmZzZXRUb3A7CgkJCWVsZSA9IGVsZS5vZmZzZXRQYXJlbnQ7CgkJfQoJCWlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk1hYyIpICE9IC0xICYmIHR5cGVvZiBkb2N1bWVudC5ib2R5LmxlZnRNYXJnaW4gIT0gInVuZGVmaW5lZCIpIHsKCQkJeCArPSBkb2N1bWVudC5ib2R5LmxlZnRNYXJnaW47CgkJCW9mZnNldFRvcCArPSBkb2N1bWVudC5ib2R5LnRvcE1hcmdpbjsKCQl9CgkKCQl2YXIgeHkgPSBuZXcgQXJyYXkoeCx5KTsKCQlyZXR1cm4geHk7Cgl9LAoJLy8vIENhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyBvbiBhIGRhdGUgaW4gdGhlIGNhbGVuZGFyLgoJc2VsZWN0RGF0ZTpmdW5jdGlvbih5ZWFyLG1vbnRoLGRheSkgewoJCXZhciB0aHMgPSBfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlOwoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRocy5vcHRbImlucHV0Il0pLnZhbHVlID0geWVhciArICItIiArIG1vbnRoICsgIi0iICsgZGF5OyAvLyBEYXRlIGZvcm1hdCBpcyA6SEFSRENPREU6CgkJdGhzLmhpZGVDYWxlbmRhcigpOwoJfSwKCS8vLyBDcmVhdGVzIGEgY2FsZW5kYXIgd2l0aCB0aGUgZGF0ZSBnaXZlbiBpbiB0aGUgYXJndW1lbnQgYXMgdGhlIHNlbGVjdGVkIGRhdGUuCgltYWtlQ2FsZW5kYXI6ZnVuY3Rpb24oeWVhciwgbW9udGgsIGRheSkgewoJCXllYXIgPSBwYXJzZUludCh5ZWFyKTsKCQltb250aD0gcGFyc2VJbnQobW9udGgpOwoJCWRheQkgPSBwYXJzZUludChkYXkpOwoJCQoJCS8vRGlzcGxheSB0aGUgdGFibGUKCQl2YXIgbmV4dF9tb250aCA9IG1vbnRoKzE7CgkJdmFyIG5leHRfbW9udGhfeWVhciA9IHllYXI7CgkJaWYobmV4dF9tb250aD49MTIpIHsKCQkJbmV4dF9tb250aCA9IDA7CgkJCW5leHRfbW9udGhfeWVhcisrOwoJCX0KCQkKCQl2YXIgcHJldmlvdXNfbW9udGggPSBtb250aC0xOwoJCXZhciBwcmV2aW91c19tb250aF95ZWFyID0geWVhcjsKCQlpZihwcmV2aW91c19tb250aDwgMCkgewoJCQlwcmV2aW91c19tb250aCA9IDExOwoJCQlwcmV2aW91c19tb250aF95ZWFyLS07CgkJfQoJCQoJCXRoaXMud3J0KCI8dGFibGU+Iik7CgkJdGhpcy53cnQoIjx0cj48dGg+PGEgaHJlZj0namF2YXNjcmlwdDpjYWxlbmRhci5tYWtlQ2FsZW5kYXIoIisocHJldmlvdXNfbW9udGhfeWVhcikrIiwiKyhwcmV2aW91c19tb250aCkrIik7JyB0aXRsZT0nIit0aGlzLm1vbnRoX25hbWVzW3ByZXZpb3VzX21vbnRoXSsiICIrKHByZXZpb3VzX21vbnRoX3llYXIpKyInPiZsdDs8L2E+PC90aD4iKTsKCQl0aGlzLndydCgiPHRoIGNvbHNwYW49JzUnIGNsYXNzPSdjYWxlbmRhci10aXRsZSc+PHNlbGVjdCBuYW1lPSdjYWxlbmRhci1tb250aCcgY2xhc3M9J2NhbGVuZGFyLW1vbnRoJyBvbkNoYW5nZT0nY2FsZW5kYXIubWFrZUNhbGVuZGFyKCIreWVhcisiLHRoaXMudmFsdWUpOyc+Iik7CgkJZm9yKHZhciBpIGluIHRoaXMubW9udGhfbmFtZXMpIHsKCQkJdGhpcy53cnQoIjxvcHRpb24gdmFsdWU9JyIraSsiJyIpOwoJCQlpZihpID09IG1vbnRoKSB0aGlzLndydCgiIHNlbGVjdGVkPSdzZWxlY3RlZCciKTsKCQkJdGhpcy53cnQoIj4iK3RoaXMubW9udGhfbmFtZXNbaV0rIjwvb3B0aW9uPiIpOwoJCX0KCQl0aGlzLndydCgiPC9zZWxlY3Q+Iik7CgkJdGhpcy53cnQoIjxzZWxlY3QgbmFtZT0nY2FsZW5kYXIteWVhcicgY2xhc3M9J2NhbGVuZGFyLXllYXInIG9uQ2hhbmdlPSdjYWxlbmRhci5tYWtlQ2FsZW5kYXIodGhpcy52YWx1ZSwgIittb250aCsiKTsnPiIpOwoJCXZhciBjdXJyZW50X3llYXIgPSB0aGlzLnRvZGF5LmdldFllYXIoKTsKCQlpZihjdXJyZW50X3llYXIgPCAxOTAwKSBjdXJyZW50X3llYXIgKz0gMTkwMDsKCQkKCQlmb3IodmFyIGk9Y3VycmVudF95ZWFyLTcwOyBpPGN1cnJlbnRfeWVhcisxMDsgaSsrKSB7CgkJCXRoaXMud3J0KCI8b3B0aW9uIHZhbHVlPSciK2krIiciKQoJCQlpZihpID09IHllYXIpIHRoaXMud3J0KCIgc2VsZWN0ZWQ9J3NlbGVjdGVkJyIpOwoJCQl0aGlzLndydCgiPiIraSsiPC9vcHRpb24+Iik7CgkJfQoJCXRoaXMud3J0KCI8L3NlbGVjdD48L3RoPiIpOwoJCXRoaXMud3J0KCI8dGg+PGEgaHJlZj0namF2YXNjcmlwdDpjYWxlbmRhci5tYWtlQ2FsZW5kYXIoIisobmV4dF9tb250aF95ZWFyKSsiLCIrKG5leHRfbW9udGgpKyIpOycgdGl0bGU9JyIrdGhpcy5tb250aF9uYW1lc1tuZXh0X21vbnRoXSsiICIrKG5leHRfbW9udGhfeWVhcikrIic+Jmd0OzwvYT48L3RoPjwvdHI+Iik7CgkJdGhpcy53cnQoIjx0ciBjbGFzcz0naGVhZGVyJz4iKTsKCQlmb3IodmFyIHdlZWtkYXk9MDsgd2Vla2RheTw3OyB3ZWVrZGF5KyspIHRoaXMud3J0KCI8dGQ+Iit0aGlzLndlZWtkYXlzW3dlZWtkYXldKyI8L3RkPiIpOwoJCXRoaXMud3J0KCI8L3RyPiIpOwoJCQoJCS8vR2V0IHRoZSBmaXJzdCBkYXkgb2YgdGhpcyBtb250aAoJCXZhciBmaXJzdF9kYXkgPSBuZXcgRGF0ZSh5ZWFyLG1vbnRoLDEpOwoJCXZhciBzdGFydF9kYXkgPSBmaXJzdF9kYXkuZ2V0RGF5KCk7CgkJCgkJdmFyIGQgPSAxOwoJCXZhciBmbGFnID0gMDsKCQkKCQkvL0xlYXAgeWVhciBzdXBwb3J0CgkJaWYoeWVhciAlIDQgPT0gMCkgdGhpcy5tb250aF9kYXlzWzFdID0gMjk7CgkJZWxzZSB0aGlzLm1vbnRoX2RheXNbMV0gPSAyODsKCQkKCQl2YXIgZGF5c19pbl90aGlzX21vbnRoID0gdGhpcy5tb250aF9kYXlzW21vbnRoXTsKCgkJLy9DcmVhdGUgdGhlIGNhbGVuZGVyCgkJZm9yKHZhciBpPTA7aTw9NTtpKyspIHsKCQkJaWYodyA+PSBkYXlzX2luX3RoaXNfbW9udGgpIGJyZWFrOwoJCQl0aGlzLndydCgiPHRyPiIpOwoJCQlmb3IodmFyIGo9MDtqPDc7aisrKSB7CgkJCQlpZihkID4gZGF5c19pbl90aGlzX21vbnRoKSBmbGFnPTA7IC8vSWYgdGhlIGRheXMgaGFzIG92ZXJzaG9vdGVkIHRoZSBudW1iZXIgb2YgZGF5cyBpbiB0aGlzIG1vbnRoLCBzdG9wIHdyaXRpbmcKCQkJCWVsc2UgaWYoaiA+PSBzdGFydF9kYXkgJiYgIWZsYWcpIGZsYWc9MTsvL0lmIHRoZSBmaXJzdCBkYXkgb2YgdGhpcyBtb250aCBoYXMgY29tZSwgc3RhcnQgdGhlIGRhdGUgd3JpdGluZwoKCQkJCWlmKGZsYWcpIHsKCQkJCQl2YXIgdyA9IGQsIG1vbiA9IG1vbnRoKzE7CgkJCQkJaWYodyA8IDEwKQl3CT0gIjAiICsgdzsKCQkJCQlpZihtb24gPCAxMCltb24gPSAiMCIgKyBtb247CgoJCQkJCS8vSXMgaXQgdG9kYXk/CgkJCQkJdmFyIGNsYXNzX25hbWUgPSAnJzsKCQkJCQl2YXIgeWVhID0gdGhpcy50b2RheS5nZXRZZWFyKCk7CgkJCQkJaWYoeWVhIDwgMTkwMCkgeWVhICs9IDE5MDA7CgoJCQkJCWlmKHllYSA9PSB5ZWFyICYmIHRoaXMudG9kYXkuZ2V0TW9udGgoKSA9PSBtb250aCAmJiB0aGlzLnRvZGF5LmdldERhdGUoKSA9PSBkKSBjbGFzc19uYW1lID0gIiB0b2RheSI7CgkJCQkJaWYoZGF5ID09IGQpIGNsYXNzX25hbWUgKz0gIiBzZWxlY3RlZCI7CgkJCQkJCgkJCQkJY2xhc3NfbmFtZSArPSAiICIgKyB0aGlzLndlZWtkYXlzW2pdLnRvTG93ZXJDYXNlKCk7CgoJCQkJCXRoaXMud3J0KCI8dGQgY2xhc3M9J2RheXMiK2NsYXNzX25hbWUrIic+PGEgaHJlZj0namF2YXNjcmlwdDpjYWxlbmRhci5zZWxlY3REYXRlKFwiIit5ZWFyKyJcIixcIiIrbW9uKyJcIixcIiIrdysiXCIpJz4iK3crIjwvYT48L3RkPiIpOwoJCQkJCWQrKzsKCQkJCX0gZWxzZSB7CgkJCQkJdGhpcy53cnQoIjx0ZCBjbGFzcz0nZGF5cyc+Jm5ic3A7PC90ZD4iKTsKCQkJCX0KCQkJfQoJCQl0aGlzLndydCgiPC90cj4iKTsKCQl9CgkJdGhpcy53cnQoIjwvdGFibGU+Iik7CgkJdGhpcy53cnQoIjxpbnB1dCB0eXBlPSdidXR0b24nIHZhbHVlPSdDYW5jZWwnIGNsYXNzPSdjYWxlbmRhci1jYW5jZWwnIG9uY2xpY2s9J2NhbGVuZGFyLmhpZGVDYWxlbmRhcigpOycgLz4iKTsKCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5vcHRbJ2NhbGVuZGFyJ10pLmlubmVySFRNTCA9IHRoaXMuZGF0YS5qb2luKCIiKTsKCQl0aGlzLmRhdGEgPSBbXTsKCX0sCgkKCS8vLyBEaXNwbGF5IHRoZSBjYWxlbmRhciAtIGlmIGEgZGF0ZSBleGlzdHMgaW4gdGhlIGlucHV0IGJveCwgdGhhdCB3aWxsIGJlIHNlbGVjdGVkIGluIHRoZSBjYWxlbmRhci4KCXNob3dDYWxlbmRhcjogZnVuY3Rpb24oKSB7CgkJdmFyIGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5vcHRbJ2lucHV0J10pOwoJCQoJCS8vUG9zaXRpb24gdGhlIGRpdiBpbiB0aGUgY29ycmVjdCBsb2NhdGlvbi4uLgoJCXZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLm9wdFsnY2FsZW5kYXInXSk7CgkJdmFyIHh5ID0gdGhpcy5nZXRQb3NpdGlvbihpbnB1dCk7CgkJdmFyIHdpZHRoID0gcGFyc2VJbnQodGhpcy5nZXRTdHlsZShpbnB1dCwnd2lkdGgnKSk7CgkJZGl2LnN0eWxlLmxlZnQ9KHh5WzBdK3dpZHRoKzEwKSsicHgiOwoJCWRpdi5zdHlsZS50b3A9eHlbMV0rInB4IjsKCgkJLy8gU2hvdyB0aGUgY2FsZW5kYXIgd2l0aCB0aGUgZGF0ZSBpbiB0aGUgaW5wdXQgYXMgdGhlIHNlbGVjdGVkIGRhdGUKCQl2YXIgZXhpc3RpbmdfZGF0ZSA9IG5ldyBEYXRlKCk7CgkJdmFyIGRhdGVfaW5faW5wdXQgPSBpbnB1dC52YWx1ZTsKCQlpZihkYXRlX2luX2lucHV0KSB7CgkJCXZhciBzZWxlY3RlZF9kYXRlID0gZmFsc2U7CgkJCXZhciBkYXRlX3BhcnRzID0gZGF0ZV9pbl9pbnB1dC5zcGxpdCgiLSIpOwoJCQlpZihkYXRlX3BhcnRzLmxlbmd0aCA9PSAzKSB7CgkJCQlkYXRlX3BhcnRzWzFdLS07IC8vTW9udGggc3RhcnRzIHdpdGggMAoJCQkJc2VsZWN0ZWRfZGF0ZSA9IG5ldyBEYXRlKGRhdGVfcGFydHNbMF0sIGRhdGVfcGFydHNbMV0sIGRhdGVfcGFydHNbMl0pOwoJCQl9CgkJCWlmKHNlbGVjdGVkX2RhdGUgJiYgIWlzTmFOKHNlbGVjdGVkX2RhdGUuZ2V0WWVhcigpKSkgeyAvL1ZhbGlkIGRhdGUuCgkJCQlleGlzdGluZ19kYXRlID0gc2VsZWN0ZWRfZGF0ZTsKCQkJfQoJCX0KCQkKCQl2YXIgdGhlX3llYXIgPSBleGlzdGluZ19kYXRlLmdldFllYXIoKTsKCQlpZih0aGVfeWVhciA8IDE5MDApIHRoZV95ZWFyICs9IDE5MDA7CgkJdGhpcy5tYWtlQ2FsZW5kYXIodGhlX3llYXIsIGV4aXN0aW5nX2RhdGUuZ2V0TW9udGgoKSwgZXhpc3RpbmdfZGF0ZS5nZXREYXRlKCkpOwoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMub3B0WydjYWxlbmRhciddKS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCQlfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlID0gdGhpczsKCX0sCgkKCS8vLyBIaWRlcyB0aGUgY3VycmVudGx5IHNob3cgY2FsZW5kYXIuCgloaWRlQ2FsZW5kYXI6IGZ1bmN0aW9uKGluc3RhbmNlKSB7CgkJdmFyIGFjdGl2ZV9jYWxlbmRhcl9pZCA9ICIiOwoJCWlmKGluc3RhbmNlKSBhY3RpdmVfY2FsZW5kYXJfaWQgPSBpbnN0YW5jZS5vcHRbJ2NhbGVuZGFyJ107CgkJZWxzZSBhY3RpdmVfY2FsZW5kYXJfaWQgPSBfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlLm9wdFsnY2FsZW5kYXInXTsKCQkKCQlpZihhY3RpdmVfY2FsZW5kYXJfaWQpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFjdGl2ZV9jYWxlbmRhcl9pZCkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQlfY2FsZW5kYXJfYWN0aXZlX2luc3RhbmNlID0ge307Cgl9LAoJCgkvLy8gU2V0dXAgYSB0ZXh0IGlucHV0IGJveCB0byBiZSBhIGNhbGVuZGFyIGJveC4KCXNldDogZnVuY3Rpb24oaW5wdXRfaWQpIHsKCQl2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpbnB1dF9pZCk7CgkJaWYoIWlucHV0KSByZXR1cm47IC8vSWYgdGhlIGlucHV0IGZpZWxkIGlzIG5vdCB0aGVyZSwgZXhpdC4KCQkKCQlpZighdGhpcy5vcHRbJ2NhbGVuZGFyJ10pIHRoaXMuaW5pdCgpOwoJCQoJCXZhciB0aHMgPSB0aGlzOwoJCWlucHV0Lm9uY2xpY2s9ZnVuY3Rpb24oKXsKCQkJdGhzLm9wdFsnaW5wdXQnXSA9IHRoaXMuaWQ7CgkJCXRocy5zaG93Q2FsZW5kYXIoKTsKCQl9OwoJfSwKCQoJLy8vIFdpbGwgYmUgY2FsbGVkIG9uY2Ugd2hlbiB0aGUgZmlyc3QgaW5wdXQgaXMgc2V0LgoJaW5pdDogZnVuY3Rpb24oKSB7CgkJaWYoIXRoaXMub3B0WydjYWxlbmRhciddIHx8ICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLm9wdFsnY2FsZW5kYXInXSkpIHsKCQkJdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCQlpZighdGhpcy5vcHRbJ2NhbGVuZGFyJ10pIHRoaXMub3B0WydjYWxlbmRhciddID0gJ2NhbGVuZGVyX2Rpdl8nKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAxMDApOwoKCQkJZGl2LnNldEF0dHJpYnV0ZSgnaWQnLHRoaXMub3B0WydjYWxlbmRhciddKTsKCQkJZGl2LmNsYXNzTmFtZT0iY2FsZW5kYXItYm94IjsKCgkJCWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF0uaW5zZXJ0QmVmb3JlKGRpdixkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdLmZpcnN0Q2hpbGQpOwoJCX0KCX0KfQo=",
	"fullcalendar.css": "LyoKICogRnVsbENhbGVuZGFyIHYxLjQuNyBTdHlsZXNoZWV0CiAqCiAqIEZlZWwgZnJlZSB0byBlZGl0IHRoaXMgZmlsZSB0byBjdXN0b21pemUgdGhlIGxvb2sgb2YgRnVsbENhbGVuZGFyLgogKiBXaGVuIHVwZ3JhZGluZyB0byBuZXdlciB2ZXJzaW9ucywgcGxlYXNlIHVwZ3JhZGUgdGhpcyBmaWxlIGFzIHdlbGwsCiAqIHBvcnRpbmcgb3ZlciBhbnkgY3VzdG9taXphdGlvbnMgYWZ0ZXJ3YXJkcy4KICoKICogRGF0ZTogTW9uIEp1bCA1IDE2OjA3OjQwIDIwMTAgLTA3MDAKICoKICovCgoKLmZjLAouZmMgLmZjLWhlYWRlciwKLmZjIC5mYy1jb250ZW50IHsKCWZvbnQtc2l6ZTogMWVtOwoJfQoJCi5mYyB7CglkaXJlY3Rpb246IGx0cjsKCXRleHQtYWxpZ246IGxlZnQ7Cgl9CgkKLmZjIHRhYmxlIHsKCWJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7Cglib3JkZXItc3BhY2luZzogMDsKCX0KCQouZmMgdGQsIC5mYyB0aCB7CglwYWRkaW5nOiAwOwoJdmVydGljYWwtYWxpZ246IHRvcDsKCX0KCgoKLyogSGVhZGVyCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKdGFibGUuZmMtaGVhZGVyIHsKCXdpZHRoOiAxMDAlOwoJfQoJCi5mYy1oZWFkZXItbGVmdCB7Cgl3aWR0aDogMjUlOwoJfQoJCi5mYy1oZWFkZXItbGVmdCB0YWJsZSB7CglmbG9hdDogbGVmdDsKCX0KCQouZmMtaGVhZGVyLWNlbnRlciB7Cgl3aWR0aDogNTAlOwoJdGV4dC1hbGlnbjogY2VudGVyOwoJfQoJCi5mYy1oZWFkZXItY2VudGVyIHRhYmxlIHsKCW1hcmdpbjogMCBhdXRvOwoJfQoJCi5mYy1oZWFkZXItcmlnaHQgewoJd2lkdGg6IDI1JTsKCX0KCQouZmMtaGVhZGVyLXJpZ2h0IHRhYmxlIHsKCWZsb2F0OiByaWdodDsKCX0KCQouZmMtaGVhZGVyLXRpdGxlIHsKCW1hcmdpbi10b3A6IDA7Cgl3aGl0ZS1zcGFjZTogbm93cmFwOwoJfQoJCi5mYy1oZWFkZXItc3BhY2UgewoJcGFkZGluZy1sZWZ0OiAxMHB4OwoJfQoJCi8qIHJpZ2h0LXRvLWxlZnQgKi8KCi5mYy1ydGwgLmZjLWhlYWRlci10aXRsZSB7CglkaXJlY3Rpb246IHJ0bDsKCX0KCgoKLyogQnV0dG9ucwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCwKLmZjLWhlYWRlciAudWktc3RhdGUtZGVmYXVsdCB7CgltYXJnaW4tYm90dG9tOiAxZW07CgljdXJzb3I6IHBvaW50ZXI7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCB7Cglib3JkZXItd2lkdGg6IDFweCAwOwoJcGFkZGluZzogMCAxcHg7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCwKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBhIHsKCWJvcmRlci1zdHlsZTogc29saWQ7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBhIHsKCWRpc3BsYXk6IGJsb2NrOwoJYm9yZGVyLXdpZHRoOiAwIDFweDsKCW1hcmdpbjogMCAtMXB4OwoJd2lkdGg6IDEwMCU7Cgl0ZXh0LWRlY29yYXRpb246IG5vbmU7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBzcGFuIHsKCWRpc3BsYXk6IGJsb2NrOwoJYm9yZGVyLXN0eWxlOiBzb2xpZDsKCWJvcmRlci13aWR0aDogMXB4IDAgMXB4IDFweDsKCXBhZGRpbmc6IDNweCA1cHg7Cgl9CgkKLmZjLWhlYWRlciAudWktc3RhdGUtZGVmYXVsdCB7CglwYWRkaW5nOiA0cHggNnB4OwoJfQoJCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRlZmF1bHQgc3BhbiwKLmZjLWhlYWRlciAudWktc3RhdGUtZGVmYXVsdCBzcGFuIHsKCXdoaXRlLXNwYWNlOiBub3dyYXA7Cgl9CgkKLyogZm9yIGFkamFjZW50IGJ1dHRvbnMgKi8KCQouZmMtaGVhZGVyIC5mYy1uby1yaWdodCB7CglwYWRkaW5nLXJpZ2h0OiAwOwoJfQoJCi5mYy1oZWFkZXIgLmZjLW5vLXJpZ2h0IGEgewoJbWFyZ2luLXJpZ2h0OiAwOwoJYm9yZGVyLXJpZ2h0OiAwOwoJfQoJCi5mYy1oZWFkZXIgLnVpLW5vLXJpZ2h0IHsKCWJvcmRlci1yaWdodDogMDsKCX0KCQovKiBmb3IgZmFrZSByb3VuZGVkIGNvcm5lcnMgKi8KCQouZmMtaGVhZGVyIC5mYy1jb3JuZXItbGVmdCB7CgltYXJnaW4tbGVmdDogMXB4OwoJcGFkZGluZy1sZWZ0OiAwOwoJfQoJCi5mYy1oZWFkZXIgLmZjLWNvcm5lci1yaWdodCB7CgltYXJnaW4tcmlnaHQ6IDFweDsKCXBhZGRpbmctcmlnaHQ6IDA7Cgl9CgkKLyogREVGQVVMVCBidXR0b24gQ09MT1JTICovCgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCwKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGVmYXVsdCBhIHsKCWJvcmRlci1jb2xvcjogIzc3NzsgLyogb3V0ZXIgYm9yZGVyICovCgljb2xvcjogIzMzMzsKCX0KCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRlZmF1bHQgc3BhbiB7Cglib3JkZXItY29sb3I6ICNmZmYgI2ZmZiAjZDFkMWQxOyAvKiBpbm5lciBib3JkZXIgKi8KCWJhY2tncm91bmQ6ICNlOGU4ZTg7Cgl9CgkKLyogUFJFU1NFRCBidXR0b24gQ09MT1JTIChkb3duIGFuZCBhY3RpdmUpICovCgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtYWN0aXZlIGEgewoJY29sb3I6ICNmZmY7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZG93biBzcGFuLAouZmMtaGVhZGVyIC5mYy1zdGF0ZS1hY3RpdmUgc3BhbiB7CgliYWNrZ3JvdW5kOiAjODg4OwoJYm9yZGVyLWNvbG9yOiAjODA4MDgwICM4MDgwODAgIzkwOTA5MDsgLyogaW5uZXIgYm9yZGVyICovCgl9CgkKLyogRElTQUJMRUQgYnV0dG9uIENPTE9SUyAqLwoJCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRpc2FibGVkIGEgewoJY29sb3I6ICM5OTk7Cgl9CgkKLmZjLWhlYWRlciAuZmMtc3RhdGUtZGlzYWJsZWQsCi5mYy1oZWFkZXIgLmZjLXN0YXRlLWRpc2FibGVkIGEgewoJYm9yZGVyLWNvbG9yOiAjY2NjOyAvKiBvdXRlciBib3JkZXIgKi8KCX0KCQouZmMtaGVhZGVyIC5mYy1zdGF0ZS1kaXNhYmxlZCBzcGFuIHsKCWJvcmRlci1jb2xvcjogI2ZmZiAjZmZmICNmMGYwZjA7IC8qIGlubmVyIGJvcmRlciAqLwoJYmFja2dyb3VuZDogI2YwZjBmMDsKCX0KCQoJCgkKLyogQ29udGVudCBBcmVhICYgR2xvYmFsIENlbGwgU3R5bGVzCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKLmZjLXdpZGdldC1jb250ZW50IHsKCWJvcmRlcjogMXB4IHNvbGlkICNjY2M7IC8qIG91dGVyIGJvcmRlciBjb2xvciAqLwoJfQoJCi5mYy1jb250ZW50IHsKCWNsZWFyOiBib3RoOwoJfQoJCi5mYy1jb250ZW50IC5mYy1zdGF0ZS1kZWZhdWx0IHsKCWJvcmRlci1zdHlsZTogc29saWQ7Cglib3JkZXItY29sb3I6ICNjY2M7IC8qIGlubmVyIGJvcmRlciBjb2xvciAqLwoJfQoJCi5mYy1jb250ZW50IC5mYy1zdGF0ZS1oaWdobGlnaHQgeyAvKiB0b2RheSAqLwoJYmFja2dyb3VuZDogI2ZmYzsKCX0KCQouZmMtY29udGVudCAuZmMtbm90LXRvZGF5IHsKCWJhY2tncm91bmQ6IG5vbmU7Cgl9CgkKLmZjLWNlbGwtb3ZlcmxheSB7IC8qIHNlbWktdHJhbnNwYXJlbnQgcmVjdGFuZ2xlIHdoaWxlIGRyYWdnaW5nICovCgliYWNrZ3JvdW5kOiAjOWNmOwoJb3BhY2l0eTogLjI7CglmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MjApOyAvKiBmb3IgSUUgKi8KCX0KCQouZmMtdmlldyB7IC8qIHByZXZlbnRzIGRyYWdnaW5nIG91dHNpZGUgb2Ygd2lkZ2V0ICovCgl3aWR0aDogMTAwJTsKCW92ZXJmbG93OiBoaWRkZW47Cgl9CgkKCQoJCi8qIEdsb2JhbCBFdmVudCBTdHlsZXMKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCi5mYy1ldmVudCwKLmZjLWFnZW5kYSAuZmMtZXZlbnQtdGltZSwKLmZjLWV2ZW50IGEgewoJYm9yZGVyLXN0eWxlOiBzb2xpZDsgCglib3JkZXItY29sb3I6ICMzNmM7ICAgICAvKiBkZWZhdWx0IEJPUkRFUiBjb2xvciAocHJvYmFibHkgdGhlIHNhbWUgYXMgYmFja2dyb3VuZC1jb2xvcikgKi8KCWJhY2tncm91bmQtY29sb3I6ICMzNmM7IC8qIGRlZmF1bHQgQkFDS0dST1VORCBjb2xvciAqLwoJY29sb3I6ICNmZmY7ICAgICAgICAgICAgLyogZGVmYXVsdCBURVhUIGNvbG9yICovCgl9CgkKCS8qIFVzZSB0aGUgJ2NsYXNzTmFtZScgQ2FsRXZlbnQgcHJvcGVydHkgYW5kIHRoZSBmb2xsb3dpbmcKCSAqIGV4YW1wbGUgQ1NTIHRvIGNoYW5nZSBldmVudCBjb2xvciBvbiBhIHBlci1ldmVudCBiYXNpczoKCSAqCgkgKiAubXljbGFzcywKCSAqIC5mYy1hZ2VuZGEgLm15Y2xhc3MgLmZjLWV2ZW50LXRpbWUsCgkgKiAubXljbGFzcyBhIHsKCSAqICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsKCSAqICAgICBib3JkZXItY29sb3I6IGJsYWNrOwoJICogICAgIGNvbG9yOiByZWQ7CgkgKiAgICAgfQoJICovCgkgCi5mYy1ldmVudCB7Cgl0ZXh0LWFsaWduOiBsZWZ0OwoJfQoJCi5mYy1ldmVudCBhIHsKCW92ZXJmbG93OiBoaWRkZW47Cglmb250LXNpemU6IC44NWVtOwoJdGV4dC1kZWNvcmF0aW9uOiBub25lOwoJY3Vyc29yOiBwb2ludGVyOwoJfQoJCi5mYy1ldmVudC1lZGl0YWJsZSB7CgljdXJzb3I6IHBvaW50ZXI7Cgl9CgkKLmZjLWV2ZW50LXRpbWUsCi5mYy1ldmVudC10aXRsZSB7CglwYWRkaW5nOiAwIDFweDsKCX0KCQovKiBmb3IgZmFrZSByb3VuZGVkIGNvcm5lcnMgKi8KCi5mYy1ldmVudCBhIHsKCWRpc3BsYXk6IGJsb2NrOwoJcG9zaXRpb246IHJlbGF0aXZlOwoJd2lkdGg6IDEwMCU7CgloZWlnaHQ6IDEwMCU7Cgl9CgkKLyogcmlnaHQtdG8tbGVmdCAqLwoKLmZjLXJ0bCAuZmMtZXZlbnQgYSB7Cgl0ZXh0LWFsaWduOiByaWdodDsKCX0KCQovKiByZXNpemFibGUgKi8KCQouZmMgLnVpLXJlc2l6YWJsZS1oYW5kbGUgewoJZGlzcGxheTogYmxvY2s7Cglwb3NpdGlvbjogYWJzb2x1dGU7Cgl6LWluZGV4OiA5OTk5OTsKCWJvcmRlcjogMCAhaW1wb3J0YW50OyAvKiBpbXBvcnRhbnQgb3ZlcnJpZGVzIHByZSBqcXVlcnkgdWkgMS43IHN0eWxlcyAqLwoJYmFja2dyb3VuZDogdXJsKGRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxBQUFBKSAhaW1wb3J0YW50OyAvKiBob3ZlciBmaXggZm9yIElFICovCgl9CgkKCQoJCi8qIEhvcml6b250YWwgRXZlbnRzCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgouZmMtZXZlbnQtaG9yaSB7Cglib3JkZXItd2lkdGg6IDFweCAwOwoJbWFyZ2luLWJvdHRvbTogMXB4OwoJfQoJCi5mYy1ldmVudC1ob3JpIGEgewoJYm9yZGVyLXdpZHRoOiAwOwoJfQoJCi8qIGZvciBmYWtlIHJvdW5kZWQgY29ybmVycyAqLwoJCi5mYy1jb250ZW50IC5mYy1jb3JuZXItbGVmdCB7CgltYXJnaW4tbGVmdDogMXB4OwoJfQoJCi5mYy1jb250ZW50IC5mYy1jb3JuZXItbGVmdCBhIHsKCW1hcmdpbi1sZWZ0OiAtMXB4OwoJYm9yZGVyLWxlZnQtd2lkdGg6IDFweDsKCX0KCQouZmMtY29udGVudCAuZmMtY29ybmVyLXJpZ2h0IHsKCW1hcmdpbi1yaWdodDogMXB4OwoJfQoJCi5mYy1jb250ZW50IC5mYy1jb3JuZXItcmlnaHQgYSB7CgltYXJnaW4tcmlnaHQ6IC0xcHg7Cglib3JkZXItcmlnaHQtd2lkdGg6IDFweDsKCX0KCQovKiByZXNpemFibGUgKi8KCQouZmMtZXZlbnQtaG9yaSAudWktcmVzaXphYmxlLWUgewoJdG9wOiAwICAgICAgICAgICAhaW1wb3J0YW50OyAvKiBpbXBvcnRhbnRzIG92ZXJyaWRlIHByZSBqcXVlcnkgdWkgMS43IHN0eWxlcyAqLwoJcmlnaHQ6IC0zcHggICAgICAhaW1wb3J0YW50OwoJd2lkdGg6IDdweCAgICAgICAhaW1wb3J0YW50OwoJaGVpZ2h0OiAxMDAlICAgICAhaW1wb3J0YW50OwoJY3Vyc29yOiBlLXJlc2l6ZTsKCX0KCQouZmMtZXZlbnQtaG9yaSAudWktcmVzaXphYmxlLXcgewoJdG9wOiAwICAgICAgICAgICAhaW1wb3J0YW50OwoJbGVmdDogLTNweCAgICAgICAhaW1wb3J0YW50OwoJd2lkdGg6IDdweCAgICAgICAhaW1wb3J0YW50OwoJaGVpZ2h0OiAxMDAlICAgICAhaW1wb3J0YW50OwoJY3Vyc29yOiB3LXJlc2l6ZTsKCX0KCQouZmMtZXZlbnQtaG9yaSAudWktcmVzaXphYmxlLWhhbmRsZSB7CglfcGFkZGluZy1ib3R0b206IDE0cHg7IC8qIElFNiBoYWQgMCBoZWlnaHQgKi8KCX0KCQoJCgovKiBNb250aCBWaWV3LCBCYXNpYyBXZWVrIFZpZXcsIEJhc2ljIERheSBWaWV3Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgouZmMtZ3JpZCB0YWJsZSB7Cgl3aWR0aDogMTAwJTsKCX0KCQouZmMgLmZjLWdyaWQgdGggewoJYm9yZGVyLXdpZHRoOiAwIDAgMCAxcHg7Cgl0ZXh0LWFsaWduOiBjZW50ZXI7Cgl9CgkKLmZjIC5mYy1ncmlkIHRkIHsKCWJvcmRlci13aWR0aDogMXB4IDAgMCAxcHg7Cgl9CgkKLmZjLWdyaWQgdGguZmMtbGVmdG1vc3QsCi5mYy1ncmlkIHRkLmZjLWxlZnRtb3N0IHsKCWJvcmRlci1sZWZ0OiAwOwoJfQoJCi5mYy1ncmlkIC5mYy1kYXktbnVtYmVyIHsKCWZsb2F0OiByaWdodDsKCXBhZGRpbmc6IDAgMnB4OwoJfQoJCi5mYy1ncmlkIC5mYy1vdGhlci1tb250aCAuZmMtZGF5LW51bWJlciB7CglvcGFjaXR5OiAwLjM7CglmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MzApOyAvKiBmb3IgSUUgKi8KCS8qIG9wYWNpdHkgd2l0aCBzbWFsbCBmb250IGNhbiBzb21ldGltZXMgbG9vayB0b28gZmFkZWQKCSAgIG1pZ2h0IHdhbnQgdG8gc2V0IHRoZSAnY29sb3InIHByb3BlcnR5IGluc3RlYWQKCSAgIG1ha2luZyBkYXktbnVtYmVycyBib2xkIGFsc28gZml4ZXMgdGhlIHByb2JsZW0gKi8KCX0KCQouZmMtZ3JpZCAuZmMtZGF5LWNvbnRlbnQgewoJY2xlYXI6IGJvdGg7CglwYWRkaW5nOiAycHggMnB4IDA7IC8qIGRpc3RhbmNlIGJldHdlZW4gZXZlbnRzIGFuZCBkYXkgZWRnZXMgKi8KCX0KCQovKiBldmVudCBzdHlsZXMgKi8KCQouZmMtZ3JpZCAuZmMtZXZlbnQtdGltZSB7Cglmb250LXdlaWdodDogYm9sZDsKCX0KCQovKiByaWdodC10by1sZWZ0ICovCgouZmMtcnRsIC5mYy1ncmlkIHsKCWRpcmVjdGlvbjogcnRsOwoJfQoJCi5mYy1ydGwgLmZjLWdyaWQgLmZjLWRheS1udW1iZXIgewoJZmxvYXQ6IGxlZnQ7Cgl9CgkKLmZjLXJ0bCAuZmMtZ3JpZCAuZmMtZXZlbnQtdGltZSB7CglmbG9hdDogcmlnaHQ7Cgl9CgkKLyogQWdlbmRhIFdlZWsgVmlldywgQWdlbmRhIERheSBWaWV3Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgouZmMgLmZjLWFnZW5kYSB0aCwKLmZjIC5mYy1hZ2VuZGEgdGQgewoJYm9yZGVyLXdpZHRoOiAxcHggMCAwIDFweDsKCX0KCQouZmMgLmZjLWFnZW5kYSAuZmMtbGVmdG1vc3QgewoJYm9yZGVyLWxlZnQ6IDA7Cgl9CgkKLmZjLWFnZW5kYSB0ci5mYy1maXJzdCB0aCwKLmZjLWFnZW5kYSB0ci5mYy1maXJzdCB0ZCB7Cglib3JkZXItdG9wOiAwOwoJfQoJCi5mYy1hZ2VuZGEtaGVhZCB0ci5mYy1sYXN0IHRoIHsKCWJvcmRlci1ib3R0b20td2lkdGg6IDFweDsKCX0KCQouZmMgLmZjLWFnZW5kYS1oZWFkIHRkLAouZmMgLmZjLWFnZW5kYS1ib2R5IHRkIHsKCWJhY2tncm91bmQ6IG5vbmU7Cgl9CgkKLmZjLWFnZW5kYS1oZWFkIHRoIHsKCXRleHQtYWxpZ246IGNlbnRlcjsKCX0KCQovKiB0aGUgdGltZSBheGlzIHJ1bm5pbmcgZG93biB0aGUgbGVmdCBzaWRlICovCgkKLmZjLWFnZW5kYSAuZmMtYXhpcyB7Cgl3aWR0aDogNTBweDsKCXBhZGRpbmc6IDAgNHB4OwoJdmVydGljYWwtYWxpZ246IG1pZGRsZTsKCXdoaXRlLXNwYWNlOiBub3dyYXA7Cgl0ZXh0LWFsaWduOiByaWdodDsKCWZvbnQtd2VpZ2h0OiBub3JtYWw7Cgl9CgkKLyogYWxsLWRheSBldmVudCBjZWxscyBhdCB0b3AgKi8KCQouZmMtYWdlbmRhLWhlYWQgdHIuZmMtYWxsLWRheSB0aCB7CgloZWlnaHQ6IDM1cHg7Cgl9CgkKLmZjLWFnZW5kYS1oZWFkIHRkIHsKCXBhZGRpbmctYm90dG9tOiAxMHB4OwoJfQoJCi5mYyAuZmMtZGl2aWRlciBkaXYgewoJZm9udC1zaXplOiAxcHg7IC8qIGZvciBJRTYvNyAqLwoJaGVpZ2h0OiAycHg7Cgl9CgkKLmZjIC5mYy1kaXZpZGVyIC5mYy1zdGF0ZS1kZWZhdWx0IHsKCWJhY2tncm91bmQ6ICNlZWU7IC8qIGNvbG9yIGZvciBkaXZpZGVyIGJldHdlZW4gYWxsLWRheSBhbmQgdGltZS1zbG90IGV2ZW50cyAqLwoJfQoKLyogYm9keSBzdHlsZXMgKi8KCQouZmMgLmZjLWFnZW5kYS1ib2R5IHRkIGRpdiB7CgloZWlnaHQ6IDIwcHg7IC8qIHNsb3QgaGVpZ2h0ICovCgl9CgkKLmZjIC5mYy1hZ2VuZGEtYm9keSB0ci5mYy1taW5vciB0aCwKLmZjIC5mYy1hZ2VuZGEtYm9keSB0ci5mYy1taW5vciB0ZCB7Cglib3JkZXItdG9wLXN0eWxlOiBkb3R0ZWQ7Cgl9CgkKLmZjLWFnZW5kYSAuZmMtZGF5LWNvbnRlbnQgewoJcGFkZGluZzogMnB4IDJweCAwOyAvKiBkaXN0YW5jZSBiZXR3ZWVuIGV2ZW50cyBhbmQgZGF5IGVkZ2VzICovCgl9CgkKCgovKiBWZXJ0aWNhbCBFdmVudHMKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCi5mYy1ldmVudC12ZXJ0IHsKCWJvcmRlci13aWR0aDogMCAxcHg7Cgl9CgkKLmZjLWV2ZW50LXZlcnQgYSB7Cglib3JkZXItd2lkdGg6IDA7Cgl9CgkKLyogZm9yIGZha2Ugcm91bmRlZCBjb3JuZXJzICovCgkKLmZjLWNvbnRlbnQgLmZjLWNvcm5lci10b3AgewoJbWFyZ2luLXRvcDogMXB4OwoJfQoJCi5mYy1jb250ZW50IC5mYy1jb3JuZXItdG9wIGEgewoJbWFyZ2luLXRvcDogLTFweDsKCWJvcmRlci10b3Atd2lkdGg6IDFweDsKCX0KCQouZmMtY29udGVudCAuZmMtY29ybmVyLWJvdHRvbSB7CgltYXJnaW4tYm90dG9tOiAxcHg7Cgl9CgkKLmZjLWNvbnRlbnQgLmZjLWNvcm5lci1ib3R0b20gYSB7CgltYXJnaW4tYm90dG9tOiAtMXB4OwoJYm9yZGVyLWJvdHRvbS13aWR0aDogMXB4OwoJfQoJCi8qIGV2ZW50IGNvbnRlbnQgKi8KCQouZmMtZXZlbnQtdmVydCBzcGFuIHsKCWRpc3BsYXk6IGJsb2NrOwoJcG9zaXRpb246IHJlbGF0aXZlOwoJei1pbmRleDogMjsKCX0KCQouZmMtZXZlbnQtdmVydCBzcGFuLmZjLWV2ZW50LXRpbWUgewoJd2hpdGUtc3BhY2U6IG5vd3JhcDsKCV93aGl0ZS1zcGFjZTogbm9ybWFsOwoJb3ZlcmZsb3c6IGhpZGRlbjsKCWJvcmRlcjogMDsKCWZvbnQtc2l6ZTogMTBweDsKCX0KCQouZmMtZXZlbnQtdmVydCBzcGFuLmZjLWV2ZW50LXRpdGxlIHsKCWxpbmUtaGVpZ2h0OiAxM3B4OwoJfQoJCi5mYy1ldmVudC12ZXJ0IHNwYW4uZmMtZXZlbnQtYmcgeyAvKiBtYWtlcyB0aGUgZXZlbnQgbGlnaHRlciB3LyBhIHNlbWktdHJhbnNwYXJlbnQgb3ZlcmxheSAgKi8KCXBvc2l0aW9uOiBhYnNvbHV0ZTsKCXotaW5kZXg6IDE7Cgl0b3A6IDA7CglsZWZ0OiAwOwoJd2lkdGg6IDEwMCU7CgloZWlnaHQ6IDEwMCU7CgliYWNrZ3JvdW5kOiAjZmZmOwoJb3BhY2l0eTogLjM7CglmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MzApOyAvKiBmb3IgSUUgKi8KCX0KCQovKiByZXNpemFibGUgKi8KCQouZmMtZXZlbnQtdmVydCAudWktcmVzaXphYmxlLXMgewoJYm90dG9tOiAwICAgICAgICAhaW1wb3J0YW50OyAvKiBpbXBvcnRhbnRzIG92ZXJyaWRlIHByZSBqcXVlcnkgdWkgMS43IHN0eWxlcyAqLwoJd2lkdGg6IDEwMCUgICAgICAhaW1wb3J0YW50OwoJaGVpZ2h0OiA4cHggICAgICAhaW1wb3J0YW50OwoJbGluZS1oZWlnaHQ6IDhweCAhaW1wb3J0YW50OwoJZm9udC1zaXplOiAxMXB4ICAhaW1wb3J0YW50OwoJZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsKCXRleHQtYWxpZ246IGNlbnRlcjsKCWN1cnNvcjogcy1yZXNpemU7Cgl9CgkKCQo=",
	"fullcalendar.js": "LyoqCiAqIEBwcmVzZXJ2ZQogKiBGdWxsQ2FsZW5kYXIgdjEuNC43CiAqIGh0dHA6Ly9hcnNoYXcuY29tL2Z1bGxjYWxlbmRhci8KICoKICogVXNlIGZ1bGxjYWxlbmRhci5jc3MgZm9yIGJhc2ljIHN0eWxpbmcuCiAqIEZvciBldmVudCBkcmFnICYgZHJvcCwgcmVxdWlyZWQgalF1ZXJ5IFVJIGRyYWdnYWJsZS4KICogRm9yIGV2ZW50IHJlc2l6aW5nLCByZXF1aXJlcyBqUXVlcnkgVUkgcmVzaXphYmxlLgogKgogKiBDb3B5cmlnaHQgKGMpIDIwMDkgQWRhbSBTaGF3CiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzOgogKiAgIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwCiAqICAgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC5odG1sCiAqCiAqIERhdGU6IE1vbiBKdWwgNSAxNjowNzo0MCAyMDEwIC0wNzAwCiAqCiAqLwogCihmdW5jdGlvbigkLCB1bmRlZmluZWQpIHsKCgp2YXIgZmMgPSAkLmZ1bGxDYWxlbmRhciA9IHt9Owp2YXIgdmlld3MgPSBmYy52aWV3cyA9IHt9OwoKCi8qIERlZmF1bHRzCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCnZhciBkZWZhdWx0cyA9IHsKCgkvLyBkaXNwbGF5CglkZWZhdWx0VmlldzogJ21vbnRoJywKCWFzcGVjdFJhdGlvOiAxLjM1LAoJaGVhZGVyOiB7CgkJbGVmdDogJ3RpdGxlJywKCQljZW50ZXI6ICcnLAoJCXJpZ2h0OiAndG9kYXkgcHJldixuZXh0JwoJfSwKCXdlZWtlbmRzOiB0cnVlLAoJCgkvLyBlZGl0aW5nCgkvL2VkaXRhYmxlOiBmYWxzZSwKCS8vZGlzYWJsZURyYWdnaW5nOiBmYWxzZSwKCS8vZGlzYWJsZVJlc2l6aW5nOiBmYWxzZSwKCQoJYWxsRGF5RGVmYXVsdDogdHJ1ZSwKCQoJLy8gZXZlbnQgYWpheAoJbGF6eUZldGNoaW5nOiB0cnVlLAoJc3RhcnRQYXJhbTogJ3N0YXJ0JywKCWVuZFBhcmFtOiAnZW5kJywKCQoJLy8gdGltZSBmb3JtYXRzCgl0aXRsZUZvcm1hdDogewoJCW1vbnRoOiAnTU1NTSB5eXl5JywKCQl3ZWVrOiAiTU1NIGRbIHl5eXldeyAnJiM4MjEyOydbIE1NTV0gZCB5eXl5fSIsCgkJZGF5OiAnZGRkZCwgTU1NIGQsIHl5eXknCgl9LAoJY29sdW1uRm9ybWF0OiB7CgkJbW9udGg6ICdkZGQnLAoJCXdlZWs6ICdkZGQgTS9kJywKCQlkYXk6ICdkZGRkIE0vZCcKCX0sCgl0aW1lRm9ybWF0OiB7IC8vIGZvciBldmVudCBlbGVtZW50cwoJCScnOiAnaCg6bW0pdCcgLy8gZGVmYXVsdAoJfSwKCQoJLy8gbG9jYWxlCglpc1JUTDogZmFsc2UsCglmaXJzdERheTogMCwKCW1vbnRoTmFtZXM6IFsnSmFudWFyeScsJ0ZlYnJ1YXJ5JywnTWFyY2gnLCdBcHJpbCcsJ01heScsJ0p1bmUnLCdKdWx5JywnQXVndXN0JywnU2VwdGVtYmVyJywnT2N0b2JlcicsJ05vdmVtYmVyJywnRGVjZW1iZXInXSwKCW1vbnRoTmFtZXNTaG9ydDogWydKYW4nLCdGZWInLCdNYXInLCdBcHInLCdNYXknLCdKdW4nLCdKdWwnLCdBdWcnLCdTZXAnLCdPY3QnLCdOb3YnLCdEZWMnXSwKCWRheU5hbWVzOiBbJ1N1bmRheScsJ01vbmRheScsJ1R1ZXNkYXknLCdXZWRuZXNkYXknLCdUaHVyc2RheScsJ0ZyaWRheScsJ1NhdHVyZGF5J10sCglkYXlOYW1lc1Nob3J0OiBbJ1N1bicsJ01vbicsJ1R1ZScsJ1dlZCcsJ1RodScsJ0ZyaScsJ1NhdCddLAoJYnV0dG9uVGV4dDogewoJCXByZXY6ICcmbmJzcDsmIzk2Njg7Jm5ic3A7JywKCQluZXh0OiAnJm5ic3A7JiM5NjU4OyZuYnNwOycsCgkJcHJldlllYXI6ICcmbmJzcDsmbHQ7Jmx0OyZuYnNwOycsCgkJbmV4dFllYXI6ICcmbmJzcDsmZ3Q7Jmd0OyZuYnNwOycsCgkJdG9kYXk6ICd0b2RheScsCgkJbW9udGg6ICdtb250aCcsCgkJd2VlazogJ3dlZWsnLAoJCWRheTogJ2RheScKCX0sCgkKCS8vIGpxdWVyeS11aSB0aGVtaW5nCgl0aGVtZTogZmFsc2UsCglidXR0b25JY29uczogewoJCXByZXY6ICdjaXJjbGUtdHJpYW5nbGUtdycsCgkJbmV4dDogJ2NpcmNsZS10cmlhbmdsZS1lJwoJfSwKCQoJLy9zZWxlY3RhYmxlOiBmYWxzZSwKCXVuc2VsZWN0QXV0bzogdHJ1ZSwKCQoJZHJvcEFjY2VwdDogJyonCgkKfTsKCi8vIHJpZ2h0LXRvLWxlZnQgZGVmYXVsdHMKdmFyIHJ0bERlZmF1bHRzID0gewoJaGVhZGVyOiB7CgkJbGVmdDogJ25leHQscHJldiB0b2RheScsCgkJY2VudGVyOiAnJywKCQlyaWdodDogJ3RpdGxlJwoJfSwKCWJ1dHRvblRleHQ6IHsKCQlwcmV2OiAnJm5ic3A7JiM5NjU4OyZuYnNwOycsCgkJbmV4dDogJyZuYnNwOyYjOTY2ODsmbmJzcDsnLAoJCXByZXZZZWFyOiAnJm5ic3A7Jmd0OyZndDsmbmJzcDsnLAoJCW5leHRZZWFyOiAnJm5ic3A7Jmx0OyZsdDsmbmJzcDsnCgl9LAoJYnV0dG9uSWNvbnM6IHsKCQlwcmV2OiAnY2lyY2xlLXRyaWFuZ2xlLWUnLAoJCW5leHQ6ICdjaXJjbGUtdHJpYW5nbGUtdycKCX0KfTsKCi8vIGZ1bmN0aW9uIGZvciBhZGRpbmcvb3ZlcnJpZGluZyBkZWZhdWx0cwp2YXIgc2V0RGVmYXVsdHMgPSBmYy5zZXREZWZhdWx0cyA9IGZ1bmN0aW9uKGQpIHsKCSQuZXh0ZW5kKHRydWUsIGRlZmF1bHRzLCBkKTsKfTsKCgoKLyogLmZ1bGxDYWxlbmRhciBqUXVlcnkgZnVuY3Rpb24KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKJC5mbi5mdWxsQ2FsZW5kYXIgPSBmdW5jdGlvbihvcHRpb25zKSB7CgoJLy8gbWV0aG9kIGNhbGxpbmcKCWlmICh0eXBlb2Ygb3B0aW9ucyA9PSAnc3RyaW5nJykgewoJCXZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwKCQkJcmVzOwoJCXRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJdmFyIGRhdGEgPSAkLmRhdGEodGhpcywgJ2Z1bGxDYWxlbmRhcicpOwoJCQlpZiAoZGF0YSkgewoJCQkJdmFyIG1ldGggPSBkYXRhW29wdGlvbnNdOwoJCQkJaWYgKG1ldGgpIHsKCQkJCQl2YXIgciA9IG1ldGguYXBwbHkodGhpcywgYXJncyk7CgkJCQkJaWYgKHJlcyA9PT0gdW5kZWZpbmVkKSB7CgkJCQkJCXJlcyA9IHI7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfSk7CgkJaWYgKHJlcyAhPT0gdW5kZWZpbmVkKSB7CgkJCXJldHVybiByZXM7CgkJfQoJCXJldHVybiB0aGlzOwoJfQoKCS8vIHBsdWNrIHRoZSAnZXZlbnRzJyBhbmQgJ2V2ZW50U291cmNlcycgb3B0aW9ucwoJdmFyIGV2ZW50U291cmNlcyA9IG9wdGlvbnMuZXZlbnRTb3VyY2VzIHx8IFtdOwoJZGVsZXRlIG9wdGlvbnMuZXZlbnRTb3VyY2VzOwoJaWYgKG9wdGlvbnMuZXZlbnRzKSB7CgkJZXZlbnRTb3VyY2VzLnB1c2gob3B0aW9ucy5ldmVudHMpOwoJCWRlbGV0ZSBvcHRpb25zLmV2ZW50czsKCX0KCQoJLy8gZmlyc3QgZXZlbnQgc291cmNlIHJlc2VydmVkIGZvciAnc3RpY2t5JyBldmVudHMKCWV2ZW50U291cmNlcy51bnNoaWZ0KFtdKTsKCQoJLy8gaW5pdGlhbGl6ZSBvcHRpb25zCglvcHRpb25zID0gJC5leHRlbmQodHJ1ZSwge30sCgkJZGVmYXVsdHMsCgkJKG9wdGlvbnMuaXNSVEwgfHwgb3B0aW9ucy5pc1JUTD09PXVuZGVmaW5lZCAmJiBkZWZhdWx0cy5pc1JUTCkgPyBydGxEZWZhdWx0cyA6IHt9LAoJCW9wdGlvbnMKCSk7Cgl2YXIgdG0gPSBvcHRpb25zLnRoZW1lID8gJ3VpJyA6ICdmYyc7IC8vIGZvciBtYWtpbmcgdGhlbWUgY2xhc3NlcwoJCgkKCXRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQoJCgkJLyogSW5zdGFuY2UgSW5pdGlhbGl6YXRpb24KCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkJCgkJLy8gZWxlbWVudAoJCXZhciBfZWxlbWVudCA9IHRoaXMsCgkJCWVsZW1lbnQgPSAkKF9lbGVtZW50KS5hZGRDbGFzcygnZmMnKSwKCQkJZWxlbWVudE91dGVyV2lkdGgsCgkJCWNvbnRlbnQgPSAkKCI8ZGl2IGNsYXNzPSdmYy1jb250ZW50ICIgKyB0bSArICItd2lkZ2V0LWNvbnRlbnQnIHN0eWxlPSdwb3NpdGlvbjpyZWxhdGl2ZScvPiIpLnByZXBlbmRUbyhfZWxlbWVudCksCgkJCXN1Z2dlc3RlZFZpZXdIZWlnaHQsCgkJCXJlc2l6ZVVJRCA9IDAsCgkJCWlnbm9yZVdpbmRvd1Jlc2l6ZSA9IDAsCgkJCWRhdGUgPSBuZXcgRGF0ZSgpLAoJCQl2aWV3TmFtZSwgIC8vIHRoZSBjdXJyZW50IHZpZXcgbmFtZSAoVE9ETzogbG9vayBpbnRvIGdldHRpbmcgcmlkIG9mKQoJCQl2aWV3LCAgICAgIC8vIHRoZSBjdXJyZW50IHZpZXcKCQkJdmlld0luc3RhbmNlcyA9IHt9LAoJCQlhYnNvbHV0ZVZpZXdFbGVtZW50OwoJCQkKCQkJCgkJCQoJCWlmIChvcHRpb25zLmlzUlRMKSB7CgkJCWVsZW1lbnQuYWRkQ2xhc3MoJ2ZjLXJ0bCcpOwoJCX0KCQlpZiAob3B0aW9ucy50aGVtZSkgewoJCQllbGVtZW50LmFkZENsYXNzKCd1aS13aWRnZXQnKTsKCQl9CgkJCgkJc2V0WU1EKGRhdGUsIG9wdGlvbnMueWVhciwgb3B0aW9ucy5tb250aCwgb3B0aW9ucy5kYXRlKTsKCQkKCQkKCQkKCQkvKiBWaWV3IFJlbmRlcmluZwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQkKCQlmdW5jdGlvbiBjaGFuZ2VWaWV3KHYpIHsKCQkJaWYgKHYgIT0gdmlld05hbWUpIHsKCQkJCWlnbm9yZVdpbmRvd1Jlc2l6ZSsrOyAvLyBiZWNhdXNlIHNldE1pbkhlaWdodCBtaWdodCBjaGFuZ2UgdGhlIGhlaWdodCBiZWZvcmUgcmVuZGVyIChhbmQgc3Vic2VxdWVudGx5IHNldFNpemUpIGlzIHJlYWNoZWQKCgkJCQl2aWV3VW5zZWxlY3QoKTsKCQkJCQoJCQkJdmFyIG9sZFZpZXcgPSB2aWV3LAoJCQkJCW5ld1ZpZXdFbGVtZW50OwoJCQkJCQoJCQkJaWYgKG9sZFZpZXcpIHsKCQkJCQlpZiAob2xkVmlldy5ldmVudHNDaGFuZ2VkKSB7CgkJCQkJCWV2ZW50c0RpcnR5KCk7CgkJCQkJCW9sZFZpZXcuZXZlbnREaXJ0eSA9IG9sZFZpZXcuZXZlbnRzQ2hhbmdlZCA9IGZhbHNlOwoJCQkJCX0KCQkJCQlpZiAob2xkVmlldy5iZWZvcmVIaWRlKSB7CgkJCQkJCW9sZFZpZXcuYmVmb3JlSGlkZSgpOyAvLyBjYWxsZWQgYmVmb3JlIGNoYW5naW5nIG1pbi1oZWlnaHQuIGlmIGNhbGxlZCBhZnRlciwgc2Nyb2xsIHN0YXRlIGlzIHJlc2V0IChpbiBPcGVyYSkKCQkJCQl9CgkJCQkJc2V0TWluSGVpZ2h0KGNvbnRlbnQsIGNvbnRlbnQuaGVpZ2h0KCkpOwoJCQkJCW9sZFZpZXcuZWxlbWVudC5oaWRlKCk7CgkJCQl9ZWxzZXsKCQkJCQlzZXRNaW5IZWlnaHQoY29udGVudCwgMSk7IC8vIG5lZWRzIHRvIGJlIDEgKG5vdCAwKSBmb3IgSUU3LCBvciBlbHNlIHZpZXcgZGltZW5zaW9ucyBtaXNjYWxjdWxhdGVkCgkJCQl9CgkJCQljb250ZW50LmNzcygnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7CgkJCQkKCQkJCWlmICh2aWV3SW5zdGFuY2VzW3ZdKSB7CgkJCQkJKHZpZXcgPSB2aWV3SW5zdGFuY2VzW3ZdKS5lbGVtZW50LnNob3coKTsKCQkJCX1lbHNlewoJCQkJCXZpZXcgPSB2aWV3SW5zdGFuY2VzW3ZdID0gZmMudmlld3Nbdl0oCgkJCQkJCW5ld1ZpZXdFbGVtZW50ID0gYWJzb2x1dGVWaWV3RWxlbWVudCA9CgkJCQkJCQkkKCI8ZGl2IGNsYXNzPSdmYy12aWV3IGZjLXZpZXctIiArIHYgKyAiJyBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGUnLz4iKQoJCQkJCQkJCS5hcHBlbmRUbyhjb250ZW50KSwKCQkJCQkJb3B0aW9ucywKCQkJCQkJdiAvLyB0aGUgdmlldydzIG5hbWUKCQkJCQkpOwoJCQkJfQoJCQkJCgkJCQlpZiAoaGVhZGVyKSB7CgkJCQkJLy8gdXBkYXRlICdhY3RpdmUnIHZpZXcgYnV0dG9uCgkJCQkJaGVhZGVyLmZpbmQoJ2Rpdi5mYy1idXR0b24tJyArIHZpZXdOYW1lKS5yZW1vdmVDbGFzcyh0bSArICctc3RhdGUtYWN0aXZlJyk7CgkJCQkJaGVhZGVyLmZpbmQoJ2Rpdi5mYy1idXR0b24tJyArIHYpLmFkZENsYXNzKHRtICsgJy1zdGF0ZS1hY3RpdmUnKTsKCQkJCX0KCQkJCQoJCQkJdmlld05hbWUgPSB2OwoJCQkJcmVuZGVyKCk7IC8vIGFmdGVyIGhlaWdodCBoYXMgYmVlbiBzZXQsIHdpbGwgbWFrZSBhYnNvbHV0ZVZpZXdFbGVtZW50J3MgcG9zaXRpb249cmVsYXRpdmUsIHRoZW4gc2V0IHRvIG51bGwKCQkJCWNvbnRlbnQuY3NzKCdvdmVyZmxvdycsICcnKTsKCQkJCWlmIChvbGRWaWV3KSB7CgkJCQkJc2V0TWluSGVpZ2h0KGNvbnRlbnQsIDEpOwoJCQkJfQoJCQkJaWYgKCFuZXdWaWV3RWxlbWVudCAmJiB2aWV3LmFmdGVyU2hvdykgewoJCQkJCXZpZXcuYWZ0ZXJTaG93KCk7IC8vIGNhbGxlZCBhZnRlciBzZXR0aW5nIG1pbi1oZWlnaHQvb3ZlcmZsb3csIHNvIGluIGZpbmFsIHNjcm9sbCBzdGF0ZSAoZm9yIE9wZXJhKQoJCQkJfQoJCQkJCgkJCQlpZ25vcmVXaW5kb3dSZXNpemUtLTsKCQkJfQoJCX0KCQkKCQkKCQlmdW5jdGlvbiByZW5kZXIoaW5jKSB7CgkJCWlmIChlbGVtZW50VmlzaWJsZSgpKSB7CgkJCQlpZ25vcmVXaW5kb3dSZXNpemUrKzsgLy8gYmVjYXVzZSB2aWV3LnJlbmRlckV2ZW50cyBtaWdodCB0ZW1wb3JhcmlseSBjaGFuZ2UgdGhlIGhlaWdodCBiZWZvcmUgc2V0U2l6ZSBpcyByZWFjaGVkCgoJCQkJdmlld1Vuc2VsZWN0KCk7CgkJCQkKCQkJCWlmIChzdWdnZXN0ZWRWaWV3SGVpZ2h0ID09PSB1bmRlZmluZWQpIHsKCQkJCQljYWxjU2l6ZSgpOwoJCQkJfQoJCQkJCgkJCQlpZiAoIXZpZXcuc3RhcnQgfHwgaW5jIHx8IGRhdGUgPCB2aWV3LnN0YXJ0IHx8IGRhdGUgPj0gdmlldy5lbmQpIHsKCQkJCQl2aWV3LnJlbmRlcihkYXRlLCBpbmMgfHwgMCk7IC8vIHJlc3BvbnNpYmxlIGZvciBjbGVhcmluZyBldmVudHMKCQkJCQlzZXRTaXplKHRydWUpOwoJCQkJCWlmICghZXZlbnRTdGFydCB8fCAhb3B0aW9ucy5sYXp5RmV0Y2hpbmcgfHwgdmlldy52aXNTdGFydCA8IGV2ZW50U3RhcnQgfHwgdmlldy52aXNFbmQgPiBldmVudEVuZCkgewoJCQkJCQlmZXRjaEFuZFJlbmRlckV2ZW50cygpOwoJCQkJCX1lbHNlewoJCQkJCQl2aWV3LnJlbmRlckV2ZW50cyhldmVudHMpOyAvLyBkb24ndCByZWZldGNoCgkJCQkJfQoJCQkJfQoJCQkJZWxzZSBpZiAodmlldy5zaXplRGlydHkgfHwgdmlldy5ldmVudHNEaXJ0eSB8fCAhb3B0aW9ucy5sYXp5RmV0Y2hpbmcpIHsKCQkJCQl2aWV3LmNsZWFyRXZlbnRzKCk7CgkJCQkJaWYgKHZpZXcuc2l6ZURpcnR5KSB7CgkJCQkJCXNldFNpemUoKTsKCQkJCQl9CgkJCQkJaWYgKG9wdGlvbnMubGF6eUZldGNoaW5nKSB7CgkJCQkJCXZpZXcucmVuZGVyRXZlbnRzKGV2ZW50cyk7IC8vIGRvbid0IHJlZmV0Y2gKCQkJCQl9ZWxzZXsKCQkJCQkJZmV0Y2hBbmRSZW5kZXJFdmVudHMoKTsKCQkJCQl9CgkJCQl9CgkJCQllbGVtZW50T3V0ZXJXaWR0aCA9IGVsZW1lbnQub3V0ZXJXaWR0aCgpOwoJCQkJdmlldy5zaXplRGlydHkgPSBmYWxzZTsKCQkJCXZpZXcuZXZlbnRzRGlydHkgPSBmYWxzZTsKCQkJCQoJCQkJaWYgKGhlYWRlcikgewoJCQkJCS8vIHVwZGF0ZSB0aXRsZSB0ZXh0CgkJCQkJaGVhZGVyLmZpbmQoJ2gyLmZjLWhlYWRlci10aXRsZScpLmh0bWwodmlldy50aXRsZSk7CgkJCQkJLy8gZW5hYmxlL2Rpc2FibGUgJ3RvZGF5JyBidXR0b24KCQkJCQl2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOwoJCQkJCWlmICh0b2RheSA+PSB2aWV3LnN0YXJ0ICYmIHRvZGF5IDwgdmlldy5lbmQpIHsKCQkJCQkJaGVhZGVyLmZpbmQoJ2Rpdi5mYy1idXR0b24tdG9kYXknKS5hZGRDbGFzcyh0bSArICctc3RhdGUtZGlzYWJsZWQnKTsKCQkJCQl9ZWxzZXsKCQkJCQkJaGVhZGVyLmZpbmQoJ2Rpdi5mYy1idXR0b24tdG9kYXknKS5yZW1vdmVDbGFzcyh0bSArICctc3RhdGUtZGlzYWJsZWQnKTsKCQkJCQl9CgkJCQl9CgkJCQkKCQkJCWlnbm9yZVdpbmRvd1Jlc2l6ZS0tOwoJCQkJdmlldy50cmlnZ2VyKCd2aWV3RGlzcGxheScsIF9lbGVtZW50KTsKCQkJfQoJCX0KCQkKCQkKCQlmdW5jdGlvbiBlbGVtZW50VmlzaWJsZSgpIHsKCQkJcmV0dXJuIF9lbGVtZW50Lm9mZnNldFdpZHRoICE9PSAwOwoJCX0KCQkKCQlmdW5jdGlvbiBib2R5VmlzaWJsZSgpIHsKCQkJcmV0dXJuICQoJ2JvZHknKVswXS5vZmZzZXRXaWR0aCAhPT0gMDsKCQl9CgoJCWZ1bmN0aW9uIHZpZXdVbnNlbGVjdCgpIHsKCQkJaWYgKHZpZXcpIHsKCQkJCXZpZXcudW5zZWxlY3QoKTsKCQkJfQoJCX0KCQkKCQkKCQkvLyBjYWxsZWQgd2hlbiBhbnkgZXZlbnQgb2JqZWN0cyBoYXZlIGJlZW4gYWRkZWQvcmVtb3ZlZC9jaGFuZ2VkLCByZXJlbmRlcnMKCQlmdW5jdGlvbiBldmVudHNDaGFuZ2VkKCkgewoJCQlldmVudHNEaXJ0eSgpOwoJCQlpZiAoZWxlbWVudFZpc2libGUoKSkgewoJCQkJdmlldy5jbGVhckV2ZW50cygpOwoJCQkJdmlldy5yZW5kZXJFdmVudHMoZXZlbnRzKTsKCQkJCXZpZXcuZXZlbnRzRGlydHkgPSBmYWxzZTsKCQkJfQoJCX0KCQkKCQkvLyBtYXJrcyBvdGhlciB2aWV3cycgZXZlbnRzIGFzIGRpcnR5CgkJZnVuY3Rpb24gZXZlbnRzRGlydHkoKSB7CgkJCSQuZWFjaCh2aWV3SW5zdGFuY2VzLCBmdW5jdGlvbigpIHsKCQkJCXRoaXMuZXZlbnRzRGlydHkgPSB0cnVlOwoJCQl9KTsKCQl9CgkJCgkJLy8gY2FsbGVkIHdoZW4gd2Uga25vdyB0aGUgZWxlbWVudCBzaXplIGhhcyBjaGFuZ2VkCgkJZnVuY3Rpb24gc2l6ZUNoYW5nZWQoKSB7CgkJCXNpemVzRGlydHkoKTsKCQkJaWYgKGVsZW1lbnRWaXNpYmxlKCkpIHsKCQkJCWNhbGNTaXplKCk7CgkJCQlzZXRTaXplKCk7CgkJCQl2aWV3VW5zZWxlY3QoKTsKCQkJCXZpZXcucmVyZW5kZXJFdmVudHMoKTsKCQkJCXZpZXcuc2l6ZURpcnR5ID0gZmFsc2U7CgkJCX0KCQl9CgkJCgkJLy8gbWFya3Mgb3RoZXIgdmlld3MnIHNpemVzIGFzIGRpcnR5CgkJZnVuY3Rpb24gc2l6ZXNEaXJ0eSgpIHsKCQkJJC5lYWNoKHZpZXdJbnN0YW5jZXMsIGZ1bmN0aW9uKCkgewoJCQkJdGhpcy5zaXplRGlydHkgPSB0cnVlOwoJCQl9KTsKCQl9CgkJCgkJCgkJCgkJCgkJLyogRXZlbnQgU291cmNlcyBhbmQgRmV0Y2hpbmcKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkJCgkJdmFyIGV2ZW50cyA9IFtdLAoJCQlldmVudFN0YXJ0LCBldmVudEVuZDsKCQkKCQkvLyBGZXRjaCBmcm9tIEFMTCBzb3VyY2VzLiBDbGVhciAnZXZlbnRzJyBhcnJheSBhbmQgcG9wdWxhdGUKCQlmdW5jdGlvbiBmZXRjaEV2ZW50cyhjYWxsYmFjaykgewoJCQlldmVudHMgPSBbXTsKCQkJZXZlbnRTdGFydCA9IGNsb25lRGF0ZSh2aWV3LnZpc1N0YXJ0KTsKCQkJZXZlbnRFbmQgPSBjbG9uZURhdGUodmlldy52aXNFbmQpOwoJCQl2YXIgcXVldWVkID0gZXZlbnRTb3VyY2VzLmxlbmd0aCwKCQkJCXNvdXJjZURvbmUgPSBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIS0tcXVldWVkKSB7CgkJCQkJCWlmIChjYWxsYmFjaykgewoJCQkJCQkJY2FsbGJhY2soZXZlbnRzKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0sIGk9MDsKCQkJZm9yICg7IGk8ZXZlbnRTb3VyY2VzLmxlbmd0aDsgaSsrKSB7CgkJCQlmZXRjaEV2ZW50U291cmNlKGV2ZW50U291cmNlc1tpXSwgc291cmNlRG9uZSk7CgkJCX0KCQl9CgkJCgkJLy8gRmV0Y2ggZnJvbSBhIHBhcnRpY3VsYXIgc291cmNlLiBBcHBlbmQgdG8gdGhlICdldmVudHMnIGFycmF5CgkJZnVuY3Rpb24gZmV0Y2hFdmVudFNvdXJjZShzcmMsIGNhbGxiYWNrKSB7CgkJCXZhciBwcmV2Vmlld05hbWUgPSB2aWV3Lm5hbWUsCgkJCQlwcmV2RGF0ZSA9IGNsb25lRGF0ZShkYXRlKSwKCQkJCXJlcG9ydEV2ZW50cyA9IGZ1bmN0aW9uKGEpIHsKCQkJCQlpZiAocHJldlZpZXdOYW1lID09IHZpZXcubmFtZSAmJiArcHJldkRhdGUgPT0gK2RhdGUgJiYgLy8gcHJvdGVjdHMgZnJvbSBmYXN0IHN3aXRjaGluZwoJCQkJCQkkLmluQXJyYXkoc3JjLCBldmVudFNvdXJjZXMpICE9IC0xKSB7ICAgICAgICAgICAgICAvLyBtYWtlcyBzdXJlIHNvdXJjZSBoYXNuJ3QgYmVlbiByZW1vdmVkCgkJCQkJCQlmb3IgKHZhciBpPTA7IGk8YS5sZW5ndGg7IGkrKykgewoJCQkJCQkJCW5vcm1hbGl6ZUV2ZW50KGFbaV0sIG9wdGlvbnMpOwoJCQkJCQkJCWFbaV0uc291cmNlID0gc3JjOwoJCQkJCQkJfQoJCQkJCQkJZXZlbnRzID0gZXZlbnRzLmNvbmNhdChhKTsKCQkJCQkJCWlmIChjYWxsYmFjaykgewoJCQkJCQkJCWNhbGxiYWNrKGEpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQl9LAoJCQkJcmVwb3J0RXZlbnRzQW5kUG9wID0gZnVuY3Rpb24oYSkgewoJCQkJCXJlcG9ydEV2ZW50cyhhKTsKCQkJCQlwb3BMb2FkaW5nKCk7CgkJCQl9OwoJCQlpZiAodHlwZW9mIHNyYyA9PSAnc3RyaW5nJykgewoJCQkJdmFyIHBhcmFtcyA9IHt9OwoJCQkJcGFyYW1zW29wdGlvbnMuc3RhcnRQYXJhbV0gPSBNYXRoLnJvdW5kKGV2ZW50U3RhcnQuZ2V0VGltZSgpIC8gMTAwMCk7CgkJCQlwYXJhbXNbb3B0aW9ucy5lbmRQYXJhbV0gPSBNYXRoLnJvdW5kKGV2ZW50RW5kLmdldFRpbWUoKSAvIDEwMDApOwoJCQkJaWYgKG9wdGlvbnMuY2FjaGVQYXJhbSkgewoJCQkJCXBhcmFtc1tvcHRpb25zLmNhY2hlUGFyYW1dID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTsgLy8gVE9ETzogZGVwcmVjYXRlIGNhY2hlUGFyYW0KCQkJCX0KCQkJCXB1c2hMb2FkaW5nKCk7CgkJCQkkLmFqYXgoewoJCQkJCXVybDogc3JjLAoJCQkJCWRhdGFUeXBlOiAnanNvbicsCgkJCQkJZGF0YTogcGFyYW1zLAoJCQkJCWNhY2hlOiBvcHRpb25zLmNhY2hlUGFyYW0gfHwgZmFsc2UsIC8vIGRvbid0IGxldCBqcXVlcnkgcHJldmVudCBjYWNoaW5nIGlmIGNhY2hlUGFyYW0gaXMgYmVpbmcgdXNlZAoJCQkJCXN1Y2Nlc3M6IHJlcG9ydEV2ZW50c0FuZFBvcAoJCQkJfSk7CgkJCX0KCQkJZWxzZSBpZiAoJC5pc0Z1bmN0aW9uKHNyYykpIHsKCQkJCXB1c2hMb2FkaW5nKCk7CgkJCQlzcmMoY2xvbmVEYXRlKGV2ZW50U3RhcnQpLCBjbG9uZURhdGUoZXZlbnRFbmQpLCByZXBvcnRFdmVudHNBbmRQb3ApOwoJCQl9CgkJCWVsc2UgewoJCQkJcmVwb3J0RXZlbnRzKHNyYyk7IC8vIHNyYyBpcyBhbiBhcnJheQoJCQl9CgkJfQoJCQoJCQoJCS8vIGZvciBjb252ZW5pZW5jZQoJCWZ1bmN0aW9uIGZldGNoQW5kUmVuZGVyRXZlbnRzKCkgewoJCQlmZXRjaEV2ZW50cyhmdW5jdGlvbihldmVudHMpIHsKCQkJCXZpZXcucmVuZGVyRXZlbnRzKGV2ZW50cyk7IC8vIG1haW50YWluIGB0aGlzYCBpbiB2aWV3CgkJCX0pOwoJCX0KCQkKCQkKCQkKCQkvKiBMb2FkaW5nIFN0YXRlCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCQoJCXZhciBsb2FkaW5nTGV2ZWwgPSAwOwoJCQoJCWZ1bmN0aW9uIHB1c2hMb2FkaW5nKCkgewoJCQlpZiAoIWxvYWRpbmdMZXZlbCsrKSB7CgkJCQl2aWV3LnRyaWdnZXIoJ2xvYWRpbmcnLCBfZWxlbWVudCwgdHJ1ZSk7CgkJCX0KCQl9CgkJCgkJZnVuY3Rpb24gcG9wTG9hZGluZygpIHsKCQkJaWYgKCEtLWxvYWRpbmdMZXZlbCkgewoJCQkJdmlldy50cmlnZ2VyKCdsb2FkaW5nJywgX2VsZW1lbnQsIGZhbHNlKTsKCQkJfQoJCX0KCQkKCQkKCQkKCQkvKiBQdWJsaWMgTWV0aG9kcwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQkKCQl2YXIgcHVibGljTWV0aG9kcyA9IHsKCQkKCQkJcmVuZGVyOiBmdW5jdGlvbigpIHsKCQkJCWNhbGNTaXplKCk7CgkJCQlzaXplc0RpcnR5KCk7CgkJCQlldmVudHNEaXJ0eSgpOwoJCQkJcmVuZGVyKCk7CgkJCX0sCgkJCQoJCQljaGFuZ2VWaWV3OiBjaGFuZ2VWaWV3LAoJCQkKCQkJZ2V0VmlldzogZnVuY3Rpb24oKSB7CgkJCQlyZXR1cm4gdmlldzsKCQkJfSwKCQkJCgkJCWdldERhdGU6IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIGRhdGU7CgkJCX0sCgkJCQoJCQlvcHRpb246IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CgkJCQlpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewoJCQkJCXJldHVybiBvcHRpb25zW25hbWVdOwoJCQkJfQoJCQkJaWYgKG5hbWUgPT0gJ2hlaWdodCcgfHwgbmFtZSA9PSAnY29udGVudEhlaWdodCcgfHwgbmFtZSA9PSAnYXNwZWN0UmF0aW8nKSB7CgkJCQkJb3B0aW9uc1tuYW1lXSA9IHZhbHVlOwoJCQkJCXNpemVDaGFuZ2VkKCk7CgkJCQl9CgkJCX0sCgkJCQoJCQlkZXN0cm95OiBmdW5jdGlvbigpIHsKCQkJCSQod2luZG93KS51bmJpbmQoJ3Jlc2l6ZScsIHdpbmRvd1Jlc2l6ZSk7CgkJCQlpZiAoaGVhZGVyKSB7CgkJCQkJaGVhZGVyLnJlbW92ZSgpOwoJCQkJfQoJCQkJY29udGVudC5yZW1vdmUoKTsKCQkJCSQucmVtb3ZlRGF0YShfZWxlbWVudCwgJ2Z1bGxDYWxlbmRhcicpOwoJCQl9LAoJCQkKCQkJLy8KCQkJLy8gTmF2aWdhdGlvbgoJCQkvLwoJCQkKCQkJcHJldjogZnVuY3Rpb24oKSB7CgkJCQlyZW5kZXIoLTEpOwoJCQl9LAoJCQkKCQkJbmV4dDogZnVuY3Rpb24oKSB7CgkJCQlyZW5kZXIoMSk7CgkJCX0sCgkJCQoJCQlwcmV2WWVhcjogZnVuY3Rpb24oKSB7CgkJCQlhZGRZZWFycyhkYXRlLCAtMSk7CgkJCQlyZW5kZXIoKTsKCQkJfSwKCQkJCgkJCW5leHRZZWFyOiBmdW5jdGlvbigpIHsKCQkJCWFkZFllYXJzKGRhdGUsIDEpOwoJCQkJcmVuZGVyKCk7CgkJCX0sCgkJCQoJCQl0b2RheTogZnVuY3Rpb24oKSB7CgkJCQlkYXRlID0gbmV3IERhdGUoKTsKCQkJCXJlbmRlcigpOwoJCQl9LAoJCQkKCQkJZ290b0RhdGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlTnVtKSB7CgkJCQlpZiAodHlwZW9mIHllYXIgPT0gJ29iamVjdCcpIHsKCQkJCQlkYXRlID0gY2xvbmVEYXRlKHllYXIpOyAvLyBwcm92aWRlZCAxIGFyZ3VtZW50LCBhIERhdGUKCQkJCX1lbHNlewoJCQkJCXNldFlNRChkYXRlLCB5ZWFyLCBtb250aCwgZGF0ZU51bSk7CgkJCQl9CgkJCQlyZW5kZXIoKTsKCQkJfSwKCQkJCgkJCWluY3JlbWVudERhdGU6IGZ1bmN0aW9uKHllYXJzLCBtb250aHMsIGRheXMpIHsKCQkJCWlmICh5ZWFycyAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJYWRkWWVhcnMoZGF0ZSwgeWVhcnMpOwoJCQkJfQoJCQkJaWYgKG1vbnRocyAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJYWRkTW9udGhzKGRhdGUsIG1vbnRocyk7CgkJCQl9CgkJCQlpZiAoZGF5cyAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJYWRkRGF5cyhkYXRlLCBkYXlzKTsKCQkJCX0KCQkJCXJlbmRlcigpOwoJCQl9LAoJCQkKCQkJLy8KCQkJLy8gRXZlbnQgTWFuaXB1bGF0aW9uCgkJCS8vCgkJCQoJCQl1cGRhdGVFdmVudDogZnVuY3Rpb24oZXZlbnQpIHsgLy8gdXBkYXRlIGFuIGV4aXN0aW5nIGV2ZW50CgkJCQl2YXIgaSwgbGVuID0gZXZlbnRzLmxlbmd0aCwgZSwKCQkJCQlzdGFydERlbHRhID0gZXZlbnQuc3RhcnQgLSBldmVudC5fc3RhcnQsCgkJCQkJZW5kRGVsdGEgPSBldmVudC5lbmQgPwoJCQkJCQkoZXZlbnQuZW5kIC0gKGV2ZW50Ll9lbmQgfHwgdmlldy5kZWZhdWx0RXZlbnRFbmQoZXZlbnQpKSkgLy8gZXZlbnQuX2VuZCB3b3VsZCBiZSBudWxsIGlmIGV2ZW50LmVuZAoJCQkJCQk6IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2FzIG51bGwgYW5kIGV2ZW50IHdhcyBqdXN0IHJlc2l6ZWQKCQkJCWZvciAoaT0wOyBpPGxlbjsgaSsrKSB7CgkJCQkJZSA9IGV2ZW50c1tpXTsKCQkJCQlpZiAoZS5faWQgPT0gZXZlbnQuX2lkICYmIGUgIT0gZXZlbnQpIHsKCQkJCQkJZS5zdGFydCA9IG5ldyBEYXRlKCtlLnN0YXJ0ICsgc3RhcnREZWx0YSk7CgkJCQkJCWlmIChldmVudC5lbmQpIHsKCQkJCQkJCWlmIChlLmVuZCkgewoJCQkJCQkJCWUuZW5kID0gbmV3IERhdGUoK2UuZW5kICsgZW5kRGVsdGEpOwoJCQkJCQkJfWVsc2V7CgkJCQkJCQkJZS5lbmQgPSBuZXcgRGF0ZSgrdmlldy5kZWZhdWx0RXZlbnRFbmQoZSkgKyBlbmREZWx0YSk7CgkJCQkJCQl9CgkJCQkJCX1lbHNlewoJCQkJCQkJZS5lbmQgPSBudWxsOwoJCQkJCQl9CgkJCQkJCWUudGl0bGUgPSBldmVudC50aXRsZTsKCQkJCQkJZS51cmwgPSBldmVudC51cmw7CgkJCQkJCWUuYWxsRGF5ID0gZXZlbnQuYWxsRGF5OwoJCQkJCQllLmNsYXNzTmFtZSA9IGV2ZW50LmNsYXNzTmFtZTsKCQkJCQkJZS5lZGl0YWJsZSA9IGV2ZW50LmVkaXRhYmxlOwoJCQkJCQlub3JtYWxpemVFdmVudChlLCBvcHRpb25zKTsKCQkJCQl9CgkJCQl9CgkJCQlub3JtYWxpemVFdmVudChldmVudCwgb3B0aW9ucyk7CgkJCQlldmVudHNDaGFuZ2VkKCk7CgkJCX0sCgkJCQoJCQlyZW5kZXJFdmVudDogZnVuY3Rpb24oZXZlbnQsIHN0aWNrKSB7IC8vIHJlbmRlciBhIG5ldyBldmVudAoJCQkJbm9ybWFsaXplRXZlbnQoZXZlbnQsIG9wdGlvbnMpOwoJCQkJaWYgKCFldmVudC5zb3VyY2UpIHsKCQkJCQlpZiAoc3RpY2spIHsKCQkJCQkJKGV2ZW50LnNvdXJjZSA9IGV2ZW50U291cmNlc1swXSkucHVzaChldmVudCk7CgkJCQkJfQoJCQkJCWV2ZW50cy5wdXNoKGV2ZW50KTsKCQkJCX0KCQkJCWV2ZW50c0NoYW5nZWQoKTsKCQkJfSwKCQkJCgkJCXJlbW92ZUV2ZW50czogZnVuY3Rpb24oZmlsdGVyKSB7CgkJCQlpZiAoIWZpbHRlcikgeyAvLyByZW1vdmUgYWxsCgkJCQkJZXZlbnRzID0gW107CgkJCQkJLy8gY2xlYXIgYWxsIGFycmF5IHNvdXJjZXMKCQkJCQlmb3IgKHZhciBpPTA7IGk8ZXZlbnRTb3VyY2VzLmxlbmd0aDsgaSsrKSB7CgkJCQkJCWlmICh0eXBlb2YgZXZlbnRTb3VyY2VzW2ldID09ICdvYmplY3QnKSB7CgkJCQkJCQlldmVudFNvdXJjZXNbaV0gPSBbXTsKCQkJCQkJfQoJCQkJCX0KCQkJCX1lbHNlewoJCQkJCWlmICghJC5pc0Z1bmN0aW9uKGZpbHRlcikpIHsgLy8gYW4gZXZlbnQgSUQKCQkJCQkJdmFyIGlkID0gZmlsdGVyICsgJyc7CgkJCQkJCWZpbHRlciA9IGZ1bmN0aW9uKGUpIHsKCQkJCQkJCXJldHVybiBlLl9pZCA9PSBpZDsKCQkJCQkJfTsKCQkJCQl9CgkJCQkJZXZlbnRzID0gJC5ncmVwKGV2ZW50cywgZmlsdGVyLCB0cnVlKTsKCQkJCQkvLyByZW1vdmUgZXZlbnRzIGZyb20gYXJyYXkgc291cmNlcwoJCQkJCWZvciAodmFyIGk9MDsgaTxldmVudFNvdXJjZXMubGVuZ3RoOyBpKyspIHsKCQkJCQkJaWYgKHR5cGVvZiBldmVudFNvdXJjZXNbaV0gPT0gJ29iamVjdCcpIHsKCQkJCQkJCWV2ZW50U291cmNlc1tpXSA9ICQuZ3JlcChldmVudFNvdXJjZXNbaV0sIGZpbHRlciwgdHJ1ZSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQlldmVudHNDaGFuZ2VkKCk7CgkJCX0sCgkJCQoJCQljbGllbnRFdmVudHM6IGZ1bmN0aW9uKGZpbHRlcikgewoJCQkJaWYgKCQuaXNGdW5jdGlvbihmaWx0ZXIpKSB7CgkJCQkJcmV0dXJuICQuZ3JlcChldmVudHMsIGZpbHRlcik7CgkJCQl9CgkJCQllbHNlIGlmIChmaWx0ZXIpIHsgLy8gYW4gZXZlbnQgSUQKCQkJCQlmaWx0ZXIgKz0gJyc7CgkJCQkJcmV0dXJuICQuZ3JlcChldmVudHMsIGZ1bmN0aW9uKGUpIHsKCQkJCQkJcmV0dXJuIGUuX2lkID09IGZpbHRlcjsKCQkJCQl9KTsKCQkJCX0KCQkJCXJldHVybiBldmVudHM7IC8vIGVsc2UsIHJldHVybiBhbGwKCQkJfSwKCQkJCgkJCXJlcmVuZGVyRXZlbnRzOiBldmVudHNDaGFuZ2VkLCAvLyBUT0RPOiB0aGluayBvZiByZW5hbWluZyBldmVudHNDaGFuZ2VkCgkJCQoJCQkvLwoJCQkvLyBFdmVudCBTb3VyY2UKCQkJLy8KCQkKCQkJYWRkRXZlbnRTb3VyY2U6IGZ1bmN0aW9uKHNvdXJjZSkgewoJCQkJZXZlbnRTb3VyY2VzLnB1c2goc291cmNlKTsKCQkJCWZldGNoRXZlbnRTb3VyY2Uoc291cmNlLCBldmVudHNDaGFuZ2VkKTsKCQkJfSwKCQkKCQkJcmVtb3ZlRXZlbnRTb3VyY2U6IGZ1bmN0aW9uKHNvdXJjZSkgewoJCQkJZXZlbnRTb3VyY2VzID0gJC5ncmVwKGV2ZW50U291cmNlcywgZnVuY3Rpb24oc3JjKSB7CgkJCQkJcmV0dXJuIHNyYyAhPSBzb3VyY2U7CgkJCQl9KTsKCQkJCS8vIHJlbW92ZSBhbGwgY2xpZW50IGV2ZW50cyBmcm9tIHRoYXQgc291cmNlCgkJCQlldmVudHMgPSAkLmdyZXAoZXZlbnRzLCBmdW5jdGlvbihlKSB7CgkJCQkJcmV0dXJuIGUuc291cmNlICE9IHNvdXJjZTsKCQkJCX0pOwoJCQkJZXZlbnRzQ2hhbmdlZCgpOwoJCQl9LAoJCQkKCQkJcmVmZXRjaEV2ZW50czogZnVuY3Rpb24oKSB7CgkJCQlmZXRjaEV2ZW50cyhldmVudHNDaGFuZ2VkKTsKCQkJfSwKCQkJCgkJCS8vCgkJCS8vIHNlbGVjdGlvbgoJCQkvLwoJCQkKCQkJc2VsZWN0OiBmdW5jdGlvbihzdGFydCwgZW5kLCBhbGxEYXkpIHsKCQkJCXZpZXcuc2VsZWN0KHN0YXJ0LCBlbmQsIGFsbERheT09PXVuZGVmaW5lZCA/IHRydWUgOiBhbGxEYXkpOwoJCQl9LAoJCQkKCQkJdW5zZWxlY3Q6IGZ1bmN0aW9uKCkgewoJCQkJdmlldy51bnNlbGVjdCgpOwoJCQl9CgkJCQoJCX07CgkJCgkJJC5kYXRhKHRoaXMsICdmdWxsQ2FsZW5kYXInLCBwdWJsaWNNZXRob2RzKTsgLy8gVE9ETzogbG9vayBpbnRvIG1lbW9yeSBsZWFrIGltcGxpY2F0aW9ucwoJCQoJCQoJCQoJCS8qIEhlYWRlcgoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQkKCQl2YXIgaGVhZGVyLAoJCQlzZWN0aW9ucyA9IG9wdGlvbnMuaGVhZGVyOwoJCWlmIChzZWN0aW9ucykgewoJCQloZWFkZXIgPSAkKCI8dGFibGUgY2xhc3M9J2ZjLWhlYWRlcicvPiIpCgkJCQkuYXBwZW5kKCQoIjx0ci8+IikKCQkJCQkuYXBwZW5kKCQoIjx0ZCBjbGFzcz0nZmMtaGVhZGVyLWxlZnQnLz4iKS5hcHBlbmQoYnVpbGRTZWN0aW9uKHNlY3Rpb25zLmxlZnQpKSkKCQkJCQkuYXBwZW5kKCQoIjx0ZCBjbGFzcz0nZmMtaGVhZGVyLWNlbnRlcicvPiIpLmFwcGVuZChidWlsZFNlY3Rpb24oc2VjdGlvbnMuY2VudGVyKSkpCgkJCQkJLmFwcGVuZCgkKCI8dGQgY2xhc3M9J2ZjLWhlYWRlci1yaWdodCcvPiIpLmFwcGVuZChidWlsZFNlY3Rpb24oc2VjdGlvbnMucmlnaHQpKSkpCgkJCQkucHJlcGVuZFRvKGVsZW1lbnQpOwoJCX0KCQlmdW5jdGlvbiBidWlsZFNlY3Rpb24oYnV0dG9uU3RyKSB7CgkJCWlmIChidXR0b25TdHIpIHsKCQkJCXZhciB0ciA9ICQoIjx0ci8+Iik7CgkJCQkkLmVhY2goYnV0dG9uU3RyLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGkpIHsKCQkJCQlpZiAoaSA+IDApIHsKCQkJCQkJdHIuYXBwZW5kKCI8dGQ+PHNwYW4gY2xhc3M9J2ZjLWhlYWRlci1zcGFjZScvPjwvdGQ+Iik7CgkJCQkJfQoJCQkJCXZhciBwcmV2QnV0dG9uOwoJCQkJCSQuZWFjaCh0aGlzLnNwbGl0KCcsJyksIGZ1bmN0aW9uKGosIGJ1dHRvbk5hbWUpIHsKCQkJCQkJaWYgKGJ1dHRvbk5hbWUgPT0gJ3RpdGxlJykgewoJCQkJCQkJdHIuYXBwZW5kKCI8dGQ+PGgyIGNsYXNzPSdmYy1oZWFkZXItdGl0bGUnPiZuYnNwOzwvaDI+PC90ZD4iKTsKCQkJCQkJCWlmIChwcmV2QnV0dG9uKSB7CgkJCQkJCQkJcHJldkJ1dHRvbi5hZGRDbGFzcyh0bSArICctY29ybmVyLXJpZ2h0Jyk7CgkJCQkJCQl9CgkJCQkJCQlwcmV2QnV0dG9uID0gbnVsbDsKCQkJCQkJfWVsc2V7CgkJCQkJCQl2YXIgYnV0dG9uQ2xpY2s7CgkJCQkJCQlpZiAocHVibGljTWV0aG9kc1tidXR0b25OYW1lXSkgewoJCQkJCQkJCWJ1dHRvbkNsaWNrID0gcHVibGljTWV0aG9kc1tidXR0b25OYW1lXTsKCQkJCQkJCX0KCQkJCQkJCWVsc2UgaWYgKHZpZXdzW2J1dHRvbk5hbWVdKSB7CgkJCQkJCQkJYnV0dG9uQ2xpY2sgPSBmdW5jdGlvbigpIHsKCQkJCQkJCQkJYnV0dG9uLnJlbW92ZUNsYXNzKHRtICsgJy1zdGF0ZS1ob3ZlcicpOwoJCQkJCQkJCQljaGFuZ2VWaWV3KGJ1dHRvbk5hbWUpOwoJCQkJCQkJCX07CgkJCQkJCQl9CgkJCQkJCQlpZiAoYnV0dG9uQ2xpY2spIHsKCQkJCQkJCQlpZiAocHJldkJ1dHRvbikgewoJCQkJCQkJCQlwcmV2QnV0dG9uLmFkZENsYXNzKHRtICsgJy1uby1yaWdodCcpOwoJCQkJCQkJCX0KCQkJCQkJCQl2YXIgYnV0dG9uLAoJCQkJCQkJCQlpY29uID0gb3B0aW9ucy50aGVtZSA/IHNtYXJ0UHJvcGVydHkob3B0aW9ucy5idXR0b25JY29ucywgYnV0dG9uTmFtZSkgOiBudWxsLAoJCQkJCQkJCQl0ZXh0ID0gc21hcnRQcm9wZXJ0eShvcHRpb25zLmJ1dHRvblRleHQsIGJ1dHRvbk5hbWUpOwoJCQkJCQkJCWlmIChpY29uKSB7CgkJCQkJCQkJCWJ1dHRvbiA9ICQoIjxkaXYgY2xhc3M9J2ZjLWJ1dHRvbi0iICsgYnV0dG9uTmFtZSArICIgdWktc3RhdGUtZGVmYXVsdCc+IiArCgkJCQkJCQkJCQkiPGE+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi0iICsgaWNvbiArICInLz48L2E+PC9kaXY+Iik7CgkJCQkJCQkJfQoJCQkJCQkJCWVsc2UgaWYgKHRleHQpIHsKCQkJCQkJCQkJYnV0dG9uID0gJCgiPGRpdiBjbGFzcz0nZmMtYnV0dG9uLSIgKyBidXR0b25OYW1lICsgIiAiICsgdG0gKyAiLXN0YXRlLWRlZmF1bHQnPiIgKwoJCQkJCQkJCQkJIjxhPjxzcGFuPiIgKyB0ZXh0ICsgIjwvc3Bhbj48L2E+PC9kaXY+Iik7CgkJCQkJCQkJfQoJCQkJCQkJCWlmIChidXR0b24pIHsKCQkJCQkJCQkJYnV0dG9uCgkJCQkJCQkJCQkuY2xpY2soZnVuY3Rpb24oKSB7CgkJCQkJCQkJCQkJaWYgKCFidXR0b24uaGFzQ2xhc3ModG0gKyAnLXN0YXRlLWRpc2FibGVkJykpIHsKCQkJCQkJCQkJCQkJYnV0dG9uQ2xpY2soKTsKCQkJCQkJCQkJCQl9CgkJCQkJCQkJCQl9KQoJCQkJCQkJCQkJLm1vdXNlZG93bihmdW5jdGlvbigpIHsKCQkJCQkJCQkJCQlidXR0b24KCQkJCQkJCQkJCQkJLm5vdCgnLicgKyB0bSArICctc3RhdGUtYWN0aXZlJykKCQkJCQkJCQkJCQkJLm5vdCgnLicgKyB0bSArICctc3RhdGUtZGlzYWJsZWQnKQoJCQkJCQkJCQkJCQkuYWRkQ2xhc3ModG0gKyAnLXN0YXRlLWRvd24nKTsKCQkJCQkJCQkJCX0pCgkJCQkJCQkJCQkubW91c2V1cChmdW5jdGlvbigpIHsKCQkJCQkJCQkJCQlidXR0b24ucmVtb3ZlQ2xhc3ModG0gKyAnLXN0YXRlLWRvd24nKTsKCQkJCQkJCQkJCX0pCgkJCQkJCQkJCQkuaG92ZXIoCgkJCQkJCQkJCQkJZnVuY3Rpb24oKSB7CgkJCQkJCQkJCQkJCWJ1dHRvbgoJCQkJCQkJCQkJCQkJLm5vdCgnLicgKyB0bSArICctc3RhdGUtYWN0aXZlJykKCQkJCQkJCQkJCQkJCS5ub3QoJy4nICsgdG0gKyAnLXN0YXRlLWRpc2FibGVkJykKCQkJCQkJCQkJCQkJCS5hZGRDbGFzcyh0bSArICctc3RhdGUtaG92ZXInKTsKCQkJCQkJCQkJCQl9LAoJCQkJCQkJCQkJCWZ1bmN0aW9uKCkgewoJCQkJCQkJCQkJCQlidXR0b24KCQkJCQkJCQkJCQkJCS5yZW1vdmVDbGFzcyh0bSArICctc3RhdGUtaG92ZXInKQoJCQkJCQkJCQkJCQkJLnJlbW92ZUNsYXNzKHRtICsgJy1zdGF0ZS1kb3duJyk7CgkJCQkJCQkJCQkJfQoJCQkJCQkJCQkJKQoJCQkJCQkJCQkJLmFwcGVuZFRvKCQoIjx0ZC8+IikuYXBwZW5kVG8odHIpKTsKCQkJCQkJCQkJaWYgKHByZXZCdXR0b24pIHsKCQkJCQkJCQkJCXByZXZCdXR0b24uYWRkQ2xhc3ModG0gKyAnLW5vLXJpZ2h0Jyk7CgkJCQkJCQkJCX1lbHNlewoJCQkJCQkJCQkJYnV0dG9uLmFkZENsYXNzKHRtICsgJy1jb3JuZXItbGVmdCcpOwoJCQkJCQkJCQl9CgkJCQkJCQkJCXByZXZCdXR0b24gPSBidXR0b247CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfSk7CgkJCQkJaWYgKHByZXZCdXR0b24pIHsKCQkJCQkJcHJldkJ1dHRvbi5hZGRDbGFzcyh0bSArICctY29ybmVyLXJpZ2h0Jyk7CgkJCQkJfQoJCQkJfSk7CgkJCQlyZXR1cm4gJCgiPHRhYmxlLz4iKS5hcHBlbmQodHIpOwoJCQl9CgkJfQoJCQoJCQoJCQoJCS8qIFJlc2l6aW5nCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCQoJCQoJCWZ1bmN0aW9uIGNhbGNTaXplKCkgewoJCQlpZiAob3B0aW9ucy5jb250ZW50SGVpZ2h0KSB7CgkJCQlzdWdnZXN0ZWRWaWV3SGVpZ2h0ID0gb3B0aW9ucy5jb250ZW50SGVpZ2h0OwoJCQl9CgkJCWVsc2UgaWYgKG9wdGlvbnMuaGVpZ2h0KSB7CgkJCQlzdWdnZXN0ZWRWaWV3SGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQgLSAoaGVhZGVyID8gaGVhZGVyLmhlaWdodCgpIDogMCkgLSB2c2lkZXMoY29udGVudFswXSk7CgkJCX0KCQkJZWxzZSB7CgkJCQlzdWdnZXN0ZWRWaWV3SGVpZ2h0ID0gTWF0aC5yb3VuZChjb250ZW50LndpZHRoKCkgLyBNYXRoLm1heChvcHRpb25zLmFzcGVjdFJhdGlvLCAuNSkpOwoJCQl9CgkJfQoJCQoJCQoJCWZ1bmN0aW9uIHNldFNpemUoZGF0ZUNoYW5nZWQpIHsKCQkJaWdub3JlV2luZG93UmVzaXplKys7CgkJCXZpZXcuc2V0SGVpZ2h0KHN1Z2dlc3RlZFZpZXdIZWlnaHQsIGRhdGVDaGFuZ2VkKTsKCQkJaWYgKGFic29sdXRlVmlld0VsZW1lbnQpIHsKCQkJCWFic29sdXRlVmlld0VsZW1lbnQuY3NzKCdwb3NpdGlvbicsICdyZWxhdGl2ZScpOwoJCQkJYWJzb2x1dGVWaWV3RWxlbWVudCA9IG51bGw7CgkJCX0KCQkJdmlldy5zZXRXaWR0aChjb250ZW50LndpZHRoKCksIGRhdGVDaGFuZ2VkKTsKCQkJaWdub3JlV2luZG93UmVzaXplLS07CgkJfQoJCQoJCQoJCWZ1bmN0aW9uIHdpbmRvd1Jlc2l6ZSgpIHsKCQkJaWYgKCFpZ25vcmVXaW5kb3dSZXNpemUpIHsKCQkJCWlmICh2aWV3LnN0YXJ0KSB7IC8vIHZpZXcgaGFzIGFscmVhZHkgYmVlbiByZW5kZXJlZAoJCQkJCXZhciB1aWQgPSArK3Jlc2l6ZVVJRDsKCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyAvLyBhZGQgYSBkZWxheQoJCQkJCQlpZiAodWlkID09IHJlc2l6ZVVJRCAmJiAhaWdub3JlV2luZG93UmVzaXplICYmIGVsZW1lbnRWaXNpYmxlKCkpIHsKCQkJCQkJCWlmIChlbGVtZW50T3V0ZXJXaWR0aCAhPSAoZWxlbWVudE91dGVyV2lkdGggPSBlbGVtZW50Lm91dGVyV2lkdGgoKSkpIHsKCQkJCQkJCQlpZ25vcmVXaW5kb3dSZXNpemUrKzsgLy8gaW4gY2FzZSB0aGUgd2luZG93UmVzaXplIGNhbGxiYWNrIGNoYW5nZXMgdGhlIGhlaWdodAoJCQkJCQkJCXNpemVDaGFuZ2VkKCk7CgkJCQkJCQkJdmlldy50cmlnZ2VyKCd3aW5kb3dSZXNpemUnLCBfZWxlbWVudCk7CgkJCQkJCQkJaWdub3JlV2luZG93UmVzaXplLS07CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9LCAyMDApOwoJCQkJfWVsc2V7CgkJCQkJLy8gY2FsZW5kYXIgbXVzdCBoYXZlIGJlZW4gaW5pdGlhbGl6ZWQgaW4gYSAweDAgaWZyYW1lIHRoYXQgaGFzIGp1c3QgYmVlbiByZXNpemVkCgkJCQkJbGF0ZVJlbmRlcigpOwoJCQkJfQoJCQl9CgkJfQoJCSQod2luZG93KS5yZXNpemUod2luZG93UmVzaXplKTsKCQkKCQkKCQkKCQkvKiBFeHRlcm5hbCBldmVudCBkcm9wcGluZwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQkKCQlpZiAob3B0aW9ucy5kcm9wcGFibGUpIHsKCQkJdmFyIF9kcmFnRWxlbWVudDsKCQkJJChkb2N1bWVudCkKCQkJCS5iaW5kKCdkcmFnc3RhcnQnLCBmdW5jdGlvbihldiwgdWkpIHsKCQkJCQl2YXIgX2UgPSBldi50YXJnZXQ7CgkJCQkJdmFyIGUgPSAkKF9lKTsKCQkJCQlpZiAoIWUucGFyZW50cygnLmZjJykubGVuZ3RoKSB7IC8vIG5vdCBhbHJlYWR5IGluc2lkZSBhIGNhbGVuZGFyCgkJCQkJCXZhciBhY2NlcHQgPSBvcHRpb25zLmRyb3BBY2NlcHQ7CgkJCQkJCWlmICgkLmlzRnVuY3Rpb24oYWNjZXB0KSA/IGFjY2VwdC5jYWxsKF9lLCBlKSA6IGUuaXMoYWNjZXB0KSkgewoJCQkJCQkJX2RyYWdFbGVtZW50ID0gX2U7CgkJCQkJCQl2aWV3LmRyYWdTdGFydChfZHJhZ0VsZW1lbnQsIGV2LCB1aSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9KQoJCQkJLmJpbmQoJ2RyYWdzdG9wJywgZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJaWYgKF9kcmFnRWxlbWVudCkgewoJCQkJCQl2aWV3LmRyYWdTdG9wKF9kcmFnRWxlbWVudCwgZXYsIHVpKTsKCQkJCQkJX2RyYWdFbGVtZW50ID0gbnVsbDsKCQkJCQl9CgkJCQl9KTsKCQl9CgkJCgkJCgkJCgkJLy8gbGV0J3MgYmVnaW4uLi4KCQljaGFuZ2VWaWV3KG9wdGlvbnMuZGVmYXVsdFZpZXcpOwoJCQoJCQoJCS8vIG5lZWRlZCBmb3IgSUUgaW4gYSAweDAgaWZyYW1lLCBiL2Mgd2hlbiBpdCBpcyByZXNpemVkLCBuZXZlciB0cmlnZ2VycyBhIHdpbmRvd1Jlc2l6ZQoJCWlmICghYm9keVZpc2libGUoKSkgewoJCQlsYXRlUmVuZGVyKCk7CgkJfQoJCQoJCQoJCS8vIGNhbGxlZCB3aGVuIHdlIGtub3cgdGhlIGNhbGVuZGFyIGNvdWxkbid0IGJlIHJlbmRlcmVkIHdoZW4gaXQgd2FzIGluaXRpYWxpemVkLAoJCS8vIGJ1dCB3ZSB0aGluayBpdCdzIHJlYWR5IG5vdwoJCWZ1bmN0aW9uIGxhdGVSZW5kZXIoKSB7CgkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IC8vIElFNyBuZWVkcyB0aGlzIHNvIGRpbWVuc2lvbnMgYXJlIGNhbGN1bGF0ZWQgY29ycmVjdGx5CgkJCQlpZiAoIXZpZXcuc3RhcnQgJiYgYm9keVZpc2libGUoKSkgeyAvLyAhdmlldy5zdGFydCBtYWtlcyBzdXJlIHRoaXMgbmV2ZXIgaGFwcGVucyBtb3JlIHRoYW4gb25jZQoJCQkJCXJlbmRlcigpOwoJCQkJfQoJCQl9LDApOwoJCX0KCgkKCX0pOwoJCglyZXR1cm4gdGhpczsKCQp9OwoKCgovKiBJbXBvcnRhbnQgRXZlbnQgVXRpbGl0aWVzCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCnZhciBmYWtlSUQgPSAwOwoKZnVuY3Rpb24gbm9ybWFsaXplRXZlbnQoZXZlbnQsIG9wdGlvbnMpIHsKCWV2ZW50Ll9pZCA9IGV2ZW50Ll9pZCB8fCAoZXZlbnQuaWQgPT09IHVuZGVmaW5lZCA/ICdfZmMnICsgZmFrZUlEKysgOiBldmVudC5pZCArICcnKTsKCWlmIChldmVudC5kYXRlKSB7CgkJaWYgKCFldmVudC5zdGFydCkgewoJCQlldmVudC5zdGFydCA9IGV2ZW50LmRhdGU7CgkJfQoJCWRlbGV0ZSBldmVudC5kYXRlOwoJfQoJZXZlbnQuX3N0YXJ0ID0gY2xvbmVEYXRlKGV2ZW50LnN0YXJ0ID0gcGFyc2VEYXRlKGV2ZW50LnN0YXJ0KSk7CglldmVudC5lbmQgPSBwYXJzZURhdGUoZXZlbnQuZW5kKTsKCWlmIChldmVudC5lbmQgJiYgZXZlbnQuZW5kIDw9IGV2ZW50LnN0YXJ0KSB7CgkJZXZlbnQuZW5kID0gbnVsbDsKCX0KCWV2ZW50Ll9lbmQgPSBldmVudC5lbmQgPyBjbG9uZURhdGUoZXZlbnQuZW5kKSA6IG51bGw7CglpZiAoZXZlbnQuYWxsRGF5ID09PSB1bmRlZmluZWQpIHsKCQlldmVudC5hbGxEYXkgPSBvcHRpb25zLmFsbERheURlZmF1bHQ7Cgl9CglpZiAoZXZlbnQuY2xhc3NOYW1lKSB7CgkJaWYgKHR5cGVvZiBldmVudC5jbGFzc05hbWUgPT0gJ3N0cmluZycpIHsKCQkJZXZlbnQuY2xhc3NOYW1lID0gZXZlbnQuY2xhc3NOYW1lLnNwbGl0KC9ccysvKTsKCQl9Cgl9ZWxzZXsKCQlldmVudC5jbGFzc05hbWUgPSBbXTsKCX0KfQovLyBUT0RPOiBpZiB0aGVyZSBpcyBubyBzdGFydCBkYXRlLCByZXR1cm4gZmFsc2UgdG8gaW5kaWNhdGUgYW4gaW52YWxpZCBldmVudAoKCi8qIEdyaWQtYmFzZWQgVmlld3M6IG1vbnRoLCBiYXNpY1dlZWssIGJhc2ljRGF5Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCnNldERlZmF1bHRzKHsKCXdlZWtNb2RlOiAnZml4ZWQnCn0pOwoKdmlld3MubW9udGggPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zLCB2aWV3TmFtZSkgewoJcmV0dXJuIG5ldyBHcmlkKGVsZW1lbnQsIG9wdGlvbnMsIHsKCQlyZW5kZXI6IGZ1bmN0aW9uKGRhdGUsIGRlbHRhKSB7CgkJCWlmIChkZWx0YSkgewoJCQkJYWRkTW9udGhzKGRhdGUsIGRlbHRhKTsKCQkJCWRhdGUuc2V0RGF0ZSgxKTsKCQkJfQoJCQkvLyBzdGFydC9lbmQKCQkJdmFyIHN0YXJ0ID0gdGhpcy5zdGFydCA9IGNsb25lRGF0ZShkYXRlLCB0cnVlKTsKCQkJc3RhcnQuc2V0RGF0ZSgxKTsKCQkJdGhpcy5lbmQgPSBhZGRNb250aHMoY2xvbmVEYXRlKHN0YXJ0KSwgMSk7CgkJCS8vIHZpc1N0YXJ0L3Zpc0VuZAoJCQl2YXIgdmlzU3RhcnQgPSB0aGlzLnZpc1N0YXJ0ID0gY2xvbmVEYXRlKHN0YXJ0KSwKCQkJCXZpc0VuZCA9IHRoaXMudmlzRW5kID0gY2xvbmVEYXRlKHRoaXMuZW5kKSwKCQkJCW53ZSA9IG9wdGlvbnMud2Vla2VuZHMgPyAwIDogMTsKCQkJaWYgKG53ZSkgewoJCQkJc2tpcFdlZWtlbmQodmlzU3RhcnQpOwoJCQkJc2tpcFdlZWtlbmQodmlzRW5kLCAtMSwgdHJ1ZSk7CgkJCX0KCQkJYWRkRGF5cyh2aXNTdGFydCwgLSgodmlzU3RhcnQuZ2V0RGF5KCkgLSBNYXRoLm1heChvcHRpb25zLmZpcnN0RGF5LCBud2UpICsgNykgJSA3KSk7CgkJCWFkZERheXModmlzRW5kLCAoNyAtIHZpc0VuZC5nZXREYXkoKSArIE1hdGgubWF4KG9wdGlvbnMuZmlyc3REYXksIG53ZSkpICUgNyk7CgkJCS8vIHJvdyBjb3VudAoJCQl2YXIgcm93Q250ID0gTWF0aC5yb3VuZCgodmlzRW5kIC0gdmlzU3RhcnQpIC8gKERBWV9NUyAqIDcpKTsKCQkJaWYgKG9wdGlvbnMud2Vla01vZGUgPT0gJ2ZpeGVkJykgewoJCQkJYWRkRGF5cyh2aXNFbmQsICg2IC0gcm93Q250KSAqIDcpOwoJCQkJcm93Q250ID0gNjsKCQkJfQoJCQkvLyB0aXRsZQoJCQl0aGlzLnRpdGxlID0gZm9ybWF0RGF0ZSgKCQkJCXN0YXJ0LAoJCQkJdGhpcy5vcHRpb24oJ3RpdGxlRm9ybWF0JyksCgkJCQlvcHRpb25zCgkJCSk7CgkJCS8vIHJlbmRlcgoJCQl0aGlzLnJlbmRlckdyaWQoCgkJCQlyb3dDbnQsIG9wdGlvbnMud2Vla2VuZHMgPyA3IDogNSwKCQkJCXRoaXMub3B0aW9uKCdjb2x1bW5Gb3JtYXQnKSwKCQkJCXRydWUKCQkJKTsKCQl9Cgl9LCB2aWV3TmFtZSk7Cn07Cgp2aWV3cy5iYXNpY1dlZWsgPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zLCB2aWV3TmFtZSkgewoJcmV0dXJuIG5ldyBHcmlkKGVsZW1lbnQsIG9wdGlvbnMsIHsKCQlyZW5kZXI6IGZ1bmN0aW9uKGRhdGUsIGRlbHRhKSB7CgkJCWlmIChkZWx0YSkgewoJCQkJYWRkRGF5cyhkYXRlLCBkZWx0YSAqIDcpOwoJCQl9CgkJCXZhciB2aXNTdGFydCA9IHRoaXMudmlzU3RhcnQgPSBjbG9uZURhdGUoCgkJCQkJdGhpcy5zdGFydCA9IGFkZERheXMoY2xvbmVEYXRlKGRhdGUpLCAtKChkYXRlLmdldERheSgpIC0gb3B0aW9ucy5maXJzdERheSArIDcpICUgNykpCgkJCQkpLAoJCQkJdmlzRW5kID0gdGhpcy52aXNFbmQgPSBjbG9uZURhdGUoCgkJCQkJdGhpcy5lbmQgPSBhZGREYXlzKGNsb25lRGF0ZSh2aXNTdGFydCksIDcpCgkJCQkpOwoJCQlpZiAoIW9wdGlvbnMud2Vla2VuZHMpIHsKCQkJCXNraXBXZWVrZW5kKHZpc1N0YXJ0KTsKCQkJCXNraXBXZWVrZW5kKHZpc0VuZCwgLTEsIHRydWUpOwoJCQl9CgkJCXRoaXMudGl0bGUgPSBmb3JtYXREYXRlcygKCQkJCXZpc1N0YXJ0LAoJCQkJYWRkRGF5cyhjbG9uZURhdGUodmlzRW5kKSwgLTEpLAoJCQkJdGhpcy5vcHRpb24oJ3RpdGxlRm9ybWF0JyksCgkJCQlvcHRpb25zCgkJCSk7CgkJCXRoaXMucmVuZGVyR3JpZCgKCQkJCTEsIG9wdGlvbnMud2Vla2VuZHMgPyA3IDogNSwKCQkJCXRoaXMub3B0aW9uKCdjb2x1bW5Gb3JtYXQnKSwKCQkJCWZhbHNlCgkJCSk7CgkJfQoJfSwgdmlld05hbWUpOwp9OwoKdmlld3MuYmFzaWNEYXkgPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zLCB2aWV3TmFtZSkgewoJcmV0dXJuIG5ldyBHcmlkKGVsZW1lbnQsIG9wdGlvbnMsIHsKCQlyZW5kZXI6IGZ1bmN0aW9uKGRhdGUsIGRlbHRhKSB7CgkJCWlmIChkZWx0YSkgewoJCQkJYWRkRGF5cyhkYXRlLCBkZWx0YSk7CgkJCQlpZiAoIW9wdGlvbnMud2Vla2VuZHMpIHsKCQkJCQlza2lwV2Vla2VuZChkYXRlLCBkZWx0YSA8IDAgPyAtMSA6IDEpOwoJCQkJfQoJCQl9CgkJCXRoaXMudGl0bGUgPSBmb3JtYXREYXRlKGRhdGUsIHRoaXMub3B0aW9uKCd0aXRsZUZvcm1hdCcpLCBvcHRpb25zKTsKCQkJdGhpcy5zdGFydCA9IHRoaXMudmlzU3RhcnQgPSBjbG9uZURhdGUoZGF0ZSwgdHJ1ZSk7CgkJCXRoaXMuZW5kID0gdGhpcy52aXNFbmQgPSBhZGREYXlzKGNsb25lRGF0ZSh0aGlzLnN0YXJ0KSwgMSk7CgkJCXRoaXMucmVuZGVyR3JpZCgKCQkJCTEsIDEsCgkJCQl0aGlzLm9wdGlvbignY29sdW1uRm9ybWF0JyksCgkJCQlmYWxzZQoJCQkpOwoJCX0KCX0sIHZpZXdOYW1lKTsKfTsKCgovLyByZW5kZXJpbmcgYnVncwoKdmFyIHRkSGVpZ2h0QnVnOwoKCmZ1bmN0aW9uIEdyaWQoZWxlbWVudCwgb3B0aW9ucywgbWV0aG9kcywgdmlld05hbWUpIHsKCQoJdmFyIHRtLCBmaXJzdERheSwKCQlud2UsICAgICAgICAgICAgLy8gbm8gd2Vla2VuZHMgKGludCkKCQlydGwsIGRpcywgZGl0LCAgLy8gZGF5IGluZGV4IHNpZ24gLyB0cmFuc2xhdGUKCQl2aWV3V2lkdGgsIHZpZXdIZWlnaHQsCgkJcm93Q250LCBjb2xDbnQsCgkJY29sV2lkdGgsCgkJdGhlYWQsIHRib2R5LAoJCWNhY2hlZEV2ZW50cz1bXSwKCQlzZWdtZW50Q29udGFpbmVyLAoJCWRheUNvbnRlbnRQb3NpdGlvbnMgPSBuZXcgSG9yaXpvbnRhbFBvc2l0aW9uQ2FjaGUoZnVuY3Rpb24oZGF5T2ZXZWVrKSB7CgkJCXJldHVybiB0Ym9keS5maW5kKCd0ZDplcSgnICsgKChkYXlPZldlZWsgLSBNYXRoLm1heChmaXJzdERheSxud2UpK2NvbENudCkgJSBjb2xDbnQpICsgJykgZGl2IGRpdicpOwoJCX0pLAoJCS8vIC4uLgoJCQoJLy8gaW5pdGlhbGl6ZSBzdXBlcmNsYXNzCgl2aWV3ID0gJC5leHRlbmQodGhpcywgdmlld01ldGhvZHMsIG1ldGhvZHMsIHsKCQlyZW5kZXJHcmlkOiByZW5kZXJHcmlkLAoJCXJlbmRlckV2ZW50czogcmVuZGVyRXZlbnRzLAoJCXJlcmVuZGVyRXZlbnRzOiByZXJlbmRlckV2ZW50cywKCQljbGVhckV2ZW50czogY2xlYXJFdmVudHMsCgkJc2V0SGVpZ2h0OiBzZXRIZWlnaHQsCgkJc2V0V2lkdGg6IHNldFdpZHRoLAoJCWRlZmF1bHRFdmVudEVuZDogZnVuY3Rpb24oZXZlbnQpIHsgLy8gY2FsY3VsYXRlcyBhbiBlbmQgaWYgZXZlbnQgZG9lc250IGhhdmUgb25lLCBtb3N0bHkgZm9yIHJlc2l6aW5nCgkJCXJldHVybiBjbG9uZURhdGUoZXZlbnQuc3RhcnQpOwoJCX0KCX0pOwoJdmlldy5uYW1lID0gdmlld05hbWU7Cgl2aWV3LmluaXQoZWxlbWVudCwgb3B0aW9ucyk7CgkKCQoJCgkvKiBHcmlkIFJlbmRlcmluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWRpc2FibGVUZXh0U2VsZWN0aW9uKGVsZW1lbnQuYWRkQ2xhc3MoJ2ZjLWdyaWQnKSk7CgkKCglmdW5jdGlvbiByZW5kZXJHcmlkKHIsIGMsIGNvbEZvcm1hdCwgc2hvd051bWJlcnMpIHsKCQoJCXJvd0NudCA9IHI7CgkJY29sQ250ID0gYzsKCQkKCQkvLyB1cGRhdGUgb3B0aW9uLWRlcml2ZWQgdmFyaWFibGVzCgkJdG0gPSBvcHRpb25zLnRoZW1lID8gJ3VpJyA6ICdmYyc7CgkJbndlID0gb3B0aW9ucy53ZWVrZW5kcyA/IDAgOiAxOwoJCWZpcnN0RGF5ID0gb3B0aW9ucy5maXJzdERheTsKCQlpZiAocnRsID0gb3B0aW9ucy5pc1JUTCkgewoJCQlkaXMgPSAtMTsKCQkJZGl0ID0gY29sQ250IC0gMTsKCQl9ZWxzZXsKCQkJZGlzID0gMTsKCQkJZGl0ID0gMDsKCQl9CgkJCgkJdmFyIG1vbnRoID0gdmlldy5zdGFydC5nZXRNb250aCgpLAoJCQl0b2RheSA9IGNsZWFyVGltZShuZXcgRGF0ZSgpKSwKCQkJcywgaSwgaiwgZCA9IGNsb25lRGF0ZSh2aWV3LnZpc1N0YXJ0KTsKCQkKCQlpZiAoIXRib2R5KSB7IC8vIGZpcnN0IHRpbWUsIGJ1aWxkIGFsbCBjZWxscyBmcm9tIHNjcmF0Y2gKCQkKCQkJdmFyIHRhYmxlID0gJCgiPHRhYmxlLz4iKS5hcHBlbmRUbyhlbGVtZW50KTsKCQkJCgkJCXMgPSAiPHRoZWFkPjx0cj4iOwoJCQlmb3IgKGk9MDsgaTxjb2xDbnQ7IGkrKykgewoJCQkJcyArPSAiPHRoIGNsYXNzPSdmYy0iICsKCQkJCQlkYXlJRHNbZC5nZXREYXkoKV0gKyAnICcgKyAvLyBuZWVkcyB0byBiZSBmaXJzdAoJCQkJCXRtICsgJy1zdGF0ZS1kZWZhdWx0JyArCgkJCQkJKGk9PWRpdCA/ICcgZmMtbGVmdG1vc3QnIDogJycpICsKCQkJCQkiJz4iICsgZm9ybWF0RGF0ZShkLCBjb2xGb3JtYXQsIG9wdGlvbnMpICsgIjwvdGg+IjsKCQkJCWFkZERheXMoZCwgMSk7CgkJCQlpZiAobndlKSB7CgkJCQkJc2tpcFdlZWtlbmQoZCk7CgkJCQl9CgkJCX0KCQkJdGhlYWQgPSAkKHMgKyAiPC90cj48L3RoZWFkPiIpLmFwcGVuZFRvKHRhYmxlKTsKCQkJCgkJCXMgPSAiPHRib2R5PiI7CgkJCWQgPSBjbG9uZURhdGUodmlldy52aXNTdGFydCk7CgkJCWZvciAoaT0wOyBpPHJvd0NudDsgaSsrKSB7CgkJCQlzICs9ICI8dHIgY2xhc3M9J2ZjLXdlZWsiICsgaSArICInPiI7CgkJCQlmb3IgKGo9MDsgajxjb2xDbnQ7IGorKykgewoJCQkJCXMgKz0gIjx0ZCBjbGFzcz0nZmMtIiArCgkJCQkJCWRheUlEc1tkLmdldERheSgpXSArICcgJyArIC8vIG5lZWRzIHRvIGJlIGZpcnN0CgkJCQkJCXRtICsgJy1zdGF0ZS1kZWZhdWx0IGZjLWRheScgKyAoaSpjb2xDbnQraikgKwoJCQkJCQkoaj09ZGl0ID8gJyBmYy1sZWZ0bW9zdCcgOiAnJykgKwoJCQkJCQkocm93Q250PjEgJiYgZC5nZXRNb250aCgpICE9IG1vbnRoID8gJyBmYy1vdGhlci1tb250aCcgOiAnJykgKwoJCQkJCQkoK2QgPT0gK3RvZGF5ID8KCQkJCQkJJyBmYy10b2RheSAnK3RtKyctc3RhdGUtaGlnaGxpZ2h0JyA6CgkJCQkJCScgZmMtbm90LXRvZGF5JykgKyAiJz4iICsKCQkJCQkJKHNob3dOdW1iZXJzID8gIjxkaXYgY2xhc3M9J2ZjLWRheS1udW1iZXInPiIgKyBkLmdldERhdGUoKSArICI8L2Rpdj4iIDogJycpICsKCQkJCQkJIjxkaXYgY2xhc3M9J2ZjLWRheS1jb250ZW50Jz48ZGl2IHN0eWxlPSdwb3NpdGlvbjpyZWxhdGl2ZSc+Jm5ic3A7PC9kaXY+PC9kaXY+PC90ZD4iOwoJCQkJCWFkZERheXMoZCwgMSk7CgkJCQkJaWYgKG53ZSkgewoJCQkJCQlza2lwV2Vla2VuZChkKTsKCQkJCQl9CgkJCQl9CgkJCQlzICs9ICI8L3RyPiI7CgkJCX0KCQkJdGJvZHkgPSAkKHMgKyAiPC90Ym9keT4iKS5hcHBlbmRUbyh0YWJsZSk7CgkJCWRheUJpbmQodGJvZHkuZmluZCgndGQnKSk7CgkJCQoJCQlzZWdtZW50Q29udGFpbmVyID0gJCgiPGRpdiBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDo4O3RvcDowO2xlZnQ6MCcvPiIpLmFwcGVuZFRvKGVsZW1lbnQpOwoJCQoJCX1lbHNleyAvLyBOT1QgZmlyc3QgdGltZSwgcmV1c2UgYXMgbWFueSBjZWxscyBhcyBwb3NzaWJsZQoJCQoJCQljbGVhckV2ZW50cygpOwoJCQoJCQl2YXIgcHJldlJvd0NudCA9IHRib2R5LmZpbmQoJ3RyJykubGVuZ3RoOwoJCQlpZiAocm93Q250IDwgcHJldlJvd0NudCkgewoJCQkJdGJvZHkuZmluZCgndHI6Z3QoJyArIChyb3dDbnQtMSkgKyAnKScpLnJlbW92ZSgpOyAvLyByZW1vdmUgZXh0cmEgcm93cwoJCQl9CgkJCWVsc2UgaWYgKHJvd0NudCA+IHByZXZSb3dDbnQpIHsgLy8gbmVlZHMgdG8gY3JlYXRlIG5ldyByb3dzLi4uCgkJCQlzID0gJyc7CgkJCQlmb3IgKGk9cHJldlJvd0NudDsgaTxyb3dDbnQ7IGkrKykgewoJCQkJCXMgKz0gIjx0ciBjbGFzcz0nZmMtd2VlayIgKyBpICsgIic+IjsKCQkJCQlmb3IgKGo9MDsgajxjb2xDbnQ7IGorKykgewoJCQkJCQlzICs9ICI8dGQgY2xhc3M9J2ZjLSIgKwoJCQkJCQkJZGF5SURzW2QuZ2V0RGF5KCldICsgJyAnICsgLy8gbmVlZHMgdG8gYmUgZmlyc3QKCQkJCQkJCXRtICsgJy1zdGF0ZS1kZWZhdWx0IGZjLW5ldyBmYy1kYXknICsgKGkqY29sQ250K2opICsKCQkJCQkJCShqPT1kaXQgPyAnIGZjLWxlZnRtb3N0JyA6ICcnKSArICInPiIgKwoJCQkJCQkJKHNob3dOdW1iZXJzID8gIjxkaXYgY2xhc3M9J2ZjLWRheS1udW1iZXInPjwvZGl2PiIgOiAnJykgKwoJCQkJCQkJIjxkaXYgY2xhc3M9J2ZjLWRheS1jb250ZW50Jz48ZGl2IHN0eWxlPSdwb3NpdGlvbjpyZWxhdGl2ZSc+Jm5ic3A7PC9kaXY+PC9kaXY+IiArCgkJCQkJCQkiPC90ZD4iOwoJCQkJCQlhZGREYXlzKGQsIDEpOwoJCQkJCQlpZiAobndlKSB7CgkJCQkJCQlza2lwV2Vla2VuZChkKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlzICs9ICI8L3RyPiI7CgkJCQl9CgkJCQl0Ym9keS5hcHBlbmQocyk7CgkJCX0KCQkJZGF5QmluZCh0Ym9keS5maW5kKCd0ZC5mYy1uZXcnKS5yZW1vdmVDbGFzcygnZmMtbmV3JykpOwoJCQkKCQkJLy8gcmUtbGFiZWwgYW5kIHJlLWNsYXNzIGV4aXN0aW5nIGNlbGxzCgkJCWQgPSBjbG9uZURhdGUodmlldy52aXNTdGFydCk7CgkJCXRib2R5LmZpbmQoJ3RkJykuZWFjaChmdW5jdGlvbigpIHsKCQkJCXZhciB0ZCA9ICQodGhpcyk7CgkJCQlpZiAocm93Q250ID4gMSkgewoJCQkJCWlmIChkLmdldE1vbnRoKCkgPT0gbW9udGgpIHsKCQkJCQkJdGQucmVtb3ZlQ2xhc3MoJ2ZjLW90aGVyLW1vbnRoJyk7CgkJCQkJfWVsc2V7CgkJCQkJCXRkLmFkZENsYXNzKCdmYy1vdGhlci1tb250aCcpOwoJCQkJCX0KCQkJCX0KCQkJCWlmICgrZCA9PSArdG9kYXkpIHsKCQkJCQl0ZC5yZW1vdmVDbGFzcygnZmMtbm90LXRvZGF5JykKCQkJCQkJLmFkZENsYXNzKCdmYy10b2RheScpCgkJCQkJCS5hZGRDbGFzcyh0bSArICctc3RhdGUtaGlnaGxpZ2h0Jyk7CgkJCQl9ZWxzZXsKCQkJCQl0ZC5hZGRDbGFzcygnZmMtbm90LXRvZGF5JykKCQkJCQkJLnJlbW92ZUNsYXNzKCdmYy10b2RheScpCgkJCQkJCS5yZW1vdmVDbGFzcyh0bSArICctc3RhdGUtaGlnaGxpZ2h0Jyk7CgkJCQl9CgkJCQl0ZC5maW5kKCdkaXYuZmMtZGF5LW51bWJlcicpLnRleHQoZC5nZXREYXRlKCkpOwoJCQkJYWRkRGF5cyhkLCAxKTsKCQkJCWlmIChud2UpIHsKCQkJCQlza2lwV2Vla2VuZChkKTsKCQkJCX0KCQkJfSk7CgkJCQoJCQlpZiAocm93Q250ID09IDEpIHsgLy8gbW9yZSBjaGFuZ2VzIGxpa2VseSAod2VlayBvciBkYXkgdmlldykKCQkJCgkJCQkvLyByZWRvIGNvbHVtbiBoZWFkZXIgdGV4dCBhbmQgY2xhc3MKCQkJCWQgPSBjbG9uZURhdGUodmlldy52aXNTdGFydCk7CgkJCQl0aGVhZC5maW5kKCd0aCcpLmVhY2goZnVuY3Rpb24oKSB7CgkJCQkJJCh0aGlzKS50ZXh0KGZvcm1hdERhdGUoZCwgY29sRm9ybWF0LCBvcHRpb25zKSk7CgkJCQkJdGhpcy5jbGFzc05hbWUgPSB0aGlzLmNsYXNzTmFtZS5yZXBsYWNlKC9eZmMtXHcrKD89ICkvLCAnZmMtJyArIGRheUlEc1tkLmdldERheSgpXSk7CgkJCQkJYWRkRGF5cyhkLCAxKTsKCQkJCQlpZiAobndlKSB7CgkJCQkJCXNraXBXZWVrZW5kKGQpOwoJCQkJCX0KCQkJCX0pOwoJCQkJCgkJCQkvLyByZWRvIGNlbGwgZGF5LW9mLXdlZWtzCgkJCQlkID0gY2xvbmVEYXRlKHZpZXcudmlzU3RhcnQpOwoJCQkJdGJvZHkuZmluZCgndGQnKS5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJCXRoaXMuY2xhc3NOYW1lID0gdGhpcy5jbGFzc05hbWUucmVwbGFjZSgvXmZjLVx3Kyg/PSApLywgJ2ZjLScgKyBkYXlJRHNbZC5nZXREYXkoKV0pOwoJCQkJCWFkZERheXMoZCwgMSk7CgkJCQkJaWYgKG53ZSkgewoJCQkJCQlza2lwV2Vla2VuZChkKTsKCQkJCQl9CgkJCQl9KTsKCQkJCQoJCQl9CgkJCgkJfQoJCQoJfQoJCgkKCQoJZnVuY3Rpb24gc2V0SGVpZ2h0KGhlaWdodCkgewoJCXZpZXdIZWlnaHQgPSBoZWlnaHQ7CgkJdmFyIGxlZnRURHMgPSB0Ym9keS5maW5kKCd0ciB0ZDpmaXJzdC1jaGlsZCcpLAoJCQl0Ym9keUhlaWdodCA9IHZpZXdIZWlnaHQgLSB0aGVhZC5oZWlnaHQoKSwKCQkJcm93SGVpZ2h0MSwgcm93SGVpZ2h0MjsKCQlpZiAob3B0aW9ucy53ZWVrTW9kZSA9PSAndmFyaWFibGUnKSB7CgkJCXJvd0hlaWdodDEgPSByb3dIZWlnaHQyID0gTWF0aC5mbG9vcih0Ym9keUhlaWdodCAvIChyb3dDbnQ9PTEgPyAyIDogNikpOwoJCX1lbHNlewoJCQlyb3dIZWlnaHQxID0gTWF0aC5mbG9vcih0Ym9keUhlaWdodCAvIHJvd0NudCk7CgkJCXJvd0hlaWdodDIgPSB0Ym9keUhlaWdodCAtIHJvd0hlaWdodDEqKHJvd0NudC0xKTsKCQl9CgkJaWYgKHRkSGVpZ2h0QnVnID09PSB1bmRlZmluZWQpIHsKCQkJLy8gYnVnIGluIGZpcmVmb3ggd2hlcmUgY2VsbCBoZWlnaHQgaW5jbHVkZXMgcGFkZGluZwoJCQl2YXIgdHIgPSB0Ym9keS5maW5kKCd0cjpmaXJzdCcpLAoJCQkJdGQgPSB0ci5maW5kKCd0ZDpmaXJzdCcpOwoJCQl0ZC5oZWlnaHQocm93SGVpZ2h0MSk7CgkJCXRkSGVpZ2h0QnVnID0gcm93SGVpZ2h0MSAhPSB0ZC5oZWlnaHQoKTsKCQl9CgkJaWYgKHRkSGVpZ2h0QnVnKSB7CgkJCWxlZnRURHMuc2xpY2UoMCwgLTEpLmhlaWdodChyb3dIZWlnaHQxKTsKCQkJbGVmdFREcy5zbGljZSgtMSkuaGVpZ2h0KHJvd0hlaWdodDIpOwoJCX1lbHNlewoJCQlzZXRPdXRlckhlaWdodChsZWZ0VERzLnNsaWNlKDAsIC0xKSwgcm93SGVpZ2h0MSk7CgkJCXNldE91dGVySGVpZ2h0KGxlZnRURHMuc2xpY2UoLTEpLCByb3dIZWlnaHQyKTsKCQl9Cgl9CgkKCQoJZnVuY3Rpb24gc2V0V2lkdGgod2lkdGgpIHsKCQl2aWV3V2lkdGggPSB3aWR0aDsKCQlkYXlDb250ZW50UG9zaXRpb25zLmNsZWFyKCk7CgkJc2V0T3V0ZXJXaWR0aCgKCQkJdGhlYWQuZmluZCgndGgnKS5zbGljZSgwLCAtMSksCgkJCWNvbFdpZHRoID0gTWF0aC5mbG9vcih2aWV3V2lkdGggLyBjb2xDbnQpCgkJKTsKCX0KCgkKCQoJLyogRXZlbnQgUmVuZGVyaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZnVuY3Rpb24gcmVuZGVyRXZlbnRzKGV2ZW50cykgewoJCXZpZXcucmVwb3J0RXZlbnRzKGNhY2hlZEV2ZW50cyA9IGV2ZW50cyk7CgkJcmVuZGVyU2Vncyhjb21waWxlU2VncyhldmVudHMpKTsKCX0KCQoJCglmdW5jdGlvbiByZXJlbmRlckV2ZW50cyhtb2RpZmllZEV2ZW50SWQpIHsKCQljbGVhckV2ZW50cygpOwoJCXJlbmRlclNlZ3MoY29tcGlsZVNlZ3MoY2FjaGVkRXZlbnRzKSwgbW9kaWZpZWRFdmVudElkKTsKCX0KCQoJCglmdW5jdGlvbiBjbGVhckV2ZW50cygpIHsKCQl2aWV3Ll9jbGVhckV2ZW50cygpOyAvLyBvbmx5IGNsZWFycyB0aGUgaGFzaGVzCgkJc2VnbWVudENvbnRhaW5lci5lbXB0eSgpOwoJfQoJCgkKCWZ1bmN0aW9uIGNvbXBpbGVTZWdzKGV2ZW50cykgewoJCXZhciBkMSA9IGNsb25lRGF0ZSh2aWV3LnZpc1N0YXJ0KSwKCQkJZDIgPSBhZGREYXlzKGNsb25lRGF0ZShkMSksIGNvbENudCksCgkJCXZpc0V2ZW50c0VuZHMgPSAkLm1hcChldmVudHMsIGV4Y2xFbmREYXkpLAoJCQlpLCByb3csCgkJCWosIGxldmVsLAoJCQlrLCBzZWcsCgkJCXNlZ3M9W107CgkJZm9yIChpPTA7IGk8cm93Q250OyBpKyspIHsKCQkJcm93ID0gc3RhY2tTZWdzKHZpZXcuc2xpY2VTZWdzKGV2ZW50cywgdmlzRXZlbnRzRW5kcywgZDEsIGQyKSk7CgkJCWZvciAoaj0wOyBqPHJvdy5sZW5ndGg7IGorKykgewoJCQkJbGV2ZWwgPSByb3dbal07CgkJCQlmb3IgKGs9MDsgazxsZXZlbC5sZW5ndGg7IGsrKykgewoJCQkJCXNlZyA9IGxldmVsW2tdOwoJCQkJCXNlZy5yb3cgPSBpOwoJCQkJCXNlZy5sZXZlbCA9IGo7CgkJCQkJc2Vncy5wdXNoKHNlZyk7CgkJCQl9CgkJCX0KCQkJYWRkRGF5cyhkMSwgNyk7CgkJCWFkZERheXMoZDIsIDcpOwoJCX0KCQlyZXR1cm4gc2VnczsKCX0KCQoJCglmdW5jdGlvbiByZW5kZXJTZWdzKHNlZ3MsIG1vZGlmaWVkRXZlbnRJZCkgewoJCV9yZW5kZXJEYXlTZWdzKAoJCQlzZWdzLAoJCQlyb3dDbnQsCgkJCXZpZXcsCgkJCTAsCgkJCXZpZXdXaWR0aCwKCQkJZnVuY3Rpb24oaSkgeyByZXR1cm4gdGJvZHkuZmluZCgndHI6ZXEoJytpKycpJykgfSwKCQkJZGF5Q29udGVudFBvc2l0aW9ucy5sZWZ0LAoJCQlkYXlDb250ZW50UG9zaXRpb25zLnJpZ2h0LAoJCQlzZWdtZW50Q29udGFpbmVyLAoJCQliaW5kU2VnSGFuZGxlcnMsCgkJCW1vZGlmaWVkRXZlbnRJZAoJCSk7Cgl9CgkKCQoJZnVuY3Rpb24gYmluZFNlZ0hhbmRsZXJzKGV2ZW50LCBldmVudEVsZW1lbnQsIHNlZykgewoJCXZpZXcuZXZlbnRFbGVtZW50SGFuZGxlcnMoZXZlbnQsIGV2ZW50RWxlbWVudCk7CgkJaWYgKGV2ZW50LmVkaXRhYmxlIHx8IGV2ZW50LmVkaXRhYmxlID09PSB1bmRlZmluZWQgJiYgb3B0aW9ucy5lZGl0YWJsZSkgewoJCQlkcmFnZ2FibGVFdmVudChldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJaWYgKHNlZy5pc0VuZCkgewoJCQkJdmlldy5yZXNpemFibGVEYXlFdmVudChldmVudCwgZXZlbnRFbGVtZW50LCBjb2xXaWR0aCk7CgkJCX0KCQl9Cgl9CgkKCQoJCgkvKiBFdmVudCBEcmFnZ2luZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIGRyYWdnYWJsZUV2ZW50KGV2ZW50LCBldmVudEVsZW1lbnQpIHsKCQlpZiAoIW9wdGlvbnMuZGlzYWJsZURyYWdnaW5nICYmIGV2ZW50RWxlbWVudC5kcmFnZ2FibGUpIHsKCQkJdmFyIGRheURlbHRhOwoJCQlldmVudEVsZW1lbnQuZHJhZ2dhYmxlKHsKCQkJCXpJbmRleDogOSwKCQkJCWRlbGF5OiA1MCwKCQkJCW9wYWNpdHk6IHZpZXcub3B0aW9uKCdkcmFnT3BhY2l0eScpLAoJCQkJcmV2ZXJ0RHVyYXRpb246IG9wdGlvbnMuZHJhZ1JldmVydER1cmF0aW9uLAoJCQkJc3RhcnQ6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCXZpZXcudHJpZ2dlcignZXZlbnREcmFnU3RhcnQnLCBldmVudEVsZW1lbnQsIGV2ZW50LCBldiwgdWkpOwoJCQkJCXZpZXcuaGlkZUV2ZW50cyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJCQlob3Zlckxpc3RlbmVyLnN0YXJ0KGZ1bmN0aW9uKGNlbGwsIG9yaWdDZWxsLCByb3dEZWx0YSwgY29sRGVsdGEpIHsKCQkJCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSgnb3B0aW9uJywgJ3JldmVydCcsICFjZWxsIHx8ICFyb3dEZWx0YSAmJiAhY29sRGVsdGEpOwoJCQkJCQljbGVhck92ZXJsYXkoKTsKCQkJCQkJaWYgKGNlbGwpIHsKCQkJCQkJCWRheURlbHRhID0gcm93RGVsdGEqNyArIGNvbERlbHRhKmRpczsKCQkJCQkJCXJlbmRlckRheU92ZXJsYXkoCgkJCQkJCQkJYWRkRGF5cyhjbG9uZURhdGUoZXZlbnQuc3RhcnQpLCBkYXlEZWx0YSksCgkJCQkJCQkJYWRkRGF5cyhleGNsRW5kRGF5KGV2ZW50KSwgZGF5RGVsdGEpCgkJCQkJCQkpOwoJCQkJCQl9ZWxzZXsKCQkJCQkJCWRheURlbHRhID0gMDsKCQkJCQkJfQoJCQkJCX0sIGV2LCAnZHJhZycpOwoJCQkJfSwKCQkJCXN0b3A6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCWhvdmVyTGlzdGVuZXIuc3RvcCgpOwoJCQkJCWNsZWFyT3ZlcmxheSgpOwoJCQkJCXZpZXcudHJpZ2dlcignZXZlbnREcmFnU3RvcCcsIGV2ZW50RWxlbWVudCwgZXZlbnQsIGV2LCB1aSk7CgkJCQkJaWYgKGRheURlbHRhKSB7CgkJCQkJCWV2ZW50RWxlbWVudC5maW5kKCdhJykucmVtb3ZlQXR0cignaHJlZicpOyAvLyBwcmV2ZW50cyBzYWZhcmkgZnJvbSB2aXNpdGluZyB0aGUgbGluawoJCQkJCQl2aWV3LmV2ZW50RHJvcCh0aGlzLCBldmVudCwgZGF5RGVsdGEsIDAsIGV2ZW50LmFsbERheSwgZXYsIHVpKTsKCQkJCQl9ZWxzZXsKCQkJCQkJaWYgKCQuYnJvd3Nlci5tc2llKSB7CgkJCQkJCQlldmVudEVsZW1lbnQuY3NzKCdmaWx0ZXInLCAnJyk7IC8vIGNsZWFyIElFIG9wYWNpdHkgc2lkZS1lZmZlY3RzCgkJCQkJCX0KCQkJCQkJdmlldy5zaG93RXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfQoJfQoJCgkKCQoJLyogRGF5IGNsaWNraW5nIGFuZCBiaW5kaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCglmdW5jdGlvbiBkYXlCaW5kKGRheXMpIHsKCQlkYXlzLmNsaWNrKGRheUNsaWNrKQoJCQkubW91c2Vkb3duKHNlbGVjdGlvbk1vdXNlZG93bik7Cgl9CgkKCWZ1bmN0aW9uIGRheUNsaWNrKGV2KSB7CgkJaWYgKCF2aWV3Lm9wdGlvbignc2VsZWN0YWJsZScpKSB7IC8vIFNlbGVjdGlvbk1hbmFnZXIgd2lsbCB3b3JyeSBhYm91dCBkYXlDbGljawoJCQl2YXIgbiA9IHBhcnNlSW50KHRoaXMuY2xhc3NOYW1lLm1hdGNoKC9mY1wtZGF5KFxkKykvKVsxXSksCgkJCQlkYXRlID0gYWRkRGF5cygKCQkJCQljbG9uZURhdGUodmlldy52aXNTdGFydCksCgkJCQkJTWF0aC5mbG9vcihuL2NvbENudCkgKiA3ICsgbiAlIGNvbENudAoJCQkJKTsKCQkJLy8gVE9ETzogd2hhdCBhYm91dCB3ZWVrZW5kcyBpbiBtaWRkbGUgb2Ygd2Vlaz8KCQkJdmlldy50cmlnZ2VyKCdkYXlDbGljaycsIHRoaXMsIGRhdGUsIHRydWUsIGV2KTsKCQl9Cgl9CgkKCQoJCgkvKiBDb29yZGluYXRlIFV0aWxpdGllcwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgl2YXIgY29vcmRpbmF0ZUdyaWQgPSBuZXcgQ29vcmRpbmF0ZUdyaWQoZnVuY3Rpb24ocm93cywgY29scykgewoJCXZhciBlLCBuLCBwOwoJCXZhciB0ZHMgPSB0Ym9keS5maW5kKCd0cjpmaXJzdCB0ZCcpOwoJCWlmIChydGwpIHsKCQkJdGRzID0gJCh0ZHMuZ2V0KCkucmV2ZXJzZSgpKTsKCQl9CgkJdGRzLmVhY2goZnVuY3Rpb24oaSwgX2UpIHsKCQkJZSA9ICQoX2UpOwoJCQluID0gZS5vZmZzZXQoKS5sZWZ0OwoJCQlpZiAoaSkgewoJCQkJcFsxXSA9IG47CgkJCX0KCQkJcCA9IFtuXTsKCQkJY29sc1tpXSA9IHA7CgkJfSk7CgkJcFsxXSA9IG4gKyBlLm91dGVyV2lkdGgoKTsKCQl0Ym9keS5maW5kKCd0cicpLmVhY2goZnVuY3Rpb24oaSwgX2UpIHsKCQkJZSA9ICQoX2UpOwoJCQluID0gZS5vZmZzZXQoKS50b3A7CgkJCWlmIChpKSB7CgkJCQlwWzFdID0gbjsKCQkJfQoJCQlwID0gW25dOwoJCQlyb3dzW2ldID0gcDsKCQl9KTsKCQlwWzFdID0gbiArIGUub3V0ZXJIZWlnaHQoKTsKCX0pOwoJCgl2YXIgaG92ZXJMaXN0ZW5lciA9IG5ldyBIb3Zlckxpc3RlbmVyKGNvb3JkaW5hdGVHcmlkKTsKCQoJCgkKCS8qIFNlbGVjdGluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgl2YXIgc2VsZWN0ZWQgPSBmYWxzZTsKCXZhciBzZWxlY3Rpb25Nb3VzZWRvd24gPSBzZWxlY3Rpb25fZGF5TW91c2Vkb3duKAoJCXZpZXcsIGhvdmVyTGlzdGVuZXIsIGNlbGxEYXRlLCBmdW5jdGlvbigpe3JldHVybiB0cnVlfSwgcmVuZGVyRGF5T3ZlcmxheSwgY2xlYXJPdmVybGF5LCByZXBvcnRTZWxlY3Rpb24sIHVuc2VsZWN0CgkpOwoJCgl2aWV3LnNlbGVjdCA9IGZ1bmN0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgYWxsRGF5KSB7CgkJY29vcmRpbmF0ZUdyaWQuYnVpbGQoKTsKCQl1bnNlbGVjdCgpOwoJCWlmICghZW5kRGF0ZSkgewoJCQllbmREYXRlID0gY2xvbmVEYXRlKHN0YXJ0RGF0ZSk7CgkJfQoJCXJlbmRlckRheU92ZXJsYXkoc3RhcnREYXRlLCBhZGREYXlzKGNsb25lRGF0ZShlbmREYXRlKSwgMSkpOwoJCXJlcG9ydFNlbGVjdGlvbihzdGFydERhdGUsIGVuZERhdGUsIGFsbERheSk7Cgl9OwoJCglmdW5jdGlvbiByZXBvcnRTZWxlY3Rpb24oc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXksIGV2KSB7CgkJc2VsZWN0ZWQgPSB0cnVlOwoJCXZpZXcudHJpZ2dlcignc2VsZWN0Jywgdmlldywgc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXksIGV2KTsKCX0KCQoJZnVuY3Rpb24gdW5zZWxlY3QoZXYpIHsKCQlpZiAoc2VsZWN0ZWQpIHsKCQkJY2xlYXJPdmVybGF5KCk7CgkJCXNlbGVjdGVkID0gZmFsc2U7CgkJCXZpZXcudHJpZ2dlcigndW5zZWxlY3QnLCB2aWV3LCBldik7CgkJfQoJfQoJdmlldy51bnNlbGVjdCA9IHVuc2VsZWN0OwoJCglzZWxlY3Rpb25fdW5zZWxlY3RBdXRvKHZpZXcsIHVuc2VsZWN0KTsKCQoJCgkKCS8qIEV4dGVybmFsIGRyYWdnaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgl2aWV3LmRyYWdTdGFydCA9IGZ1bmN0aW9uKF9kcmFnRWxlbWVudCwgZXYsIHVpKSB7CgkJaG92ZXJMaXN0ZW5lci5zdGFydChmdW5jdGlvbihjZWxsKSB7CgkJCWNsZWFyT3ZlcmxheSgpOwoJCQlpZiAoY2VsbCkgewoJCQkJX3JlbmRlckRheU92ZXJsYXkoY2VsbC5yb3csIGNlbGwuY29sLCBjZWxsLnJvdywgY2VsbC5jb2wpOwoJCQl9CgkJfSwgZXYpOwoJfTsKCQoJdmlldy5kcmFnU3RvcCA9IGZ1bmN0aW9uKF9kcmFnRWxlbWVudCwgZXYsIHVpKSB7CgkJdmFyIGNlbGwgPSBob3Zlckxpc3RlbmVyLnN0b3AoKTsKCQljbGVhck92ZXJsYXkoKTsKCQlpZiAoY2VsbCkgewoJCQl2YXIgZCA9IGNlbGxEYXRlKGNlbGwpOwoJCQl2aWV3LnRyaWdnZXIoJ2Ryb3AnLCBfZHJhZ0VsZW1lbnQsIGQsIHRydWUsIGV2LCB1aSk7CgkJfQoJfTsKCQoJCgkKCS8qIFNlbWktdHJhbnNwYXJlbnQgT3ZlcmxheSBIZWxwZXJzCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCglmdW5jdGlvbiByZW5kZXJEYXlPdmVybGF5KG92ZXJsYXlTdGFydCwgb3ZlcmxheUVuZCkgeyAvLyBvdmVybGF5RW5kIGlzIGV4Y2x1c2l2ZQoJCXZhciByb3dTdGFydCA9IGNsb25lRGF0ZSh2aWV3LnZpc1N0YXJ0KTsKCQl2YXIgcm93RW5kID0gYWRkRGF5cyhjbG9uZURhdGUocm93U3RhcnQpLCBjb2xDbnQpOwoJCWZvciAodmFyIGk9MDsgaTxyb3dDbnQ7IGkrKykgewoJCQl2YXIgc3RyZXRjaFN0YXJ0ID0gbmV3IERhdGUoTWF0aC5tYXgocm93U3RhcnQsIG92ZXJsYXlTdGFydCkpOwoJCQl2YXIgc3RyZXRjaEVuZCA9IG5ldyBEYXRlKE1hdGgubWluKHJvd0VuZCwgb3ZlcmxheUVuZCkpOwoJCQlpZiAoc3RyZXRjaFN0YXJ0IDwgc3RyZXRjaEVuZCkgewoJCQkJdmFyIGNvbFN0YXJ0LCBjb2xFbmQ7CgkJCQlpZiAocnRsKSB7CgkJCQkJY29sU3RhcnQgPSBkYXlEaWZmKHN0cmV0Y2hFbmQsIHJvd1N0YXJ0KSpkaXMrZGl0KzE7CgkJCQkJY29sRW5kID0gZGF5RGlmZihzdHJldGNoU3RhcnQsIHJvd1N0YXJ0KSpkaXMrZGl0KzE7CgkJCQl9ZWxzZXsKCQkJCQljb2xTdGFydCA9IGRheURpZmYoc3RyZXRjaFN0YXJ0LCByb3dTdGFydCk7CgkJCQkJY29sRW5kID0gZGF5RGlmZihzdHJldGNoRW5kLCByb3dTdGFydCk7CgkJCQl9CgkJCQlkYXlCaW5kKAoJCQkJCV9yZW5kZXJEYXlPdmVybGF5KGksIGNvbFN0YXJ0LCBpLCBjb2xFbmQtMSkKCQkJCSk7CgkJCX0KCQkJYWRkRGF5cyhyb3dTdGFydCwgNyk7CgkJCWFkZERheXMocm93RW5kLCA3KTsKCQl9Cgl9CgkKCWZ1bmN0aW9uIF9yZW5kZXJEYXlPdmVybGF5KHJvdzAsIGNvbDAsIHJvdzEsIGNvbDEpIHsgLy8gcm93MSxjb2wxIGlzIGluY2x1c2l2ZQoJCXZhciByZWN0ID0gY29vcmRpbmF0ZUdyaWQucmVjdChyb3cwLCBjb2wwLCByb3cxLCBjb2wxLCBlbGVtZW50KTsKCQlyZXR1cm4gdmlldy5yZW5kZXJPdmVybGF5KHJlY3QsIGVsZW1lbnQpOwoJfQoJCglmdW5jdGlvbiBjbGVhck92ZXJsYXkoKSB7CgkJdmlldy5jbGVhck92ZXJsYXlzKCk7Cgl9CgkKCQoJCgkvKiBEYXRlIFV0aWxzCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgkKCWZ1bmN0aW9uIGNlbGxEYXRlKGNlbGwpIHsKCQlyZXR1cm4gYWRkRGF5cyhjbG9uZURhdGUodmlldy52aXNTdGFydCksIGNlbGwucm93KjcgKyBjZWxsLmNvbCpkaXMrZGl0KTsKCQkvLyBUT0RPOiB3aGF0IGFib3V0IHdlZWtlbmRzIGluIG1pZGRsZSBvZiB3ZWVrPwoJfQoJCgp9CgoKZnVuY3Rpb24gX3JlbmRlckRheVNlZ3Moc2Vncywgcm93Q250LCB2aWV3LCBtaW5MZWZ0LCBtYXhMZWZ0LCBnZXRSb3csIGRheUNvbnRlbnRMZWZ0LCBkYXlDb250ZW50UmlnaHQsIHNlZ21lbnRDb250YWluZXIsIGJpbmRTZWdIYW5kbGVycywgbW9kaWZpZWRFdmVudElkKSB7CgoJdmFyIG9wdGlvbnM9dmlldy5vcHRpb25zLAoJCXJ0bD1vcHRpb25zLmlzUlRMLAoJCWksIHNlZ0NudD1zZWdzLmxlbmd0aCwgc2VnLAoJCWV2ZW50LAoJCWNsYXNzTmFtZSwKCQlsZWZ0LCByaWdodCwKCQlodG1sPScnLAoJCWV2ZW50RWxlbWVudHMsCgkJZXZlbnRFbGVtZW50LAoJCXRyaWdnZXJSZXMsCgkJaHNpZGVDYWNoZT17fSwKCQl2bWFyZ2luQ2FjaGU9e30sCgkJa2V5LCB2YWwsCgkJcm93SSwgdG9wLCBsZXZlbEksIGxldmVsSGVpZ2h0LAoJCXJvd0RpdnM9W10sCgkJcm93RGl2VG9wcz1bXTsKCQkKCS8vIGNhbGN1bGF0ZSBkZXNpcmVkIHBvc2l0aW9uL2RpbWVuc2lvbnMsIGNyZWF0ZSBodG1sCglmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCXNlZyA9IHNlZ3NbaV07CgkJZXZlbnQgPSBzZWcuZXZlbnQ7CgkJY2xhc3NOYW1lID0gJ2ZjLWV2ZW50IGZjLWV2ZW50LWhvcmkgJzsKCQlpZiAocnRsKSB7CgkJCWlmIChzZWcuaXNTdGFydCkgewoJCQkJY2xhc3NOYW1lICs9ICdmYy1jb3JuZXItcmlnaHQgJzsKCQkJfQoJCQlpZiAoc2VnLmlzRW5kKSB7CgkJCQljbGFzc05hbWUgKz0gJ2ZjLWNvcm5lci1sZWZ0ICc7CgkJCX0KCQkJbGVmdCA9IHNlZy5pc0VuZCA/IGRheUNvbnRlbnRMZWZ0KHNlZy5lbmQuZ2V0RGF5KCktMSkgOiBtaW5MZWZ0OwoJCQlyaWdodCA9IHNlZy5pc1N0YXJ0ID8gZGF5Q29udGVudFJpZ2h0KHNlZy5zdGFydC5nZXREYXkoKSkgOiBtYXhMZWZ0OwoJCX1lbHNlewoJCQlpZiAoc2VnLmlzU3RhcnQpIHsKCQkJCWNsYXNzTmFtZSArPSAnZmMtY29ybmVyLWxlZnQgJzsKCQkJfQoJCQlpZiAoc2VnLmlzRW5kKSB7CgkJCQljbGFzc05hbWUgKz0gJ2ZjLWNvcm5lci1yaWdodCAnOwoJCQl9CgkJCWxlZnQgPSBzZWcuaXNTdGFydCA/IGRheUNvbnRlbnRMZWZ0KHNlZy5zdGFydC5nZXREYXkoKSkgOiBtaW5MZWZ0OwoJCQlyaWdodCA9IHNlZy5pc0VuZCA/IGRheUNvbnRlbnRSaWdodChzZWcuZW5kLmdldERheSgpLTEpIDogbWF4TGVmdDsKCQl9CgkJaHRtbCArPQoJCQkiPGRpdiBjbGFzcz0nIiArIGNsYXNzTmFtZSArIGV2ZW50LmNsYXNzTmFtZS5qb2luKCcgJykgKyAiJyBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDo4O2xlZnQ6IitsZWZ0KyJweCc+IiArCgkJCQkiPGEiICsgKGV2ZW50LnVybCA/ICIgaHJlZj0nIiArIGh0bWxFc2NhcGUoZXZlbnQudXJsKSArICInIiA6ICcnKSArICI+IiArCgkJCQkJKCFldmVudC5hbGxEYXkgJiYgc2VnLmlzU3RhcnQgPwoJCQkJCQkiPHNwYW4gY2xhc3M9J2ZjLWV2ZW50LXRpbWUnPiIgKwoJCQkJCQkJaHRtbEVzY2FwZShmb3JtYXREYXRlcyhldmVudC5zdGFydCwgZXZlbnQuZW5kLCB2aWV3Lm9wdGlvbigndGltZUZvcm1hdCcpLCBvcHRpb25zKSkgKwoJCQkJCQkiPC9zcGFuPiIKCQkJCQk6JycpICsKCQkJCQkiPHNwYW4gY2xhc3M9J2ZjLWV2ZW50LXRpdGxlJz4iICsgaHRtbEVzY2FwZShldmVudC50aXRsZSkgKyAiPC9zcGFuPiIgKwoJCQkJIjwvYT4iICsKCQkJCSgoZXZlbnQuZWRpdGFibGUgfHwgZXZlbnQuZWRpdGFibGUgPT09IHVuZGVmaW5lZCAmJiBvcHRpb25zLmVkaXRhYmxlKSAmJiAhb3B0aW9ucy5kaXNhYmxlUmVzaXppbmcgJiYgJC5mbi5yZXNpemFibGUgPwoJCQkJCSI8ZGl2IGNsYXNzPSd1aS1yZXNpemFibGUtaGFuZGxlIHVpLXJlc2l6YWJsZS0iICsgKHJ0bCA/ICd3JyA6ICdlJykgKyAiJz48L2Rpdj4iCgkJCQkJOiAnJykgKwoJCQkiPC9kaXY+IjsKCQlzZWcubGVmdCA9IGxlZnQ7CgkJc2VnLm91dGVyV2lkdGggPSByaWdodCAtIGxlZnQ7Cgl9CglzZWdtZW50Q29udGFpbmVyWzBdLmlubmVySFRNTCA9IGh0bWw7IC8vIGZhc3RlciB0aGFuIGh0bWwoKQoJZXZlbnRFbGVtZW50cyA9IHNlZ21lbnRDb250YWluZXIuY2hpbGRyZW4oKTsKCQoJLy8gcmV0cmlldmUgZWxlbWVudHMsIHJ1biB0aHJvdWdoIGV2ZW50UmVuZGVyIGNhbGxiYWNrLCBiaW5kIGhhbmRsZXJzCglmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCXNlZyA9IHNlZ3NbaV07CgkJZXZlbnRFbGVtZW50ID0gJChldmVudEVsZW1lbnRzW2ldKTsgLy8gZmFzdGVyIHRoYW4gZXEoKQoJCWV2ZW50ID0gc2VnLmV2ZW50OwoJCXRyaWdnZXJSZXMgPSB2aWV3LnRyaWdnZXIoJ2V2ZW50UmVuZGVyJywgZXZlbnQsIGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCWlmICh0cmlnZ2VyUmVzID09PSBmYWxzZSkgewoJCQlldmVudEVsZW1lbnQucmVtb3ZlKCk7CgkJfWVsc2V7CgkJCWlmICh0cmlnZ2VyUmVzICYmIHRyaWdnZXJSZXMgIT09IHRydWUpIHsKCQkJCWV2ZW50RWxlbWVudC5yZW1vdmUoKTsKCQkJCWV2ZW50RWxlbWVudCA9ICQodHJpZ2dlclJlcykKCQkJCQkuY3NzKHsKCQkJCQkJcG9zaXRpb246ICdhYnNvbHV0ZScsCgkJCQkJCWxlZnQ6IHNlZy5sZWZ0CgkJCQkJfSkKCQkJCQkuYXBwZW5kVG8oc2VnbWVudENvbnRhaW5lcik7CgkJCX0KCQkJc2VnLmVsZW1lbnQgPSBldmVudEVsZW1lbnQ7CgkJCWlmIChldmVudC5faWQgPT09IG1vZGlmaWVkRXZlbnRJZCkgewoJCQkJYmluZFNlZ0hhbmRsZXJzKGV2ZW50LCBldmVudEVsZW1lbnQsIHNlZyk7CgkJCX1lbHNlewoJCQkJZXZlbnRFbGVtZW50WzBdLl9mY2kgPSBpOyAvLyBmb3IgbGF6eVNlZ0JpbmQKCQkJfQoJCQl2aWV3LnJlcG9ydEV2ZW50RWxlbWVudChldmVudCwgZXZlbnRFbGVtZW50KTsKCQl9Cgl9CgkKCWxhenlTZWdCaW5kKHNlZ21lbnRDb250YWluZXIsIHNlZ3MsIGJpbmRTZWdIYW5kbGVycyk7CgkKCS8vIHJlY29yZCBldmVudCBob3Jpem9udGFsIHNpZGVzCglmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCXNlZyA9IHNlZ3NbaV07CgkJaWYgKGV2ZW50RWxlbWVudCA9IHNlZy5lbGVtZW50KSB7CgkJCXZhbCA9IGhzaWRlQ2FjaGVba2V5ID0gc2VnLmtleSA9IGNzc0tleShldmVudEVsZW1lbnRbMF0pXTsKCQkJc2VnLmhzaWRlcyA9IHZhbCA9PT0gdW5kZWZpbmVkID8gKGhzaWRlQ2FjaGVba2V5XSA9IGhzaWRlcyhldmVudEVsZW1lbnRbMF0sIHRydWUpKSA6IHZhbDsKCQl9Cgl9CgkKCS8vIHNldCBldmVudCB3aWR0aHMKCWZvciAoaT0wOyBpPHNlZ0NudDsgaSsrKSB7CgkJc2VnID0gc2Vnc1tpXTsKCQlpZiAoZXZlbnRFbGVtZW50ID0gc2VnLmVsZW1lbnQpIHsKCQkJZXZlbnRFbGVtZW50WzBdLnN0eWxlLndpZHRoID0gc2VnLm91dGVyV2lkdGggLSBzZWcuaHNpZGVzICsgJ3B4JzsKCQl9Cgl9CgkKCS8vIHJlY29yZCBldmVudCBoZWlnaHRzCglmb3IgKGk9MDsgaTxzZWdDbnQ7IGkrKykgewoJCXNlZyA9IHNlZ3NbaV07CgkJaWYgKGV2ZW50RWxlbWVudCA9IHNlZy5lbGVtZW50KSB7CgkJCXZhbCA9IHZtYXJnaW5DYWNoZVtrZXkgPSBzZWcua2V5XTsKCQkJc2VnLm91dGVySGVpZ2h0ID0gZXZlbnRFbGVtZW50WzBdLm9mZnNldEhlaWdodCArICgKCQkJCXZhbCA9PT0gdW5kZWZpbmVkID8gKHZtYXJnaW5DYWNoZVtrZXldID0gdm1hcmdpbnMoZXZlbnRFbGVtZW50WzBdKSkgOiB2YWwKCQkJKTsKCQl9Cgl9CgkKCS8vIHNldCByb3cgaGVpZ2h0cywgY2FsY3VsYXRlIGV2ZW50IHRvcHMgKGluIHJlbGF0aW9uIHRvIHJvdyB0b3ApCglmb3IgKGk9MCwgcm93ST0wOyByb3dJPHJvd0NudDsgcm93SSsrKSB7CgkJdG9wID0gbGV2ZWxJID0gbGV2ZWxIZWlnaHQgPSAwOwoJCXdoaWxlIChpPHNlZ0NudCAmJiAoc2VnID0gc2Vnc1tpXSkucm93ID09IHJvd0kpIHsKCQkJaWYgKHNlZy5sZXZlbCAhPSBsZXZlbEkpIHsKCQkJCXRvcCArPSBsZXZlbEhlaWdodDsKCQkJCWxldmVsSGVpZ2h0ID0gMDsKCQkJCWxldmVsSSsrOwoJCQl9CgkJCWxldmVsSGVpZ2h0ID0gTWF0aC5tYXgobGV2ZWxIZWlnaHQsIHNlZy5vdXRlckhlaWdodHx8MCk7CgkJCXNlZy50b3AgPSB0b3A7CgkJCWkrKzsKCQl9CgkJcm93RGl2c1tyb3dJXSA9IGdldFJvdyhyb3dJKS5maW5kKCd0ZDpmaXJzdCBkaXYuZmMtZGF5LWNvbnRlbnQgPiBkaXYnKSAvLyBvcHRpbWFsIHNlbGVjdG9yPwoJCQkuaGVpZ2h0KHRvcCArIGxldmVsSGVpZ2h0KTsKCX0KCQoJLy8gY2FsY3VsYXRlIHJvdyB0b3BzCglmb3IgKHJvd0k9MDsgcm93STxyb3dDbnQ7IHJvd0krKykgewoJCXJvd0RpdlRvcHNbcm93SV0gPSByb3dEaXZzW3Jvd0ldWzBdLm9mZnNldFRvcDsKCX0KCQoJLy8gc2V0IGV2ZW50IHRvcHMKCWZvciAoaT0wOyBpPHNlZ0NudDsgaSsrKSB7CgkJc2VnID0gc2Vnc1tpXTsKCQlpZiAoZXZlbnRFbGVtZW50ID0gc2VnLmVsZW1lbnQpIHsKCQkJZXZlbnRFbGVtZW50WzBdLnN0eWxlLnRvcCA9IHJvd0RpdlRvcHNbc2VnLnJvd10gKyBzZWcudG9wICsgJ3B4JzsKCQkJZXZlbnQgPSBzZWcuZXZlbnQ7CgkJCXZpZXcudHJpZ2dlcignZXZlbnRBZnRlclJlbmRlcicsIGV2ZW50LCBldmVudCwgZXZlbnRFbGVtZW50KTsKCQl9Cgl9CgkKfQoKCgovKiBBZ2VuZGEgVmlld3M6IGFnZW5kYVdlZWsvYWdlbmRhRGF5Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCnNldERlZmF1bHRzKHsKCWFsbERheVNsb3Q6IHRydWUsCglhbGxEYXlUZXh0OiAnYWxsLWRheScsCglmaXJzdEhvdXI6IDYsCglzbG90TWludXRlczogMzAsCglkZWZhdWx0RXZlbnRNaW51dGVzOiAxMjAsCglheGlzRm9ybWF0OiAnaCg6bW0pdHQnLAoJdGltZUZvcm1hdDogewoJCWFnZW5kYTogJ2g6bW17IC0gaDptbX0nCgl9LAoJZHJhZ09wYWNpdHk6IHsKCQlhZ2VuZGE6IC41Cgl9LAoJbWluVGltZTogMCwKCW1heFRpbWU6IDI0Cn0pOwoKdmlld3MuYWdlbmRhV2VlayA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMsIHZpZXdOYW1lKSB7CglyZXR1cm4gbmV3IEFnZW5kYShlbGVtZW50LCBvcHRpb25zLCB7CgkJcmVuZGVyOiBmdW5jdGlvbihkYXRlLCBkZWx0YSkgewoJCQlpZiAoZGVsdGEpIHsKCQkJCWFkZERheXMoZGF0ZSwgZGVsdGEgKiA3KTsKCQkJfQoJCQl2YXIgdmlzU3RhcnQgPSB0aGlzLnZpc1N0YXJ0ID0gY2xvbmVEYXRlKAoJCQkJCXRoaXMuc3RhcnQgPSBhZGREYXlzKGNsb25lRGF0ZShkYXRlKSwgLSgoZGF0ZS5nZXREYXkoKSAtIG9wdGlvbnMuZmlyc3REYXkgKyA3KSAlIDcpKQoJCQkJKSwKCQkJCXZpc0VuZCA9IHRoaXMudmlzRW5kID0gY2xvbmVEYXRlKAoJCQkJCXRoaXMuZW5kID0gYWRkRGF5cyhjbG9uZURhdGUodmlzU3RhcnQpLCA3KQoJCQkJKTsKCQkJaWYgKCFvcHRpb25zLndlZWtlbmRzKSB7CgkJCQlza2lwV2Vla2VuZCh2aXNTdGFydCk7CgkJCQlza2lwV2Vla2VuZCh2aXNFbmQsIC0xLCB0cnVlKTsKCQkJfQoJCQl0aGlzLnRpdGxlID0gZm9ybWF0RGF0ZXMoCgkJCQl2aXNTdGFydCwKCQkJCWFkZERheXMoY2xvbmVEYXRlKHZpc0VuZCksIC0xKSwKCQkJCXRoaXMub3B0aW9uKCd0aXRsZUZvcm1hdCcpLAoJCQkJb3B0aW9ucwoJCQkpOwoJCQl0aGlzLnJlbmRlckFnZW5kYSgKCQkJCW9wdGlvbnMud2Vla2VuZHMgPyA3IDogNSwKCQkJCXRoaXMub3B0aW9uKCdjb2x1bW5Gb3JtYXQnKQoJCQkpOwoJCX0KCX0sIHZpZXdOYW1lKTsKfTsKCnZpZXdzLmFnZW5kYURheSA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMsIHZpZXdOYW1lKSB7CglyZXR1cm4gbmV3IEFnZW5kYShlbGVtZW50LCBvcHRpb25zLCB7CgkJcmVuZGVyOiBmdW5jdGlvbihkYXRlLCBkZWx0YSkgewoJCQlpZiAoZGVsdGEpIHsKCQkJCWFkZERheXMoZGF0ZSwgZGVsdGEpOwoJCQkJaWYgKCFvcHRpb25zLndlZWtlbmRzKSB7CgkJCQkJc2tpcFdlZWtlbmQoZGF0ZSwgZGVsdGEgPCAwID8gLTEgOiAxKTsKCQkJCX0KCQkJfQoJCQl0aGlzLnRpdGxlID0gZm9ybWF0RGF0ZShkYXRlLCB0aGlzLm9wdGlvbigndGl0bGVGb3JtYXQnKSwgb3B0aW9ucyk7CgkJCXRoaXMuc3RhcnQgPSB0aGlzLnZpc1N0YXJ0ID0gY2xvbmVEYXRlKGRhdGUsIHRydWUpOwoJCQl0aGlzLmVuZCA9IHRoaXMudmlzRW5kID0gYWRkRGF5cyhjbG9uZURhdGUodGhpcy5zdGFydCksIDEpOwoJCQl0aGlzLnJlbmRlckFnZW5kYSgKCQkJCTEsCgkJCQl0aGlzLm9wdGlvbignY29sdW1uRm9ybWF0JykKCQkJKTsKCQl9Cgl9LCB2aWV3TmFtZSk7Cn07CgpmdW5jdGlvbiBBZ2VuZGEoZWxlbWVudCwgb3B0aW9ucywgbWV0aG9kcywgdmlld05hbWUpIHsKCgl2YXIgaGVhZCwgYm9keSwgYm9keUNvbnRlbnQsIGJvZHlUYWJsZSwgYmcsCgkJY29sQ250LAoJCXNsb3RDbnQ9MCwgLy8gc3Bhbm5pbmcgYWxsIHRoZSB3YXkgYWNyb3NzCgkJYXhpc1dpZHRoLCBjb2xXaWR0aCwgc2xvdEhlaWdodCwKCQl2aWV3V2lkdGgsIHZpZXdIZWlnaHQsCgkJc2F2ZWRTY3JvbGxUb3AsCgkJY2FjaGVkRXZlbnRzPVtdLAoJCWRheVNlZ21lbnRDb250YWluZXIsCgkJc2xvdFNlZ21lbnRDb250YWluZXIsCgkJdG0sIGZpcnN0RGF5LAoJCW53ZSwgICAgICAgICAgICAvLyBubyB3ZWVrZW5kcyAoaW50KQoJCXJ0bCwgZGlzLCBkaXQsICAvLyBkYXkgaW5kZXggc2lnbiAvIHRyYW5zbGF0ZQoJCW1pbk1pbnV0ZSwgbWF4TWludXRlLAoJCWNvbENvbnRlbnRQb3NpdGlvbnMgPSBuZXcgSG9yaXpvbnRhbFBvc2l0aW9uQ2FjaGUoZnVuY3Rpb24oY29sKSB7CgkJCXJldHVybiBiZy5maW5kKCd0ZDplcSgnICsgY29sICsgJykgZGl2IGRpdicpOwoJCX0pLAoJCXNsb3RUb3BDYWNoZSA9IHt9LAoJCS8vIC4uLgoJCQoJdmlldyA9ICQuZXh0ZW5kKHRoaXMsIHZpZXdNZXRob2RzLCBtZXRob2RzLCB7CgkJcmVuZGVyQWdlbmRhOiByZW5kZXJBZ2VuZGEsCgkJcmVuZGVyRXZlbnRzOiByZW5kZXJFdmVudHMsCgkJcmVyZW5kZXJFdmVudHM6IHJlcmVuZGVyRXZlbnRzLAoJCWNsZWFyRXZlbnRzOiBjbGVhckV2ZW50cywKCQlzZXRIZWlnaHQ6IHNldEhlaWdodCwKCQlzZXRXaWR0aDogc2V0V2lkdGgsCgkJYmVmb3JlSGlkZTogZnVuY3Rpb24oKSB7CgkJCXNhdmVkU2Nyb2xsVG9wID0gYm9keS5zY3JvbGxUb3AoKTsKCQl9LAoJCWFmdGVyU2hvdzogZnVuY3Rpb24oKSB7CgkJCWJvZHkuc2Nyb2xsVG9wKHNhdmVkU2Nyb2xsVG9wKTsKCQl9LAoJCWRlZmF1bHRFdmVudEVuZDogZnVuY3Rpb24oZXZlbnQpIHsKCQkJdmFyIHN0YXJ0ID0gY2xvbmVEYXRlKGV2ZW50LnN0YXJ0KTsKCQkJaWYgKGV2ZW50LmFsbERheSkgewoJCQkJcmV0dXJuIHN0YXJ0OwoJCQl9CgkJCXJldHVybiBhZGRNaW51dGVzKHN0YXJ0LCBvcHRpb25zLmRlZmF1bHRFdmVudE1pbnV0ZXMpOwoJCX0KCX0pOwoJdmlldy5uYW1lID0gdmlld05hbWU7Cgl2aWV3LmluaXQoZWxlbWVudCwgb3B0aW9ucyk7CgkKCQoJCgkvKiBUaW1lLXNsb3QgcmVuZGVyaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJZGlzYWJsZVRleHRTZWxlY3Rpb24oZWxlbWVudC5hZGRDbGFzcygnZmMtYWdlbmRhJykpOwoJCgkKCWZ1bmN0aW9uIHJlbmRlckFnZW5kYShjLCBjb2xGb3JtYXQpIHsKCQoJCWNvbENudCA9IGM7CgkJCgkJLy8gdXBkYXRlIG9wdGlvbi1kZXJpdmVkIHZhcmlhYmxlcwoJCXRtID0gb3B0aW9ucy50aGVtZSA/ICd1aScgOiAnZmMnOwoJCW53ZSA9IG9wdGlvbnMud2Vla2VuZHMgPyAwIDogMTsKCQlmaXJzdERheSA9IG9wdGlvbnMuZmlyc3REYXk7CgkJaWYgKHJ0bCA9IG9wdGlvbnMuaXNSVEwpIHsKCQkJZGlzID0gLTE7CgkJCWRpdCA9IGNvbENudCAtIDE7CgkJfWVsc2V7CgkJCWRpcyA9IDE7CgkJCWRpdCA9IDA7CgkJfQoJCW1pbk1pbnV0ZSA9IHBhcnNlVGltZShvcHRpb25zLm1pblRpbWUpOwoJCW1heE1pbnV0ZSA9IHBhcnNlVGltZShvcHRpb25zLm1heFRpbWUpOwoJCQoJCXZhciBkMCA9IHJ0bCA/IGFkZERheXMoY2xvbmVEYXRlKHZpZXcudmlzRW5kKSwgLTEpIDogY2xvbmVEYXRlKHZpZXcudmlzU3RhcnQpLAoJCQlkID0gY2xvbmVEYXRlKGQwKSwKCQkJdG9kYXkgPSBjbGVhclRpbWUobmV3IERhdGUoKSk7CgkJCgkJaWYgKCFoZWFkKSB7IC8vIGZpcnN0IHRpbWUgcmVuZGVyaW5nLCBidWlsZCBmcm9tIHNjcmF0Y2gKCQkKCQkJdmFyIGksCgkJCQltaW51dGVzLAoJCQkJc2xvdE5vcm1hbCA9IG9wdGlvbnMuc2xvdE1pbnV0ZXMgJSAxNSA9PSAwLCAvLy4uLgoJCQkKCQkJLy8gaGVhZAoJCQlzID0gIjxkaXYgY2xhc3M9J2ZjLWFnZW5kYS1oZWFkJyBzdHlsZT0ncG9zaXRpb246cmVsYXRpdmU7ei1pbmRleDo0Jz4iICsKCQkJCSI8dGFibGUgc3R5bGU9J3dpZHRoOjEwMCUnPiIgKwoJCQkJIjx0ciBjbGFzcz0nZmMtZmlyc3QiICsgKG9wdGlvbnMuYWxsRGF5U2xvdCA/ICcnIDogJyBmYy1sYXN0JykgKyAiJz4iICsKCQkJCSI8dGggY2xhc3M9J2ZjLWxlZnRtb3N0ICIgKwoJCQkJCXRtICsgIi1zdGF0ZS1kZWZhdWx0Jz4mbmJzcDs8L3RoPiI7CgkJCWZvciAoaT0wOyBpPGNvbENudDsgaSsrKSB7CgkJCQlzICs9ICI8dGggY2xhc3M9J2ZjLSIgKwoJCQkJCWRheUlEc1tkLmdldERheSgpXSArICcgJyArIC8vIG5lZWRzIHRvIGJlIGZpcnN0CgkJCQkJdG0gKyAnLXN0YXRlLWRlZmF1bHQnICsKCQkJCQkiJz4iICsgZm9ybWF0RGF0ZShkLCBjb2xGb3JtYXQsIG9wdGlvbnMpICsgIjwvdGg+IjsKCQkJCWFkZERheXMoZCwgZGlzKTsKCQkJCWlmIChud2UpIHsKCQkJCQlza2lwV2Vla2VuZChkLCBkaXMpOwoJCQkJfQoJCQl9CgkJCXMgKz0gIjx0aCBjbGFzcz0nIiArIHRtICsgIi1zdGF0ZS1kZWZhdWx0Jz4mbmJzcDs8L3RoPjwvdHI+IjsKCQkJaWYgKG9wdGlvbnMuYWxsRGF5U2xvdCkgewoJCQkJcyArPSAiPHRyIGNsYXNzPSdmYy1hbGwtZGF5Jz4iICsKCQkJCQkJIjx0aCBjbGFzcz0nZmMtYXhpcyBmYy1sZWZ0bW9zdCAiICsgdG0gKyAiLXN0YXRlLWRlZmF1bHQnPiIgKyBvcHRpb25zLmFsbERheVRleHQgKyAiPC90aD4iICsKCQkJCQkJIjx0ZCBjb2xzcGFuPSciICsgY29sQ250ICsgIicgY2xhc3M9JyIgKyB0bSArICItc3RhdGUtZGVmYXVsdCc+IiArCgkJCQkJCQkiPGRpdiBjbGFzcz0nZmMtZGF5LWNvbnRlbnQnPjxkaXYgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlJz4mbmJzcDs8L2Rpdj48L2Rpdj48L3RkPiIgKwoJCQkJCQkiPHRoIGNsYXNzPSciICsgdG0gKyAiLXN0YXRlLWRlZmF1bHQnPiZuYnNwOzwvdGg+IiArCgkJCQkJIjwvdHI+PHRyIGNsYXNzPSdmYy1kaXZpZGVyIGZjLWxhc3QnPjx0aCBjb2xzcGFuPSciICsgKGNvbENudCsyKSArICInIGNsYXNzPSciICsKCQkJCQkJdG0gKyAiLXN0YXRlLWRlZmF1bHQgZmMtbGVmdG1vc3QnPjxkaXYvPjwvdGg+PC90cj4iOwoJCQl9CgkJCXMrPSAiPC90YWJsZT48L2Rpdj4iOwoJCQloZWFkID0gJChzKS5hcHBlbmRUbyhlbGVtZW50KTsKCQkJZGF5QmluZChoZWFkLmZpbmQoJ3RkJykpOwoJCQkKCQkJLy8gYWxsLWRheSBldmVudCBjb250YWluZXIKCQkJZGF5U2VnbWVudENvbnRhaW5lciA9ICQoIjxkaXYgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6ODt0b3A6MDtsZWZ0OjAnLz4iKS5hcHBlbmRUbyhoZWFkKTsKCQkJCgkJCS8vIGJvZHkKCQkJZCA9IHplcm9EYXRlKCk7CgkJCXZhciBtYXhkID0gYWRkTWludXRlcyhjbG9uZURhdGUoZCksIG1heE1pbnV0ZSk7CgkJCWFkZE1pbnV0ZXMoZCwgbWluTWludXRlKTsKCQkJcyA9ICI8dGFibGU+IjsKCQkJZm9yIChpPTA7IGQgPCBtYXhkOyBpKyspIHsKCQkJCW1pbnV0ZXMgPSBkLmdldE1pbnV0ZXMoKTsKCQkJCXMgKz0gIjx0ciBjbGFzcz0nIiArCgkJCQkJKCFpID8gJ2ZjLWZpcnN0JyA6ICghbWludXRlcyA/ICcnIDogJ2ZjLW1pbm9yJykpICsKCQkJCQkiJz48dGggY2xhc3M9J2ZjLWF4aXMgZmMtbGVmdG1vc3QgIiArIHRtICsgIi1zdGF0ZS1kZWZhdWx0Jz4iICsKCQkJCQkoKCFzbG90Tm9ybWFsIHx8ICFtaW51dGVzKSA/IGZvcm1hdERhdGUoZCwgb3B0aW9ucy5heGlzRm9ybWF0KSA6ICcmbmJzcDsnKSArIAoJCQkJCSI8L3RoPjx0ZCBjbGFzcz0nZmMtc2xvdCIgKyBpICsgJyAnICsKCQkJCQkJdG0gKyAiLXN0YXRlLWRlZmF1bHQnPjxkaXYgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlJz4mbmJzcDs8L2Rpdj48L3RkPjwvdHI+IjsKCQkJCWFkZE1pbnV0ZXMoZCwgb3B0aW9ucy5zbG90TWludXRlcyk7CgkJCQlzbG90Q250Kys7CgkJCX0KCQkJcyArPSAiPC90YWJsZT4iOwoJCQlib2R5ID0gJCgiPGRpdiBjbGFzcz0nZmMtYWdlbmRhLWJvZHknIHN0eWxlPSdwb3NpdGlvbjpyZWxhdGl2ZTt6LWluZGV4OjI7b3ZlcmZsb3c6YXV0bycvPiIpCgkJCQkuYXBwZW5kKGJvZHlDb250ZW50ID0gJCgiPGRpdiBzdHlsZT0ncG9zaXRpb246cmVsYXRpdmU7b3ZlcmZsb3c6aGlkZGVuJz4iKQoJCQkJCS5hcHBlbmQoYm9keVRhYmxlID0gJChzKSkpCgkJCQkuYXBwZW5kVG8oZWxlbWVudCk7CgkJCXNsb3RCaW5kKGJvZHkuZmluZCgndGQnKSk7CgkJCQoJCQkvLyBzbG90IGV2ZW50IGNvbnRhaW5lcgoJCQlzbG90U2VnbWVudENvbnRhaW5lciA9ICQoIjxkaXYgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6ODt0b3A6MDtsZWZ0OjAnLz4iKS5hcHBlbmRUbyhib2R5Q29udGVudCk7CgkJCQoJCQkvLyBiYWNrZ3JvdW5kIHN0cmlwZXMKCQkJZCA9IGNsb25lRGF0ZShkMCk7CgkJCXMgPSAiPGRpdiBjbGFzcz0nZmMtYWdlbmRhLWJnJyBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoxJz4iICsKCQkJCSI8dGFibGUgc3R5bGU9J3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCUnPjx0ciBjbGFzcz0nZmMtZmlyc3QnPiI7CgkJCWZvciAoaT0wOyBpPGNvbENudDsgaSsrKSB7CgkJCQlzICs9ICI8dGQgY2xhc3M9J2ZjLSIgKwoJCQkJCWRheUlEc1tkLmdldERheSgpXSArICcgJyArIC8vIG5lZWRzIHRvIGJlIGZpcnN0CgkJCQkJdG0gKyAnLXN0YXRlLWRlZmF1bHQgJyArCgkJCQkJKCFpID8gJ2ZjLWxlZnRtb3N0ICcgOiAnJykgKwoJCQkJCSgrZCA9PSArdG9kYXkgPyB0bSArICctc3RhdGUtaGlnaGxpZ2h0IGZjLXRvZGF5JyA6ICdmYy1ub3QtdG9kYXknKSArCgkJCQkJIic+PGRpdiBjbGFzcz0nZmMtZGF5LWNvbnRlbnQnPjxkaXY+Jm5ic3A7PC9kaXY+PC9kaXY+PC90ZD4iOwoJCQkJYWRkRGF5cyhkLCBkaXMpOwoJCQkJaWYgKG53ZSkgewoJCQkJCXNraXBXZWVrZW5kKGQsIGRpcyk7CgkJCQl9CgkJCX0KCQkJcyArPSAiPC90cj48L3RhYmxlPjwvZGl2PiI7CgkJCWJnID0gJChzKS5hcHBlbmRUbyhlbGVtZW50KTsKCQkJCgkJfWVsc2V7IC8vIHNrZWxldG9uIGFscmVhZHkgYnVpbHQsIGp1c3QgbW9kaWZ5IGl0CgkJCgkJCWNsZWFyRXZlbnRzKCk7CgkJCQoJCQkvLyByZWRvIGNvbHVtbiBoZWFkZXIgdGV4dCBhbmQgY2xhc3MKCQkJaGVhZC5maW5kKCd0cjpmaXJzdCB0aCcpLnNsaWNlKDEsIC0xKS5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJJCh0aGlzKS50ZXh0KGZvcm1hdERhdGUoZCwgY29sRm9ybWF0LCBvcHRpb25zKSk7CgkJCQl0aGlzLmNsYXNzTmFtZSA9IHRoaXMuY2xhc3NOYW1lLnJlcGxhY2UoL15mYy1cdysoPz0gKS8sICdmYy0nICsgZGF5SURzW2QuZ2V0RGF5KCldKTsKCQkJCWFkZERheXMoZCwgZGlzKTsKCQkJCWlmIChud2UpIHsKCQkJCQlza2lwV2Vla2VuZChkLCBkaXMpOwoJCQkJfQoJCQl9KTsKCQkJCgkJCS8vIGNoYW5nZSBjbGFzc2VzIG9mIGJhY2tncm91bmQgc3RyaXBlcwoJCQlkID0gY2xvbmVEYXRlKGQwKTsKCQkJYmcuZmluZCgndGQnKS5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJdGhpcy5jbGFzc05hbWUgPSB0aGlzLmNsYXNzTmFtZS5yZXBsYWNlKC9eZmMtXHcrKD89ICkvLCAnZmMtJyArIGRheUlEc1tkLmdldERheSgpXSk7CgkJCQlpZiAoK2QgPT0gK3RvZGF5KSB7CgkJCQkJJCh0aGlzKQoJCQkJCQkucmVtb3ZlQ2xhc3MoJ2ZjLW5vdC10b2RheScpCgkJCQkJCS5hZGRDbGFzcygnZmMtdG9kYXknKQoJCQkJCQkuYWRkQ2xhc3ModG0gKyAnLXN0YXRlLWhpZ2hsaWdodCcpOwoJCQkJfWVsc2V7CgkJCQkJJCh0aGlzKQoJCQkJCQkuYWRkQ2xhc3MoJ2ZjLW5vdC10b2RheScpCgkJCQkJCS5yZW1vdmVDbGFzcygnZmMtdG9kYXknKQoJCQkJCQkucmVtb3ZlQ2xhc3ModG0gKyAnLXN0YXRlLWhpZ2hsaWdodCcpOwoJCQkJfQoJCQkJYWRkRGF5cyhkLCBkaXMpOwoJCQkJaWYgKG53ZSkgewoJCQkJCXNraXBXZWVrZW5kKGQsIGRpcyk7CgkJCQl9CgkJCX0pOwoJCQoJCX0KCQkKCX0KCQoJCglmdW5jdGlvbiByZXNldFNjcm9sbCgpIHsKCQl2YXIgZDAgPSB6ZXJvRGF0ZSgpLAoJCQlzY3JvbGxEYXRlID0gY2xvbmVEYXRlKGQwKTsKCQlzY3JvbGxEYXRlLnNldEhvdXJzKG9wdGlvbnMuZmlyc3RIb3VyKTsKCQl2YXIgdG9wID0gdGltZVBvc2l0aW9uKGQwLCBzY3JvbGxEYXRlKSArIDEsIC8vICsxIGZvciB0aGUgYm9yZGVyCgkJCXNjcm9sbCA9IGZ1bmN0aW9uKCkgewoJCQkJYm9keS5zY3JvbGxUb3AodG9wKTsKCQkJfTsKCQlzY3JvbGwoKTsKCQlzZXRUaW1lb3V0KHNjcm9sbCwgMCk7IC8vIG92ZXJyaWRlcyBhbnkgcHJldmlvdXMgc2Nyb2xsIHN0YXRlIG1hZGUgYnkgdGhlIGJyb3dzZXIKCX0KCQoJCglmdW5jdGlvbiBzZXRIZWlnaHQoaGVpZ2h0LCBkYXRlQ2hhbmdlZCkgewoJCXZpZXdIZWlnaHQgPSBoZWlnaHQ7CgkJc2xvdFRvcENhY2hlID0ge307CgkJCgkJYm9keS5oZWlnaHQoaGVpZ2h0IC0gaGVhZC5oZWlnaHQoKSk7CgkJCgkJc2xvdEhlaWdodCA9IGJvZHkuZmluZCgndHI6Zmlyc3QgZGl2JykuaGVpZ2h0KCkgKyAxOwoJCQoJCWJnLmNzcyh7CgkJCXRvcDogaGVhZC5maW5kKCd0cicpLmhlaWdodCgpLAoJCQloZWlnaHQ6IGhlaWdodAoJCX0pOwoJCQoJCWlmIChkYXRlQ2hhbmdlZCkgewoJCQlyZXNldFNjcm9sbCgpOwoJCX0KCX0KCQoJCglmdW5jdGlvbiBzZXRXaWR0aCh3aWR0aCkgewoJCXZpZXdXaWR0aCA9IHdpZHRoOwoJCWNvbENvbnRlbnRQb3NpdGlvbnMuY2xlYXIoKTsKCQkKCQlib2R5LndpZHRoKHdpZHRoKTsKCQlib2R5VGFibGUud2lkdGgoJycpOwoJCQoJCXZhciB0b3BURHMgPSBoZWFkLmZpbmQoJ3RyOmZpcnN0IHRoJyksCgkJCXN0cmlwZVREcyA9IGJnLmZpbmQoJ3RkJyksCgkJCWNsaWVudFdpZHRoID0gYm9keVswXS5jbGllbnRXaWR0aDsKCQkJCgkJYm9keVRhYmxlLndpZHRoKGNsaWVudFdpZHRoKTsKCQkKCQkvLyB0aW1lLWF4aXMgd2lkdGgKCQlheGlzV2lkdGggPSAwOwoJCXNldE91dGVyV2lkdGgoCgkJCWhlYWQuZmluZCgndHI6bHQoMikgdGg6Zmlyc3QnKS5hZGQoYm9keS5maW5kKCd0cjpmaXJzdCB0aCcpKQoJCQkJLndpZHRoKCcnKQoJCQkJLmVhY2goZnVuY3Rpb24oKSB7CgkJCQkJYXhpc1dpZHRoID0gTWF0aC5tYXgoYXhpc1dpZHRoLCAkKHRoaXMpLm91dGVyV2lkdGgoKSk7CgkJCQl9KSwKCQkJYXhpc1dpZHRoCgkJKTsKCQkKCQkvLyBjb2x1bW4gd2lkdGgKCQljb2xXaWR0aCA9IE1hdGguZmxvb3IoKGNsaWVudFdpZHRoIC0gYXhpc1dpZHRoKSAvIGNvbENudCk7CgkJc2V0T3V0ZXJXaWR0aChzdHJpcGVURHMuc2xpY2UoMCwgLTEpLCBjb2xXaWR0aCk7CgkJc2V0T3V0ZXJXaWR0aCh0b3BURHMuc2xpY2UoMSwgLTIpLCBjb2xXaWR0aCk7CgkJc2V0T3V0ZXJXaWR0aCh0b3BURHMuc2xpY2UoLTIsIC0xKSwgY2xpZW50V2lkdGggLSBheGlzV2lkdGggLSBjb2xXaWR0aCooY29sQ250LTEpKTsKCQkKCQliZy5jc3MoewoJCQlsZWZ0OiBheGlzV2lkdGgsCgkJCXdpZHRoOiBjbGllbnRXaWR0aCAtIGF4aXNXaWR0aAoJCX0pOwoJfQoJCgkKCQoJLyogU2xvdC9EYXkgY2xpY2tpbmcgYW5kIGJpbmRpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoKCWZ1bmN0aW9uIGRheUJpbmQodGRzKSB7CgkJdGRzLmNsaWNrKHNsb3RDbGljaykKCQkJLm1vdXNlZG93bihkYXlTZWxlY3Rpb25Nb3VzZWRvd24pOwoJfQoKCglmdW5jdGlvbiBzbG90QmluZCh0ZHMpIHsKCQl0ZHMuY2xpY2soc2xvdENsaWNrKQoJCQkubW91c2Vkb3duKHNsb3RTZWxlY3Rpb25Nb3VzZWRvd24pOwoJfQoJCgkKCWZ1bmN0aW9uIHNsb3RDbGljayhldikgewoJCWlmICghdmlldy5vcHRpb24oJ3NlbGVjdGFibGUnKSkgeyAvLyBTZWxlY3Rpb25NYW5hZ2VyIHdpbGwgd29ycnkgYWJvdXQgZGF5Q2xpY2sKCQkJdmFyIGNvbCA9IE1hdGgubWluKGNvbENudC0xLCBNYXRoLmZsb29yKChldi5wYWdlWCAtIGJnLm9mZnNldCgpLmxlZnQpIC8gY29sV2lkdGgpKSwKCQkJCWRhdGUgPSBhZGREYXlzKGNsb25lRGF0ZSh2aWV3LnZpc1N0YXJ0KSwgY29sKmRpcytkaXQpLAoJCQkJcm93TWF0Y2ggPSB0aGlzLmNsYXNzTmFtZS5tYXRjaCgvZmMtc2xvdChcZCspLyk7CgkJCWlmIChyb3dNYXRjaCkgewoJCQkJdmFyIG1pbnMgPSBwYXJzZUludChyb3dNYXRjaFsxXSkgKiBvcHRpb25zLnNsb3RNaW51dGVzLAoJCQkJCWhvdXJzID0gTWF0aC5mbG9vcihtaW5zLzYwKTsKCQkJCWRhdGUuc2V0SG91cnMoaG91cnMpOwoJCQkJZGF0ZS5zZXRNaW51dGVzKG1pbnMlNjAgKyBtaW5NaW51dGUpOwoJCQkJdmlldy50cmlnZ2VyKCdkYXlDbGljaycsIHRoaXMsIGRhdGUsIGZhbHNlLCBldik7CgkJCX1lbHNlewoJCQkJdmlldy50cmlnZ2VyKCdkYXlDbGljaycsIHRoaXMsIGRhdGUsIHRydWUsIGV2KTsKCQkJfQoJCX0KCX0KCQoJCgkKCS8qIEV2ZW50IFJlbmRlcmluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCglmdW5jdGlvbiByZW5kZXJFdmVudHMoZXZlbnRzLCBtb2RpZmllZEV2ZW50SWQpIHsKCQl2aWV3LnJlcG9ydEV2ZW50cyhjYWNoZWRFdmVudHMgPSBldmVudHMpOwoJCXZhciBpLCBsZW49ZXZlbnRzLmxlbmd0aCwKCQkJZGF5RXZlbnRzPVtdLAoJCQlzbG90RXZlbnRzPVtdOwoJCWZvciAoaT0wOyBpPGxlbjsgaSsrKSB7CgkJCWlmIChldmVudHNbaV0uYWxsRGF5KSB7CgkJCQlkYXlFdmVudHMucHVzaChldmVudHNbaV0pOwoJCQl9ZWxzZXsKCQkJCXNsb3RFdmVudHMucHVzaChldmVudHNbaV0pOwoJCQl9CgkJfQoJCXJlbmRlckRheVNlZ3MoY29tcGlsZURheVNlZ3MoZGF5RXZlbnRzKSwgbW9kaWZpZWRFdmVudElkKTsKCQlyZW5kZXJTbG90U2Vncyhjb21waWxlU2xvdFNlZ3Moc2xvdEV2ZW50cyksIG1vZGlmaWVkRXZlbnRJZCk7Cgl9CgkKCQoJZnVuY3Rpb24gcmVyZW5kZXJFdmVudHMobW9kaWZpZWRFdmVudElkKSB7CgkJY2xlYXJFdmVudHMoKTsKCQlyZW5kZXJFdmVudHMoY2FjaGVkRXZlbnRzLCBtb2RpZmllZEV2ZW50SWQpOwoJfQoJCgkKCWZ1bmN0aW9uIGNsZWFyRXZlbnRzKCkgewoJCXZpZXcuX2NsZWFyRXZlbnRzKCk7IC8vIG9ubHkgY2xlYXJzIHRoZSBoYXNoZXMKCQlkYXlTZWdtZW50Q29udGFpbmVyLmVtcHR5KCk7CgkJc2xvdFNlZ21lbnRDb250YWluZXIuZW1wdHkoKTsKCX0KCQoJCgkKCQoJCglmdW5jdGlvbiBjb21waWxlRGF5U2VncyhldmVudHMpIHsKCQl2YXIgbGV2ZWxzID0gc3RhY2tTZWdzKHZpZXcuc2xpY2VTZWdzKGV2ZW50cywgJC5tYXAoZXZlbnRzLCBleGNsRW5kRGF5KSwgdmlldy52aXNTdGFydCwgdmlldy52aXNFbmQpKSwKCQkJaSwgbGV2ZWxDbnQ9bGV2ZWxzLmxlbmd0aCwgbGV2ZWwsCgkJCWosIHNlZywKCQkJc2Vncz1bXTsKCQlmb3IgKGk9MDsgaTxsZXZlbENudDsgaSsrKSB7CgkJCWxldmVsID0gbGV2ZWxzW2ldOwoJCQlmb3IgKGo9MDsgajxsZXZlbC5sZW5ndGg7IGorKykgewoJCQkJc2VnID0gbGV2ZWxbal07CgkJCQlzZWcucm93ID0gMDsKCQkJCXNlZy5sZXZlbCA9IGk7CgkJCQlzZWdzLnB1c2goc2VnKTsKCQkJfQoJCX0KCQlyZXR1cm4gc2VnczsKCX0KCQoJCglmdW5jdGlvbiBjb21waWxlU2xvdFNlZ3MoZXZlbnRzKSB7CgkJdmFyIGQgPSBhZGRNaW51dGVzKGNsb25lRGF0ZSh2aWV3LnZpc1N0YXJ0KSwgbWluTWludXRlKSwKCQkJdmlzRXZlbnRFbmRzID0gJC5tYXAoZXZlbnRzLCBzbG90RXZlbnRFbmQpLAoJCQlpLCBjb2wsCgkJCWosIGxldmVsLAoJCQlrLCBzZWcsCgkJCXNlZ3M9W107CgkJZm9yIChpPTA7IGk8Y29sQ250OyBpKyspIHsKCQkJY29sID0gc3RhY2tTZWdzKHZpZXcuc2xpY2VTZWdzKGV2ZW50cywgdmlzRXZlbnRFbmRzLCBkLCBhZGRNaW51dGVzKGNsb25lRGF0ZShkKSwgbWF4TWludXRlLW1pbk1pbnV0ZSkpKTsKCQkJY291bnRGb3J3YXJkU2Vncyhjb2wpOwoJCQlmb3IgKGo9MDsgajxjb2wubGVuZ3RoOyBqKyspIHsKCQkJCWxldmVsID0gY29sW2pdOwoJCQkJZm9yIChrPTA7IGs8bGV2ZWwubGVuZ3RoOyBrKyspIHsKCQkJCQlzZWcgPSBsZXZlbFtrXTsKCQkJCQlzZWcuY29sID0gaTsKCQkJCQlzZWcubGV2ZWwgPSBqOwoJCQkJCXNlZ3MucHVzaChzZWcpOwoJCQkJfQoJCQl9CgkJCWFkZERheXMoZCwgMSwgdHJ1ZSk7CgkJfQoJCXJldHVybiBzZWdzOwoJfQoJCgkKCQoJCgkvLyByZW5kZXJzICdhbGwtZGF5JyBldmVudHMgYXQgdGhlIHRvcAoJCglmdW5jdGlvbiByZW5kZXJEYXlTZWdzKHNlZ3MsIG1vZGlmaWVkRXZlbnRJZCkgewoJCWlmIChvcHRpb25zLmFsbERheVNsb3QpIHsKCQkJX3JlbmRlckRheVNlZ3MoCgkJCQlzZWdzLAoJCQkJMSwKCQkJCXZpZXcsCgkJCQlheGlzV2lkdGgsCgkJCQl2aWV3V2lkdGgsCgkJCQlmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gaGVhZC5maW5kKCd0ci5mYy1hbGwtZGF5Jyk7CgkJCQl9LAoJCQkJZnVuY3Rpb24oZGF5T2ZXZWVrKSB7CgkJCQkJcmV0dXJuIGF4aXNXaWR0aCArIGNvbENvbnRlbnRQb3NpdGlvbnMubGVmdChkYXlPZldlZWtDb2woZGF5T2ZXZWVrKSk7CgkJCQl9LAoJCQkJZnVuY3Rpb24oZGF5T2ZXZWVrKSB7CgkJCQkJcmV0dXJuIGF4aXNXaWR0aCArIGNvbENvbnRlbnRQb3NpdGlvbnMucmlnaHQoZGF5T2ZXZWVrQ29sKGRheU9mV2VlaykpOwoJCQkJfSwKCQkJCWRheVNlZ21lbnRDb250YWluZXIsCgkJCQlkYXlTZWdCaW5kLAoJCQkJbW9kaWZpZWRFdmVudElkCgkJCSk7CgkJCXNldEhlaWdodCh2aWV3SGVpZ2h0KTsgLy8gbWlnaHQgaGF2ZSBwdXNoZWQgdGhlIGJvZHkgZG93biwgc28gcmVzaXplCgkJfQoJfQoJCgkKCQoJLy8gcmVuZGVycyBldmVudHMgaW4gdGhlICd0aW1lIHNsb3RzJyBhdCB0aGUgYm90dG9tCgkKCWZ1bmN0aW9uIHJlbmRlclNsb3RTZWdzKHNlZ3MsIG1vZGlmaWVkRXZlbnRJZCkgewoJCgkJdmFyIGksIHNlZ0NudD1zZWdzLmxlbmd0aCwgc2VnLAoJCQlldmVudCwKCQkJY2xhc3NOYW1lLAoJCQl0b3AsIGJvdHRvbSwKCQkJY29sSSwgbGV2ZWxJLCBmb3J3YXJkLAoJCQlsZWZ0bW9zdCwKCQkJYXZhaWxXaWR0aCwKCQkJb3V0ZXJXaWR0aCwKCQkJbGVmdCwKCQkJaHRtbD0nJywKCQkJZXZlbnRFbGVtZW50cywKCQkJZXZlbnRFbGVtZW50LAoJCQl0cmlnZ2VyUmVzLAoJCQl2c2lkZUNhY2hlPXt9LAoJCQloc2lkZUNhY2hlPXt9LAoJCQlrZXksIHZhbCwKCQkJdGl0bGVTcGFuLAoJCQloZWlnaHQ7CgkJCQoJCS8vIGNhbGN1bGF0ZSBwb3NpdGlvbi9kaW1lbnNpb25zLCBjcmVhdGUgaHRtbAoJCWZvciAoaT0wOyBpPHNlZ0NudDsgaSsrKSB7CgkJCXNlZyA9IHNlZ3NbaV07CgkJCWV2ZW50ID0gc2VnLmV2ZW50OwoJCQljbGFzc05hbWUgPSAnZmMtZXZlbnQgZmMtZXZlbnQtdmVydCAnOwoJCQlpZiAoc2VnLmlzU3RhcnQpIHsKCQkJCWNsYXNzTmFtZSArPSAnZmMtY29ybmVyLXRvcCAnOwoJCQl9CgkJCWlmIChzZWcuaXNFbmQpIHsKCQkJCWNsYXNzTmFtZSArPSAnZmMtY29ybmVyLWJvdHRvbSAnOwoJCQl9CgkJCXRvcCA9IHRpbWVQb3NpdGlvbihzZWcuc3RhcnQsIHNlZy5zdGFydCk7CgkJCWJvdHRvbSA9IHRpbWVQb3NpdGlvbihzZWcuc3RhcnQsIHNlZy5lbmQpOwoJCQljb2xJID0gc2VnLmNvbDsKCQkJbGV2ZWxJID0gc2VnLmxldmVsOwoJCQlmb3J3YXJkID0gc2VnLmZvcndhcmQgfHwgMDsKCQkJbGVmdG1vc3QgPSBheGlzV2lkdGggKyBjb2xDb250ZW50UG9zaXRpb25zLmxlZnQoY29sSSpkaXMgKyBkaXQpOwoJCQlhdmFpbFdpZHRoID0gYXhpc1dpZHRoICsgY29sQ29udGVudFBvc2l0aW9ucy5yaWdodChjb2xJKmRpcyArIGRpdCkgLSBsZWZ0bW9zdDsKCQkJYXZhaWxXaWR0aCA9IE1hdGgubWluKGF2YWlsV2lkdGgtNiwgYXZhaWxXaWR0aCouOTUpOyAvLyBUT0RPOiBtb3ZlIHRoaXMgdG8gQ1NTCgkJCWlmIChsZXZlbEkpIHsKCQkJCS8vIGluZGVudGVkIGFuZCB0aGluCgkJCQlvdXRlcldpZHRoID0gYXZhaWxXaWR0aCAvIChsZXZlbEkgKyBmb3J3YXJkICsgMSk7CgkJCX1lbHNlewoJCQkJaWYgKGZvcndhcmQpIHsKCQkJCQkvLyBtb2RlcmF0ZWx5IHdpZGUsIGFsaWduZWQgbGVmdCBzdGlsbAoJCQkJCW91dGVyV2lkdGggPSAoKGF2YWlsV2lkdGggLyAoZm9yd2FyZCArIDEpKSAtICgxMi8yKSkgKiAyOyAvLyAxMiBpcyB0aGUgcHJlZGljdGVkIHdpZHRoIG9mIHJlc2l6ZXIgPQoJCQkJfWVsc2V7CgkJCQkJLy8gY2FuIGJlIGVudGlyZSB3aWR0aCwgYWxpZ25lZCBsZWZ0CgkJCQkJb3V0ZXJXaWR0aCA9IGF2YWlsV2lkdGg7CgkJCQl9CgkJCX0KCQkJbGVmdCA9IGxlZnRtb3N0ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGVmdG1vc3QgcG9zc2libGUKCQkJCShhdmFpbFdpZHRoIC8gKGxldmVsSSArIGZvcndhcmQgKyAxKSAqIGxldmVsSSkgLy8gaW5kZW50YXRpb24KCQkJCSogZGlzICsgKHJ0bCA/IGF2YWlsV2lkdGggLSBvdXRlcldpZHRoIDogMCk7ICAgLy8gcnRsCgkJCXNlZy50b3AgPSB0b3A7CgkJCXNlZy5sZWZ0ID0gbGVmdDsKCQkJc2VnLm91dGVyV2lkdGggPSBvdXRlcldpZHRoOwoJCQlzZWcub3V0ZXJIZWlnaHQgPSBib3R0b20gLSB0b3A7CgkJCWh0bWwgKz0gc2xvdFNlZ0h0bWwoZXZlbnQsIHNlZywgY2xhc3NOYW1lKTsKCQl9CgkJc2xvdFNlZ21lbnRDb250YWluZXJbMF0uaW5uZXJIVE1MID0gaHRtbDsgLy8gZmFzdGVyIHRoYW4gaHRtbCgpCgkJZXZlbnRFbGVtZW50cyA9IHNsb3RTZWdtZW50Q29udGFpbmVyLmNoaWxkcmVuKCk7CgkJCgkJLy8gcmV0cmlldmUgZWxlbWVudHMsIHJ1biB0aHJvdWdoIGV2ZW50UmVuZGVyIGNhbGxiYWNrLCBiaW5kIGV2ZW50IGhhbmRsZXJzCgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJZXZlbnQgPSBzZWcuZXZlbnQ7CgkJCWV2ZW50RWxlbWVudCA9ICQoZXZlbnRFbGVtZW50c1tpXSk7IC8vIGZhc3RlciB0aGFuIGVxKCkKCQkJdHJpZ2dlclJlcyA9IHZpZXcudHJpZ2dlcignZXZlbnRSZW5kZXInLCBldmVudCwgZXZlbnQsIGV2ZW50RWxlbWVudCk7CgkJCWlmICh0cmlnZ2VyUmVzID09PSBmYWxzZSkgewoJCQkJZXZlbnRFbGVtZW50LnJlbW92ZSgpOwoJCQl9ZWxzZXsKCQkJCWlmICh0cmlnZ2VyUmVzICYmIHRyaWdnZXJSZXMgIT09IHRydWUpIHsKCQkJCQlldmVudEVsZW1lbnQucmVtb3ZlKCk7CgkJCQkJZXZlbnRFbGVtZW50ID0gJCh0cmlnZ2VyUmVzKQoJCQkJCQkuY3NzKHsKCQkJCQkJCXBvc2l0aW9uOiAnYWJzb2x1dGUnLAoJCQkJCQkJdG9wOiBzZWcudG9wLAoJCQkJCQkJbGVmdDogc2VnLmxlZnQKCQkJCQkJfSkKCQkJCQkJLmFwcGVuZFRvKHNsb3RTZWdtZW50Q29udGFpbmVyKTsKCQkJCX0KCQkJCXNlZy5lbGVtZW50ID0gZXZlbnRFbGVtZW50OwoJCQkJaWYgKGV2ZW50Ll9pZCA9PT0gbW9kaWZpZWRFdmVudElkKSB7CgkJCQkJc2xvdFNlZ0JpbmQoZXZlbnQsIGV2ZW50RWxlbWVudCwgc2VnKTsKCQkJCX1lbHNlewoJCQkJCWV2ZW50RWxlbWVudFswXS5fZmNpID0gaTsgLy8gZm9yIGxhenlTZWdCaW5kCgkJCQl9CgkJCQl2aWV3LnJlcG9ydEV2ZW50RWxlbWVudChldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJfQoJCX0KCQkKCQlsYXp5U2VnQmluZChzbG90U2VnbWVudENvbnRhaW5lciwgc2Vncywgc2xvdFNlZ0JpbmQpOwoJCQoJCS8vIHJlY29yZCBldmVudCBzaWRlcyBhbmQgdGl0bGUgcG9zaXRpb25zCgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJaWYgKGV2ZW50RWxlbWVudCA9IHNlZy5lbGVtZW50KSB7CgkJCQl2YWwgPSB2c2lkZUNhY2hlW2tleSA9IHNlZy5rZXkgPSBjc3NLZXkoZXZlbnRFbGVtZW50WzBdKV07CgkJCQlzZWcudnNpZGVzID0gdmFsID09PSB1bmRlZmluZWQgPyAodnNpZGVDYWNoZVtrZXldID0gdnNpZGVzKGV2ZW50RWxlbWVudFswXSwgdHJ1ZSkpIDogdmFsOwoJCQkJdmFsID0gaHNpZGVDYWNoZVtrZXldOwoJCQkJc2VnLmhzaWRlcyA9IHZhbCA9PT0gdW5kZWZpbmVkID8gKGhzaWRlQ2FjaGVba2V5XSA9IGhzaWRlcyhldmVudEVsZW1lbnRbMF0sIHRydWUpKSA6IHZhbDsKCQkJCXRpdGxlU3BhbiA9IGV2ZW50RWxlbWVudC5maW5kKCdzcGFuLmZjLWV2ZW50LXRpdGxlJyk7CgkJCQlpZiAodGl0bGVTcGFuLmxlbmd0aCkgewoJCQkJCXNlZy50aXRsZVRvcCA9IHRpdGxlU3BhblswXS5vZmZzZXRUb3A7CgkJCQl9CgkJCX0KCQl9CgkJCgkJLy8gc2V0IGFsbCBwb3NpdGlvbnMvZGltZW5zaW9ucyBhdCBvbmNlCgkJZm9yIChpPTA7IGk8c2VnQ250OyBpKyspIHsKCQkJc2VnID0gc2Vnc1tpXTsKCQkJaWYgKGV2ZW50RWxlbWVudCA9IHNlZy5lbGVtZW50KSB7CgkJCQlldmVudEVsZW1lbnRbMF0uc3R5bGUud2lkdGggPSBzZWcub3V0ZXJXaWR0aCAtIHNlZy5oc2lkZXMgKyAncHgnOwoJCQkJZXZlbnRFbGVtZW50WzBdLnN0eWxlLmhlaWdodCA9IChoZWlnaHQgPSBzZWcub3V0ZXJIZWlnaHQgLSBzZWcudnNpZGVzKSArICdweCc7CgkJCQlldmVudCA9IHNlZy5ldmVudDsKCQkJCWlmIChzZWcudGl0bGVUb3AgIT09IHVuZGVmaW5lZCAmJiBoZWlnaHQgLSBzZWcudGl0bGVUb3AgPCAxMCkgewoJCQkJCS8vIG5vdCBlbm91Z2ggcm9vbSBmb3IgdGl0bGUsIHB1dCBpdCBpbiB0aGUgdGltZSBoZWFkZXIKCQkJCQlldmVudEVsZW1lbnQuZmluZCgnc3Bhbi5mYy1ldmVudC10aW1lJykKCQkJCQkJLnRleHQoZm9ybWF0RGF0ZShldmVudC5zdGFydCwgdmlldy5vcHRpb24oJ3RpbWVGb3JtYXQnKSkgKyAnIC0gJyArIGV2ZW50LnRpdGxlKTsKCQkJCQlldmVudEVsZW1lbnQuZmluZCgnc3Bhbi5mYy1ldmVudC10aXRsZScpCgkJCQkJCS5yZW1vdmUoKTsKCQkJCX0KCQkJCXZpZXcudHJpZ2dlcignZXZlbnRBZnRlclJlbmRlcicsIGV2ZW50LCBldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJfQoJCX0KCQkJCQkKCX0KCQoJZnVuY3Rpb24gc2xvdFNlZ0h0bWwoZXZlbnQsIHNlZywgY2xhc3NOYW1lKSB7CgkJcmV0dXJuICI8ZGl2IGNsYXNzPSciICsgY2xhc3NOYW1lICsgZXZlbnQuY2xhc3NOYW1lLmpvaW4oJyAnKSArICInIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4Ojg7dG9wOiIgKyBzZWcudG9wICsgInB4O2xlZnQ6IiArIHNlZy5sZWZ0ICsgInB4Jz4iICsKCQkJIjxhIiArIChldmVudC51cmwgPyAiIGhyZWY9JyIgKyBodG1sRXNjYXBlKGV2ZW50LnVybCkgKyAiJyIgOiAnJykgKyAiPiIgKwoJCQkJIjxzcGFuIGNsYXNzPSdmYy1ldmVudC1iZyc+PC9zcGFuPiIgKwoJCQkJIjxzcGFuIGNsYXNzPSdmYy1ldmVudC10aW1lJz4iICsgaHRtbEVzY2FwZShmb3JtYXREYXRlcyhldmVudC5zdGFydCwgZXZlbnQuZW5kLCB2aWV3Lm9wdGlvbigndGltZUZvcm1hdCcpKSkgKyAiPC9zcGFuPiIgKwoJCQkJIjxzcGFuIGNsYXNzPSdmYy1ldmVudC10aXRsZSc+IiArIGh0bWxFc2NhcGUoZXZlbnQudGl0bGUpICsgIjwvc3Bhbj4iICsKCQkJIjwvYT4iICsKCQkJKChldmVudC5lZGl0YWJsZSB8fCBldmVudC5lZGl0YWJsZSA9PT0gdW5kZWZpbmVkICYmIG9wdGlvbnMuZWRpdGFibGUpICYmICFvcHRpb25zLmRpc2FibGVSZXNpemluZyAmJiAkLmZuLnJlc2l6YWJsZSA/CgkJCQkiPGRpdiBjbGFzcz0ndWktcmVzaXphYmxlLWhhbmRsZSB1aS1yZXNpemFibGUtcyc+PTwvZGl2PiIKCQkJCTogJycpICsKCQkiPC9kaXY+IjsKCX0KCQoJCgkKCWZ1bmN0aW9uIGRheVNlZ0JpbmQoZXZlbnQsIGV2ZW50RWxlbWVudCwgc2VnKSB7CgkJdmlldy5ldmVudEVsZW1lbnRIYW5kbGVycyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQlpZiAoZXZlbnQuZWRpdGFibGUgfHwgZXZlbnQuZWRpdGFibGUgPT09IHVuZGVmaW5lZCAmJiBvcHRpb25zLmVkaXRhYmxlKSB7CgkJCWRyYWdnYWJsZURheUV2ZW50KGV2ZW50LCBldmVudEVsZW1lbnQsIHNlZy5pc1N0YXJ0KTsKCQkJaWYgKHNlZy5pc0VuZCkgewoJCQkJdmlldy5yZXNpemFibGVEYXlFdmVudChldmVudCwgZXZlbnRFbGVtZW50LCBjb2xXaWR0aCk7CgkJCX0KCQl9Cgl9CgkKCQoJCglmdW5jdGlvbiBzbG90U2VnQmluZChldmVudCwgZXZlbnRFbGVtZW50LCBzZWcpIHsKCQl2aWV3LmV2ZW50RWxlbWVudEhhbmRsZXJzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCWlmIChldmVudC5lZGl0YWJsZSB8fCBldmVudC5lZGl0YWJsZSA9PT0gdW5kZWZpbmVkICYmIG9wdGlvbnMuZWRpdGFibGUpIHsKCQkJdmFyIHRpbWVFbGVtZW50ID0gZXZlbnRFbGVtZW50LmZpbmQoJ3NwYW4uZmMtZXZlbnQtdGltZScpOwoJCQlkcmFnZ2FibGVTbG90RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgdGltZUVsZW1lbnQpOwoJCQlpZiAoc2VnLmlzRW5kKSB7CgkJCQlyZXNpemFibGVTbG90RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgdGltZUVsZW1lbnQpOwoJCQl9CgkJfQoJfQoKCQoJCgkKCS8qIEV2ZW50IERyYWdnaW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCQoJCgkvLyB3aGVuIGV2ZW50IHN0YXJ0cyBvdXQgRlVMTC1EQVkKCQoJZnVuY3Rpb24gZHJhZ2dhYmxlRGF5RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgaXNTdGFydCkgewoJCWlmICghb3B0aW9ucy5kaXNhYmxlRHJhZ2dpbmcgJiYgZXZlbnRFbGVtZW50LmRyYWdnYWJsZSkgewoJCQl2YXIgb3JpZ1dpZHRoOwoJCQl2YXIgYWxsRGF5PXRydWU7CgkJCXZhciBkYXlEZWx0YTsKCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSh7CgkJCQl6SW5kZXg6IDksCgkJCQlvcGFjaXR5OiB2aWV3Lm9wdGlvbignZHJhZ09wYWNpdHknLCAnbW9udGgnKSwgLy8gdXNlIHdoYXRldmVyIHRoZSBtb250aCB2aWV3IHdhcyB1c2luZwoJCQkJcmV2ZXJ0RHVyYXRpb246IG9wdGlvbnMuZHJhZ1JldmVydER1cmF0aW9uLAoJCQkJc3RhcnQ6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCXZpZXcudHJpZ2dlcignZXZlbnREcmFnU3RhcnQnLCBldmVudEVsZW1lbnQsIGV2ZW50LCBldiwgdWkpOwoJCQkJCXZpZXcuaGlkZUV2ZW50cyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJCQlvcmlnV2lkdGggPSBldmVudEVsZW1lbnQud2lkdGgoKTsKCQkJCQlob3Zlckxpc3RlbmVyLnN0YXJ0KGZ1bmN0aW9uKGNlbGwsIG9yaWdDZWxsLCByb3dEZWx0YSwgY29sRGVsdGEpIHsKCQkJCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSgnb3B0aW9uJywgJ3JldmVydCcsICFjZWxsIHx8ICFyb3dEZWx0YSAmJiAhY29sRGVsdGEpOwoJCQkJCQljbGVhck92ZXJsYXkoKTsKCQkJCQkJaWYgKGNlbGwpIHsKCQkJCQkJCWRheURlbHRhID0gY29sRGVsdGEgKiBkaXM7CgkJCQkJCQlpZiAoIWNlbGwucm93KSB7CgkJCQkJCQkJLy8gb24gZnVsbC1kYXlzCgkJCQkJCQkJcmVuZGVyRGF5T3ZlcmxheSgKCQkJCQkJCQkJYWRkRGF5cyhjbG9uZURhdGUoZXZlbnQuc3RhcnQpLCBkYXlEZWx0YSksCgkJCQkJCQkJCWFkZERheXMoZXhjbEVuZERheShldmVudCksIGRheURlbHRhKQoJCQkJCQkJCSk7CgkJCQkJCQkJcmVzZXRFbGVtZW50KCk7CgkJCQkJCQl9ZWxzZXsKCQkJCQkJCQkvLyBtb3VzZSBpcyBvdmVyIGJvdHRvbSBzbG90cwoJCQkJCQkJCWlmIChpc1N0YXJ0ICYmIGFsbERheSkgewoJCQkJCQkJCQkvLyBjb252ZXJ0IGV2ZW50IHRvIHRlbXBvcmFyeSBzbG90LWV2ZW50CgkJCQkJCQkJCXNldE91dGVySGVpZ2h0KAoJCQkJCQkJCQkJZXZlbnRFbGVtZW50LndpZHRoKGNvbFdpZHRoIC0gMTApLCAvLyBkb24ndCB1c2UgZW50aXJlIHdpZHRoCgkJCQkJCQkJCQlzbG90SGVpZ2h0ICogTWF0aC5yb3VuZCgKCQkJCQkJCQkJCQkoZXZlbnQuZW5kID8gKChldmVudC5lbmQgLSBldmVudC5zdGFydCkgLyBNSU5VVEVfTVMpIDogb3B0aW9ucy5kZWZhdWx0RXZlbnRNaW51dGVzKQoJCQkJCQkJCQkJCS8gb3B0aW9ucy5zbG90TWludXRlcwoJCQkJCQkJCQkJKQoJCQkJCQkJCQkpOwoJCQkJCQkJCQlldmVudEVsZW1lbnQuZHJhZ2dhYmxlKCdvcHRpb24nLCAnZ3JpZCcsIFtjb2xXaWR0aCwgMV0pOwoJCQkJCQkJCQlhbGxEYXkgPSBmYWxzZTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9LCBldiwgJ2RyYWcnKTsKCQkJCX0sCgkJCQlzdG9wOiBmdW5jdGlvbihldiwgdWkpIHsKCQkJCQl2YXIgY2VsbCA9IGhvdmVyTGlzdGVuZXIuc3RvcCgpOwoJCQkJCWNsZWFyT3ZlcmxheSgpOwoJCQkJCXZpZXcudHJpZ2dlcignZXZlbnREcmFnU3RvcCcsIGV2ZW50RWxlbWVudCwgZXZlbnQsIGV2LCB1aSk7CgkJCQkJaWYgKGNlbGwgJiYgKCFhbGxEYXkgfHwgZGF5RGVsdGEpKSB7CgkJCQkJCS8vIGNoYW5nZWQhCgkJCQkJCWV2ZW50RWxlbWVudC5maW5kKCdhJykucmVtb3ZlQXR0cignaHJlZicpOyAvLyBwcmV2ZW50cyBzYWZhcmkgZnJvbSB2aXNpdGluZyB0aGUgbGluawoJCQkJCQl2YXIgbWludXRlRGVsdGEgPSAwOwoJCQkJCQlpZiAoIWFsbERheSkgewoJCQkJCQkJbWludXRlRGVsdGEgPSBNYXRoLnJvdW5kKChldmVudEVsZW1lbnQub2Zmc2V0KCkudG9wIC0gYm9keUNvbnRlbnQub2Zmc2V0KCkudG9wKSAvIHNsb3RIZWlnaHQpCgkJCQkJCQkJKiBvcHRpb25zLnNsb3RNaW51dGVzCgkJCQkJCQkJKyBtaW5NaW51dGUKCQkJCQkJCQktIChldmVudC5zdGFydC5nZXRIb3VycygpICogNjAgKyBldmVudC5zdGFydC5nZXRNaW51dGVzKCkpOwoJCQkJCQl9CgkJCQkJCXZpZXcuZXZlbnREcm9wKHRoaXMsIGV2ZW50LCBkYXlEZWx0YSwgbWludXRlRGVsdGEsIGFsbERheSwgZXYsIHVpKTsKCQkJCQl9ZWxzZXsKCQkJCQkJLy8gaGFzbid0IG1vdmVkIG9yIGlzIG91dCBvZiBib3VuZHMgKGRyYWdnYWJsZSBoYXMgYWxyZWFkeSByZXZlcnRlZCkKCQkJCQkJcmVzZXRFbGVtZW50KCk7CgkJCQkJCWlmICgkLmJyb3dzZXIubXNpZSkgewoJCQkJCQkJZXZlbnRFbGVtZW50LmNzcygnZmlsdGVyJywgJycpOyAvLyBjbGVhciBJRSBvcGFjaXR5IHNpZGUtZWZmZWN0cwoJCQkJCQl9CgkJCQkJCXZpZXcuc2hvd0V2ZW50cyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoJCQlmdW5jdGlvbiByZXNldEVsZW1lbnQoKSB7CgkJCQlpZiAoIWFsbERheSkgewoJCQkJCWV2ZW50RWxlbWVudAoJCQkJCQkud2lkdGgob3JpZ1dpZHRoKQoJCQkJCQkuaGVpZ2h0KCcnKQoJCQkJCQkuZHJhZ2dhYmxlKCdvcHRpb24nLCAnZ3JpZCcsIG51bGwpOwoJCQkJCWFsbERheSA9IHRydWU7CgkJCQl9CgkJCX0KCQl9Cgl9CgkKCQoJCgkvLyB3aGVuIGV2ZW50IHN0YXJ0cyBvdXQgSU4gVElNRVNMT1RTCgkKCWZ1bmN0aW9uIGRyYWdnYWJsZVNsb3RFdmVudChldmVudCwgZXZlbnRFbGVtZW50LCB0aW1lRWxlbWVudCkgewoJCWlmICghb3B0aW9ucy5kaXNhYmxlRHJhZ2dpbmcgJiYgZXZlbnRFbGVtZW50LmRyYWdnYWJsZSkgewoJCQl2YXIgb3JpZ1Bvc2l0aW9uOwoJCQl2YXIgYWxsRGF5PWZhbHNlOwoJCQl2YXIgZGF5RGVsdGE7CgkJCXZhciBtaW51dGVEZWx0YTsKCQkJdmFyIHByZXZNaW51dGVEZWx0YTsKCQkJZXZlbnRFbGVtZW50LmRyYWdnYWJsZSh7CgkJCQl6SW5kZXg6IDksCgkJCQlzY3JvbGw6IGZhbHNlLAoJCQkJZ3JpZDogW2NvbFdpZHRoLCBzbG90SGVpZ2h0XSwKCQkJCWF4aXM6IGNvbENudD09MSA/ICd5JyA6IGZhbHNlLAoJCQkJb3BhY2l0eTogdmlldy5vcHRpb24oJ2RyYWdPcGFjaXR5JyksCgkJCQlyZXZlcnREdXJhdGlvbjogb3B0aW9ucy5kcmFnUmV2ZXJ0RHVyYXRpb24sCgkJCQlzdGFydDogZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJdmlldy50cmlnZ2VyKCdldmVudERyYWdTdGFydCcsIGV2ZW50RWxlbWVudCwgZXZlbnQsIGV2LCB1aSk7CgkJCQkJdmlldy5oaWRlRXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCWlmICgkLmJyb3dzZXIubXNpZSkgewoJCQkJCQlldmVudEVsZW1lbnQuZmluZCgnc3Bhbi5mYy1ldmVudC1iZycpLmhpZGUoKTsgLy8gbmVzdGVkIG9wYWNpdGllcyBtZXNzIHVwIGluIElFLCBqdXN0IGhpZGUKCQkJCQl9CgkJCQkJb3JpZ1Bvc2l0aW9uID0gZXZlbnRFbGVtZW50LnBvc2l0aW9uKCk7CgkJCQkJbWludXRlRGVsdGEgPSBwcmV2TWludXRlRGVsdGEgPSAwOwoJCQkJCWhvdmVyTGlzdGVuZXIuc3RhcnQoZnVuY3Rpb24oY2VsbCwgb3JpZ0NlbGwsIHJvd0RlbHRhLCBjb2xEZWx0YSkgewoJCQkJCQlldmVudEVsZW1lbnQuZHJhZ2dhYmxlKCdvcHRpb24nLCAncmV2ZXJ0JywgIWNlbGwpOwoJCQkJCQljbGVhck92ZXJsYXkoKTsKCQkJCQkJaWYgKGNlbGwpIHsKCQkJCQkJCWRheURlbHRhID0gY29sRGVsdGEgKiBkaXM7CgkJCQkJCQlpZiAob3B0aW9ucy5hbGxEYXlTbG90ICYmICFjZWxsLnJvdykgewoJCQkJCQkJCS8vIG92ZXIgZnVsbCBkYXlzCgkJCQkJCQkJaWYgKCFhbGxEYXkpIHsKCQkJCQkJCQkJLy8gY29udmVydCB0byB0ZW1wb3JhcnkgYWxsLWRheSBldmVudAoJCQkJCQkJCQlhbGxEYXkgPSB0cnVlOwoJCQkJCQkJCQl0aW1lRWxlbWVudC5oaWRlKCk7CgkJCQkJCQkJCWV2ZW50RWxlbWVudC5kcmFnZ2FibGUoJ29wdGlvbicsICdncmlkJywgbnVsbCk7CgkJCQkJCQkJfQoJCQkJCQkJCXJlbmRlckRheU92ZXJsYXkoCgkJCQkJCQkJCWFkZERheXMoY2xvbmVEYXRlKGV2ZW50LnN0YXJ0KSwgZGF5RGVsdGEpLAoJCQkJCQkJCQlhZGREYXlzKGV4Y2xFbmREYXkoZXZlbnQpLCBkYXlEZWx0YSkKCQkJCQkJCQkpOwoJCQkJCQkJfWVsc2V7CgkJCQkJCQkJLy8gb24gc2xvdHMKCQkJCQkJCQlyZXNldEVsZW1lbnQoKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0sIGV2LCAnZHJhZycpOwoJCQkJfSwKCQkJCWRyYWc6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCW1pbnV0ZURlbHRhID0gTWF0aC5yb3VuZCgodWkucG9zaXRpb24udG9wIC0gb3JpZ1Bvc2l0aW9uLnRvcCkgLyBzbG90SGVpZ2h0KSAqIG9wdGlvbnMuc2xvdE1pbnV0ZXM7CgkJCQkJaWYgKG1pbnV0ZURlbHRhICE9IHByZXZNaW51dGVEZWx0YSkgewoJCQkJCQlpZiAoIWFsbERheSkgewoJCQkJCQkJdXBkYXRlVGltZVRleHQobWludXRlRGVsdGEpOwoJCQkJCQl9CgkJCQkJCXByZXZNaW51dGVEZWx0YSA9IG1pbnV0ZURlbHRhOwoJCQkJCX0KCQkJCX0sCgkJCQlzdG9wOiBmdW5jdGlvbihldiwgdWkpIHsKCQkJCQl2YXIgY2VsbCA9IGhvdmVyTGlzdGVuZXIuc3RvcCgpOwoJCQkJCWNsZWFyT3ZlcmxheSgpOwoJCQkJCXZpZXcudHJpZ2dlcignZXZlbnREcmFnU3RvcCcsIGV2ZW50RWxlbWVudCwgZXZlbnQsIGV2LCB1aSk7CgkJCQkJaWYgKGNlbGwgJiYgKGRheURlbHRhIHx8IG1pbnV0ZURlbHRhIHx8IGFsbERheSkpIHsKCQkJCQkJLy8gY2hhbmdlZCEKCQkJCQkJdmlldy5ldmVudERyb3AodGhpcywgZXZlbnQsIGRheURlbHRhLCBhbGxEYXkgPyAwIDogbWludXRlRGVsdGEsIGFsbERheSwgZXYsIHVpKTsKCQkJCQl9ZWxzZXsKCQkJCQkJLy8gZWl0aGVyIG5vIGNoYW5nZSBvciBvdXQtb2YtYm91bmRzIChkcmFnZ2FibGUgaGFzIGFscmVhZHkgcmV2ZXJ0ZWQpCgkJCQkJCXJlc2V0RWxlbWVudCgpOwoJCQkJCQlldmVudEVsZW1lbnQuY3NzKG9yaWdQb3NpdGlvbik7IC8vIHNvbWV0aW1lcyBmYXN0IGRyYWdzIG1ha2UgZXZlbnQgcmV2ZXJ0IHRvIHdyb25nIHBvc2l0aW9uCgkJCQkJCXVwZGF0ZVRpbWVUZXh0KDApOwoJCQkJCQlpZiAoJC5icm93c2VyLm1zaWUpIHsKCQkJCQkJCWV2ZW50RWxlbWVudAoJCQkJCQkJCS5jc3MoJ2ZpbHRlcicsICcnKSAvLyBjbGVhciBJRSBvcGFjaXR5IHNpZGUtZWZmZWN0cwoJCQkJCQkJCS5maW5kKCdzcGFuLmZjLWV2ZW50LWJnJykKCQkJCQkJCQkJLmNzcygnZGlzcGxheScsICcnKTsgLy8gLnNob3coKSBtYWRlIGRpc3BsYXk9aW5saW5lCgkJCQkJCX0KCQkJCQkJdmlldy5zaG93RXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJCWZ1bmN0aW9uIHVwZGF0ZVRpbWVUZXh0KG1pbnV0ZURlbHRhKSB7CgkJCQl2YXIgbmV3U3RhcnQgPSBhZGRNaW51dGVzKGNsb25lRGF0ZShldmVudC5zdGFydCksIG1pbnV0ZURlbHRhKTsKCQkJCXZhciBuZXdFbmQ7CgkJCQlpZiAoZXZlbnQuZW5kKSB7CgkJCQkJbmV3RW5kID0gYWRkTWludXRlcyhjbG9uZURhdGUoZXZlbnQuZW5kKSwgbWludXRlRGVsdGEpOwoJCQkJfQoJCQkJdGltZUVsZW1lbnQudGV4dChmb3JtYXREYXRlcyhuZXdTdGFydCwgbmV3RW5kLCB2aWV3Lm9wdGlvbigndGltZUZvcm1hdCcpKSk7CgkJCX0KCQkJZnVuY3Rpb24gcmVzZXRFbGVtZW50KCkgewoJCQkJLy8gY29udmVydCBiYWNrIHRvIG9yaWdpbmFsIHNsb3QtZXZlbnQKCQkJCWlmIChhbGxEYXkpIHsKCQkJCQl0aW1lRWxlbWVudC5jc3MoJ2Rpc3BsYXknLCAnJyk7IC8vIHNob3coKSB3YXMgY2F1c2luZyBkaXNwbGF5PWlubGluZQoJCQkJCWV2ZW50RWxlbWVudC5kcmFnZ2FibGUoJ29wdGlvbicsICdncmlkJywgW2NvbFdpZHRoLCBzbG90SGVpZ2h0XSk7CgkJCQkJYWxsRGF5ID0gZmFsc2U7CgkJCQl9CgkJCX0KCQl9Cgl9CgkKCQoJCgkKCS8qIEV2ZW50IFJlc2l6aW5nCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkKCS8vIGZvciBUSU1FU0xPVCBldmVudHMKCglmdW5jdGlvbiByZXNpemFibGVTbG90RXZlbnQoZXZlbnQsIGV2ZW50RWxlbWVudCwgdGltZUVsZW1lbnQpIHsKCQlpZiAoIW9wdGlvbnMuZGlzYWJsZVJlc2l6aW5nICYmIGV2ZW50RWxlbWVudC5yZXNpemFibGUpIHsKCQkJdmFyIHNsb3REZWx0YSwgcHJldlNsb3REZWx0YTsKCQkJZXZlbnRFbGVtZW50LnJlc2l6YWJsZSh7CgkJCQloYW5kbGVzOiB7CgkJCQkJczogJ2Rpdi51aS1yZXNpemFibGUtcycKCQkJCX0sCgkJCQlncmlkOiBzbG90SGVpZ2h0LAoJCQkJc3RhcnQ6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCXNsb3REZWx0YSA9IHByZXZTbG90RGVsdGEgPSAwOwoJCQkJCXZpZXcuaGlkZUV2ZW50cyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJCQlpZiAoJC5icm93c2VyLm1zaWUgJiYgJC5icm93c2VyLnZlcnNpb24gPT0gJzYuMCcpIHsKCQkJCQkJZXZlbnRFbGVtZW50LmNzcygnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7CgkJCQkJfQoJCQkJCWV2ZW50RWxlbWVudC5jc3MoJ3otaW5kZXgnLCA5KTsKCQkJCQl2aWV3LnRyaWdnZXIoJ2V2ZW50UmVzaXplU3RhcnQnLCB0aGlzLCBldmVudCwgZXYsIHVpKTsKCQkJCX0sCgkJCQlyZXNpemU6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCS8vIGRvbid0IHJlbHkgb24gdWkuc2l6ZS5oZWlnaHQsIGRvZXNuJ3QgdGFrZSBncmlkIGludG8gYWNjb3VudAoJCQkJCXNsb3REZWx0YSA9IE1hdGgucm91bmQoKE1hdGgubWF4KHNsb3RIZWlnaHQsIGV2ZW50RWxlbWVudC5oZWlnaHQoKSkgLSB1aS5vcmlnaW5hbFNpemUuaGVpZ2h0KSAvIHNsb3RIZWlnaHQpOwoJCQkJCWlmIChzbG90RGVsdGEgIT0gcHJldlNsb3REZWx0YSkgewoJCQkJCQl0aW1lRWxlbWVudC50ZXh0KAoJCQkJCQkJZm9ybWF0RGF0ZXMoCgkJCQkJCQkJZXZlbnQuc3RhcnQsCgkJCQkJCQkJKCFzbG90RGVsdGEgJiYgIWV2ZW50LmVuZCkgPyBudWxsIDogLy8gbm8gY2hhbmdlLCBzbyBkb24ndCBkaXNwbGF5IHRpbWUgcmFuZ2UKCQkJCQkJCQkJYWRkTWludXRlcyh2aWV3LmV2ZW50RW5kKGV2ZW50KSwgb3B0aW9ucy5zbG90TWludXRlcypzbG90RGVsdGEpLAoJCQkJCQkJCXZpZXcub3B0aW9uKCd0aW1lRm9ybWF0JykKCQkJCQkJCSkKCQkJCQkJKTsKCQkJCQkJcHJldlNsb3REZWx0YSA9IHNsb3REZWx0YTsKCQkJCQl9CgkJCQl9LAoJCQkJc3RvcDogZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJdmlldy50cmlnZ2VyKCdldmVudFJlc2l6ZVN0b3AnLCB0aGlzLCBldmVudCwgZXYsIHVpKTsKCQkJCQlpZiAoc2xvdERlbHRhKSB7CgkJCQkJCXZpZXcuZXZlbnRSZXNpemUodGhpcywgZXZlbnQsIDAsIG9wdGlvbnMuc2xvdE1pbnV0ZXMqc2xvdERlbHRhLCBldiwgdWkpOwoJCQkJCX1lbHNlewoJCQkJCQlldmVudEVsZW1lbnQuY3NzKCd6LWluZGV4JywgOCk7CgkJCQkJCXZpZXcuc2hvd0V2ZW50cyhldmVudCwgZXZlbnRFbGVtZW50KTsKCQkJCQkJLy8gQlVHOiBpZiBldmVudCB3YXMgcmVhbGx5IHNob3J0LCBuZWVkIHRvIHB1dCB0aXRsZSBiYWNrIGluIHNwYW4KCQkJCQl9CgkJCQl9CgkJCX0pOwoJCX0KCX0KCQoJCgkKCQoJLyogQ29vcmRpbmF0ZSBVdGlsaXRpZXMKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJdmFyIGNvb3JkaW5hdGVHcmlkID0gbmV3IENvb3JkaW5hdGVHcmlkKGZ1bmN0aW9uKHJvd3MsIGNvbHMpIHsKCQl2YXIgZSwgbiwgcDsKCQliZy5maW5kKCd0ZCcpLmVhY2goZnVuY3Rpb24oaSwgX2UpIHsKCQkJZSA9ICQoX2UpOwoJCQluID0gZS5vZmZzZXQoKS5sZWZ0OwoJCQlpZiAoaSkgewoJCQkJcFsxXSA9IG47CgkJCX0KCQkJcCA9IFtuXTsKCQkJY29sc1tpXSA9IHA7CgkJfSk7CgkJcFsxXSA9IG4gKyBlLm91dGVyV2lkdGgoKTsKCQlpZiAob3B0aW9ucy5hbGxEYXlTbG90KSB7CgkJCWUgPSBoZWFkLmZpbmQoJ3RkJyk7CgkJCW4gPSBlLm9mZnNldCgpLnRvcDsKCQkJcm93c1swXSA9IFtuLCBuK2Uub3V0ZXJIZWlnaHQoKV07CgkJfQoJCXZhciBib2R5Q29udGVudFRvcCA9IGJvZHlDb250ZW50Lm9mZnNldCgpLnRvcDsKCQl2YXIgYm9keVRvcCA9IGJvZHkub2Zmc2V0KCkudG9wOwoJCXZhciBib2R5Qm90dG9tID0gYm9keVRvcCArIGJvZHkub3V0ZXJIZWlnaHQoKTsKCQlmdW5jdGlvbiBjb25zdHJhaW4obikgewoJCQlyZXR1cm4gTWF0aC5tYXgoYm9keVRvcCwgTWF0aC5taW4oYm9keUJvdHRvbSwgbikpOwoJCX0KCQlmb3IgKHZhciBpPTA7IGk8c2xvdENudDsgaSsrKSB7CgkJCXJvd3MucHVzaChbCgkJCQljb25zdHJhaW4oYm9keUNvbnRlbnRUb3AgKyBzbG90SGVpZ2h0KmkpLAoJCQkJY29uc3RyYWluKGJvZHlDb250ZW50VG9wICsgc2xvdEhlaWdodCooaSsxKSkKCQkJXSk7CgkJfQoJfSk7CgkKCXZhciBob3Zlckxpc3RlbmVyID0gbmV3IEhvdmVyTGlzdGVuZXIoY29vcmRpbmF0ZUdyaWQpOwoJCgkvLyBnZXQgdGhlIFkgY29vcmRpbmF0ZSBvZiB0aGUgZ2l2ZW4gdGltZSBvbiB0aGUgZ2l2ZW4gZGF5IChib3RoIERhdGUgb2JqZWN0cykKCWZ1bmN0aW9uIHRpbWVQb3NpdGlvbihkYXksIHRpbWUpIHsgLy8gYm90aCBkYXRlIG9iamVjdHMuIGRheSBob2xkcyAwMDowMCBvZiBjdXJyZW50IGRheQoJCWRheSA9IGNsb25lRGF0ZShkYXksIHRydWUpOwoJCWlmICh0aW1lIDwgYWRkTWludXRlcyhjbG9uZURhdGUoZGF5KSwgbWluTWludXRlKSkgewoJCQlyZXR1cm4gMDsKCQl9CgkJaWYgKHRpbWUgPj0gYWRkTWludXRlcyhjbG9uZURhdGUoZGF5KSwgbWF4TWludXRlKSkgewoJCQlyZXR1cm4gYm9keUNvbnRlbnQuaGVpZ2h0KCk7CgkJfQoJCXZhciBzbG90TWludXRlcyA9IG9wdGlvbnMuc2xvdE1pbnV0ZXMsCgkJCW1pbnV0ZXMgPSB0aW1lLmdldEhvdXJzKCkqNjAgKyB0aW1lLmdldE1pbnV0ZXMoKSAtIG1pbk1pbnV0ZSwKCQkJc2xvdEkgPSBNYXRoLmZsb29yKG1pbnV0ZXMgLyBzbG90TWludXRlcyksCgkJCXNsb3RUb3AgPSBzbG90VG9wQ2FjaGVbc2xvdEldOwoJCWlmIChzbG90VG9wID09PSB1bmRlZmluZWQpIHsKCQkJc2xvdFRvcCA9IHNsb3RUb3BDYWNoZVtzbG90SV0gPSBib2R5LmZpbmQoJ3RyOmVxKCcgKyBzbG90SSArICcpIHRkIGRpdicpWzBdLm9mZnNldFRvcDsKCQl9CgkJcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgucm91bmQoCgkJCXNsb3RUb3AgLSAxICsgc2xvdEhlaWdodCAqICgobWludXRlcyAlIHNsb3RNaW51dGVzKSAvIHNsb3RNaW51dGVzKQoJCSkpOwoJfQoJCgkKCQoJCgkvKiBTZWxlY3RpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJdmFyIHNlbGVjdGVkID0gZmFsc2U7Cgl2YXIgZGF5U2VsZWN0aW9uTW91c2Vkb3duID0gc2VsZWN0aW9uX2RheU1vdXNlZG93bigKCQl2aWV3LCBob3Zlckxpc3RlbmVyLCBjZWxsRGF0ZSwgY2VsbElzQWxsRGF5LCByZW5kZXJEYXlPdmVybGF5LCBjbGVhck92ZXJsYXksIHJlcG9ydFNlbGVjdGlvbiwgdW5zZWxlY3QKCSk7CgkKCWZ1bmN0aW9uIHNsb3RTZWxlY3Rpb25Nb3VzZWRvd24oZXYpIHsKCQlpZiAodmlldy5vcHRpb24oJ3NlbGVjdGFibGUnKSkgewoJCQl1bnNlbGVjdChldik7CgkJCXZhciBfbW91c2Vkb3duRWxlbWVudCA9IHRoaXM7CgkJCXZhciBkYXRlczsKCQkJaG92ZXJMaXN0ZW5lci5zdGFydChmdW5jdGlvbihjZWxsLCBvcmlnQ2VsbCkgewoJCQkJY2xlYXJTZWxlY3Rpb24oKTsKCQkJCWlmIChjZWxsICYmIGNlbGwuY29sID09IG9yaWdDZWxsLmNvbCAmJiAhY2VsbElzQWxsRGF5KGNlbGwpKSB7CgkJCQkJdmFyIGQxID0gY2VsbERhdGUob3JpZ0NlbGwpOwoJCQkJCXZhciBkMiA9IGNlbGxEYXRlKGNlbGwpOwoJCQkJCWRhdGVzID0gWwoJCQkJCQlkMSwKCQkJCQkJYWRkTWludXRlcyhjbG9uZURhdGUoZDEpLCBvcHRpb25zLnNsb3RNaW51dGVzKSwKCQkJCQkJZDIsCgkJCQkJCWFkZE1pbnV0ZXMoY2xvbmVEYXRlKGQyKSwgb3B0aW9ucy5zbG90TWludXRlcykKCQkJCQldLnNvcnQoY21wKTsKCQkJCQlyZW5kZXJTbG90U2VsZWN0aW9uKGRhdGVzWzBdLCBkYXRlc1szXSk7CgkJCQl9ZWxzZXsKCQkJCQlkYXRlcyA9IG51bGw7CgkJCQl9CgkJCX0sIGV2KTsKCQkJJChkb2N1bWVudCkub25lKCdtb3VzZXVwJywgZnVuY3Rpb24oZXYpIHsKCQkJCWhvdmVyTGlzdGVuZXIuc3RvcCgpOwoJCQkJaWYgKGRhdGVzKSB7CgkJCQkJaWYgKCtkYXRlc1swXSA9PSArZGF0ZXNbMV0pIHsKCQkJCQkJdmlldy50cmlnZ2VyKCdkYXlDbGljaycsIF9tb3VzZWRvd25FbGVtZW50LCBkYXRlc1swXSwgZmFsc2UsIGV2KTsKCQkJCQkJLy8gQlVHOiBfbW91c2Vkb3duRWxlbWVudCB3aWxsIHNvbWV0aW1lcyBiZSB0aGUgb3ZlcmxheQoJCQkJCX0KCQkJCQlyZXBvcnRTZWxlY3Rpb24oZGF0ZXNbMF0sIGRhdGVzWzNdLCBmYWxzZSwgZXYpOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgkKCXZpZXcuc2VsZWN0ID0gZnVuY3Rpb24oc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXkpIHsKCQljb29yZGluYXRlR3JpZC5idWlsZCgpOwoJCXVuc2VsZWN0KCk7CgkJaWYgKGFsbERheSkgewoJCQlpZiAob3B0aW9ucy5hbGxEYXlTbG90KSB7CgkJCQlpZiAoIWVuZERhdGUpIHsKCQkJCQllbmREYXRlID0gY2xvbmVEYXRlKHN0YXJ0RGF0ZSk7CgkJCQl9CgkJCQlyZW5kZXJEYXlPdmVybGF5KHN0YXJ0RGF0ZSwgYWRkRGF5cyhjbG9uZURhdGUoZW5kRGF0ZSksIDEpKTsKCQkJfQoJCX1lbHNlewoJCQlpZiAoIWVuZERhdGUpIHsKCQkJCWVuZERhdGUgPSBhZGRNaW51dGVzKGNsb25lRGF0ZShzdGFydERhdGUpLCBvcHRpb25zLnNsb3RNaW51dGVzKTsKCQkJfQoJCQlyZW5kZXJTbG90U2VsZWN0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7CgkJfQoJCXJlcG9ydFNlbGVjdGlvbihzdGFydERhdGUsIGVuZERhdGUsIGFsbERheSk7Cgl9OwoJCglmdW5jdGlvbiByZXBvcnRTZWxlY3Rpb24oc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXksIGV2KSB7CgkJc2VsZWN0ZWQgPSB0cnVlOwoJCXZpZXcudHJpZ2dlcignc2VsZWN0Jywgdmlldywgc3RhcnREYXRlLCBlbmREYXRlLCBhbGxEYXksIGV2KTsKCX0KCQoJZnVuY3Rpb24gdW5zZWxlY3QoZXYpIHsKCQlpZiAoc2VsZWN0ZWQpIHsKCQkJY2xlYXJTZWxlY3Rpb24oKTsKCQkJc2VsZWN0ZWQgPSBmYWxzZTsKCQkJdmlldy50cmlnZ2VyKCd1bnNlbGVjdCcsIHZpZXcsIGV2KTsKCQl9Cgl9Cgl2aWV3LnVuc2VsZWN0ID0gdW5zZWxlY3Q7CgkKCXNlbGVjdGlvbl91bnNlbGVjdEF1dG8odmlldywgdW5zZWxlY3QpOwoJCgkKCQoJCgkvKiBTZWxlY3RpbmcgZHJhd2luZyB1dGlscwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoJCgl2YXIgc2VsZWN0aW9uSGVscGVyOwoJCglmdW5jdGlvbiByZW5kZXJTbG90U2VsZWN0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSkgewoJCXZhciBoZWxwZXJPcHRpb24gPSB2aWV3Lm9wdGlvbignc2VsZWN0SGVscGVyJyk7CgkJaWYgKGhlbHBlck9wdGlvbikgewoJCQl2YXIgY29sID0gZGF5RGlmZihzdGFydERhdGUsIHZpZXcudmlzU3RhcnQpICogZGlzICsgZGl0OwoJCQlpZiAoY29sID49IDAgJiYgY29sIDwgY29sQ250KSB7IC8vIG9ubHkgd29ya3Mgd2hlbiB0aW1lcyBhcmUgb24gc2FtZSBkYXkKCQkJCXZhciByZWN0ID0gY29vcmRpbmF0ZUdyaWQucmVjdCgwLCBjb2wsIDAsIGNvbCwgYm9keUNvbnRlbnQpOyAvLyBvbmx5IGZvciBob3Jpem9udGFsIGNvb3JkcwoJCQkJdmFyIHRvcCA9IHRpbWVQb3NpdGlvbihzdGFydERhdGUsIHN0YXJ0RGF0ZSk7CgkJCQl2YXIgYm90dG9tID0gdGltZVBvc2l0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7CgkJCQlpZiAoYm90dG9tID4gdG9wKSB7IC8vIHByb3RlY3QgYWdhaW5zdCBzZWxlY3Rpb25zIHRoYXQgYXJlIGVudGlyZWx5IGJlZm9yZSBvciBhZnRlciB2aXNpYmxlIHJhbmdlCgkJCQkJcmVjdC50b3AgPSB0b3A7CgkJCQkJcmVjdC5oZWlnaHQgPSBib3R0b20gLSB0b3A7CgkJCQkJcmVjdC5sZWZ0ICs9IDI7CgkJCQkJcmVjdC53aWR0aCAtPSA1OwoJCQkJCWlmICgkLmlzRnVuY3Rpb24oaGVscGVyT3B0aW9uKSkgewoJCQkJCQl2YXIgaGVscGVyUmVzID0gaGVscGVyT3B0aW9uKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7CgkJCQkJCWlmIChoZWxwZXJSZXMpIHsKCQkJCQkJCXJlY3QucG9zaXRpb24gPSAnYWJzb2x1dGUnOwoJCQkJCQkJcmVjdC56SW5kZXggPSA4OwoJCQkJCQkJc2VsZWN0aW9uSGVscGVyID0gJChoZWxwZXJSZXMpCgkJCQkJCQkJLmNzcyhyZWN0KQoJCQkJCQkJCS5hcHBlbmRUbyhib2R5Q29udGVudCk7CgkJCQkJCX0KCQkJCQl9ZWxzZXsKCQkJCQkJc2VsZWN0aW9uSGVscGVyID0gJChzbG90U2VnSHRtbCgKCQkJCQkJCXsKCQkJCQkJCQl0aXRsZTogJycsCgkJCQkJCQkJc3RhcnQ6IHN0YXJ0RGF0ZSwKCQkJCQkJCQllbmQ6IGVuZERhdGUsCgkJCQkJCQkJY2xhc3NOYW1lOiBbXSwKCQkJCQkJCQllZGl0YWJsZTogZmFsc2UKCQkJCQkJCX0sCgkJCQkJCQlyZWN0LAoJCQkJCQkJJ2ZjLWV2ZW50IGZjLWV2ZW50LXZlcnQgZmMtY29ybmVyLXRvcCBmYy1jb3JuZXItYm90dG9tICcKCQkJCQkJKSk7CgkJCQkJCWlmICgkLmJyb3dzZXIubXNpZSkgewoJCQkJCQkJc2VsZWN0aW9uSGVscGVyLmZpbmQoJ3NwYW4uZmMtZXZlbnQtYmcnKS5oaWRlKCk7IC8vIG5lc3RlZCBvcGFjaXRpZXMgbWVzcyB1cCBpbiBJRSwganVzdCBoaWRlCgkJCQkJCX0KCQkJCQkJc2VsZWN0aW9uSGVscGVyLmNzcygnb3BhY2l0eScsIHZpZXcub3B0aW9uKCdkcmFnT3BhY2l0eScpKTsKCQkJCQl9CgkJCQkJaWYgKHNlbGVjdGlvbkhlbHBlcikgewoJCQkJCQlzbG90QmluZChzZWxlY3Rpb25IZWxwZXIpOwoJCQkJCQlib2R5Q29udGVudC5hcHBlbmQoc2VsZWN0aW9uSGVscGVyKTsKCQkJCQkJc2V0T3V0ZXJXaWR0aChzZWxlY3Rpb25IZWxwZXIsIHJlY3Qud2lkdGgsIHRydWUpOyAvLyBuZWVkcyB0byBiZSBhZnRlciBhcHBlbmRlZAoJCQkJCQlzZXRPdXRlckhlaWdodChzZWxlY3Rpb25IZWxwZXIsIHJlY3QuaGVpZ2h0LCB0cnVlKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9ZWxzZXsKCQkJcmVuZGVyU2xvdE92ZXJsYXkoc3RhcnREYXRlLCBlbmREYXRlKTsKCQl9Cgl9CgkKCWZ1bmN0aW9uIGNsZWFyU2VsZWN0aW9uKCkgewoJCWNsZWFyT3ZlcmxheSgpOwoJCWlmIChzZWxlY3Rpb25IZWxwZXIpIHsKCQkJc2VsZWN0aW9uSGVscGVyLnJlbW92ZSgpOwoJCQlzZWxlY3Rpb25IZWxwZXIgPSBudWxsOwoJCX0KCX0KCQoJCgkKCQoJLyogU2VtaS10cmFuc3BhcmVudCBPdmVybGF5IEhlbHBlcnMKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCglmdW5jdGlvbiByZW5kZXJEYXlPdmVybGF5KHN0YXJ0RGF0ZSwgZW5kRGF0ZSkgewoJCXZhciBzdGFydENvbCwgZW5kQ29sOwoJCWlmIChydGwpIHsKCQkJc3RhcnRDb2wgPSBkYXlEaWZmKGVuZERhdGUsIHZpZXcudmlzU3RhcnQpKmRpcytkaXQrMTsKCQkJZW5kQ29sID0gZGF5RGlmZihzdGFydERhdGUsIHZpZXcudmlzU3RhcnQpKmRpcytkaXQrMTsKCQl9ZWxzZXsKCQkJc3RhcnRDb2wgPSBkYXlEaWZmKHN0YXJ0RGF0ZSwgdmlldy52aXNTdGFydCk7CgkJCWVuZENvbCA9IGRheURpZmYoZW5kRGF0ZSwgdmlldy52aXNTdGFydCk7CgkJfQoJCXN0YXJ0Q29sID0gTWF0aC5tYXgoMCwgc3RhcnRDb2wpOwoJCWVuZENvbCA9IE1hdGgubWluKGNvbENudCwgZW5kQ29sKTsKCQlpZiAoc3RhcnRDb2wgPCBlbmRDb2wpIHsKCQkJZGF5QmluZCgKCQkJCV9yZW5kZXJEYXlPdmVybGF5KDAsIHN0YXJ0Q29sLCAwLCBlbmRDb2wtMSkKCQkJKTsKCQl9Cgl9CgkKCWZ1bmN0aW9uIF9yZW5kZXJEYXlPdmVybGF5KGNvbDAsIHJvdzAsIGNvbDEsIHJvdzEpIHsKCQl2YXIgcmVjdCA9IGNvb3JkaW5hdGVHcmlkLnJlY3QoY29sMCwgcm93MCwgY29sMSwgcm93MSwgaGVhZCk7CgkJcmV0dXJuIHZpZXcucmVuZGVyT3ZlcmxheShyZWN0LCBoZWFkKTsKCX0KCglmdW5jdGlvbiByZW5kZXJTbG90T3ZlcmxheShvdmVybGF5U3RhcnQsIG92ZXJsYXlFbmQpIHsKCQl2YXIgZGF5U3RhcnQgPSBjbG9uZURhdGUodmlldy52aXNTdGFydCk7CgkJdmFyIGRheUVuZCA9IGFkZERheXMoY2xvbmVEYXRlKGRheVN0YXJ0KSwgMSk7CgkJZm9yICh2YXIgaT0wOyBpPGNvbENudDsgaSsrKSB7CgkJCXZhciBzdHJldGNoU3RhcnQgPSBuZXcgRGF0ZShNYXRoLm1heChkYXlTdGFydCwgb3ZlcmxheVN0YXJ0KSk7CgkJCXZhciBzdHJldGNoRW5kID0gbmV3IERhdGUoTWF0aC5taW4oZGF5RW5kLCBvdmVybGF5RW5kKSk7CgkJCWlmIChzdHJldGNoU3RhcnQgPCBzdHJldGNoRW5kKSB7CgkJCQl2YXIgY29sID0gaSpkaXMrZGl0OwoJCQkJdmFyIHJlY3QgPSBjb29yZGluYXRlR3JpZC5yZWN0KDAsIGNvbCwgMCwgY29sLCBib2R5Q29udGVudCk7IC8vIG9ubHkgdXNlIGl0IGZvciBob3Jpem9udGFsIGNvb3JkcwoJCQkJdmFyIHRvcCA9IHRpbWVQb3NpdGlvbihkYXlTdGFydCwgc3RyZXRjaFN0YXJ0KTsKCQkJCXZhciBib3R0b20gPSB0aW1lUG9zaXRpb24oZGF5U3RhcnQsIHN0cmV0Y2hFbmQpOwoJCQkJcmVjdC50b3AgPSB0b3A7CgkJCQlyZWN0LmhlaWdodCA9IGJvdHRvbSAtIHRvcDsKCQkJCXNsb3RCaW5kKAoJCQkJCXZpZXcucmVuZGVyT3ZlcmxheShyZWN0LCBib2R5Q29udGVudCkKCQkJCSk7CgkJCX0KCQkJYWRkRGF5cyhkYXlTdGFydCwgMSk7CgkJCWFkZERheXMoZGF5RW5kLCAxKTsKCQl9Cgl9CgkKCWZ1bmN0aW9uIGNsZWFyT3ZlcmxheSgpIHsKCQl2aWV3LmNsZWFyT3ZlcmxheXMoKTsKCX0KCQoJCgkKCQoJLyogRXh0ZXJuYWwgZHJhZ2dpbmcKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJdmlldy5kcmFnU3RhcnQgPSBmdW5jdGlvbihfZHJhZ0VsZW1lbnQsIGV2LCB1aSkgewoJCWhvdmVyTGlzdGVuZXIuc3RhcnQoZnVuY3Rpb24oY2VsbCkgewoJCQljbGVhck92ZXJsYXkoKTsKCQkJaWYgKGNlbGwpIHsKCQkJCWlmIChjZWxsSXNBbGxEYXkoY2VsbCkpIHsKCQkJCQlfcmVuZGVyRGF5T3ZlcmxheShjZWxsLnJvdywgY2VsbC5jb2wsIGNlbGwucm93LCBjZWxsLmNvbCk7CgkJCQl9ZWxzZXsKCQkJCQl2YXIgZDEgPSBjZWxsRGF0ZShjZWxsKTsKCQkJCQl2YXIgZDIgPSBhZGRNaW51dGVzKGNsb25lRGF0ZShkMSksIG9wdGlvbnMuZGVmYXVsdEV2ZW50TWludXRlcyk7CgkJCQkJcmVuZGVyU2xvdE92ZXJsYXkoZDEsIGQyKTsKCQkJCX0KCQkJfQoJCX0sIGV2KTsKCX07CgkKCXZpZXcuZHJhZ1N0b3AgPSBmdW5jdGlvbihfZHJhZ0VsZW1lbnQsIGV2LCB1aSkgewoJCXZhciBjZWxsID0gaG92ZXJMaXN0ZW5lci5zdG9wKCk7CgkJY2xlYXJPdmVybGF5KCk7CgkJaWYgKGNlbGwpIHsKCQkJdmlldy50cmlnZ2VyKCdkcm9wJywgX2RyYWdFbGVtZW50LCBjZWxsRGF0ZShjZWxsKSwgY2VsbElzQWxsRGF5KGNlbGwpLCBldiwgdWkpOwoJCX0KCX07CgkKCQoJCgkKCS8qIERhdGUgVXRpbGl0aWVzCgktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCQoJZnVuY3Rpb24gc2xvdEV2ZW50RW5kKGV2ZW50KSB7CgkJaWYgKGV2ZW50LmVuZCkgewoJCQlyZXR1cm4gY2xvbmVEYXRlKGV2ZW50LmVuZCk7CgkJfWVsc2V7CgkJCXJldHVybiBhZGRNaW51dGVzKGNsb25lRGF0ZShldmVudC5zdGFydCksIG9wdGlvbnMuZGVmYXVsdEV2ZW50TWludXRlcyk7CgkJfQoJfQoJCglmdW5jdGlvbiBkYXlPZldlZWtDb2woZGF5T2ZXZWVrKSB7CgkJcmV0dXJuICgoZGF5T2ZXZWVrIC0gTWF0aC5tYXgoZmlyc3REYXksbndlKStjb2xDbnQpICUgY29sQ250KSpkaXMrZGl0OwoJfQoJCglmdW5jdGlvbiBjZWxsRGF0ZShjZWxsKSB7CgkJdmFyIGQgPSBhZGREYXlzKGNsb25lRGF0ZSh2aWV3LnZpc1N0YXJ0KSwgY2VsbC5jb2wqZGlzK2RpdCk7CgkJdmFyIHNsb3RJbmRleCA9IGNlbGwucm93OwoJCWlmIChvcHRpb25zLmFsbERheVNsb3QpIHsKCQkJc2xvdEluZGV4LS07CgkJfQoJCWlmIChzbG90SW5kZXggPj0gMCkgewoJCQlhZGRNaW51dGVzKGQsIG1pbk1pbnV0ZSArIHNsb3RJbmRleCpvcHRpb25zLnNsb3RNaW51dGVzKTsKCQl9CgkJcmV0dXJuIGQ7Cgl9CgkKCWZ1bmN0aW9uIGNlbGxJc0FsbERheShjZWxsKSB7CgkJcmV0dXJuIG9wdGlvbnMuYWxsRGF5U2xvdCAmJiAhY2VsbC5yb3c7Cgl9CgkKCQoKfQoKCi8vIGNvdW50IHRoZSBudW1iZXIgb2YgY29sbGlkaW5nLCBoaWdoZXItbGV2ZWwgc2VnbWVudHMgKGZvciBldmVudCBzcXVpc2hpbmcpCgpmdW5jdGlvbiBjb3VudEZvcndhcmRTZWdzKGxldmVscykgewoJdmFyIGksIGosIGssIGxldmVsLCBzZWdGb3J3YXJkLCBzZWdCYWNrOwoJZm9yIChpPWxldmVscy5sZW5ndGgtMTsgaT4wOyBpLS0pIHsKCQlsZXZlbCA9IGxldmVsc1tpXTsKCQlmb3IgKGo9MDsgajxsZXZlbC5sZW5ndGg7IGorKykgewoJCQlzZWdGb3J3YXJkID0gbGV2ZWxbal07CgkJCWZvciAoaz0wOyBrPGxldmVsc1tpLTFdLmxlbmd0aDsgaysrKSB7CgkJCQlzZWdCYWNrID0gbGV2ZWxzW2ktMV1ba107CgkJCQlpZiAoc2Vnc0NvbGxpZGUoc2VnRm9yd2FyZCwgc2VnQmFjaykpIHsKCQkJCQlzZWdCYWNrLmZvcndhcmQgPSBNYXRoLm1heChzZWdCYWNrLmZvcndhcmR8fDAsIChzZWdGb3J3YXJkLmZvcndhcmR8fDApKzEpOwoJCQkJfQoJCQl9CgkJfQoJfQp9CgoKLyogTWV0aG9kcyAmIFV0aWxpdGllcyBmb3IgQWxsIFZpZXdzCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCnZhciB2aWV3TWV0aG9kcyA9IHsKCgkvKgoJICogT2JqZWN0cyBpbmhlcml0aW5nIHRoZXNlIG1ldGhvZHMgbXVzdCBpbXBsZW1lbnQgdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzL21ldGhvZHM6CgkgKiAtIHRpdGxlCgkgKiAtIHN0YXJ0CgkgKiAtIGVuZAoJICogLSB2aXNTdGFydAoJICogLSB2aXNFbmQKCSAqIC0gZGVmYXVsdEV2ZW50RW5kKGV2ZW50KQoJICogLSByZW5kZXIoZXZlbnRzKQoJICogLSByZXJlbmRlckV2ZW50cygpCgkgKgoJICoKCSAqIHotaW5kZXggcmVzZXJ2YXRpb25zOgoJICogMyAtIGRheS1vdmVybGF5CgkgKiA4IC0gZXZlbnRzCgkgKiA5IC0gZHJhZ2dpbmcvcmVzaXppbmcgZXZlbnRzCgkgKgoJICovCgkKCQoKCWluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHsKCQl0aGlzLmVsZW1lbnQgPSBlbGVtZW50OwoJCXRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CgkJdGhpcy5ldmVudHNCeUlEID0ge307CgkJdGhpcy5ldmVudEVsZW1lbnRzID0gW107CgkJdGhpcy5ldmVudEVsZW1lbnRzQnlJRCA9IHt9OwoJCXRoaXMudXNlZE92ZXJsYXlzID0gW107CgkJdGhpcy51bnVzZWRPdmVybGF5cyA9IFtdOwoJfSwKCQoJCgkKCS8vIHRyaWdnZXJzIGFuIGV2ZW50IGhhbmRsZXIsIGFsd2F5cyBhcHBlbmQgdmlldyBhcyBsYXN0IGFyZwoJCgl0cmlnZ2VyOiBmdW5jdGlvbihuYW1lLCB0aGlzT2JqKSB7CgkJaWYgKHRoaXMub3B0aW9uc1tuYW1lXSkgewoJCQlyZXR1cm4gdGhpcy5vcHRpb25zW25hbWVdLmFwcGx5KHRoaXNPYmogfHwgdGhpcywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKS5jb25jYXQoW3RoaXNdKSk7CgkJfQoJfSwKCQoJCgkKCS8vIHJldHVybnMgYSBEYXRlIG9iamVjdCBmb3IgYW4gZXZlbnQncyBlbmQKCQoJZXZlbnRFbmQ6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJcmV0dXJuIGV2ZW50LmVuZCA/IGNsb25lRGF0ZShldmVudC5lbmQpIDogdGhpcy5kZWZhdWx0RXZlbnRFbmQoZXZlbnQpOyAvLyBUT0RPOiBtYWtlIHN1cmUgYWx3YXlzIHVzaW5nIGNvcGllcwoJfSwKCQoJCgkKCS8vIHJlcG9ydCB3aGVuIHZpZXcgcmVjZWl2ZXMgbmV3IGV2ZW50cwoJCglyZXBvcnRFdmVudHM6IGZ1bmN0aW9uKGV2ZW50cykgeyAvLyBldmVudHMgYXJlIGFscmVhZHkgbm9ybWFsaXplZCBhdCB0aGlzIHBvaW50CgkJdmFyIGksIGxlbj1ldmVudHMubGVuZ3RoLCBldmVudCwKCQkJZXZlbnRzQnlJRCA9IHRoaXMuZXZlbnRzQnlJRCA9IHt9OwoJCWZvciAoaT0wOyBpPGxlbjsgaSsrKSB7CgkJCWV2ZW50ID0gZXZlbnRzW2ldOwoJCQlpZiAoZXZlbnRzQnlJRFtldmVudC5faWRdKSB7CgkJCQlldmVudHNCeUlEW2V2ZW50Ll9pZF0ucHVzaChldmVudCk7CgkJCX1lbHNlewoJCQkJZXZlbnRzQnlJRFtldmVudC5faWRdID0gW2V2ZW50XTsKCQkJfQoJCX0KCX0sCgkKCQoJCgkvLyByZXBvcnQgd2hlbiB2aWV3IGNyZWF0ZXMgYW4gZWxlbWVudCBmb3IgYW4gZXZlbnQKCglyZXBvcnRFdmVudEVsZW1lbnQ6IGZ1bmN0aW9uKGV2ZW50LCBlbGVtZW50KSB7CgkJdGhpcy5ldmVudEVsZW1lbnRzLnB1c2goZWxlbWVudCk7CgkJdmFyIGV2ZW50RWxlbWVudHNCeUlEID0gdGhpcy5ldmVudEVsZW1lbnRzQnlJRDsKCQlpZiAoZXZlbnRFbGVtZW50c0J5SURbZXZlbnQuX2lkXSkgewoJCQlldmVudEVsZW1lbnRzQnlJRFtldmVudC5faWRdLnB1c2goZWxlbWVudCk7CgkJfWVsc2V7CgkJCWV2ZW50RWxlbWVudHNCeUlEW2V2ZW50Ll9pZF0gPSBbZWxlbWVudF07CgkJfQoJfSwKCQoJCgkKCS8vIGV2ZW50IGVsZW1lbnQgbWFuaXB1bGF0aW9uCgkKCV9jbGVhckV2ZW50czogZnVuY3Rpb24oKSB7IC8vIG9ubHkgcmVzZXRzIGhhc2hlcwoJCXRoaXMuZXZlbnRFbGVtZW50cyA9IFtdOwoJCXRoaXMuZXZlbnRFbGVtZW50c0J5SUQgPSB7fTsKCX0sCgkKCXNob3dFdmVudHM6IGZ1bmN0aW9uKGV2ZW50LCBleGNlcHRFbGVtZW50KSB7CgkJdGhpcy5fZWVlKGV2ZW50LCBleGNlcHRFbGVtZW50LCAnc2hvdycpOwoJfSwKCQoJaGlkZUV2ZW50czogZnVuY3Rpb24oZXZlbnQsIGV4Y2VwdEVsZW1lbnQpIHsKCQl0aGlzLl9lZWUoZXZlbnQsIGV4Y2VwdEVsZW1lbnQsICdoaWRlJyk7Cgl9LAoJCglfZWVlOiBmdW5jdGlvbihldmVudCwgZXhjZXB0RWxlbWVudCwgZnVuY05hbWUpIHsgLy8gZXZlbnQtZWxlbWVudC1lYWNoCgkJdmFyIGVsZW1lbnRzID0gdGhpcy5ldmVudEVsZW1lbnRzQnlJRFtldmVudC5faWRdLAoJCQlpLCBsZW4gPSBlbGVtZW50cy5sZW5ndGg7CgkJZm9yIChpPTA7IGk8bGVuOyBpKyspIHsKCQkJaWYgKGVsZW1lbnRzW2ldWzBdICE9IGV4Y2VwdEVsZW1lbnRbMF0pIHsgLy8gQUhBSEFIQUhBSEFIQUhBSAoJCQkJZWxlbWVudHNbaV1bZnVuY05hbWVdKCk7CgkJCX0KCQl9Cgl9LAoJCgkKCQoJLy8gZXZlbnQgbW9kaWZpY2F0aW9uIHJlcG9ydGluZwoJCglldmVudERyb3A6IGZ1bmN0aW9uKGUsIGV2ZW50LCBkYXlEZWx0YSwgbWludXRlRGVsdGEsIGFsbERheSwgZXYsIHVpKSB7CgkJdmFyIHZpZXcgPSB0aGlzLAoJCQlvbGRBbGxEYXkgPSBldmVudC5hbGxEYXksCgkJCWV2ZW50SWQgPSBldmVudC5faWQ7CgkJdmlldy5tb3ZlRXZlbnRzKHZpZXcuZXZlbnRzQnlJRFtldmVudElkXSwgZGF5RGVsdGEsIG1pbnV0ZURlbHRhLCBhbGxEYXkpOwoJCXZpZXcudHJpZ2dlcignZXZlbnREcm9wJywgZSwgZXZlbnQsIGRheURlbHRhLCBtaW51dGVEZWx0YSwgYWxsRGF5LCBmdW5jdGlvbigpIHsgLy8gVE9ETzogY2hhbmdlIGRvY3MKCQkJLy8gVE9ETzogaW52ZXN0aWdhdGUgY2FzZXMgd2hlcmUgdGhpcyBpbnZlcnNlIHRlY2huaXF1ZSBtaWdodCBub3Qgd29yawoJCQl2aWV3Lm1vdmVFdmVudHModmlldy5ldmVudHNCeUlEW2V2ZW50SWRdLCAtZGF5RGVsdGEsIC1taW51dGVEZWx0YSwgb2xkQWxsRGF5KTsKCQkJdmlldy5yZXJlbmRlckV2ZW50cygpOwoJCX0sIGV2LCB1aSk7CgkJdmlldy5ldmVudHNDaGFuZ2VkID0gdHJ1ZTsKCQl2aWV3LnJlcmVuZGVyRXZlbnRzKGV2ZW50SWQpOwoJfSwKCQoJZXZlbnRSZXNpemU6IGZ1bmN0aW9uKGUsIGV2ZW50LCBkYXlEZWx0YSwgbWludXRlRGVsdGEsIGV2LCB1aSkgewoJCXZhciB2aWV3ID0gdGhpcywKCQkJZXZlbnRJZCA9IGV2ZW50Ll9pZDsKCQl2aWV3LmVsb25nYXRlRXZlbnRzKHZpZXcuZXZlbnRzQnlJRFtldmVudElkXSwgZGF5RGVsdGEsIG1pbnV0ZURlbHRhKTsKCQl2aWV3LnRyaWdnZXIoJ2V2ZW50UmVzaXplJywgZSwgZXZlbnQsIGRheURlbHRhLCBtaW51dGVEZWx0YSwgZnVuY3Rpb24oKSB7CgkJCS8vIFRPRE86IGludmVzdGlnYXRlIGNhc2VzIHdoZXJlIHRoaXMgaW52ZXJzZSB0ZWNobmlxdWUgbWlnaHQgbm90IHdvcmsKCQkJdmlldy5lbG9uZ2F0ZUV2ZW50cyh2aWV3LmV2ZW50c0J5SURbZXZlbnRJZF0sIC1kYXlEZWx0YSwgLW1pbnV0ZURlbHRhKTsKCQkJdmlldy5yZXJlbmRlckV2ZW50cygpOwoJCX0sIGV2LCB1aSk7CgkJdmlldy5ldmVudHNDaGFuZ2VkID0gdHJ1ZTsKCQl2aWV3LnJlcmVuZGVyRXZlbnRzKGV2ZW50SWQpOwoJfSwKCQoJCgkKCS8vIGV2ZW50IG1vZGlmaWNhdGlvbgoJCgltb3ZlRXZlbnRzOiBmdW5jdGlvbihldmVudHMsIGRheURlbHRhLCBtaW51dGVEZWx0YSwgYWxsRGF5KSB7CgkJbWludXRlRGVsdGEgPSBtaW51dGVEZWx0YSB8fCAwOwoJCWZvciAodmFyIGUsIGxlbj1ldmVudHMubGVuZ3RoLCBpPTA7IGk8bGVuOyBpKyspIHsKCQkJZSA9IGV2ZW50c1tpXTsKCQkJaWYgKGFsbERheSAhPT0gdW5kZWZpbmVkKSB7CgkJCQllLmFsbERheSA9IGFsbERheTsKCQkJfQoJCQlhZGRNaW51dGVzKGFkZERheXMoZS5zdGFydCwgZGF5RGVsdGEsIHRydWUpLCBtaW51dGVEZWx0YSk7CgkJCWlmIChlLmVuZCkgewoJCQkJZS5lbmQgPSBhZGRNaW51dGVzKGFkZERheXMoZS5lbmQsIGRheURlbHRhLCB0cnVlKSwgbWludXRlRGVsdGEpOwoJCQl9CgkJCW5vcm1hbGl6ZUV2ZW50KGUsIHRoaXMub3B0aW9ucyk7CgkJfQoJfSwKCQoJZWxvbmdhdGVFdmVudHM6IGZ1bmN0aW9uKGV2ZW50cywgZGF5RGVsdGEsIG1pbnV0ZURlbHRhKSB7CgkJbWludXRlRGVsdGEgPSBtaW51dGVEZWx0YSB8fCAwOwoJCWZvciAodmFyIGUsIGxlbj1ldmVudHMubGVuZ3RoLCBpPTA7IGk8bGVuOyBpKyspIHsKCQkJZSA9IGV2ZW50c1tpXTsKCQkJZS5lbmQgPSBhZGRNaW51dGVzKGFkZERheXModGhpcy5ldmVudEVuZChlKSwgZGF5RGVsdGEsIHRydWUpLCBtaW51dGVEZWx0YSk7CgkJCW5vcm1hbGl6ZUV2ZW50KGUsIHRoaXMub3B0aW9ucyk7CgkJfQoJfSwKCQoJCgkKCS8vIHNlbWktdHJhbnNwYXJlbnQgb3ZlcmxheSAod2hpbGUgZHJhZ2dpbmcgb3Igc2VsZWN0aW5nKQoJCglyZW5kZXJPdmVybGF5OiBmdW5jdGlvbihyZWN0LCBwYXJlbnQpIHsKCQl2YXIgZSA9IHRoaXMudW51c2VkT3ZlcmxheXMuc2hpZnQoKTsKCQlpZiAoIWUpIHsKCQkJZSA9ICQoIjxkaXYgY2xhc3M9J2ZjLWNlbGwtb3ZlcmxheScgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6MycvPiIpOwoJCX0KCQlpZiAoZVswXS5wYXJlbnROb2RlICE9IHBhcmVudFswXSkgewoJCQllLmFwcGVuZFRvKHBhcmVudCk7CgkJfQoJCXRoaXMudXNlZE92ZXJsYXlzLnB1c2goZS5jc3MocmVjdCkuc2hvdygpKTsKCQlyZXR1cm4gZTsKCX0sCgoJY2xlYXJPdmVybGF5czogZnVuY3Rpb24oKSB7CgkJdmFyIGU7CgkJd2hpbGUgKGUgPSB0aGlzLnVzZWRPdmVybGF5cy5zaGlmdCgpKSB7CgkJCXRoaXMudW51c2VkT3ZlcmxheXMucHVzaChlLmhpZGUoKS51bmJpbmQoKSk7CgkJfQoJfSwKCQoJCgkKCQoJLy8gY29tbW9uIGhvcml6b250YWwgZXZlbnQgcmVzaXppbmcKCglyZXNpemFibGVEYXlFdmVudDogZnVuY3Rpb24oZXZlbnQsIGV2ZW50RWxlbWVudCwgY29sV2lkdGgpIHsKCQl2YXIgdmlldyA9IHRoaXM7CgkJaWYgKCF2aWV3Lm9wdGlvbnMuZGlzYWJsZVJlc2l6aW5nICYmIGV2ZW50RWxlbWVudC5yZXNpemFibGUpIHsKCQkJZXZlbnRFbGVtZW50LnJlc2l6YWJsZSh7CgkJCQloYW5kbGVzOiB2aWV3Lm9wdGlvbnMuaXNSVEwgPyB7dzonZGl2LnVpLXJlc2l6YWJsZS13J30gOiB7ZTonZGl2LnVpLXJlc2l6YWJsZS1lJ30sCgkJCQlncmlkOiBjb2xXaWR0aCwKCQkJCW1pbldpZHRoOiBjb2xXaWR0aC8yLCAvLyBuZWVkIHRoaXMgb3IgZWxzZSBJRSB0aHJvd3MgZXJyb3JzIHdoZW4gdG9vIHNtYWxsCgkJCQljb250YWlubWVudDogdmlldy5lbGVtZW50LnBhcmVudCgpLnBhcmVudCgpLCAvLyB0aGUgbWFpbiBlbGVtZW50Li4uCgkJCQkgICAgICAgICAgICAgLy8gLi4uIGEgZml4LiB3b3VsZG4ndCBhbGxvdyBleHRlbmRpbmcgdG8gbGFzdCBjb2x1bW4gaW4gYWdlbmRhIHZpZXdzIChqcSB1aSBidWc/KQoJCQkJc3RhcnQ6IGZ1bmN0aW9uKGV2LCB1aSkgewoJCQkJCWV2ZW50RWxlbWVudC5jc3MoJ3otaW5kZXgnLCA5KTsKCQkJCQl2aWV3LmhpZGVFdmVudHMoZXZlbnQsIGV2ZW50RWxlbWVudCk7CgkJCQkJdmlldy50cmlnZ2VyKCdldmVudFJlc2l6ZVN0YXJ0JywgdGhpcywgZXZlbnQsIGV2LCB1aSk7CgkJCQl9LAoJCQkJc3RvcDogZnVuY3Rpb24oZXYsIHVpKSB7CgkJCQkJdmlldy50cmlnZ2VyKCdldmVudFJlc2l6ZVN0b3AnLCB0aGlzLCBldmVudCwgZXYsIHVpKTsKCQkJCQkvLyB1aS5zaXplLndpZHRoIHdhc24ndCB3b3JraW5nIHdpdGggZ3JpZCBjb3JyZWN0bHksIHVzZSAud2lkdGgoKQoJCQkJCXZhciBkYXlEZWx0YSA9IE1hdGgucm91bmQoKGV2ZW50RWxlbWVudC53aWR0aCgpIC0gdWkub3JpZ2luYWxTaXplLndpZHRoKSAvIGNvbFdpZHRoKTsKCQkJCQlpZiAoZGF5RGVsdGEpIHsKCQkJCQkJdmlldy5ldmVudFJlc2l6ZSh0aGlzLCBldmVudCwgZGF5RGVsdGEsIDAsIGV2LCB1aSk7CgkJCQkJfWVsc2V7CgkJCQkJCWV2ZW50RWxlbWVudC5jc3MoJ3otaW5kZXgnLCA4KTsKCQkJCQkJdmlldy5zaG93RXZlbnRzKGV2ZW50LCBldmVudEVsZW1lbnQpOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfQoJfSwKCQoJCgkKCS8vIGF0dGFjaGVzIGV2ZW50Q2xpY2ssIGV2ZW50TW91c2VvdmVyLCBldmVudE1vdXNlb3V0CgkKCWV2ZW50RWxlbWVudEhhbmRsZXJzOiBmdW5jdGlvbihldmVudCwgZXZlbnRFbGVtZW50KSB7CgkJdmFyIHZpZXcgPSB0aGlzOwoJCWV2ZW50RWxlbWVudAoJCQkuY2xpY2soZnVuY3Rpb24oZXYpIHsKCQkJCWlmICghZXZlbnRFbGVtZW50Lmhhc0NsYXNzKCd1aS1kcmFnZ2FibGUtZHJhZ2dpbmcnKSAmJgoJCQkJCSFldmVudEVsZW1lbnQuaGFzQ2xhc3MoJ3VpLXJlc2l6YWJsZS1yZXNpemluZycpKSB7CgkJCQkJCXJldHVybiB2aWV3LnRyaWdnZXIoJ2V2ZW50Q2xpY2snLCB0aGlzLCBldmVudCwgZXYpOwoJCQkJCX0KCQkJfSkKCQkJLmhvdmVyKAoJCQkJZnVuY3Rpb24oZXYpIHsKCQkJCQl2aWV3LnRyaWdnZXIoJ2V2ZW50TW91c2VvdmVyJywgdGhpcywgZXZlbnQsIGV2KTsKCQkJCX0sCgkJCQlmdW5jdGlvbihldikgewoJCQkJCXZpZXcudHJpZ2dlcignZXZlbnRNb3VzZW91dCcsIHRoaXMsIGV2ZW50LCBldik7CgkJCQl9CgkJCSk7Cgl9LAoJCgkKCQoJLy8gZ2V0IGEgcHJvcGVydHkgZnJvbSB0aGUgJ29wdGlvbnMnIG9iamVjdCwgdXNpbmcgc21hcnQgdmlldyBuYW1pbmcKCQoJb3B0aW9uOiBmdW5jdGlvbihuYW1lLCB2aWV3TmFtZSkgewoJCXZhciB2ID0gdGhpcy5vcHRpb25zW25hbWVdOwoJCWlmICh0eXBlb2YgdiA9PSAnb2JqZWN0JykgewoJCQlyZXR1cm4gc21hcnRQcm9wZXJ0eSh2LCB2aWV3TmFtZSB8fCB0aGlzLm5hbWUpOwoJCX0KCQlyZXR1cm4gdjsKCX0sCgkKCQoJCgkvLyBldmVudCByZW5kZXJpbmcgdXRpbGl0aWVzCgkKCXNsaWNlU2VnczogZnVuY3Rpb24oZXZlbnRzLCB2aXNFdmVudEVuZHMsIHN0YXJ0LCBlbmQpIHsKCQl2YXIgc2VncyA9IFtdLAoJCQlpLCBsZW49ZXZlbnRzLmxlbmd0aCwgZXZlbnQsCgkJCWV2ZW50U3RhcnQsIGV2ZW50RW5kLAoJCQlzZWdTdGFydCwgc2VnRW5kLAoJCQlpc1N0YXJ0LCBpc0VuZDsKCQlmb3IgKGk9MDsgaTxsZW47IGkrKykgewoJCQlldmVudCA9IGV2ZW50c1tpXTsKCQkJZXZlbnRTdGFydCA9IGV2ZW50LnN0YXJ0OwoJCQlldmVudEVuZCA9IHZpc0V2ZW50RW5kc1tpXTsKCQkJaWYgKGV2ZW50RW5kID4gc3RhcnQgJiYgZXZlbnRTdGFydCA8IGVuZCkgewoJCQkJaWYgKGV2ZW50U3RhcnQgPCBzdGFydCkgewoJCQkJCXNlZ1N0YXJ0ID0gY2xvbmVEYXRlKHN0YXJ0KTsKCQkJCQlpc1N0YXJ0ID0gZmFsc2U7CgkJCQl9ZWxzZXsKCQkJCQlzZWdTdGFydCA9IGV2ZW50U3RhcnQ7CgkJCQkJaXNTdGFydCA9IHRydWU7CgkJCQl9CgkJCQlpZiAoZXZlbnRFbmQgPiBlbmQpIHsKCQkJCQlzZWdFbmQgPSBjbG9uZURhdGUoZW5kKTsKCQkJCQlpc0VuZCA9IGZhbHNlOwoJCQkJfWVsc2V7CgkJCQkJc2VnRW5kID0gZXZlbnRFbmQ7CgkJCQkJaXNFbmQgPSB0cnVlOwoJCQkJfQoJCQkJc2Vncy5wdXNoKHsKCQkJCQlldmVudDogZXZlbnQsCgkJCQkJc3RhcnQ6IHNlZ1N0YXJ0LAoJCQkJCWVuZDogc2VnRW5kLAoJCQkJCWlzU3RhcnQ6IGlzU3RhcnQsCgkJCQkJaXNFbmQ6IGlzRW5kLAoJCQkJCW1zTGVuZ3RoOiBzZWdFbmQgLSBzZWdTdGFydAoJCQkJfSk7CgkJCX0KCQl9IAoJCXJldHVybiBzZWdzLnNvcnQoc2VnQ21wKTsKCX0KCQoKfTsKCgoKZnVuY3Rpb24gbGF6eVNlZ0JpbmQoY29udGFpbmVyLCBzZWdzLCBiaW5kSGFuZGxlcnMpIHsKCWNvbnRhaW5lci51bmJpbmQoJ21vdXNlb3ZlcicpLm1vdXNlb3ZlcihmdW5jdGlvbihldikgewoJCXZhciBwYXJlbnQ9ZXYudGFyZ2V0LCBlLAoJCQlpLCBzZWc7CgkJd2hpbGUgKHBhcmVudCAhPSB0aGlzKSB7CgkJCWUgPSBwYXJlbnQ7CgkJCXBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlOwoJCX0KCQlpZiAoKGkgPSBlLl9mY2kpICE9PSB1bmRlZmluZWQpIHsKCQkJZS5fZmNpID0gdW5kZWZpbmVkOwoJCQlzZWcgPSBzZWdzW2ldOwoJCQliaW5kSGFuZGxlcnMoc2VnLmV2ZW50LCBzZWcuZWxlbWVudCwgc2VnKTsKCQkJJChldi50YXJnZXQpLnRyaWdnZXIoZXYpOwoJCX0KCQlldi5zdG9wUHJvcGFnYXRpb24oKTsKCX0pOwp9CgoKCi8vIGV2ZW50IHJlbmRlcmluZyBjYWxjdWxhdGlvbiB1dGlsaXRpZXMKCmZ1bmN0aW9uIHN0YWNrU2VncyhzZWdzKSB7Cgl2YXIgbGV2ZWxzID0gW10sCgkJaSwgbGVuID0gc2Vncy5sZW5ndGgsIHNlZywKCQlqLCBjb2xsaWRlLCBrOwoJZm9yIChpPTA7IGk8bGVuOyBpKyspIHsKCQlzZWcgPSBzZWdzW2ldOwoJCWogPSAwOyAvLyB0aGUgbGV2ZWwgaW5kZXggd2hlcmUgc2VnIHNob3VsZCBiZWxvbmcKCQl3aGlsZSAodHJ1ZSkgewoJCQljb2xsaWRlID0gZmFsc2U7CgkJCWlmIChsZXZlbHNbal0pIHsKCQkJCWZvciAoaz0wOyBrPGxldmVsc1tqXS5sZW5ndGg7IGsrKykgewoJCQkJCWlmIChzZWdzQ29sbGlkZShsZXZlbHNbal1ba10sIHNlZykpIHsKCQkJCQkJY29sbGlkZSA9IHRydWU7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlpZiAoY29sbGlkZSkgewoJCQkJaisrOwoJCQl9ZWxzZXsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWlmIChsZXZlbHNbal0pIHsKCQkJbGV2ZWxzW2pdLnB1c2goc2VnKTsKCQl9ZWxzZXsKCQkJbGV2ZWxzW2pdID0gW3NlZ107CgkJfQoJfQoJcmV0dXJuIGxldmVsczsKfQoKZnVuY3Rpb24gc2VnQ21wKGEsIGIpIHsKCXJldHVybiAgKGIubXNMZW5ndGggLSBhLm1zTGVuZ3RoKSAqIDEwMCArIChhLmV2ZW50LnN0YXJ0IC0gYi5ldmVudC5zdGFydCk7Cn0KCmZ1bmN0aW9uIHNlZ3NDb2xsaWRlKHNlZzEsIHNlZzIpIHsKCXJldHVybiBzZWcxLmVuZCA+IHNlZzIuc3RhcnQgJiYgc2VnMS5zdGFydCA8IHNlZzIuZW5kOwp9CgoKCgoKZnVuY3Rpb24gc2VsZWN0aW9uX2RheU1vdXNlZG93bih2aWV3LCBob3Zlckxpc3RlbmVyLCBjZWxsRGF0ZSwgY2VsbElzQWxsRGF5LCByZW5kZXJTZWxlY3Rpb24sIGNsZWFyU2VsZWN0aW9uLCByZXBvcnRTZWxlY3Rpb24sIHVuc2VsZWN0KSB7CglyZXR1cm4gZnVuY3Rpb24oZXYpIHsKCQlpZiAodmlldy5vcHRpb24oJ3NlbGVjdGFibGUnKSkgewoJCQl1bnNlbGVjdChldik7CgkJCXZhciBfbW91c2Vkb3duRWxlbWVudCA9IHRoaXM7CgkJCXZhciBkYXRlczsKCQkJaG92ZXJMaXN0ZW5lci5zdGFydChmdW5jdGlvbihjZWxsLCBvcmlnQ2VsbCkgewoJCQkJY2xlYXJTZWxlY3Rpb24oKTsKCQkJCWlmIChjZWxsICYmIGNlbGxJc0FsbERheShjZWxsKSkgewoJCQkJCWRhdGVzID0gWyBjZWxsRGF0ZShvcmlnQ2VsbCksIGNlbGxEYXRlKGNlbGwpIF0uc29ydChjbXApOwoJCQkJCXJlbmRlclNlbGVjdGlvbihkYXRlc1swXSwgYWRkRGF5cyhjbG9uZURhdGUoZGF0ZXNbMV0pLCAxKSwgdHJ1ZSk7CgkJCQl9ZWxzZXsKCQkJCQlkYXRlcyA9IG51bGw7CgkJCQl9CgkJCX0sIGV2KTsKCQkJJChkb2N1bWVudCkub25lKCdtb3VzZXVwJywgZnVuY3Rpb24oZXYpIHsKCQkJCWhvdmVyTGlzdGVuZXIuc3RvcCgpOwoJCQkJaWYgKGRhdGVzKSB7CgkJCQkJaWYgKCtkYXRlc1swXSA9PSArZGF0ZXNbMV0pIHsKCQkJCQkJdmlldy50cmlnZ2VyKCdkYXlDbGljaycsIF9tb3VzZWRvd25FbGVtZW50LCBkYXRlc1swXSwgdHJ1ZSwgZXYpOwoJCQkJCQkvLyBCVUc6IF9tb3VzZWRvd25FbGVtZW50IHdpbGwgc29tZXRpbWVzIGJlIHRoZSBvdmVybGF5CgkJCQkJfQoJCQkJCXJlcG9ydFNlbGVjdGlvbihkYXRlc1swXSwgZGF0ZXNbMV0sIHRydWUsIGV2KTsKCQkJCX0KCQkJfSk7CgkJfQoJfQp9CgoKZnVuY3Rpb24gc2VsZWN0aW9uX3Vuc2VsZWN0QXV0byh2aWV3LCB1bnNlbGVjdCkgewoJaWYgKHZpZXcub3B0aW9uKCdzZWxlY3RhYmxlJykgJiYgdmlldy5vcHRpb24oJ3Vuc2VsZWN0QXV0bycpKSB7CgkJJChkb2N1bWVudCkubW91c2Vkb3duKGZ1bmN0aW9uKGV2KSB7CgkJCXZhciBpZ25vcmUgPSB2aWV3Lm9wdGlvbigndW5zZWxlY3RDYW5jZWwnKTsKCQkJaWYgKGlnbm9yZSkgewoJCQkJaWYgKCQoZXYudGFyZ2V0KS5wYXJlbnRzKGlnbm9yZSkubGVuZ3RoKSB7IC8vIGNvdWxkIGJlIG9wdGltaXplZCB0byBzdG9wIGFmdGVyIGZpcnN0IG1hdGNoCgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgkJCXVuc2VsZWN0KGV2KTsKCQl9KTsKCX0KfQoKLyogRGF0ZSBNYXRoCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCnZhciBEQVlfTVMgPSA4NjQwMDAwMCwKCUhPVVJfTVMgPSAzNjAwMDAwLAoJTUlOVVRFX01TID0gNjAwMDA7CgpmdW5jdGlvbiBhZGRZZWFycyhkLCBuLCBrZWVwVGltZSkgewoJZC5zZXRGdWxsWWVhcihkLmdldEZ1bGxZZWFyKCkgKyBuKTsKCWlmICgha2VlcFRpbWUpIHsKCQljbGVhclRpbWUoZCk7Cgl9CglyZXR1cm4gZDsKfQoKZnVuY3Rpb24gYWRkTW9udGhzKGQsIG4sIGtlZXBUaW1lKSB7IC8vIHByZXZlbnRzIGRheSBvdmVyZmxvdy91bmRlcmZsb3cKCWlmICgrZCkgeyAvLyBwcmV2ZW50IGluZmluaXRlIGxvb3Bpbmcgb24gaW52YWxpZCBkYXRlcwoJCXZhciBtID0gZC5nZXRNb250aCgpICsgbiwKCQkJY2hlY2sgPSBjbG9uZURhdGUoZCk7CgkJY2hlY2suc2V0RGF0ZSgxKTsKCQljaGVjay5zZXRNb250aChtKTsKCQlkLnNldE1vbnRoKG0pOwoJCWlmICgha2VlcFRpbWUpIHsKCQkJY2xlYXJUaW1lKGQpOwoJCX0KCQl3aGlsZSAoZC5nZXRNb250aCgpICE9IGNoZWNrLmdldE1vbnRoKCkpIHsKCQkJZC5zZXREYXRlKGQuZ2V0RGF0ZSgpICsgKGQgPCBjaGVjayA/IDEgOiAtMSkpOwoJCX0KCX0KCXJldHVybiBkOwp9CgpmdW5jdGlvbiBhZGREYXlzKGQsIG4sIGtlZXBUaW1lKSB7IC8vIGRlYWxzIHdpdGggZGF5bGlnaHQgc2F2aW5ncwoJaWYgKCtkKSB7CgkJdmFyIGRkID0gZC5nZXREYXRlKCkgKyBuLAoJCQljaGVjayA9IGNsb25lRGF0ZShkKTsKCQljaGVjay5zZXRIb3Vycyg5KTsgLy8gc2V0IHRvIG1pZGRsZSBvZiBkYXkKCQljaGVjay5zZXREYXRlKGRkKTsKCQlkLnNldERhdGUoZGQpOwoJCWlmICgha2VlcFRpbWUpIHsKCQkJY2xlYXJUaW1lKGQpOwoJCX0KCQlmaXhEYXRlKGQsIGNoZWNrKTsKCX0KCXJldHVybiBkOwp9CmZjLmFkZERheXMgPSBhZGREYXlzOwoKZnVuY3Rpb24gZml4RGF0ZShkLCBjaGVjaykgeyAvLyBmb3JjZSBkIHRvIGJlIG9uIGNoZWNrJ3MgWU1ELCBmb3IgZGF5bGlnaHQgc2F2aW5ncyBwdXJwb3NlcwoJaWYgKCtkKSB7IC8vIHByZXZlbnQgaW5maW5pdGUgbG9vcGluZyBvbiBpbnZhbGlkIGRhdGVzCgkJd2hpbGUgKGQuZ2V0RGF0ZSgpICE9IGNoZWNrLmdldERhdGUoKSkgewoJCQlkLnNldFRpbWUoK2QgKyAoZCA8IGNoZWNrID8gMSA6IC0xKSAqIEhPVVJfTVMpOwoJCX0KCX0KfQoKZnVuY3Rpb24gYWRkTWludXRlcyhkLCBuKSB7CglkLnNldE1pbnV0ZXMoZC5nZXRNaW51dGVzKCkgKyBuKTsKCXJldHVybiBkOwp9CgpmdW5jdGlvbiBjbGVhclRpbWUoZCkgewoJZC5zZXRIb3VycygwKTsKCWQuc2V0TWludXRlcygwKTsKCWQuc2V0U2Vjb25kcygwKTsgCglkLnNldE1pbGxpc2Vjb25kcygwKTsKCXJldHVybiBkOwp9CgpmdW5jdGlvbiBjbG9uZURhdGUoZCwgZG9udEtlZXBUaW1lKSB7CglpZiAoZG9udEtlZXBUaW1lKSB7CgkJcmV0dXJuIGNsZWFyVGltZShuZXcgRGF0ZSgrZCkpOwoJfQoJcmV0dXJuIG5ldyBEYXRlKCtkKTsKfQpmYy5jbG9uZURhdGUgPSBjbG9uZURhdGU7CgpmdW5jdGlvbiB6ZXJvRGF0ZSgpIHsgLy8gcmV0dXJucyBhIERhdGUgd2l0aCB0aW1lIDAwOjAwOjAwIGFuZCBkYXRlT2ZNb250aD0xCgl2YXIgaT0wLCBkOwoJZG8gewoJCWQgPSBuZXcgRGF0ZSgxOTcwLCBpKyssIDEpOwoJfSB3aGlsZSAoZC5nZXRIb3VycygpKTsgLy8gIT0gMAoJcmV0dXJuIGQ7Cn0KCmZ1bmN0aW9uIHNraXBXZWVrZW5kKGRhdGUsIGluYywgZXhjbCkgewoJaW5jID0gaW5jIHx8IDE7Cgl3aGlsZSAoIWRhdGUuZ2V0RGF5KCkgfHwgKGV4Y2wgJiYgZGF0ZS5nZXREYXkoKT09MSB8fCAhZXhjbCAmJiBkYXRlLmdldERheSgpPT02KSkgewoJCWFkZERheXMoZGF0ZSwgaW5jKTsKCX0KCXJldHVybiBkYXRlOwp9CgpmdW5jdGlvbiBkYXlEaWZmKGQxLCBkMikgeyAvLyBkMSAtIGQyCglyZXR1cm4gTWF0aC5yb3VuZCgoY2xvbmVEYXRlKGQxLCB0cnVlKSAtIGNsb25lRGF0ZShkMiwgdHJ1ZSkpIC8gREFZX01TKTsKfQoKZnVuY3Rpb24gc2V0WU1EKGRhdGUsIHksIG0sIGQpIHsKCWlmICh5ICE9PSB1bmRlZmluZWQgJiYgeSAhPSBkYXRlLmdldEZ1bGxZZWFyKCkpIHsKCQlkYXRlLnNldERhdGUoMSk7CgkJZGF0ZS5zZXRNb250aCgwKTsKCQlkYXRlLnNldEZ1bGxZZWFyKHkpOwoJfQoJaWYgKG0gIT09IHVuZGVmaW5lZCAmJiBtICE9IGRhdGUuZ2V0TW9udGgoKSkgewoJCWRhdGUuc2V0RGF0ZSgxKTsKCQlkYXRlLnNldE1vbnRoKG0pOwoJfQoJaWYgKGQgIT09IHVuZGVmaW5lZCkgewoJCWRhdGUuc2V0RGF0ZShkKTsKCX0KfQoKCgovKiBEYXRlIFBhcnNpbmcKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKdmFyIHBhcnNlRGF0ZSA9IGZjLnBhcnNlRGF0ZSA9IGZ1bmN0aW9uKHMpIHsKCWlmICh0eXBlb2YgcyA9PSAnb2JqZWN0JykgeyAvLyBhbHJlYWR5IGEgRGF0ZSBvYmplY3QKCQlyZXR1cm4gczsKCX0KCWlmICh0eXBlb2YgcyA9PSAnbnVtYmVyJykgeyAvLyBhIFVOSVggdGltZXN0YW1wCgkJcmV0dXJuIG5ldyBEYXRlKHMgKiAxMDAwKTsKCX0KCWlmICh0eXBlb2YgcyA9PSAnc3RyaW5nJykgewoJCWlmIChzLm1hdGNoKC9eXGQrJC8pKSB7IC8vIGEgVU5JWCB0aW1lc3RhbXAKCQkJcmV0dXJuIG5ldyBEYXRlKHBhcnNlSW50KHMpICogMTAwMCk7CgkJfQoJCXJldHVybiBwYXJzZUlTTzg2MDEocywgdHJ1ZSkgfHwgKHMgPyBuZXcgRGF0ZShzKSA6IG51bGwpOwoJfQoJLy8gVE9ETzogbmV2ZXIgcmV0dXJuIGludmFsaWQgZGF0ZXMgKGxpa2UgZnJvbSBuZXcgRGF0ZSg8c3RyaW5nPikpLCByZXR1cm4gbnVsbCBpbnN0ZWFkCglyZXR1cm4gbnVsbDsKfTsKCnZhciBwYXJzZUlTTzg2MDEgPSBmYy5wYXJzZUlTTzg2MDEgPSBmdW5jdGlvbihzLCBpZ25vcmVUaW1lem9uZSkgewoJLy8gZGVyaXZlZCBmcm9tIGh0dHA6Ly9kZWxldGUubWUudWsvMjAwNS8wMy9pc284NjAxLmh0bWwKCS8vIFRPRE86IGZvciBhIGtub3cgZ2xpdGNoL2ZlYXR1cmUsIHJlYWQgdGVzdHMvaXNzdWVfMjA2X3BhcnNlRGF0ZV9kc3QuaHRtbAoJdmFyIG0gPSBzLm1hdGNoKC9eKFswLTldezR9KSgtKFswLTldezJ9KSgtKFswLTldezJ9KShbVCBdKFswLTldezJ9KTooWzAtOV17Mn0pKDooWzAtOV17Mn0pKFwuKFswLTldKykpPyk/KFp8KChbLStdKShbMC05XXsyfSk6KFswLTldezJ9KSkpPyk/KT8pPyQvKTsKCWlmICghbSkgewoJCXJldHVybiBudWxsOwoJfQoJdmFyIGRhdGUgPSBuZXcgRGF0ZShtWzFdLCAwLCAxKSwKCQljaGVjayA9IG5ldyBEYXRlKG1bMV0sIDAsIDEsIDksIDApLAoJCW9mZnNldCA9IDA7CglpZiAobVszXSkgewoJCWRhdGUuc2V0TW9udGgobVszXSAtIDEpOwoJCWNoZWNrLnNldE1vbnRoKG1bM10gLSAxKTsKCX0KCWlmIChtWzVdKSB7CgkJZGF0ZS5zZXREYXRlKG1bNV0pOwoJCWNoZWNrLnNldERhdGUobVs1XSk7Cgl9CglmaXhEYXRlKGRhdGUsIGNoZWNrKTsKCWlmIChtWzddKSB7CgkJZGF0ZS5zZXRIb3VycyhtWzddKTsKCX0KCWlmIChtWzhdKSB7CgkJZGF0ZS5zZXRNaW51dGVzKG1bOF0pOwoJfQoJaWYgKG1bMTBdKSB7CgkJZGF0ZS5zZXRTZWNvbmRzKG1bMTBdKTsKCX0KCWlmIChtWzEyXSkgewoJCWRhdGUuc2V0TWlsbGlzZWNvbmRzKE51bWJlcigiMC4iICsgbVsxMl0pICogMTAwMCk7Cgl9CglmaXhEYXRlKGRhdGUsIGNoZWNrKTsKCWlmICghaWdub3JlVGltZXpvbmUpIHsKCQlpZiAobVsxNF0pIHsKCQkJb2Zmc2V0ID0gTnVtYmVyKG1bMTZdKSAqIDYwICsgTnVtYmVyKG1bMTddKTsKCQkJb2Zmc2V0ICo9IG1bMTVdID09ICctJyA/IDEgOiAtMTsKCQl9CgkJb2Zmc2V0IC09IGRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKTsKCX0KCXJldHVybiBuZXcgRGF0ZSgrZGF0ZSArIChvZmZzZXQgKiA2MCAqIDEwMDApKTsKfTsKCnZhciBwYXJzZVRpbWUgPSBmYy5wYXJzZVRpbWUgPSBmdW5jdGlvbihzKSB7IC8vIHJldHVybnMgbWludXRlcyBzaW5jZSBzdGFydCBvZiBkYXkKCWlmICh0eXBlb2YgcyA9PSAnbnVtYmVyJykgeyAvLyBhbiBob3VyCgkJcmV0dXJuIHMgKiA2MDsKCX0KCWlmICh0eXBlb2YgcyA9PSAnb2JqZWN0JykgeyAvLyBhIERhdGUgb2JqZWN0CgkJcmV0dXJuIHMuZ2V0SG91cnMoKSAqIDYwICsgcy5nZXRNaW51dGVzKCk7Cgl9Cgl2YXIgbSA9IHMubWF0Y2goLyhcZCspKD86OihcZCspKT9ccyooXHcrKT8vKTsKCWlmIChtKSB7CgkJdmFyIGggPSBwYXJzZUludChtWzFdKTsKCQlpZiAobVszXSkgewoJCQloICU9IDEyOwoJCQlpZiAobVszXS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKSA9PSAncCcpIHsKCQkJCWggKz0gMTI7CgkJCX0KCQl9CgkJcmV0dXJuIGggKiA2MCArIChtWzJdID8gcGFyc2VJbnQobVsyXSkgOiAwKTsKCX0KfTsKCgoKLyogRGF0ZSBGb3JtYXR0aW5nCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCnZhciBmb3JtYXREYXRlID0gZmMuZm9ybWF0RGF0ZSA9IGZ1bmN0aW9uKGRhdGUsIGZvcm1hdCwgb3B0aW9ucykgewoJcmV0dXJuIGZvcm1hdERhdGVzKGRhdGUsIG51bGwsIGZvcm1hdCwgb3B0aW9ucyk7Cn07Cgp2YXIgZm9ybWF0RGF0ZXMgPSBmYy5mb3JtYXREYXRlcyA9IGZ1bmN0aW9uKGRhdGUxLCBkYXRlMiwgZm9ybWF0LCBvcHRpb25zKSB7CglvcHRpb25zID0gb3B0aW9ucyB8fCBkZWZhdWx0czsKCXZhciBkYXRlID0gZGF0ZTEsCgkJb3RoZXJEYXRlID0gZGF0ZTIsCgkJaSwgbGVuID0gZm9ybWF0Lmxlbmd0aCwgYywKCQlpMiwgZm9ybWF0dGVyLAoJCXJlcyA9ICcnOwoJZm9yIChpPTA7IGk8bGVuOyBpKyspIHsKCQljID0gZm9ybWF0LmNoYXJBdChpKTsKCQlpZiAoYyA9PSAiJyIpIHsKCQkJZm9yIChpMj1pKzE7IGkyPGxlbjsgaTIrKykgewoJCQkJaWYgKGZvcm1hdC5jaGFyQXQoaTIpID09ICInIikgewoJCQkJCWlmIChkYXRlKSB7CgkJCQkJCWlmIChpMiA9PSBpKzEpIHsKCQkJCQkJCXJlcyArPSAiJyI7CgkJCQkJCX1lbHNlewoJCQkJCQkJcmVzICs9IGZvcm1hdC5zdWJzdHJpbmcoaSsxLCBpMik7CgkJCQkJCX0KCQkJCQkJaSA9IGkyOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCQllbHNlIGlmIChjID09ICcoJykgewoJCQlmb3IgKGkyPWkrMTsgaTI8bGVuOyBpMisrKSB7CgkJCQlpZiAoZm9ybWF0LmNoYXJBdChpMikgPT0gJyknKSB7CgkJCQkJdmFyIHN1YnJlcyA9IGZvcm1hdERhdGUoZGF0ZSwgZm9ybWF0LnN1YnN0cmluZyhpKzEsIGkyKSwgb3B0aW9ucyk7CgkJCQkJaWYgKHBhcnNlSW50KHN1YnJlcy5yZXBsYWNlKC9cRC8sICcnKSkpIHsKCQkJCQkJcmVzICs9IHN1YnJlczsKCQkJCQl9CgkJCQkJaSA9IGkyOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJCWVsc2UgaWYgKGMgPT0gJ1snKSB7CgkJCWZvciAoaTI9aSsxOyBpMjxsZW47IGkyKyspIHsKCQkJCWlmIChmb3JtYXQuY2hhckF0KGkyKSA9PSAnXScpIHsKCQkJCQl2YXIgc3ViZm9ybWF0ID0gZm9ybWF0LnN1YnN0cmluZyhpKzEsIGkyKTsKCQkJCQl2YXIgc3VicmVzID0gZm9ybWF0RGF0ZShkYXRlLCBzdWJmb3JtYXQsIG9wdGlvbnMpOwoJCQkJCWlmIChzdWJyZXMgIT0gZm9ybWF0RGF0ZShvdGhlckRhdGUsIHN1YmZvcm1hdCwgb3B0aW9ucykpIHsKCQkJCQkJcmVzICs9IHN1YnJlczsKCQkJCQl9CgkJCQkJaSA9IGkyOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJCWVsc2UgaWYgKGMgPT0gJ3snKSB7CgkJCWRhdGUgPSBkYXRlMjsKCQkJb3RoZXJEYXRlID0gZGF0ZTE7CgkJfQoJCWVsc2UgaWYgKGMgPT0gJ30nKSB7CgkJCWRhdGUgPSBkYXRlMTsKCQkJb3RoZXJEYXRlID0gZGF0ZTI7CgkJfQoJCWVsc2UgewoJCQlmb3IgKGkyPWxlbjsgaTI+aTsgaTItLSkgewoJCQkJaWYgKGZvcm1hdHRlciA9IGRhdGVGb3JtYXR0ZXJzW2Zvcm1hdC5zdWJzdHJpbmcoaSwgaTIpXSkgewoJCQkJCWlmIChkYXRlKSB7CgkJCQkJCXJlcyArPSBmb3JtYXR0ZXIoZGF0ZSwgb3B0aW9ucyk7CgkJCQkJfQoJCQkJCWkgPSBpMiAtIDE7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJaWYgKGkyID09IGkpIHsKCQkJCWlmIChkYXRlKSB7CgkJCQkJcmVzICs9IGM7CgkJCQl9CgkJCX0KCQl9Cgl9CglyZXR1cm4gcmVzOwp9OwoKdmFyIGRhdGVGb3JtYXR0ZXJzID0gewoJcwk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0U2Vjb25kcygpIH0sCglzcwk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIHplcm9QYWQoZC5nZXRTZWNvbmRzKCkpIH0sCgltCTogZnVuY3Rpb24oZCkJeyByZXR1cm4gZC5nZXRNaW51dGVzKCkgfSwKCW1tCTogZnVuY3Rpb24oZCkJeyByZXR1cm4gemVyb1BhZChkLmdldE1pbnV0ZXMoKSkgfSwKCWgJOiBmdW5jdGlvbihkKQl7IHJldHVybiBkLmdldEhvdXJzKCkgJSAxMiB8fCAxMiB9LAoJaGgJOiBmdW5jdGlvbihkKQl7IHJldHVybiB6ZXJvUGFkKGQuZ2V0SG91cnMoKSAlIDEyIHx8IDEyKSB9LAoJSAk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0SG91cnMoKSB9LAoJSEgJOiBmdW5jdGlvbihkKQl7IHJldHVybiB6ZXJvUGFkKGQuZ2V0SG91cnMoKSkgfSwKCWQJOiBmdW5jdGlvbihkKQl7IHJldHVybiBkLmdldERhdGUoKSB9LAoJZGQJOiBmdW5jdGlvbihkKQl7IHJldHVybiB6ZXJvUGFkKGQuZ2V0RGF0ZSgpKSB9LAoJZGRkCTogZnVuY3Rpb24oZCxvKQl7IHJldHVybiBvLmRheU5hbWVzU2hvcnRbZC5nZXREYXkoKV0gfSwKCWRkZGQ6IGZ1bmN0aW9uKGQsbykJeyByZXR1cm4gby5kYXlOYW1lc1tkLmdldERheSgpXSB9LAoJTQk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0TW9udGgoKSArIDEgfSwKCU1NCTogZnVuY3Rpb24oZCkJeyByZXR1cm4gemVyb1BhZChkLmdldE1vbnRoKCkgKyAxKSB9LAoJTU1NCTogZnVuY3Rpb24oZCxvKQl7IHJldHVybiBvLm1vbnRoTmFtZXNTaG9ydFtkLmdldE1vbnRoKCldIH0sCglNTU1NOiBmdW5jdGlvbihkLG8pCXsgcmV0dXJuIG8ubW9udGhOYW1lc1tkLmdldE1vbnRoKCldIH0sCgl5eQk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIChkLmdldEZ1bGxZZWFyKCkrJycpLnN1YnN0cmluZygyKSB9LAoJeXl5eTogZnVuY3Rpb24oZCkJeyByZXR1cm4gZC5nZXRGdWxsWWVhcigpIH0sCgl0CTogZnVuY3Rpb24oZCkJeyByZXR1cm4gZC5nZXRIb3VycygpIDwgMTIgPyAnYScgOiAncCcgfSwKCXR0CTogZnVuY3Rpb24oZCkJeyByZXR1cm4gZC5nZXRIb3VycygpIDwgMTIgPyAnYW0nIDogJ3BtJyB9LAoJVAk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0SG91cnMoKSA8IDEyID8gJ0EnIDogJ1AnIH0sCglUVAk6IGZ1bmN0aW9uKGQpCXsgcmV0dXJuIGQuZ2V0SG91cnMoKSA8IDEyID8gJ0FNJyA6ICdQTScgfSwKCXUJOiBmdW5jdGlvbihkKQl7IHJldHVybiBmb3JtYXREYXRlKGQsICJ5eXl5LU1NLWRkJ1QnSEg6bW06c3MnWiciKSB9LAoJUwk6IGZ1bmN0aW9uKGQpCXsKCQl2YXIgZGF0ZSA9IGQuZ2V0RGF0ZSgpOwoJCWlmIChkYXRlID4gMTAgJiYgZGF0ZSA8IDIwKSB7CgkJCXJldHVybiAndGgnOwoJCX0KCQlyZXR1cm4gWydzdCcsICduZCcsICdyZCddW2RhdGUlMTAtMV0gfHwgJ3RoJzsKCX0KfTsKCgoKLyogRWxlbWVudCBEaW1lbnNpb25zCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCmZ1bmN0aW9uIHNldE91dGVyV2lkdGgoZWxlbWVudCwgd2lkdGgsIGluY2x1ZGVNYXJnaW5zKSB7CgllbGVtZW50LmVhY2goZnVuY3Rpb24oaSwgX2VsZW1lbnQpIHsKCQlfZWxlbWVudC5zdHlsZS53aWR0aCA9IHdpZHRoIC0gaHNpZGVzKF9lbGVtZW50LCBpbmNsdWRlTWFyZ2lucykgKyAncHgnOwoJfSk7Cn0KCmZ1bmN0aW9uIHNldE91dGVySGVpZ2h0KGVsZW1lbnQsIGhlaWdodCwgaW5jbHVkZU1hcmdpbnMpIHsKCWVsZW1lbnQuZWFjaChmdW5jdGlvbihpLCBfZWxlbWVudCkgewoJCV9lbGVtZW50LnN0eWxlLmhlaWdodCA9IGhlaWdodCAtIHZzaWRlcyhfZWxlbWVudCwgaW5jbHVkZU1hcmdpbnMpICsgJ3B4JzsKCX0pOwp9CgoKZnVuY3Rpb24gaHNpZGVzKF9lbGVtZW50LCBpbmNsdWRlTWFyZ2lucykgewoJcmV0dXJuIChwYXJzZUZsb2F0KGpRdWVyeS5jdXJDU1MoX2VsZW1lbnQsICdwYWRkaW5nTGVmdCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoalF1ZXJ5LmN1ckNTUyhfZWxlbWVudCwgJ3BhZGRpbmdSaWdodCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoalF1ZXJ5LmN1ckNTUyhfZWxlbWVudCwgJ2JvcmRlckxlZnRXaWR0aCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoalF1ZXJ5LmN1ckNTUyhfZWxlbWVudCwgJ2JvcmRlclJpZ2h0V2lkdGgnLCB0cnVlKSkgfHwgMCkgKwoJICAgICAgIChpbmNsdWRlTWFyZ2lucyA/IGhtYXJnaW5zKF9lbGVtZW50KSA6IDApOwp9CgpmdW5jdGlvbiBobWFyZ2lucyhfZWxlbWVudCkgewoJcmV0dXJuIChwYXJzZUZsb2F0KGpRdWVyeS5jdXJDU1MoX2VsZW1lbnQsICdtYXJnaW5MZWZ0JywgdHJ1ZSkpIHx8IDApICsKCSAgICAgICAocGFyc2VGbG9hdChqUXVlcnkuY3VyQ1NTKF9lbGVtZW50LCAnbWFyZ2luUmlnaHQnLCB0cnVlKSkgfHwgMCk7Cn0KCmZ1bmN0aW9uIHZzaWRlcyhfZWxlbWVudCwgaW5jbHVkZU1hcmdpbnMpIHsKCXJldHVybiAocGFyc2VGbG9hdChqUXVlcnkuY3VyQ1NTKF9lbGVtZW50LCAncGFkZGluZ1RvcCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoalF1ZXJ5LmN1ckNTUyhfZWxlbWVudCwgJ3BhZGRpbmdCb3R0b20nLCB0cnVlKSkgfHwgMCkgKwoJICAgICAgIChwYXJzZUZsb2F0KGpRdWVyeS5jdXJDU1MoX2VsZW1lbnQsICdib3JkZXJUb3BXaWR0aCcsIHRydWUpKSB8fCAwKSArCgkgICAgICAgKHBhcnNlRmxvYXQoalF1ZXJ5LmN1ckNTUyhfZWxlbWVudCwgJ2JvcmRlckJvdHRvbVdpZHRoJywgdHJ1ZSkpIHx8IDApICsKCSAgICAgICAoaW5jbHVkZU1hcmdpbnMgPyB2bWFyZ2lucyhfZWxlbWVudCkgOiAwKTsKfQoKZnVuY3Rpb24gdm1hcmdpbnMoX2VsZW1lbnQpIHsKCXJldHVybiAocGFyc2VGbG9hdChqUXVlcnkuY3VyQ1NTKF9lbGVtZW50LCAnbWFyZ2luVG9wJywgdHJ1ZSkpIHx8IDApICsKCSAgICAgICAocGFyc2VGbG9hdChqUXVlcnkuY3VyQ1NTKF9lbGVtZW50LCAnbWFyZ2luQm90dG9tJywgdHJ1ZSkpIHx8IDApOwp9CgoKCgpmdW5jdGlvbiBzZXRNaW5IZWlnaHQoZWxlbWVudCwgaCkgewoJaCA9IHR5cGVvZiBoID09ICdudW1iZXInID8gaCArICdweCcgOiBoOwoJZWxlbWVudFswXS5zdHlsZS5jc3NUZXh0ICs9ICc7bWluLWhlaWdodDonICsgaCArICc7X2hlaWdodDonICsgaDsKfQoKCgovKiBQb3NpdGlvbiBDYWxjdWxhdGlvbgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCi8vIG5hc3R5IGJ1Z3MgaW4gb3BlcmEgOS4yNQovLyBwb3NpdGlvbigpJ3MgdG9wIHJldHVybmluZyBpbmNvcnJlY3RseSB3aXRoIFRSL1REIG9yIGVsZW1lbnRzIHdpdGhpbiBURAoKdmFyIHRvcEJ1ZzsKCmZ1bmN0aW9uIHRvcENvcnJlY3QodHIpIHsgLy8gdHIvdGgvdGQgb3IgYW55dGhpbmcgZWxzZQoJaWYgKHRvcEJ1ZyAhPT0gZmFsc2UpIHsKCQl2YXIgY2VsbDsKCQlpZiAodHIuaXMoJ3RoLHRkJykpIHsKCQkJdHIgPSAoY2VsbCA9IHRyKS5wYXJlbnQoKTsKCQl9CgkJaWYgKHRvcEJ1ZyA9PT0gdW5kZWZpbmVkICYmIHRyLmlzKCd0cicpKSB7CgkJCXRvcEJ1ZyA9IHRyLnBvc2l0aW9uKCkudG9wICE9IHRyLmNoaWxkcmVuKCkucG9zaXRpb24oKS50b3A7CgkJfQoJCWlmICh0b3BCdWcpIHsKCQkJcmV0dXJuIHRyLnBhcmVudCgpLnBvc2l0aW9uKCkudG9wICsgKGNlbGwgPyB0ci5wb3NpdGlvbigpLnRvcCAtIGNlbGwucG9zaXRpb24oKS50b3AgOiAwKTsKCQl9Cgl9CglyZXR1cm4gMDsKfQoKCgovKiBDb29yZGluYXRlIEdyaWQKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKZnVuY3Rpb24gQ29vcmRpbmF0ZUdyaWQoYnVpbGRGdW5jKSB7CgoJdmFyIHQgPSB0aGlzOwoJdmFyIHJvd3M7Cgl2YXIgY29sczsKCQoJdC5idWlsZCA9IGZ1bmN0aW9uKCkgewoJCXJvd3MgPSBbXTsKCQljb2xzID0gW107CgkJYnVpbGRGdW5jKHJvd3MsIGNvbHMpOwoJfTsKCQoJdC5jZWxsID0gZnVuY3Rpb24oeCwgeSkgewoJCXZhciByb3dDbnQgPSByb3dzLmxlbmd0aDsKCQl2YXIgY29sQ250ID0gY29scy5sZW5ndGg7CgkJdmFyIGksIHI9LTEsIGM9LTE7CgkJZm9yIChpPTA7IGk8cm93Q250OyBpKyspIHsKCQkJaWYgKHkgPj0gcm93c1tpXVswXSAmJiB5IDwgcm93c1tpXVsxXSkgewoJCQkJciA9IGk7CgkJCQlicmVhazsKCQkJfQoJCX0KCQlmb3IgKGk9MDsgaTxjb2xDbnQ7IGkrKykgewoJCQlpZiAoeCA+PSBjb2xzW2ldWzBdICYmIHggPCBjb2xzW2ldWzFdKSB7CgkJCQljID0gaTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCXJldHVybiAocj49MCAmJiBjPj0wKSA/IHsgcm93OnIsIGNvbDpjIH0gOiBudWxsOwoJfTsKCQoJdC5yZWN0ID0gZnVuY3Rpb24ocm93MCwgY29sMCwgcm93MSwgY29sMSwgb3JpZ2luRWxlbWVudCkgeyAvLyByb3cxLGNvbDEgaXMgaW5jbHVzaXZlCgkJdmFyIG9yaWdpbiA9IG9yaWdpbkVsZW1lbnQub2Zmc2V0KCk7CgkJcmV0dXJuIHsKCQkJdG9wOiByb3dzW3JvdzBdWzBdIC0gb3JpZ2luLnRvcCwKCQkJbGVmdDogY29sc1tjb2wwXVswXSAtIG9yaWdpbi5sZWZ0LAoJCQl3aWR0aDogY29sc1tjb2wxXVsxXSAtIGNvbHNbY29sMF1bMF0sCgkJCWhlaWdodDogcm93c1tyb3cxXVsxXSAtIHJvd3Nbcm93MF1bMF0KCQl9OwoJfTsKCn0KCgoKLyogSG92ZXIgTGlzdGVuZXIKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKZnVuY3Rpb24gSG92ZXJMaXN0ZW5lcihjb29yZGluYXRlR3JpZCkgewoKCXZhciB0ID0gdGhpczsKCXZhciBiaW5kVHlwZTsKCXZhciBjaGFuZ2U7Cgl2YXIgZmlyc3RDZWxsOwoJdmFyIGNlbGw7CgkKCXQuc3RhcnQgPSBmdW5jdGlvbihfY2hhbmdlLCBldiwgX2JpbmRUeXBlKSB7CgkJY2hhbmdlID0gX2NoYW5nZTsKCQlmaXJzdENlbGwgPSBjZWxsID0gbnVsbDsKCQljb29yZGluYXRlR3JpZC5idWlsZCgpOwoJCW1vdXNlKGV2KTsKCQliaW5kVHlwZSA9IF9iaW5kVHlwZSB8fCAnbW91c2Vtb3ZlJzsKCQkkKGRvY3VtZW50KS5iaW5kKGJpbmRUeXBlLCBtb3VzZSk7Cgl9OwoJCglmdW5jdGlvbiBtb3VzZShldikgewoJCXZhciBuZXdDZWxsID0gY29vcmRpbmF0ZUdyaWQuY2VsbChldi5wYWdlWCwgZXYucGFnZVkpOwoJCWlmICghbmV3Q2VsbCAhPSAhY2VsbCB8fCBuZXdDZWxsICYmIChuZXdDZWxsLnJvdyAhPSBjZWxsLnJvdyB8fCBuZXdDZWxsLmNvbCAhPSBjZWxsLmNvbCkpIHsKCQkJaWYgKG5ld0NlbGwpIHsKCQkJCWlmICghZmlyc3RDZWxsKSB7CgkJCQkJZmlyc3RDZWxsID0gbmV3Q2VsbDsKCQkJCX0KCQkJCWNoYW5nZShuZXdDZWxsLCBmaXJzdENlbGwsIG5ld0NlbGwucm93LWZpcnN0Q2VsbC5yb3csIG5ld0NlbGwuY29sLWZpcnN0Q2VsbC5jb2wpOwoJCQl9ZWxzZXsKCQkJCWNoYW5nZShuZXdDZWxsLCBmaXJzdENlbGwpOwoJCQl9CgkJCWNlbGwgPSBuZXdDZWxsOwoJCX0KCX0KCQoJdC5zdG9wID0gZnVuY3Rpb24oKSB7CgkJJChkb2N1bWVudCkudW5iaW5kKGJpbmRUeXBlLCBtb3VzZSk7CgkJcmV0dXJuIGNlbGw7Cgl9OwoJCn0KCgoKLyogTWlzYyBVdGlscwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgp2YXIgZGF5SURzID0gWydzdW4nLCAnbW9uJywgJ3R1ZScsICd3ZWQnLCAndGh1JywgJ2ZyaScsICdzYXQnXTsKCmZ1bmN0aW9uIHplcm9QYWQobikgewoJcmV0dXJuIChuIDwgMTAgPyAnMCcgOiAnJykgKyBuOwp9CgpmdW5jdGlvbiBzbWFydFByb3BlcnR5KG9iaiwgbmFtZSkgeyAvLyBnZXQgYSBjYW1lbC1jYXNlZC9uYW1lc3BhY2VkIHByb3BlcnR5IG9mIGFuIG9iamVjdAoJaWYgKG9ialtuYW1lXSAhPT0gdW5kZWZpbmVkKSB7CgkJcmV0dXJuIG9ialtuYW1lXTsKCX0KCXZhciBwYXJ0cyA9IG5hbWUuc3BsaXQoLyg/PVtBLVpdKS8pLAoJCWk9cGFydHMubGVuZ3RoLTEsIHJlczsKCWZvciAoOyBpPj0wOyBpLS0pIHsKCQlyZXMgPSBvYmpbcGFydHNbaV0udG9Mb3dlckNhc2UoKV07CgkJaWYgKHJlcyAhPT0gdW5kZWZpbmVkKSB7CgkJCXJldHVybiByZXM7CgkJfQoJfQoJcmV0dXJuIG9ialsnJ107Cn0KCmZ1bmN0aW9uIGh0bWxFc2NhcGUocykgewoJcmV0dXJuIHMucmVwbGFjZSgvJi9nLCAnJmFtcDsnKQoJCS5yZXBsYWNlKC88L2csICcmbHQ7JykKCQkucmVwbGFjZSgvPi9nLCAnJmd0OycpCgkJLnJlcGxhY2UoLycvZywgJyYjMDM5OycpCgkJLnJlcGxhY2UoLyIvZywgJyZxdW90OycpCgkJLnJlcGxhY2UoL1xuL2csICc8YnIgLz4nKTsKfQoKCgpmdW5jdGlvbiBIb3Jpem9udGFsUG9zaXRpb25DYWNoZShnZXRFbGVtZW50KSB7CgoJdmFyIHQgPSB0aGlzLAoJCWVsZW1lbnRzID0ge30sCgkJbGVmdHMgPSB7fSwKCQlyaWdodHMgPSB7fTsKCQkKCWZ1bmN0aW9uIGUoaSkgewoJCXJldHVybiBlbGVtZW50c1tpXSA9IGVsZW1lbnRzW2ldIHx8IGdldEVsZW1lbnQoaSk7Cgl9CgkKCXQubGVmdCA9IGZ1bmN0aW9uKGkpIHsKCQlyZXR1cm4gbGVmdHNbaV0gPSBsZWZ0c1tpXSA9PT0gdW5kZWZpbmVkID8gZShpKS5wb3NpdGlvbigpLmxlZnQgOiBsZWZ0c1tpXTsKCX07CgkKCXQucmlnaHQgPSBmdW5jdGlvbihpKSB7CgkJcmV0dXJuIHJpZ2h0c1tpXSA9IHJpZ2h0c1tpXSA9PT0gdW5kZWZpbmVkID8gdC5sZWZ0KGkpICsgZShpKS53aWR0aCgpIDogcmlnaHRzW2ldOwoJfTsKCQoJdC5jbGVhciA9IGZ1bmN0aW9uKCkgewoJCWVsZW1lbnRzID0ge307CgkJbGVmdHMgPSB7fTsKCQlyaWdodHMgPSB7fTsKCX07CgkKfQoKCgpmdW5jdGlvbiBjc3NLZXkoX2VsZW1lbnQpIHsKCXJldHVybiBfZWxlbWVudC5pZCArICcvJyArIF9lbGVtZW50LmNsYXNzTmFtZSArICcvJyArIF9lbGVtZW50LnN0eWxlLmNzc1RleHQucmVwbGFjZSgvKF58OylccyoodG9wfGxlZnR8d2lkdGh8aGVpZ2h0KVxzKjpbXjtdKi9pZywgJycpOwp9CgoKCmZ1bmN0aW9uIGNtcChhLCBiKSB7CglyZXR1cm4gYSAtIGI7Cn0KCgoKZnVuY3Rpb24gZXhjbEVuZERheShldmVudCkgewoJaWYgKGV2ZW50LmVuZCkgewoJCXJldHVybiBfZXhjbEVuZERheShldmVudC5lbmQsIGV2ZW50LmFsbERheSk7Cgl9ZWxzZXsKCQlyZXR1cm4gYWRkRGF5cyhjbG9uZURhdGUoZXZlbnQuc3RhcnQpLCAxKTsKCX0KfQoKZnVuY3Rpb24gX2V4Y2xFbmREYXkoZW5kLCBhbGxEYXkpIHsKCWVuZCA9IGNsb25lRGF0ZShlbmQpOwoJcmV0dXJuIGFsbERheSB8fCBlbmQuZ2V0SG91cnMoKSB8fCBlbmQuZ2V0TWludXRlcygpID8gYWRkRGF5cyhlbmQsIDEpIDogY2xlYXJUaW1lKGVuZCk7Cn0KCgoKZnVuY3Rpb24gZGlzYWJsZVRleHRTZWxlY3Rpb24oZWxlbWVudCkgewoJZWxlbWVudAoJCS5hdHRyKCd1bnNlbGVjdGFibGUnLCAnb24nKQoJCS5jc3MoJ01velVzZXJTZWxlY3QnLCAnbm9uZScpCgkJLmJpbmQoJ3NlbGVjdHN0YXJ0LnVpJywgZnVuY3Rpb24oKSB7IHJldHVybiBmYWxzZTsgfSk7Cn0KCi8qCmZ1bmN0aW9uIGVuYWJsZVRleHRTZWxlY3Rpb24oZWxlbWVudCkgewoJZWxlbWVudAoJCS5hdHRyKCd1bnNlbGVjdGFibGUnLCAnb2ZmJykKCQkuY3NzKCdNb3pVc2VyU2VsZWN0JywgJycpCgkJLnVuYmluZCgnc2VsZWN0c3RhcnQudWknKTsKfQoqLwoKCgoNCn0pKGpRdWVyeSk7",
	"jquery.js": "LyohCiAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuNC4yCiAqIGh0dHA6Ly9qcXVlcnkuY29tLwogKgogKiBDb3B5cmlnaHQgMjAxMCwgSm9obiBSZXNpZwogKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgb3IgR1BMIFZlcnNpb24gMiBsaWNlbnNlcy4KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQogKgogKiBJbmNsdWRlcyBTaXp6bGUuanMKICogaHR0cDovL3NpenpsZWpzLmNvbS8KICogQ29weXJpZ2h0IDIwMTAsIFRoZSBEb2pvIEZvdW5kYXRpb24KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCwgQlNELCBhbmQgR1BMIExpY2Vuc2VzLgogKgogKiBEYXRlOiBTYXQgRmViIDEzIDIyOjMzOjQ4IDIwMTAgLTA1MDAKICovCihmdW5jdGlvbihBLHcpe2Z1bmN0aW9uIG1hKCl7aWYoIWMuaXNSZWFkeSl7dHJ5e3MuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsKCJsZWZ0Iil9Y2F0Y2goYSl7c2V0VGltZW91dChtYSwxKTtyZXR1cm59Yy5yZWFkeSgpfX1mdW5jdGlvbiBRYShhLGIpe2Iuc3JjP2MuYWpheCh7dXJsOmIuc3JjLGFzeW5jOmZhbHNlLGRhdGFUeXBlOiJzY3JpcHQifSk6Yy5nbG9iYWxFdmFsKGIudGV4dHx8Yi50ZXh0Q29udGVudHx8Yi5pbm5lckhUTUx8fCIiKTtiLnBhcmVudE5vZGUmJmIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKX1mdW5jdGlvbiBYKGEsYixkLGYsZSxqKXt2YXIgaT1hLmxlbmd0aDtpZih0eXBlb2YgYj09PSJvYmplY3QiKXtmb3IodmFyIG8gaW4gYilYKGEsbyxiW29dLGYsZSxkKTtyZXR1cm4gYX1pZihkIT09dyl7Zj0haiYmZiYmYy5pc0Z1bmN0aW9uKGQpO2ZvcihvPTA7bzxpO28rKyllKGFbb10sYixmP2QuY2FsbChhW29dLG8sZShhW29dLGIpKTpkLGopO3JldHVybiBhfXJldHVybiBpPwplKGFbMF0sYik6d31mdW5jdGlvbiBKKCl7cmV0dXJuKG5ldyBEYXRlKS5nZXRUaW1lKCl9ZnVuY3Rpb24gWSgpe3JldHVybiBmYWxzZX1mdW5jdGlvbiBaKCl7cmV0dXJuIHRydWV9ZnVuY3Rpb24gbmEoYSxiLGQpe2RbMF0udHlwZT1hO3JldHVybiBjLmV2ZW50LmhhbmRsZS5hcHBseShiLGQpfWZ1bmN0aW9uIG9hKGEpe3ZhciBiLGQ9W10sZj1bXSxlPWFyZ3VtZW50cyxqLGksbyxrLG4scjtpPWMuZGF0YSh0aGlzLCJldmVudHMiKTtpZighKGEubGl2ZUZpcmVkPT09dGhpc3x8IWl8fCFpLmxpdmV8fGEuYnV0dG9uJiZhLnR5cGU9PT0iY2xpY2siKSl7YS5saXZlRmlyZWQ9dGhpczt2YXIgdT1pLmxpdmUuc2xpY2UoMCk7Zm9yKGs9MDtrPHUubGVuZ3RoO2srKyl7aT11W2tdO2kub3JpZ1R5cGUucmVwbGFjZShPLCIiKT09PWEudHlwZT9mLnB1c2goaS5zZWxlY3Rvcik6dS5zcGxpY2Uoay0tLDEpfWo9YyhhLnRhcmdldCkuY2xvc2VzdChmLGEuY3VycmVudFRhcmdldCk7bj0wO2ZvcihyPQpqLmxlbmd0aDtuPHI7bisrKWZvcihrPTA7azx1Lmxlbmd0aDtrKyspe2k9dVtrXTtpZihqW25dLnNlbGVjdG9yPT09aS5zZWxlY3Rvcil7bz1qW25dLmVsZW07Zj1udWxsO2lmKGkucHJlVHlwZT09PSJtb3VzZWVudGVyInx8aS5wcmVUeXBlPT09Im1vdXNlbGVhdmUiKWY9YyhhLnJlbGF0ZWRUYXJnZXQpLmNsb3Nlc3QoaS5zZWxlY3RvcilbMF07aWYoIWZ8fGYhPT1vKWQucHVzaCh7ZWxlbTpvLGhhbmRsZU9iajppfSl9fW49MDtmb3Iocj1kLmxlbmd0aDtuPHI7bisrKXtqPWRbbl07YS5jdXJyZW50VGFyZ2V0PWouZWxlbTthLmRhdGE9ai5oYW5kbGVPYmouZGF0YTthLmhhbmRsZU9iaj1qLmhhbmRsZU9iajtpZihqLmhhbmRsZU9iai5vcmlnSGFuZGxlci5hcHBseShqLmVsZW0sZSk9PT1mYWxzZSl7Yj1mYWxzZTticmVha319cmV0dXJuIGJ9fWZ1bmN0aW9uIHBhKGEsYil7cmV0dXJuImxpdmUuIisoYSYmYSE9PSIqIj9hKyIuIjoiIikrYi5yZXBsYWNlKC9cLi9nLCJgIikucmVwbGFjZSgvIC9nLAoiJiIpfWZ1bmN0aW9uIHFhKGEpe3JldHVybiFhfHwhYS5wYXJlbnROb2RlfHxhLnBhcmVudE5vZGUubm9kZVR5cGU9PT0xMX1mdW5jdGlvbiByYShhLGIpe3ZhciBkPTA7Yi5lYWNoKGZ1bmN0aW9uKCl7aWYodGhpcy5ub2RlTmFtZT09PShhW2RdJiZhW2RdLm5vZGVOYW1lKSl7dmFyIGY9Yy5kYXRhKGFbZCsrXSksZT1jLmRhdGEodGhpcyxmKTtpZihmPWYmJmYuZXZlbnRzKXtkZWxldGUgZS5oYW5kbGU7ZS5ldmVudHM9e307Zm9yKHZhciBqIGluIGYpZm9yKHZhciBpIGluIGZbal0pYy5ldmVudC5hZGQodGhpcyxqLGZbal1baV0sZltqXVtpXS5kYXRhKX19fSl9ZnVuY3Rpb24gc2EoYSxiLGQpe3ZhciBmLGUsajtiPWImJmJbMF0/YlswXS5vd25lckRvY3VtZW50fHxiWzBdOnM7aWYoYS5sZW5ndGg9PT0xJiZ0eXBlb2YgYVswXT09PSJzdHJpbmciJiZhWzBdLmxlbmd0aDw1MTImJmI9PT1zJiYhdGEudGVzdChhWzBdKSYmKGMuc3VwcG9ydC5jaGVja0Nsb25lfHwhdWEudGVzdChhWzBdKSkpe2U9CnRydWU7aWYoaj1jLmZyYWdtZW50c1thWzBdXSlpZihqIT09MSlmPWp9aWYoIWYpe2Y9Yi5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7Yy5jbGVhbihhLGIsZixkKX1pZihlKWMuZnJhZ21lbnRzW2FbMF1dPWo/ZjoxO3JldHVybntmcmFnbWVudDpmLGNhY2hlYWJsZTplfX1mdW5jdGlvbiBLKGEsYil7dmFyIGQ9e307Yy5lYWNoKHZhLmNvbmNhdC5hcHBseShbXSx2YS5zbGljZSgwLGIpKSxmdW5jdGlvbigpe2RbdGhpc109YX0pO3JldHVybiBkfWZ1bmN0aW9uIHdhKGEpe3JldHVybiJzY3JvbGxUbyJpbiBhJiZhLmRvY3VtZW50P2E6YS5ub2RlVHlwZT09PTk/YS5kZWZhdWx0Vmlld3x8YS5wYXJlbnRXaW5kb3c6ZmFsc2V9dmFyIGM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGMuZm4uaW5pdChhLGIpfSxSYT1BLmpRdWVyeSxTYT1BLiQscz1BLmRvY3VtZW50LFQsVGE9L15bXjxdKig8W1x3XFddKz4pW14+XSokfF4jKFtcdy1dKykkLyxVYT0vXi5bXjojXFtcLixdKiQvLFZhPS9cUy8sCldhPS9eKFxzfFx1MDBBMCkrfChcc3xcdTAwQTApKyQvZyxYYT0vXjwoXHcrKVxzKlwvPz4oPzo8XC9cMT4pPyQvLFA9bmF2aWdhdG9yLnVzZXJBZ2VudCx4YT1mYWxzZSxRPVtdLEwsJD1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLGFhPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksYmE9QXJyYXkucHJvdG90eXBlLnB1c2gsUj1BcnJheS5wcm90b3R5cGUuc2xpY2UseWE9QXJyYXkucHJvdG90eXBlLmluZGV4T2Y7Yy5mbj1jLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLGIpe3ZhciBkLGY7aWYoIWEpcmV0dXJuIHRoaXM7aWYoYS5ub2RlVHlwZSl7dGhpcy5jb250ZXh0PXRoaXNbMF09YTt0aGlzLmxlbmd0aD0xO3JldHVybiB0aGlzfWlmKGE9PT0iYm9keSImJiFiKXt0aGlzLmNvbnRleHQ9czt0aGlzWzBdPXMuYm9keTt0aGlzLnNlbGVjdG9yPSJib2R5Ijt0aGlzLmxlbmd0aD0xO3JldHVybiB0aGlzfWlmKHR5cGVvZiBhPT09InN0cmluZyIpaWYoKGQ9VGEuZXhlYyhhKSkmJgooZFsxXXx8IWIpKWlmKGRbMV0pe2Y9Yj9iLm93bmVyRG9jdW1lbnR8fGI6cztpZihhPVhhLmV4ZWMoYSkpaWYoYy5pc1BsYWluT2JqZWN0KGIpKXthPVtzLmNyZWF0ZUVsZW1lbnQoYVsxXSldO2MuZm4uYXR0ci5jYWxsKGEsYix0cnVlKX1lbHNlIGE9W2YuY3JlYXRlRWxlbWVudChhWzFdKV07ZWxzZXthPXNhKFtkWzFdXSxbZl0pO2E9KGEuY2FjaGVhYmxlP2EuZnJhZ21lbnQuY2xvbmVOb2RlKHRydWUpOmEuZnJhZ21lbnQpLmNoaWxkTm9kZXN9cmV0dXJuIGMubWVyZ2UodGhpcyxhKX1lbHNle2lmKGI9cy5nZXRFbGVtZW50QnlJZChkWzJdKSl7aWYoYi5pZCE9PWRbMl0pcmV0dXJuIFQuZmluZChhKTt0aGlzLmxlbmd0aD0xO3RoaXNbMF09Yn10aGlzLmNvbnRleHQ9czt0aGlzLnNlbGVjdG9yPWE7cmV0dXJuIHRoaXN9ZWxzZSBpZighYiYmL15cdyskLy50ZXN0KGEpKXt0aGlzLnNlbGVjdG9yPWE7dGhpcy5jb250ZXh0PXM7YT1zLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpO3JldHVybiBjLm1lcmdlKHRoaXMsCmEpfWVsc2UgcmV0dXJuIWJ8fGIuanF1ZXJ5PyhifHxUKS5maW5kKGEpOmMoYikuZmluZChhKTtlbHNlIGlmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gVC5yZWFkeShhKTtpZihhLnNlbGVjdG9yIT09dyl7dGhpcy5zZWxlY3Rvcj1hLnNlbGVjdG9yO3RoaXMuY29udGV4dD1hLmNvbnRleHR9cmV0dXJuIGMubWFrZUFycmF5KGEsdGhpcyl9LHNlbGVjdG9yOiIiLGpxdWVyeToiMS40LjIiLGxlbmd0aDowLHNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sZW5ndGh9LHRvQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gUi5jYWxsKHRoaXMsMCl9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4gYT09bnVsbD90aGlzLnRvQXJyYXkoKTphPDA/dGhpcy5zbGljZShhKVswXTp0aGlzW2FdfSxwdXNoU3RhY2s6ZnVuY3Rpb24oYSxiLGQpe3ZhciBmPWMoKTtjLmlzQXJyYXkoYSk/YmEuYXBwbHkoZixhKTpjLm1lcmdlKGYsYSk7Zi5wcmV2T2JqZWN0PXRoaXM7Zi5jb250ZXh0PXRoaXMuY29udGV4dDtpZihiPT09CiJmaW5kIilmLnNlbGVjdG9yPXRoaXMuc2VsZWN0b3IrKHRoaXMuc2VsZWN0b3I/IiAiOiIiKStkO2Vsc2UgaWYoYilmLnNlbGVjdG9yPXRoaXMuc2VsZWN0b3IrIi4iK2IrIigiK2QrIikiO3JldHVybiBmfSxlYWNoOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuZWFjaCh0aGlzLGEsYil9LHJlYWR5OmZ1bmN0aW9uKGEpe2MuYmluZFJlYWR5KCk7aWYoYy5pc1JlYWR5KWEuY2FsbChzLGMpO2Vsc2UgUSYmUS5wdXNoKGEpO3JldHVybiB0aGlzfSxlcTpmdW5jdGlvbihhKXtyZXR1cm4gYT09PS0xP3RoaXMuc2xpY2UoYSk6dGhpcy5zbGljZShhLCthKzEpfSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApfSxsYXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoLTEpfSxzbGljZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhSLmFwcGx5KHRoaXMsYXJndW1lbnRzKSwic2xpY2UiLFIuY2FsbChhcmd1bWVudHMpLmpvaW4oIiwiKSl9LG1hcDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soYy5tYXAodGhpcywKZnVuY3Rpb24oYixkKXtyZXR1cm4gYS5jYWxsKGIsZCxiKX0pKX0sZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldk9iamVjdHx8YyhudWxsKX0scHVzaDpiYSxzb3J0OltdLnNvcnQsc3BsaWNlOltdLnNwbGljZX07Yy5mbi5pbml0LnByb3RvdHlwZT1jLmZuO2MuZXh0ZW5kPWMuZm4uZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdfHx7fSxiPTEsZD1hcmd1bWVudHMubGVuZ3RoLGY9ZmFsc2UsZSxqLGksbztpZih0eXBlb2YgYT09PSJib29sZWFuIil7Zj1hO2E9YXJndW1lbnRzWzFdfHx7fTtiPTJ9aWYodHlwZW9mIGEhPT0ib2JqZWN0IiYmIWMuaXNGdW5jdGlvbihhKSlhPXt9O2lmKGQ9PT1iKXthPXRoaXM7LS1ifWZvcig7YjxkO2IrKylpZigoZT1hcmd1bWVudHNbYl0pIT1udWxsKWZvcihqIGluIGUpe2k9YVtqXTtvPWVbal07aWYoYSE9PW8paWYoZiYmbyYmKGMuaXNQbGFpbk9iamVjdChvKXx8Yy5pc0FycmF5KG8pKSl7aT1pJiYoYy5pc1BsYWluT2JqZWN0KGkpfHwKYy5pc0FycmF5KGkpKT9pOmMuaXNBcnJheShvKT9bXTp7fTthW2pdPWMuZXh0ZW5kKGYsaSxvKX1lbHNlIGlmKG8hPT13KWFbal09b31yZXR1cm4gYX07Yy5leHRlbmQoe25vQ29uZmxpY3Q6ZnVuY3Rpb24oYSl7QS4kPVNhO2lmKGEpQS5qUXVlcnk9UmE7cmV0dXJuIGN9LGlzUmVhZHk6ZmFsc2UscmVhZHk6ZnVuY3Rpb24oKXtpZighYy5pc1JlYWR5KXtpZighcy5ib2R5KXJldHVybiBzZXRUaW1lb3V0KGMucmVhZHksMTMpO2MuaXNSZWFkeT10cnVlO2lmKFEpe2Zvcih2YXIgYSxiPTA7YT1RW2IrK107KWEuY2FsbChzLGMpO1E9bnVsbH1jLmZuLnRyaWdnZXJIYW5kbGVyJiZjKHMpLnRyaWdnZXJIYW5kbGVyKCJyZWFkeSIpfX0sYmluZFJlYWR5OmZ1bmN0aW9uKCl7aWYoIXhhKXt4YT10cnVlO2lmKHMucmVhZHlTdGF0ZT09PSJjb21wbGV0ZSIpcmV0dXJuIGMucmVhZHkoKTtpZihzLmFkZEV2ZW50TGlzdGVuZXIpe3MuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsCkwsZmFsc2UpO0EuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsYy5yZWFkeSxmYWxzZSl9ZWxzZSBpZihzLmF0dGFjaEV2ZW50KXtzLmF0dGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLEwpO0EuYXR0YWNoRXZlbnQoIm9ubG9hZCIsYy5yZWFkeSk7dmFyIGE9ZmFsc2U7dHJ5e2E9QS5mcmFtZUVsZW1lbnQ9PW51bGx9Y2F0Y2goYil7fXMuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsJiZhJiZtYSgpfX19LGlzRnVuY3Rpb246ZnVuY3Rpb24oYSl7cmV0dXJuICQuY2FsbChhKT09PSJbb2JqZWN0IEZ1bmN0aW9uXSJ9LGlzQXJyYXk6ZnVuY3Rpb24oYSl7cmV0dXJuICQuY2FsbChhKT09PSJbb2JqZWN0IEFycmF5XSJ9LGlzUGxhaW5PYmplY3Q6ZnVuY3Rpb24oYSl7aWYoIWF8fCQuY2FsbChhKSE9PSJbb2JqZWN0IE9iamVjdF0ifHxhLm5vZGVUeXBlfHxhLnNldEludGVydmFsKXJldHVybiBmYWxzZTtpZihhLmNvbnN0cnVjdG9yJiYhYWEuY2FsbChhLCJjb25zdHJ1Y3RvciIpJiYhYWEuY2FsbChhLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwKImlzUHJvdG90eXBlT2YiKSlyZXR1cm4gZmFsc2U7dmFyIGI7Zm9yKGIgaW4gYSk7cmV0dXJuIGI9PT13fHxhYS5jYWxsKGEsYil9LGlzRW1wdHlPYmplY3Q6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiIGluIGEpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlfSxlcnJvcjpmdW5jdGlvbihhKXt0aHJvdyBhO30scGFyc2VKU09OOmZ1bmN0aW9uKGEpe2lmKHR5cGVvZiBhIT09InN0cmluZyJ8fCFhKXJldHVybiBudWxsO2E9Yy50cmltKGEpO2lmKC9eW1xdLDp7fVxzXSokLy50ZXN0KGEucmVwbGFjZSgvXFwoPzpbIlxcXC9iZm5ydF18dVswLTlhLWZBLUZdezR9KS9nLCJAIikucmVwbGFjZSgvIlteIlxcXG5ccl0qInx0cnVlfGZhbHNlfG51bGx8LT9cZCsoPzpcLlxkKik/KD86W2VFXVsrXC1dP1xkKyk/L2csIl0iKS5yZXBsYWNlKC8oPzpefDp8LCkoPzpccypcWykrL2csIiIpKSlyZXR1cm4gQS5KU09OJiZBLkpTT04ucGFyc2U/QS5KU09OLnBhcnNlKGEpOihuZXcgRnVuY3Rpb24oInJldHVybiAiKwphKSkoKTtlbHNlIGMuZXJyb3IoIkludmFsaWQgSlNPTjogIithKX0sbm9vcDpmdW5jdGlvbigpe30sZ2xvYmFsRXZhbDpmdW5jdGlvbihhKXtpZihhJiZWYS50ZXN0KGEpKXt2YXIgYj1zLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF18fHMuZG9jdW1lbnRFbGVtZW50LGQ9cy5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtkLnR5cGU9InRleHQvamF2YXNjcmlwdCI7aWYoYy5zdXBwb3J0LnNjcmlwdEV2YWwpZC5hcHBlbmRDaGlsZChzLmNyZWF0ZVRleHROb2RlKGEpKTtlbHNlIGQudGV4dD1hO2IuaW5zZXJ0QmVmb3JlKGQsYi5maXJzdENoaWxkKTtiLnJlbW92ZUNoaWxkKGQpfX0sbm9kZU5hbWU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5ub2RlTmFtZSYmYS5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpPT09Yi50b1VwcGVyQ2FzZSgpfSxlYWNoOmZ1bmN0aW9uKGEsYixkKXt2YXIgZixlPTAsaj1hLmxlbmd0aCxpPWo9PT13fHxjLmlzRnVuY3Rpb24oYSk7aWYoZClpZihpKWZvcihmIGluIGEpe2lmKGIuYXBwbHkoYVtmXSwKZCk9PT1mYWxzZSlicmVha31lbHNlIGZvcig7ZTxqOyl7aWYoYi5hcHBseShhW2UrK10sZCk9PT1mYWxzZSlicmVha31lbHNlIGlmKGkpZm9yKGYgaW4gYSl7aWYoYi5jYWxsKGFbZl0sZixhW2ZdKT09PWZhbHNlKWJyZWFrfWVsc2UgZm9yKGQ9YVswXTtlPGomJmIuY2FsbChkLGUsZCkhPT1mYWxzZTtkPWFbKytlXSk7cmV0dXJuIGF9LHRyaW06ZnVuY3Rpb24oYSl7cmV0dXJuKGF8fCIiKS5yZXBsYWNlKFdhLCIiKX0sbWFrZUFycmF5OmZ1bmN0aW9uKGEsYil7Yj1ifHxbXTtpZihhIT1udWxsKWEubGVuZ3RoPT1udWxsfHx0eXBlb2YgYT09PSJzdHJpbmcifHxjLmlzRnVuY3Rpb24oYSl8fHR5cGVvZiBhIT09ImZ1bmN0aW9uIiYmYS5zZXRJbnRlcnZhbD9iYS5jYWxsKGIsYSk6Yy5tZXJnZShiLGEpO3JldHVybiBifSxpbkFycmF5OmZ1bmN0aW9uKGEsYil7aWYoYi5pbmRleE9mKXJldHVybiBiLmluZGV4T2YoYSk7Zm9yKHZhciBkPTAsZj1iLmxlbmd0aDtkPGY7ZCsrKWlmKGJbZF09PT0KYSlyZXR1cm4gZDtyZXR1cm4tMX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXt2YXIgZD1hLmxlbmd0aCxmPTA7aWYodHlwZW9mIGIubGVuZ3RoPT09Im51bWJlciIpZm9yKHZhciBlPWIubGVuZ3RoO2Y8ZTtmKyspYVtkKytdPWJbZl07ZWxzZSBmb3IoO2JbZl0hPT13OylhW2QrK109YltmKytdO2EubGVuZ3RoPWQ7cmV0dXJuIGF9LGdyZXA6ZnVuY3Rpb24oYSxiLGQpe2Zvcih2YXIgZj1bXSxlPTAsaj1hLmxlbmd0aDtlPGo7ZSsrKSFkIT09IWIoYVtlXSxlKSYmZi5wdXNoKGFbZV0pO3JldHVybiBmfSxtYXA6ZnVuY3Rpb24oYSxiLGQpe2Zvcih2YXIgZj1bXSxlLGo9MCxpPWEubGVuZ3RoO2o8aTtqKyspe2U9YihhW2pdLGosZCk7aWYoZSE9bnVsbClmW2YubGVuZ3RoXT1lfXJldHVybiBmLmNvbmNhdC5hcHBseShbXSxmKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYixkKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MilpZih0eXBlb2YgYj09PSJzdHJpbmciKXtkPWE7YT1kW2JdO2I9d31lbHNlIGlmKGImJgohYy5pc0Z1bmN0aW9uKGIpKXtkPWI7Yj13fWlmKCFiJiZhKWI9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShkfHx0aGlzLGFyZ3VtZW50cyl9O2lmKGEpYi5ndWlkPWEuZ3VpZD1hLmd1aWR8fGIuZ3VpZHx8Yy5ndWlkKys7cmV0dXJuIGJ9LHVhTWF0Y2g6ZnVuY3Rpb24oYSl7YT1hLnRvTG93ZXJDYXNlKCk7YT0vKHdlYmtpdClbIFwvXShbXHcuXSspLy5leGVjKGEpfHwvKG9wZXJhKSg/Oi4qdmVyc2lvbik/WyBcL10oW1x3Ll0rKS8uZXhlYyhhKXx8Lyhtc2llKSAoW1x3Ll0rKS8uZXhlYyhhKXx8IS9jb21wYXRpYmxlLy50ZXN0KGEpJiYvKG1vemlsbGEpKD86Lio/IHJ2OihbXHcuXSspKT8vLmV4ZWMoYSl8fFtdO3JldHVybnticm93c2VyOmFbMV18fCIiLHZlcnNpb246YVsyXXx8IjAifX0sYnJvd3Nlcjp7fX0pO1A9Yy51YU1hdGNoKFApO2lmKFAuYnJvd3Nlcil7Yy5icm93c2VyW1AuYnJvd3Nlcl09dHJ1ZTtjLmJyb3dzZXIudmVyc2lvbj1QLnZlcnNpb259aWYoYy5icm93c2VyLndlYmtpdCljLmJyb3dzZXIuc2FmYXJpPQp0cnVlO2lmKHlhKWMuaW5BcnJheT1mdW5jdGlvbihhLGIpe3JldHVybiB5YS5jYWxsKGIsYSl9O1Q9YyhzKTtpZihzLmFkZEV2ZW50TGlzdGVuZXIpTD1mdW5jdGlvbigpe3MucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsTCxmYWxzZSk7Yy5yZWFkeSgpfTtlbHNlIGlmKHMuYXR0YWNoRXZlbnQpTD1mdW5jdGlvbigpe2lmKHMucmVhZHlTdGF0ZT09PSJjb21wbGV0ZSIpe3MuZGV0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsTCk7Yy5yZWFkeSgpfX07KGZ1bmN0aW9uKCl7Yy5zdXBwb3J0PXt9O3ZhciBhPXMuZG9jdW1lbnRFbGVtZW50LGI9cy5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKSxkPXMuY3JlYXRlRWxlbWVudCgiZGl2IiksZj0ic2NyaXB0IitKKCk7ZC5zdHlsZS5kaXNwbGF5PSJub25lIjtkLmlubmVySFRNTD0iICAgPGxpbmsvPjx0YWJsZT48L3RhYmxlPjxhIGhyZWY9Jy9hJyBzdHlsZT0nY29sb3I6cmVkO2Zsb2F0OmxlZnQ7b3BhY2l0eTouNTU7Jz5hPC9hPjxpbnB1dCB0eXBlPSdjaGVja2JveCcvPiI7CnZhciBlPWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSxqPWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKVswXTtpZighKCFlfHwhZS5sZW5ndGh8fCFqKSl7Yy5zdXBwb3J0PXtsZWFkaW5nV2hpdGVzcGFjZTpkLmZpcnN0Q2hpbGQubm9kZVR5cGU9PT0zLHRib2R5OiFkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpLmxlbmd0aCxodG1sU2VyaWFsaXplOiEhZC5nZXRFbGVtZW50c0J5VGFnTmFtZSgibGluayIpLmxlbmd0aCxzdHlsZTovcmVkLy50ZXN0KGouZ2V0QXR0cmlidXRlKCJzdHlsZSIpKSxocmVmTm9ybWFsaXplZDpqLmdldEF0dHJpYnV0ZSgiaHJlZiIpPT09Ii9hIixvcGFjaXR5Oi9eMC41NSQvLnRlc3Qoai5zdHlsZS5vcGFjaXR5KSxjc3NGbG9hdDohIWouc3R5bGUuY3NzRmxvYXQsY2hlY2tPbjpkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpbnB1dCIpWzBdLnZhbHVlPT09Im9uIixvcHRTZWxlY3RlZDpzLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLmFwcGVuZENoaWxkKHMuY3JlYXRlRWxlbWVudCgib3B0aW9uIikpLnNlbGVjdGVkLApwYXJlbnROb2RlOmQucmVtb3ZlQ2hpbGQoZC5hcHBlbmRDaGlsZChzLmNyZWF0ZUVsZW1lbnQoImRpdiIpKSkucGFyZW50Tm9kZT09PW51bGwsZGVsZXRlRXhwYW5kbzp0cnVlLGNoZWNrQ2xvbmU6ZmFsc2Usc2NyaXB0RXZhbDpmYWxzZSxub0Nsb25lRXZlbnQ6dHJ1ZSxib3hNb2RlbDpudWxsfTtiLnR5cGU9InRleHQvamF2YXNjcmlwdCI7dHJ5e2IuYXBwZW5kQ2hpbGQocy5jcmVhdGVUZXh0Tm9kZSgid2luZG93LiIrZisiPTE7IikpfWNhdGNoKGkpe31hLmluc2VydEJlZm9yZShiLGEuZmlyc3RDaGlsZCk7aWYoQVtmXSl7Yy5zdXBwb3J0LnNjcmlwdEV2YWw9dHJ1ZTtkZWxldGUgQVtmXX10cnl7ZGVsZXRlIGIudGVzdH1jYXRjaChvKXtjLnN1cHBvcnQuZGVsZXRlRXhwYW5kbz1mYWxzZX1hLnJlbW92ZUNoaWxkKGIpO2lmKGQuYXR0YWNoRXZlbnQmJmQuZmlyZUV2ZW50KXtkLmF0dGFjaEV2ZW50KCJvbmNsaWNrIixmdW5jdGlvbiBrKCl7Yy5zdXBwb3J0Lm5vQ2xvbmVFdmVudD0KZmFsc2U7ZC5kZXRhY2hFdmVudCgib25jbGljayIsayl9KTtkLmNsb25lTm9kZSh0cnVlKS5maXJlRXZlbnQoIm9uY2xpY2siKX1kPXMuY3JlYXRlRWxlbWVudCgiZGl2Iik7ZC5pbm5lckhUTUw9IjxpbnB1dCB0eXBlPSdyYWRpbycgbmFtZT0ncmFkaW90ZXN0JyBjaGVja2VkPSdjaGVja2VkJy8+IjthPXMuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO2EuYXBwZW5kQ2hpbGQoZC5maXJzdENoaWxkKTtjLnN1cHBvcnQuY2hlY2tDbG9uZT1hLmNsb25lTm9kZSh0cnVlKS5jbG9uZU5vZGUodHJ1ZSkubGFzdENoaWxkLmNoZWNrZWQ7YyhmdW5jdGlvbigpe3ZhciBrPXMuY3JlYXRlRWxlbWVudCgiZGl2Iik7ay5zdHlsZS53aWR0aD1rLnN0eWxlLnBhZGRpbmdMZWZ0PSIxcHgiO3MuYm9keS5hcHBlbmRDaGlsZChrKTtjLmJveE1vZGVsPWMuc3VwcG9ydC5ib3hNb2RlbD1rLm9mZnNldFdpZHRoPT09MjtzLmJvZHkucmVtb3ZlQ2hpbGQoaykuc3R5bGUuZGlzcGxheT0ibm9uZSJ9KTthPWZ1bmN0aW9uKGspe3ZhciBuPQpzLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2s9Im9uIitrO3ZhciByPWsgaW4gbjtpZighcil7bi5zZXRBdHRyaWJ1dGUoaywicmV0dXJuOyIpO3I9dHlwZW9mIG5ba109PT0iZnVuY3Rpb24ifXJldHVybiByfTtjLnN1cHBvcnQuc3VibWl0QnViYmxlcz1hKCJzdWJtaXQiKTtjLnN1cHBvcnQuY2hhbmdlQnViYmxlcz1hKCJjaGFuZ2UiKTthPWI9ZD1lPWo9bnVsbH19KSgpO2MucHJvcHM9eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUiLHJlYWRvbmx5OiJyZWFkT25seSIsbWF4bGVuZ3RoOiJtYXhMZW5ndGgiLGNlbGxzcGFjaW5nOiJjZWxsU3BhY2luZyIscm93c3Bhbjoicm93U3BhbiIsY29sc3BhbjoiY29sU3BhbiIsdGFiaW5kZXg6InRhYkluZGV4Iix1c2VtYXA6InVzZU1hcCIsZnJhbWVib3JkZXI6ImZyYW1lQm9yZGVyIn07dmFyIEc9ImpRdWVyeSIrSigpLFlhPTAsemE9e307Yy5leHRlbmQoe2NhY2hlOnt9LGV4cGFuZG86Ryxub0RhdGE6e2VtYmVkOnRydWUsb2JqZWN0OnRydWUsCmFwcGxldDp0cnVlfSxkYXRhOmZ1bmN0aW9uKGEsYixkKXtpZighKGEubm9kZU5hbWUmJmMubm9EYXRhW2Eubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pKXthPWE9PUE/emE6YTt2YXIgZj1hW0ddLGU9Yy5jYWNoZTtpZighZiYmdHlwZW9mIGI9PT0ic3RyaW5nIiYmZD09PXcpcmV0dXJuIG51bGw7Znx8KGY9KytZYSk7aWYodHlwZW9mIGI9PT0ib2JqZWN0Iil7YVtHXT1mO2VbZl09Yy5leHRlbmQodHJ1ZSx7fSxiKX1lbHNlIGlmKCFlW2ZdKXthW0ddPWY7ZVtmXT17fX1hPWVbZl07aWYoZCE9PXcpYVtiXT1kO3JldHVybiB0eXBlb2YgYj09PSJzdHJpbmciP2FbYl06YX19LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtpZighKGEubm9kZU5hbWUmJmMubm9EYXRhW2Eubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pKXthPWE9PUE/emE6YTt2YXIgZD1hW0ddLGY9Yy5jYWNoZSxlPWZbZF07aWYoYil7aWYoZSl7ZGVsZXRlIGVbYl07Yy5pc0VtcHR5T2JqZWN0KGUpJiZjLnJlbW92ZURhdGEoYSl9fWVsc2V7aWYoYy5zdXBwb3J0LmRlbGV0ZUV4cGFuZG8pZGVsZXRlIGFbYy5leHBhbmRvXTsKZWxzZSBhLnJlbW92ZUF0dHJpYnV0ZSYmYS5yZW1vdmVBdHRyaWJ1dGUoYy5leHBhbmRvKTtkZWxldGUgZltkXX19fX0pO2MuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGEsYil7aWYodHlwZW9mIGE9PT0idW5kZWZpbmVkIiYmdGhpcy5sZW5ndGgpcmV0dXJuIGMuZGF0YSh0aGlzWzBdKTtlbHNlIGlmKHR5cGVvZiBhPT09Im9iamVjdCIpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2MuZGF0YSh0aGlzLGEpfSk7dmFyIGQ9YS5zcGxpdCgiLiIpO2RbMV09ZFsxXT8iLiIrZFsxXToiIjtpZihiPT09dyl7dmFyIGY9dGhpcy50cmlnZ2VySGFuZGxlcigiZ2V0RGF0YSIrZFsxXSsiISIsW2RbMF1dKTtpZihmPT09dyYmdGhpcy5sZW5ndGgpZj1jLmRhdGEodGhpc1swXSxhKTtyZXR1cm4gZj09PXcmJmRbMV0/dGhpcy5kYXRhKGRbMF0pOmZ9ZWxzZSByZXR1cm4gdGhpcy50cmlnZ2VyKCJzZXREYXRhIitkWzFdKyIhIixbZFswXSxiXSkuZWFjaChmdW5jdGlvbigpe2MuZGF0YSh0aGlzLAphLGIpfSl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2MucmVtb3ZlRGF0YSh0aGlzLGEpfSl9fSk7Yy5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYixkKXtpZihhKXtiPShifHwiZngiKSsicXVldWUiO3ZhciBmPWMuZGF0YShhLGIpO2lmKCFkKXJldHVybiBmfHxbXTtpZighZnx8Yy5pc0FycmF5KGQpKWY9Yy5kYXRhKGEsYixjLm1ha2VBcnJheShkKSk7ZWxzZSBmLnB1c2goZCk7cmV0dXJuIGZ9fSxkZXF1ZXVlOmZ1bmN0aW9uKGEsYil7Yj1ifHwiZngiO3ZhciBkPWMucXVldWUoYSxiKSxmPWQuc2hpZnQoKTtpZihmPT09ImlucHJvZ3Jlc3MiKWY9ZC5zaGlmdCgpO2lmKGYpe2I9PT0iZngiJiZkLnVuc2hpZnQoImlucHJvZ3Jlc3MiKTtmLmNhbGwoYSxmdW5jdGlvbigpe2MuZGVxdWV1ZShhLGIpfSl9fX0pO2MuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIpe2lmKHR5cGVvZiBhIT09InN0cmluZyIpe2I9YTthPSJmeCJ9aWYoYj09PQp3KXJldHVybiBjLnF1ZXVlKHRoaXNbMF0sYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBkPWMucXVldWUodGhpcyxhLGIpO2E9PT0iZngiJiZkWzBdIT09ImlucHJvZ3Jlc3MiJiZjLmRlcXVldWUodGhpcyxhKX0pfSxkZXF1ZXVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjLmRlcXVldWUodGhpcyxhKX0pfSxkZWxheTpmdW5jdGlvbihhLGIpe2E9Yy5meD9jLmZ4LnNwZWVkc1thXXx8YTphO2I9Ynx8ImZ4IjtyZXR1cm4gdGhpcy5xdWV1ZShiLGZ1bmN0aW9uKCl7dmFyIGQ9dGhpcztzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Yy5kZXF1ZXVlKGQsYil9LGEpfSl9LGNsZWFyUXVldWU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucXVldWUoYXx8ImZ4IixbXSl9fSk7dmFyIEFhPS9bXG5cdF0vZyxjYT0vXHMrLyxaYT0vXHIvZywkYT0vaHJlZnxzcmN8c3R5bGUvLGFiPS8oYnV0dG9ufGlucHV0KS9pLGJiPS8oYnV0dG9ufGlucHV0fG9iamVjdHxzZWxlY3R8dGV4dGFyZWEpL2ksCmNiPS9eKGF8YXJlYSkkL2ksQmE9L3JhZGlvfGNoZWNrYm94LztjLmZuLmV4dGVuZCh7YXR0cjpmdW5jdGlvbihhLGIpe3JldHVybiBYKHRoaXMsYSxiLHRydWUsYy5hdHRyKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yy5hdHRyKHRoaXMsYSwiIik7dGhpcy5ub2RlVHlwZT09PTEmJnRoaXMucmVtb3ZlQXR0cmlidXRlKGEpfSl9LGFkZENsYXNzOmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKG4pe3ZhciByPWModGhpcyk7ci5hZGRDbGFzcyhhLmNhbGwodGhpcyxuLHIuYXR0cigiY2xhc3MiKSkpfSk7aWYoYSYmdHlwZW9mIGE9PT0ic3RyaW5nIilmb3IodmFyIGI9KGF8fCIiKS5zcGxpdChjYSksZD0wLGY9dGhpcy5sZW5ndGg7ZDxmO2QrKyl7dmFyIGU9dGhpc1tkXTtpZihlLm5vZGVUeXBlPT09MSlpZihlLmNsYXNzTmFtZSl7Zm9yKHZhciBqPSIgIitlLmNsYXNzTmFtZSsiICIsCmk9ZS5jbGFzc05hbWUsbz0wLGs9Yi5sZW5ndGg7bzxrO28rKylpZihqLmluZGV4T2YoIiAiK2Jbb10rIiAiKTwwKWkrPSIgIitiW29dO2UuY2xhc3NOYW1lPWMudHJpbShpKX1lbHNlIGUuY2xhc3NOYW1lPWF9cmV0dXJuIHRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGspe3ZhciBuPWModGhpcyk7bi5yZW1vdmVDbGFzcyhhLmNhbGwodGhpcyxrLG4uYXR0cigiY2xhc3MiKSkpfSk7aWYoYSYmdHlwZW9mIGE9PT0ic3RyaW5nInx8YT09PXcpZm9yKHZhciBiPShhfHwiIikuc3BsaXQoY2EpLGQ9MCxmPXRoaXMubGVuZ3RoO2Q8ZjtkKyspe3ZhciBlPXRoaXNbZF07aWYoZS5ub2RlVHlwZT09PTEmJmUuY2xhc3NOYW1lKWlmKGEpe2Zvcih2YXIgaj0oIiAiK2UuY2xhc3NOYW1lKyIgIikucmVwbGFjZShBYSwiICIpLGk9MCxvPWIubGVuZ3RoO2k8bztpKyspaj1qLnJlcGxhY2UoIiAiK2JbaV0rIiAiLAoiICIpO2UuY2xhc3NOYW1lPWMudHJpbShqKX1lbHNlIGUuY2xhc3NOYW1lPSIifXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihhLGIpe3ZhciBkPXR5cGVvZiBhLGY9dHlwZW9mIGI9PT0iYm9vbGVhbiI7aWYoYy5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oZSl7dmFyIGo9Yyh0aGlzKTtqLnRvZ2dsZUNsYXNzKGEuY2FsbCh0aGlzLGUsai5hdHRyKCJjbGFzcyIpLGIpLGIpfSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKGQ9PT0ic3RyaW5nIilmb3IodmFyIGUsaj0wLGk9Yyh0aGlzKSxvPWIsaz1hLnNwbGl0KGNhKTtlPWtbaisrXTspe289Zj9vOiFpLmhhc0NsYXNzKGUpO2lbbz8iYWRkQ2xhc3MiOiJyZW1vdmVDbGFzcyJdKGUpfWVsc2UgaWYoZD09PSJ1bmRlZmluZWQifHxkPT09ImJvb2xlYW4iKXt0aGlzLmNsYXNzTmFtZSYmYy5kYXRhKHRoaXMsIl9fY2xhc3NOYW1lX18iLHRoaXMuY2xhc3NOYW1lKTt0aGlzLmNsYXNzTmFtZT0KdGhpcy5jbGFzc05hbWV8fGE9PT1mYWxzZT8iIjpjLmRhdGEodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIn19KX0saGFzQ2xhc3M6ZnVuY3Rpb24oYSl7YT0iICIrYSsiICI7Zm9yKHZhciBiPTAsZD10aGlzLmxlbmd0aDtiPGQ7YisrKWlmKCgiICIrdGhpc1tiXS5jbGFzc05hbWUrIiAiKS5yZXBsYWNlKEFhLCIgIikuaW5kZXhPZihhKT4tMSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2V9LHZhbDpmdW5jdGlvbihhKXtpZihhPT09dyl7dmFyIGI9dGhpc1swXTtpZihiKXtpZihjLm5vZGVOYW1lKGIsIm9wdGlvbiIpKXJldHVybihiLmF0dHJpYnV0ZXMudmFsdWV8fHt9KS5zcGVjaWZpZWQ/Yi52YWx1ZTpiLnRleHQ7aWYoYy5ub2RlTmFtZShiLCJzZWxlY3QiKSl7dmFyIGQ9Yi5zZWxlY3RlZEluZGV4LGY9W10sZT1iLm9wdGlvbnM7Yj1iLnR5cGU9PT0ic2VsZWN0LW9uZSI7aWYoZDwwKXJldHVybiBudWxsO3ZhciBqPWI/ZDowO2ZvcihkPWI/ZCsxOmUubGVuZ3RoO2o8ZDtqKyspe3ZhciBpPQplW2pdO2lmKGkuc2VsZWN0ZWQpe2E9YyhpKS52YWwoKTtpZihiKXJldHVybiBhO2YucHVzaChhKX19cmV0dXJuIGZ9aWYoQmEudGVzdChiLnR5cGUpJiYhYy5zdXBwb3J0LmNoZWNrT24pcmV0dXJuIGIuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpPT09bnVsbD8ib24iOmIudmFsdWU7cmV0dXJuKGIudmFsdWV8fCIiKS5yZXBsYWNlKFphLCIiKX1yZXR1cm4gd312YXIgbz1jLmlzRnVuY3Rpb24oYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihrKXt2YXIgbj1jKHRoaXMpLHI9YTtpZih0aGlzLm5vZGVUeXBlPT09MSl7aWYobylyPWEuY2FsbCh0aGlzLGssbi52YWwoKSk7aWYodHlwZW9mIHI9PT0ibnVtYmVyIilyKz0iIjtpZihjLmlzQXJyYXkocikmJkJhLnRlc3QodGhpcy50eXBlKSl0aGlzLmNoZWNrZWQ9Yy5pbkFycmF5KG4udmFsKCkscik+PTA7ZWxzZSBpZihjLm5vZGVOYW1lKHRoaXMsInNlbGVjdCIpKXt2YXIgdT1jLm1ha2VBcnJheShyKTtjKCJvcHRpb24iLHRoaXMpLmVhY2goZnVuY3Rpb24oKXt0aGlzLnNlbGVjdGVkPQpjLmluQXJyYXkoYyh0aGlzKS52YWwoKSx1KT49MH0pO2lmKCF1Lmxlbmd0aCl0aGlzLnNlbGVjdGVkSW5kZXg9LTF9ZWxzZSB0aGlzLnZhbHVlPXJ9fSl9fSk7Yy5leHRlbmQoe2F0dHJGbjp7dmFsOnRydWUsY3NzOnRydWUsaHRtbDp0cnVlLHRleHQ6dHJ1ZSxkYXRhOnRydWUsd2lkdGg6dHJ1ZSxoZWlnaHQ6dHJ1ZSxvZmZzZXQ6dHJ1ZX0sYXR0cjpmdW5jdGlvbihhLGIsZCxmKXtpZighYXx8YS5ub2RlVHlwZT09PTN8fGEubm9kZVR5cGU9PT04KXJldHVybiB3O2lmKGYmJmIgaW4gYy5hdHRyRm4pcmV0dXJuIGMoYSlbYl0oZCk7Zj1hLm5vZGVUeXBlIT09MXx8IWMuaXNYTUxEb2MoYSk7dmFyIGU9ZCE9PXc7Yj1mJiZjLnByb3BzW2JdfHxiO2lmKGEubm9kZVR5cGU9PT0xKXt2YXIgaj0kYS50ZXN0KGIpO2lmKGIgaW4gYSYmZiYmIWope2lmKGUpe2I9PT0idHlwZSImJmFiLnRlc3QoYS5ub2RlTmFtZSkmJmEucGFyZW50Tm9kZSYmYy5lcnJvcigidHlwZSBwcm9wZXJ0eSBjYW4ndCBiZSBjaGFuZ2VkIik7CmFbYl09ZH1pZihjLm5vZGVOYW1lKGEsImZvcm0iKSYmYS5nZXRBdHRyaWJ1dGVOb2RlKGIpKXJldHVybiBhLmdldEF0dHJpYnV0ZU5vZGUoYikubm9kZVZhbHVlO2lmKGI9PT0idGFiSW5kZXgiKXJldHVybihiPWEuZ2V0QXR0cmlidXRlTm9kZSgidGFiSW5kZXgiKSkmJmIuc3BlY2lmaWVkP2IudmFsdWU6YmIudGVzdChhLm5vZGVOYW1lKXx8Y2IudGVzdChhLm5vZGVOYW1lKSYmYS5ocmVmPzA6dztyZXR1cm4gYVtiXX1pZighYy5zdXBwb3J0LnN0eWxlJiZmJiZiPT09InN0eWxlIil7aWYoZSlhLnN0eWxlLmNzc1RleHQ9IiIrZDtyZXR1cm4gYS5zdHlsZS5jc3NUZXh0fWUmJmEuc2V0QXR0cmlidXRlKGIsIiIrZCk7YT0hYy5zdXBwb3J0LmhyZWZOb3JtYWxpemVkJiZmJiZqP2EuZ2V0QXR0cmlidXRlKGIsMik6YS5nZXRBdHRyaWJ1dGUoYik7cmV0dXJuIGE9PT1udWxsP3c6YX1yZXR1cm4gYy5zdHlsZShhLGIsZCl9fSk7dmFyIE89L1wuKC4qKSQvLGRiPWZ1bmN0aW9uKGEpe3JldHVybiBhLnJlcGxhY2UoL1teXHdcc1wuXHxgXS9nLApmdW5jdGlvbihiKXtyZXR1cm4iXFwiK2J9KX07Yy5ldmVudD17YWRkOmZ1bmN0aW9uKGEsYixkLGYpe2lmKCEoYS5ub2RlVHlwZT09PTN8fGEubm9kZVR5cGU9PT04KSl7aWYoYS5zZXRJbnRlcnZhbCYmYSE9PUEmJiFhLmZyYW1lRWxlbWVudClhPUE7dmFyIGUsajtpZihkLmhhbmRsZXIpe2U9ZDtkPWUuaGFuZGxlcn1pZighZC5ndWlkKWQuZ3VpZD1jLmd1aWQrKztpZihqPWMuZGF0YShhKSl7dmFyIGk9ai5ldmVudHM9ai5ldmVudHN8fHt9LG89ai5oYW5kbGU7aWYoIW8pai5oYW5kbGU9bz1mdW5jdGlvbigpe3JldHVybiB0eXBlb2YgYyE9PSJ1bmRlZmluZWQiJiYhYy5ldmVudC50cmlnZ2VyZWQ/Yy5ldmVudC5oYW5kbGUuYXBwbHkoby5lbGVtLGFyZ3VtZW50cyk6d307by5lbGVtPWE7Yj1iLnNwbGl0KCIgIik7Zm9yKHZhciBrLG49MCxyO2s9YltuKytdOyl7aj1lP2MuZXh0ZW5kKHt9LGUpOntoYW5kbGVyOmQsZGF0YTpmfTtpZihrLmluZGV4T2YoIi4iKT4tMSl7cj1rLnNwbGl0KCIuIik7Cms9ci5zaGlmdCgpO2oubmFtZXNwYWNlPXIuc2xpY2UoMCkuc29ydCgpLmpvaW4oIi4iKX1lbHNle3I9W107ai5uYW1lc3BhY2U9IiJ9ai50eXBlPWs7ai5ndWlkPWQuZ3VpZDt2YXIgdT1pW2tdLHo9Yy5ldmVudC5zcGVjaWFsW2tdfHx7fTtpZighdSl7dT1pW2tdPVtdO2lmKCF6LnNldHVwfHx6LnNldHVwLmNhbGwoYSxmLHIsbyk9PT1mYWxzZSlpZihhLmFkZEV2ZW50TGlzdGVuZXIpYS5hZGRFdmVudExpc3RlbmVyKGssbyxmYWxzZSk7ZWxzZSBhLmF0dGFjaEV2ZW50JiZhLmF0dGFjaEV2ZW50KCJvbiIrayxvKX1pZih6LmFkZCl7ei5hZGQuY2FsbChhLGopO2lmKCFqLmhhbmRsZXIuZ3VpZClqLmhhbmRsZXIuZ3VpZD1kLmd1aWR9dS5wdXNoKGopO2MuZXZlbnQuZ2xvYmFsW2tdPXRydWV9YT1udWxsfX19LGdsb2JhbDp7fSxyZW1vdmU6ZnVuY3Rpb24oYSxiLGQsZil7aWYoIShhLm5vZGVUeXBlPT09M3x8YS5ub2RlVHlwZT09PTgpKXt2YXIgZSxqPTAsaSxvLGssbixyLHUsej1jLmRhdGEoYSksCkM9eiYmei5ldmVudHM7aWYoeiYmQyl7aWYoYiYmYi50eXBlKXtkPWIuaGFuZGxlcjtiPWIudHlwZX1pZighYnx8dHlwZW9mIGI9PT0ic3RyaW5nIiYmYi5jaGFyQXQoMCk9PT0iLiIpe2I9Ynx8IiI7Zm9yKGUgaW4gQyljLmV2ZW50LnJlbW92ZShhLGUrYil9ZWxzZXtmb3IoYj1iLnNwbGl0KCIgIik7ZT1iW2orK107KXtuPWU7aT1lLmluZGV4T2YoIi4iKTwwO289W107aWYoIWkpe289ZS5zcGxpdCgiLiIpO2U9by5zaGlmdCgpO2s9bmV3IFJlZ0V4cCgiKF58XFwuKSIrYy5tYXAoby5zbGljZSgwKS5zb3J0KCksZGIpLmpvaW4oIlxcLig/Oi4qXFwuKT8iKSsiKFxcLnwkKSIpfWlmKHI9Q1tlXSlpZihkKXtuPWMuZXZlbnQuc3BlY2lhbFtlXXx8e307Zm9yKEI9Znx8MDtCPHIubGVuZ3RoO0IrKyl7dT1yW0JdO2lmKGQuZ3VpZD09PXUuZ3VpZCl7aWYoaXx8ay50ZXN0KHUubmFtZXNwYWNlKSl7Zj09bnVsbCYmci5zcGxpY2UoQi0tLDEpO24ucmVtb3ZlJiZuLnJlbW92ZS5jYWxsKGEsdSl9aWYoZiE9Cm51bGwpYnJlYWt9fWlmKHIubGVuZ3RoPT09MHx8ZiE9bnVsbCYmci5sZW5ndGg9PT0xKXtpZighbi50ZWFyZG93bnx8bi50ZWFyZG93bi5jYWxsKGEsbyk9PT1mYWxzZSlDYShhLGUsei5oYW5kbGUpO2RlbGV0ZSBDW2VdfX1lbHNlIGZvcih2YXIgQj0wO0I8ci5sZW5ndGg7QisrKXt1PXJbQl07aWYoaXx8ay50ZXN0KHUubmFtZXNwYWNlKSl7Yy5ldmVudC5yZW1vdmUoYSxuLHUuaGFuZGxlcixCKTtyLnNwbGljZShCLS0sMSl9fX1pZihjLmlzRW1wdHlPYmplY3QoQykpe2lmKGI9ei5oYW5kbGUpYi5lbGVtPW51bGw7ZGVsZXRlIHouZXZlbnRzO2RlbGV0ZSB6LmhhbmRsZTtjLmlzRW1wdHlPYmplY3QoeikmJmMucmVtb3ZlRGF0YShhKX19fX19LHRyaWdnZXI6ZnVuY3Rpb24oYSxiLGQsZil7dmFyIGU9YS50eXBlfHxhO2lmKCFmKXthPXR5cGVvZiBhPT09Im9iamVjdCI/YVtHXT9hOmMuZXh0ZW5kKGMuRXZlbnQoZSksYSk6Yy5FdmVudChlKTtpZihlLmluZGV4T2YoIiEiKT49MCl7YS50eXBlPQplPWUuc2xpY2UoMCwtMSk7YS5leGNsdXNpdmU9dHJ1ZX1pZighZCl7YS5zdG9wUHJvcGFnYXRpb24oKTtjLmV2ZW50Lmdsb2JhbFtlXSYmYy5lYWNoKGMuY2FjaGUsZnVuY3Rpb24oKXt0aGlzLmV2ZW50cyYmdGhpcy5ldmVudHNbZV0mJmMuZXZlbnQudHJpZ2dlcihhLGIsdGhpcy5oYW5kbGUuZWxlbSl9KX1pZighZHx8ZC5ub2RlVHlwZT09PTN8fGQubm9kZVR5cGU9PT04KXJldHVybiB3O2EucmVzdWx0PXc7YS50YXJnZXQ9ZDtiPWMubWFrZUFycmF5KGIpO2IudW5zaGlmdChhKX1hLmN1cnJlbnRUYXJnZXQ9ZDsoZj1jLmRhdGEoZCwiaGFuZGxlIikpJiZmLmFwcGx5KGQsYik7Zj1kLnBhcmVudE5vZGV8fGQub3duZXJEb2N1bWVudDt0cnl7aWYoIShkJiZkLm5vZGVOYW1lJiZjLm5vRGF0YVtkLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSlpZihkWyJvbiIrZV0mJmRbIm9uIitlXS5hcHBseShkLGIpPT09ZmFsc2UpYS5yZXN1bHQ9ZmFsc2V9Y2F0Y2goail7fWlmKCFhLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkmJgpmKWMuZXZlbnQudHJpZ2dlcihhLGIsZix0cnVlKTtlbHNlIGlmKCFhLmlzRGVmYXVsdFByZXZlbnRlZCgpKXtmPWEudGFyZ2V0O3ZhciBpLG89Yy5ub2RlTmFtZShmLCJhIikmJmU9PT0iY2xpY2siLGs9Yy5ldmVudC5zcGVjaWFsW2VdfHx7fTtpZigoIWsuX2RlZmF1bHR8fGsuX2RlZmF1bHQuY2FsbChkLGEpPT09ZmFsc2UpJiYhbyYmIShmJiZmLm5vZGVOYW1lJiZjLm5vRGF0YVtmLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSl7dHJ5e2lmKGZbZV0pe2lmKGk9Zlsib24iK2VdKWZbIm9uIitlXT1udWxsO2MuZXZlbnQudHJpZ2dlcmVkPXRydWU7ZltlXSgpfX1jYXRjaChuKXt9aWYoaSlmWyJvbiIrZV09aTtjLmV2ZW50LnRyaWdnZXJlZD1mYWxzZX19fSxoYW5kbGU6ZnVuY3Rpb24oYSl7dmFyIGIsZCxmLGU7YT1hcmd1bWVudHNbMF09Yy5ldmVudC5maXgoYXx8QS5ldmVudCk7YS5jdXJyZW50VGFyZ2V0PXRoaXM7Yj1hLnR5cGUuaW5kZXhPZigiLiIpPDAmJiFhLmV4Y2x1c2l2ZTsKaWYoIWIpe2Q9YS50eXBlLnNwbGl0KCIuIik7YS50eXBlPWQuc2hpZnQoKTtmPW5ldyBSZWdFeHAoIihefFxcLikiK2Quc2xpY2UoMCkuc29ydCgpLmpvaW4oIlxcLig/Oi4qXFwuKT8iKSsiKFxcLnwkKSIpfWU9Yy5kYXRhKHRoaXMsImV2ZW50cyIpO2Q9ZVthLnR5cGVdO2lmKGUmJmQpe2Q9ZC5zbGljZSgwKTtlPTA7Zm9yKHZhciBqPWQubGVuZ3RoO2U8ajtlKyspe3ZhciBpPWRbZV07aWYoYnx8Zi50ZXN0KGkubmFtZXNwYWNlKSl7YS5oYW5kbGVyPWkuaGFuZGxlcjthLmRhdGE9aS5kYXRhO2EuaGFuZGxlT2JqPWk7aT1pLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKGkhPT13KXthLnJlc3VsdD1pO2lmKGk9PT1mYWxzZSl7YS5wcmV2ZW50RGVmYXVsdCgpO2Euc3RvcFByb3BhZ2F0aW9uKCl9fWlmKGEuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSlicmVha319fXJldHVybiBhLnJlc3VsdH0scHJvcHM6ImFsdEtleSBhdHRyQ2hhbmdlIGF0dHJOYW1lIGJ1YmJsZXMgYnV0dG9uIGNhbmNlbGFibGUgY2hhckNvZGUgY2xpZW50WCBjbGllbnRZIGN0cmxLZXkgY3VycmVudFRhcmdldCBkYXRhIGRldGFpbCBldmVudFBoYXNlIGZyb21FbGVtZW50IGhhbmRsZXIga2V5Q29kZSBsYXllclggbGF5ZXJZIG1ldGFLZXkgbmV3VmFsdWUgb2Zmc2V0WCBvZmZzZXRZIG9yaWdpbmFsVGFyZ2V0IHBhZ2VYIHBhZ2VZIHByZXZWYWx1ZSByZWxhdGVkTm9kZSByZWxhdGVkVGFyZ2V0IHNjcmVlblggc2NyZWVuWSBzaGlmdEtleSBzcmNFbGVtZW50IHRhcmdldCB0b0VsZW1lbnQgdmlldyB3aGVlbERlbHRhIHdoaWNoIi5zcGxpdCgiICIpLApmaXg6ZnVuY3Rpb24oYSl7aWYoYVtHXSlyZXR1cm4gYTt2YXIgYj1hO2E9Yy5FdmVudChiKTtmb3IodmFyIGQ9dGhpcy5wcm9wcy5sZW5ndGgsZjtkOyl7Zj10aGlzLnByb3BzWy0tZF07YVtmXT1iW2ZdfWlmKCFhLnRhcmdldClhLnRhcmdldD1hLnNyY0VsZW1lbnR8fHM7aWYoYS50YXJnZXQubm9kZVR5cGU9PT0zKWEudGFyZ2V0PWEudGFyZ2V0LnBhcmVudE5vZGU7aWYoIWEucmVsYXRlZFRhcmdldCYmYS5mcm9tRWxlbWVudClhLnJlbGF0ZWRUYXJnZXQ9YS5mcm9tRWxlbWVudD09PWEudGFyZ2V0P2EudG9FbGVtZW50OmEuZnJvbUVsZW1lbnQ7aWYoYS5wYWdlWD09bnVsbCYmYS5jbGllbnRYIT1udWxsKXtiPXMuZG9jdW1lbnRFbGVtZW50O2Q9cy5ib2R5O2EucGFnZVg9YS5jbGllbnRYKyhiJiZiLnNjcm9sbExlZnR8fGQmJmQuc2Nyb2xsTGVmdHx8MCktKGImJmIuY2xpZW50TGVmdHx8ZCYmZC5jbGllbnRMZWZ0fHwwKTthLnBhZ2VZPWEuY2xpZW50WSsoYiYmYi5zY3JvbGxUb3B8fApkJiZkLnNjcm9sbFRvcHx8MCktKGImJmIuY2xpZW50VG9wfHxkJiZkLmNsaWVudFRvcHx8MCl9aWYoIWEud2hpY2gmJihhLmNoYXJDb2RlfHxhLmNoYXJDb2RlPT09MD9hLmNoYXJDb2RlOmEua2V5Q29kZSkpYS53aGljaD1hLmNoYXJDb2RlfHxhLmtleUNvZGU7aWYoIWEubWV0YUtleSYmYS5jdHJsS2V5KWEubWV0YUtleT1hLmN0cmxLZXk7aWYoIWEud2hpY2gmJmEuYnV0dG9uIT09dylhLndoaWNoPWEuYnV0dG9uJjE/MTphLmJ1dHRvbiYyPzM6YS5idXR0b24mND8yOjA7cmV0dXJuIGF9LGd1aWQ6MUU4LHByb3h5OmMucHJveHksc3BlY2lhbDp7cmVhZHk6e3NldHVwOmMuYmluZFJlYWR5LHRlYXJkb3duOmMubm9vcH0sbGl2ZTp7YWRkOmZ1bmN0aW9uKGEpe2MuZXZlbnQuYWRkKHRoaXMsYS5vcmlnVHlwZSxjLmV4dGVuZCh7fSxhLHtoYW5kbGVyOm9hfSkpfSxyZW1vdmU6ZnVuY3Rpb24oYSl7dmFyIGI9dHJ1ZSxkPWEub3JpZ1R5cGUucmVwbGFjZShPLCIiKTtjLmVhY2goYy5kYXRhKHRoaXMsCiJldmVudHMiKS5saXZlfHxbXSxmdW5jdGlvbigpe2lmKGQ9PT10aGlzLm9yaWdUeXBlLnJlcGxhY2UoTywiIikpcmV0dXJuIGI9ZmFsc2V9KTtiJiZjLmV2ZW50LnJlbW92ZSh0aGlzLGEub3JpZ1R5cGUsb2EpfX0sYmVmb3JldW5sb2FkOntzZXR1cDpmdW5jdGlvbihhLGIsZCl7aWYodGhpcy5zZXRJbnRlcnZhbCl0aGlzLm9uYmVmb3JldW5sb2FkPWQ7cmV0dXJuIGZhbHNlfSx0ZWFyZG93bjpmdW5jdGlvbihhLGIpe2lmKHRoaXMub25iZWZvcmV1bmxvYWQ9PT1iKXRoaXMub25iZWZvcmV1bmxvYWQ9bnVsbH19fX07dmFyIENhPXMucmVtb3ZlRXZlbnRMaXN0ZW5lcj9mdW5jdGlvbihhLGIsZCl7YS5yZW1vdmVFdmVudExpc3RlbmVyKGIsZCxmYWxzZSl9OmZ1bmN0aW9uKGEsYixkKXthLmRldGFjaEV2ZW50KCJvbiIrYixkKX07Yy5FdmVudD1mdW5jdGlvbihhKXtpZighdGhpcy5wcmV2ZW50RGVmYXVsdClyZXR1cm4gbmV3IGMuRXZlbnQoYSk7aWYoYSYmYS50eXBlKXt0aGlzLm9yaWdpbmFsRXZlbnQ9CmE7dGhpcy50eXBlPWEudHlwZX1lbHNlIHRoaXMudHlwZT1hO3RoaXMudGltZVN0YW1wPUooKTt0aGlzW0ddPXRydWV9O2MuRXZlbnQucHJvdG90eXBlPXtwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPVo7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O2lmKGEpe2EucHJldmVudERlZmF1bHQmJmEucHJldmVudERlZmF1bHQoKTthLnJldHVyblZhbHVlPWZhbHNlfX0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1aO3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDtpZihhKXthLnN0b3BQcm9wYWdhdGlvbiYmYS5zdG9wUHJvcGFnYXRpb24oKTthLmNhbmNlbEJ1YmJsZT10cnVlfX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1aO3RoaXMuc3RvcFByb3BhZ2F0aW9uKCl9LGlzRGVmYXVsdFByZXZlbnRlZDpZLGlzUHJvcGFnYXRpb25TdG9wcGVkOlksCmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOll9O3ZhciBEYT1mdW5jdGlvbihhKXt2YXIgYj1hLnJlbGF0ZWRUYXJnZXQ7dHJ5e2Zvcig7YiYmYiE9PXRoaXM7KWI9Yi5wYXJlbnROb2RlO2lmKGIhPT10aGlzKXthLnR5cGU9YS5kYXRhO2MuZXZlbnQuaGFuZGxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19Y2F0Y2goZCl7fX0sRWE9ZnVuY3Rpb24oYSl7YS50eXBlPWEuZGF0YTtjLmV2ZW50LmhhbmRsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2MuZWFjaCh7bW91c2VlbnRlcjoibW91c2VvdmVyIixtb3VzZWxlYXZlOiJtb3VzZW91dCJ9LGZ1bmN0aW9uKGEsYil7Yy5ldmVudC5zcGVjaWFsW2FdPXtzZXR1cDpmdW5jdGlvbihkKXtjLmV2ZW50LmFkZCh0aGlzLGIsZCYmZC5zZWxlY3Rvcj9FYTpEYSxhKX0sdGVhcmRvd246ZnVuY3Rpb24oZCl7Yy5ldmVudC5yZW1vdmUodGhpcyxiLGQmJmQuc2VsZWN0b3I/RWE6RGEpfX19KTtpZighYy5zdXBwb3J0LnN1Ym1pdEJ1YmJsZXMpYy5ldmVudC5zcGVjaWFsLnN1Ym1pdD0Ke3NldHVwOmZ1bmN0aW9uKCl7aWYodGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIT09ImZvcm0iKXtjLmV2ZW50LmFkZCh0aGlzLCJjbGljay5zcGVjaWFsU3VibWl0IixmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldCxkPWIudHlwZTtpZigoZD09PSJzdWJtaXQifHxkPT09ImltYWdlIikmJmMoYikuY2xvc2VzdCgiZm9ybSIpLmxlbmd0aClyZXR1cm4gbmEoInN1Ym1pdCIsdGhpcyxhcmd1bWVudHMpfSk7Yy5ldmVudC5hZGQodGhpcywia2V5cHJlc3Muc3BlY2lhbFN1Ym1pdCIsZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsZD1iLnR5cGU7aWYoKGQ9PT0idGV4dCJ8fGQ9PT0icGFzc3dvcmQiKSYmYyhiKS5jbG9zZXN0KCJmb3JtIikubGVuZ3RoJiZhLmtleUNvZGU9PT0xMylyZXR1cm4gbmEoInN1Ym1pdCIsdGhpcyxhcmd1bWVudHMpfSl9ZWxzZSByZXR1cm4gZmFsc2V9LHRlYXJkb3duOmZ1bmN0aW9uKCl7Yy5ldmVudC5yZW1vdmUodGhpcywiLnNwZWNpYWxTdWJtaXQiKX19OwppZighYy5zdXBwb3J0LmNoYW5nZUJ1YmJsZXMpe3ZhciBkYT0vdGV4dGFyZWF8aW5wdXR8c2VsZWN0L2ksZWEsRmE9ZnVuY3Rpb24oYSl7dmFyIGI9YS50eXBlLGQ9YS52YWx1ZTtpZihiPT09InJhZGlvInx8Yj09PSJjaGVja2JveCIpZD1hLmNoZWNrZWQ7ZWxzZSBpZihiPT09InNlbGVjdC1tdWx0aXBsZSIpZD1hLnNlbGVjdGVkSW5kZXg+LTE/Yy5tYXAoYS5vcHRpb25zLGZ1bmN0aW9uKGYpe3JldHVybiBmLnNlbGVjdGVkfSkuam9pbigiLSIpOiIiO2Vsc2UgaWYoYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09InNlbGVjdCIpZD1hLnNlbGVjdGVkSW5kZXg7cmV0dXJuIGR9LGZhPWZ1bmN0aW9uKGEsYil7dmFyIGQ9YS50YXJnZXQsZixlO2lmKCEoIWRhLnRlc3QoZC5ub2RlTmFtZSl8fGQucmVhZE9ubHkpKXtmPWMuZGF0YShkLCJfY2hhbmdlX2RhdGEiKTtlPUZhKGQpO2lmKGEudHlwZSE9PSJmb2N1c291dCJ8fGQudHlwZSE9PSJyYWRpbyIpYy5kYXRhKGQsIl9jaGFuZ2VfZGF0YSIsCmUpO2lmKCEoZj09PXd8fGU9PT1mKSlpZihmIT1udWxsfHxlKXthLnR5cGU9ImNoYW5nZSI7cmV0dXJuIGMuZXZlbnQudHJpZ2dlcihhLGIsZCl9fX07Yy5ldmVudC5zcGVjaWFsLmNoYW5nZT17ZmlsdGVyczp7Zm9jdXNvdXQ6ZmEsY2xpY2s6ZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsZD1iLnR5cGU7aWYoZD09PSJyYWRpbyJ8fGQ9PT0iY2hlY2tib3gifHxiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT0ic2VsZWN0IilyZXR1cm4gZmEuY2FsbCh0aGlzLGEpfSxrZXlkb3duOmZ1bmN0aW9uKGEpe3ZhciBiPWEudGFyZ2V0LGQ9Yi50eXBlO2lmKGEua2V5Q29kZT09PTEzJiZiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkhPT0idGV4dGFyZWEifHxhLmtleUNvZGU9PT0zMiYmKGQ9PT0iY2hlY2tib3gifHxkPT09InJhZGlvIil8fGQ9PT0ic2VsZWN0LW11bHRpcGxlIilyZXR1cm4gZmEuY2FsbCh0aGlzLGEpfSxiZWZvcmVhY3RpdmF0ZTpmdW5jdGlvbihhKXthPWEudGFyZ2V0O2MuZGF0YShhLAoiX2NoYW5nZV9kYXRhIixGYShhKSl9fSxzZXR1cDpmdW5jdGlvbigpe2lmKHRoaXMudHlwZT09PSJmaWxlIilyZXR1cm4gZmFsc2U7Zm9yKHZhciBhIGluIGVhKWMuZXZlbnQuYWRkKHRoaXMsYSsiLnNwZWNpYWxDaGFuZ2UiLGVhW2FdKTtyZXR1cm4gZGEudGVzdCh0aGlzLm5vZGVOYW1lKX0sdGVhcmRvd246ZnVuY3Rpb24oKXtjLmV2ZW50LnJlbW92ZSh0aGlzLCIuc3BlY2lhbENoYW5nZSIpO3JldHVybiBkYS50ZXN0KHRoaXMubm9kZU5hbWUpfX07ZWE9Yy5ldmVudC5zcGVjaWFsLmNoYW5nZS5maWx0ZXJzfXMuYWRkRXZlbnRMaXN0ZW5lciYmYy5lYWNoKHtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQifSxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGQoZil7Zj1jLmV2ZW50LmZpeChmKTtmLnR5cGU9YjtyZXR1cm4gYy5ldmVudC5oYW5kbGUuY2FsbCh0aGlzLGYpfWMuZXZlbnQuc3BlY2lhbFtiXT17c2V0dXA6ZnVuY3Rpb24oKXt0aGlzLmFkZEV2ZW50TGlzdGVuZXIoYSwKZCx0cnVlKX0sdGVhcmRvd246ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxkLHRydWUpfX19KTtjLmVhY2goWyJiaW5kIiwib25lIl0sZnVuY3Rpb24oYSxiKXtjLmZuW2JdPWZ1bmN0aW9uKGQsZixlKXtpZih0eXBlb2YgZD09PSJvYmplY3QiKXtmb3IodmFyIGogaW4gZCl0aGlzW2JdKGosZixkW2pdLGUpO3JldHVybiB0aGlzfWlmKGMuaXNGdW5jdGlvbihmKSl7ZT1mO2Y9d312YXIgaT1iPT09Im9uZSI/Yy5wcm94eShlLGZ1bmN0aW9uKGspe2ModGhpcykudW5iaW5kKGssaSk7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSk6ZTtpZihkPT09InVubG9hZCImJmIhPT0ib25lIil0aGlzLm9uZShkLGYsZSk7ZWxzZXtqPTA7Zm9yKHZhciBvPXRoaXMubGVuZ3RoO2o8bztqKyspYy5ldmVudC5hZGQodGhpc1tqXSxkLGksZil9cmV0dXJuIHRoaXN9fSk7Yy5mbi5leHRlbmQoe3VuYmluZDpmdW5jdGlvbihhLGIpe2lmKHR5cGVvZiBhPT09Im9iamVjdCImJgohYS5wcmV2ZW50RGVmYXVsdClmb3IodmFyIGQgaW4gYSl0aGlzLnVuYmluZChkLGFbZF0pO2Vsc2V7ZD0wO2Zvcih2YXIgZj10aGlzLmxlbmd0aDtkPGY7ZCsrKWMuZXZlbnQucmVtb3ZlKHRoaXNbZF0sYSxiKX1yZXR1cm4gdGhpc30sZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGQsZil7cmV0dXJuIHRoaXMubGl2ZShiLGQsZixhKX0sdW5kZWxlZ2F0ZTpmdW5jdGlvbihhLGIsZCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg9PT0wP3RoaXMudW5iaW5kKCJsaXZlIik6dGhpcy5kaWUoYixudWxsLGQsYSl9LHRyaWdnZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yy5ldmVudC50cmlnZ2VyKGEsYix0aGlzKX0pfSx0cmlnZ2VySGFuZGxlcjpmdW5jdGlvbihhLGIpe2lmKHRoaXNbMF0pe2E9Yy5FdmVudChhKTthLnByZXZlbnREZWZhdWx0KCk7YS5zdG9wUHJvcGFnYXRpb24oKTtjLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXNbMF0pO3JldHVybiBhLnJlc3VsdH19LAp0b2dnbGU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWFyZ3VtZW50cyxkPTE7ZDxiLmxlbmd0aDspYy5wcm94eShhLGJbZCsrXSk7cmV0dXJuIHRoaXMuY2xpY2soYy5wcm94eShhLGZ1bmN0aW9uKGYpe3ZhciBlPShjLmRhdGEodGhpcywibGFzdFRvZ2dsZSIrYS5ndWlkKXx8MCklZDtjLmRhdGEodGhpcywibGFzdFRvZ2dsZSIrYS5ndWlkLGUrMSk7Zi5wcmV2ZW50RGVmYXVsdCgpO3JldHVybiBiW2VdLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8ZmFsc2V9KSl9LGhvdmVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMubW91c2VlbnRlcihhKS5tb3VzZWxlYXZlKGJ8fGEpfX0pO3ZhciBHYT17Zm9jdXM6ImZvY3VzaW4iLGJsdXI6ImZvY3Vzb3V0Iixtb3VzZWVudGVyOiJtb3VzZW92ZXIiLG1vdXNlbGVhdmU6Im1vdXNlb3V0In07Yy5lYWNoKFsibGl2ZSIsImRpZSJdLGZ1bmN0aW9uKGEsYil7Yy5mbltiXT1mdW5jdGlvbihkLGYsZSxqKXt2YXIgaSxvPTAsayxuLHI9anx8dGhpcy5zZWxlY3RvciwKdT1qP3RoaXM6Yyh0aGlzLmNvbnRleHQpO2lmKGMuaXNGdW5jdGlvbihmKSl7ZT1mO2Y9d31mb3IoZD0oZHx8IiIpLnNwbGl0KCIgIik7KGk9ZFtvKytdKSE9bnVsbDspe2o9Ty5leGVjKGkpO2s9IiI7aWYoail7az1qWzBdO2k9aS5yZXBsYWNlKE8sIiIpfWlmKGk9PT0iaG92ZXIiKWQucHVzaCgibW91c2VlbnRlciIraywibW91c2VsZWF2ZSIrayk7ZWxzZXtuPWk7aWYoaT09PSJmb2N1cyJ8fGk9PT0iYmx1ciIpe2QucHVzaChHYVtpXStrKTtpKz1rfWVsc2UgaT0oR2FbaV18fGkpK2s7Yj09PSJsaXZlIj91LmVhY2goZnVuY3Rpb24oKXtjLmV2ZW50LmFkZCh0aGlzLHBhKGkscikse2RhdGE6ZixzZWxlY3RvcjpyLGhhbmRsZXI6ZSxvcmlnVHlwZTppLG9yaWdIYW5kbGVyOmUscHJlVHlwZTpufSl9KTp1LnVuYmluZChwYShpLHIpLGUpfX1yZXR1cm4gdGhpc319KTtjLmVhY2goImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIGNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IiLnNwbGl0KCIgIiksCmZ1bmN0aW9uKGEsYil7Yy5mbltiXT1mdW5jdGlvbihkKXtyZXR1cm4gZD90aGlzLmJpbmQoYixkKTp0aGlzLnRyaWdnZXIoYil9O2lmKGMuYXR0ckZuKWMuYXR0ckZuW2JdPXRydWV9KTtBLmF0dGFjaEV2ZW50JiYhQS5hZGRFdmVudExpc3RlbmVyJiZBLmF0dGFjaEV2ZW50KCJvbnVubG9hZCIsZnVuY3Rpb24oKXtmb3IodmFyIGEgaW4gYy5jYWNoZSlpZihjLmNhY2hlW2FdLmhhbmRsZSl0cnl7Yy5ldmVudC5yZW1vdmUoYy5jYWNoZVthXS5oYW5kbGUuZWxlbSl9Y2F0Y2goYil7fX0pOyhmdW5jdGlvbigpe2Z1bmN0aW9uIGEoZyl7Zm9yKHZhciBoPSIiLGwsbT0wO2dbbV07bSsrKXtsPWdbbV07aWYobC5ub2RlVHlwZT09PTN8fGwubm9kZVR5cGU9PT00KWgrPWwubm9kZVZhbHVlO2Vsc2UgaWYobC5ub2RlVHlwZSE9PTgpaCs9YShsLmNoaWxkTm9kZXMpfXJldHVybiBofWZ1bmN0aW9uIGIoZyxoLGwsbSxxLHApe3E9MDtmb3IodmFyIHY9bS5sZW5ndGg7cTx2O3ErKyl7dmFyIHQ9bVtxXTsKaWYodCl7dD10W2ddO2Zvcih2YXIgeT1mYWxzZTt0Oyl7aWYodC5zaXpjYWNoZT09PWwpe3k9bVt0LnNpenNldF07YnJlYWt9aWYodC5ub2RlVHlwZT09PTEmJiFwKXt0LnNpemNhY2hlPWw7dC5zaXpzZXQ9cX1pZih0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1oKXt5PXQ7YnJlYWt9dD10W2ddfW1bcV09eX19fWZ1bmN0aW9uIGQoZyxoLGwsbSxxLHApe3E9MDtmb3IodmFyIHY9bS5sZW5ndGg7cTx2O3ErKyl7dmFyIHQ9bVtxXTtpZih0KXt0PXRbZ107Zm9yKHZhciB5PWZhbHNlO3Q7KXtpZih0LnNpemNhY2hlPT09bCl7eT1tW3Quc2l6c2V0XTticmVha31pZih0Lm5vZGVUeXBlPT09MSl7aWYoIXApe3Quc2l6Y2FjaGU9bDt0LnNpenNldD1xfWlmKHR5cGVvZiBoIT09InN0cmluZyIpe2lmKHQ9PT1oKXt5PXRydWU7YnJlYWt9fWVsc2UgaWYoay5maWx0ZXIoaCxbdF0pLmxlbmd0aD4wKXt5PXQ7YnJlYWt9fXQ9dFtnXX1tW3FdPXl9fX12YXIgZj0vKCg/OlwoKD86XChbXigpXStcKXxbXigpXSspK1wpfFxbKD86XFtbXltcXV0qXF18WyciXVteJyJdKlsnIl18W15bXF0nIl0rKStcXXxcXC58W14gPit+LChcW1xcXSspK3xbPit+XSkoXHMqLFxzKik/KCg/Oi58XHJ8XG4pKikvZywKZT0wLGo9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxpPWZhbHNlLG89dHJ1ZTtbMCwwXS5zb3J0KGZ1bmN0aW9uKCl7bz1mYWxzZTtyZXR1cm4gMH0pO3ZhciBrPWZ1bmN0aW9uKGcsaCxsLG0pe2w9bHx8W107dmFyIHE9aD1ofHxzO2lmKGgubm9kZVR5cGUhPT0xJiZoLm5vZGVUeXBlIT09OSlyZXR1cm5bXTtpZighZ3x8dHlwZW9mIGchPT0ic3RyaW5nIilyZXR1cm4gbDtmb3IodmFyIHA9W10sdix0LHksUyxIPXRydWUsTT14KGgpLEk9ZzsoZi5leGVjKCIiKSx2PWYuZXhlYyhJKSkhPT1udWxsOyl7ST12WzNdO3AucHVzaCh2WzFdKTtpZih2WzJdKXtTPXZbM107YnJlYWt9fWlmKHAubGVuZ3RoPjEmJnIuZXhlYyhnKSlpZihwLmxlbmd0aD09PTImJm4ucmVsYXRpdmVbcFswXV0pdD1nYShwWzBdK3BbMV0saCk7ZWxzZSBmb3IodD1uLnJlbGF0aXZlW3BbMF1dP1toXTprKHAuc2hpZnQoKSxoKTtwLmxlbmd0aDspe2c9cC5zaGlmdCgpO2lmKG4ucmVsYXRpdmVbZ10pZys9cC5zaGlmdCgpOwp0PWdhKGcsdCl9ZWxzZXtpZighbSYmcC5sZW5ndGg+MSYmaC5ub2RlVHlwZT09PTkmJiFNJiZuLm1hdGNoLklELnRlc3QocFswXSkmJiFuLm1hdGNoLklELnRlc3QocFtwLmxlbmd0aC0xXSkpe3Y9ay5maW5kKHAuc2hpZnQoKSxoLE0pO2g9di5leHByP2suZmlsdGVyKHYuZXhwcix2LnNldClbMF06di5zZXRbMF19aWYoaCl7dj1tP3tleHByOnAucG9wKCksc2V0OnoobSl9OmsuZmluZChwLnBvcCgpLHAubGVuZ3RoPT09MSYmKHBbMF09PT0ifiJ8fHBbMF09PT0iKyIpJiZoLnBhcmVudE5vZGU/aC5wYXJlbnROb2RlOmgsTSk7dD12LmV4cHI/ay5maWx0ZXIodi5leHByLHYuc2V0KTp2LnNldDtpZihwLmxlbmd0aD4wKXk9eih0KTtlbHNlIEg9ZmFsc2U7Zm9yKDtwLmxlbmd0aDspe3ZhciBEPXAucG9wKCk7dj1EO2lmKG4ucmVsYXRpdmVbRF0pdj1wLnBvcCgpO2Vsc2UgRD0iIjtpZih2PT1udWxsKXY9aDtuLnJlbGF0aXZlW0RdKHksdixNKX19ZWxzZSB5PVtdfXl8fCh5PXQpO3l8fGsuZXJyb3IoRHx8CmcpO2lmKGouY2FsbCh5KT09PSJbb2JqZWN0IEFycmF5XSIpaWYoSClpZihoJiZoLm5vZGVUeXBlPT09MSlmb3IoZz0wO3lbZ10hPW51bGw7ZysrKXtpZih5W2ddJiYoeVtnXT09PXRydWV8fHlbZ10ubm9kZVR5cGU9PT0xJiZFKGgseVtnXSkpKWwucHVzaCh0W2ddKX1lbHNlIGZvcihnPTA7eVtnXSE9bnVsbDtnKyspeVtnXSYmeVtnXS5ub2RlVHlwZT09PTEmJmwucHVzaCh0W2ddKTtlbHNlIGwucHVzaC5hcHBseShsLHkpO2Vsc2Ugeih5LGwpO2lmKFMpe2soUyxxLGwsbSk7ay51bmlxdWVTb3J0KGwpfXJldHVybiBsfTtrLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oZyl7aWYoQil7aT1vO2cuc29ydChCKTtpZihpKWZvcih2YXIgaD0xO2g8Zy5sZW5ndGg7aCsrKWdbaF09PT1nW2gtMV0mJmcuc3BsaWNlKGgtLSwxKX1yZXR1cm4gZ307ay5tYXRjaGVzPWZ1bmN0aW9uKGcsaCl7cmV0dXJuIGsoZyxudWxsLG51bGwsaCl9O2suZmluZD1mdW5jdGlvbihnLGgsbCl7dmFyIG0scTtpZighZylyZXR1cm5bXTsKZm9yKHZhciBwPTAsdj1uLm9yZGVyLmxlbmd0aDtwPHY7cCsrKXt2YXIgdD1uLm9yZGVyW3BdO2lmKHE9bi5sZWZ0TWF0Y2hbdF0uZXhlYyhnKSl7dmFyIHk9cVsxXTtxLnNwbGljZSgxLDEpO2lmKHkuc3Vic3RyKHkubGVuZ3RoLTEpIT09IlxcIil7cVsxXT0ocVsxXXx8IiIpLnJlcGxhY2UoL1xcL2csIiIpO209bi5maW5kW3RdKHEsaCxsKTtpZihtIT1udWxsKXtnPWcucmVwbGFjZShuLm1hdGNoW3RdLCIiKTticmVha319fX1tfHwobT1oLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpO3JldHVybntzZXQ6bSxleHByOmd9fTtrLmZpbHRlcj1mdW5jdGlvbihnLGgsbCxtKXtmb3IodmFyIHE9ZyxwPVtdLHY9aCx0LHksUz1oJiZoWzBdJiZ4KGhbMF0pO2cmJmgubGVuZ3RoOyl7Zm9yKHZhciBIIGluIG4uZmlsdGVyKWlmKCh0PW4ubGVmdE1hdGNoW0hdLmV4ZWMoZykpIT1udWxsJiZ0WzJdKXt2YXIgTT1uLmZpbHRlcltIXSxJLEQ7RD10WzFdO3k9ZmFsc2U7dC5zcGxpY2UoMSwxKTtpZihELnN1YnN0cihELmxlbmd0aC0KMSkhPT0iXFwiKXtpZih2PT09cClwPVtdO2lmKG4ucHJlRmlsdGVyW0hdKWlmKHQ9bi5wcmVGaWx0ZXJbSF0odCx2LGwscCxtLFMpKXtpZih0PT09dHJ1ZSljb250aW51ZX1lbHNlIHk9ST10cnVlO2lmKHQpZm9yKHZhciBVPTA7KEQ9dltVXSkhPW51bGw7VSsrKWlmKEQpe0k9TShELHQsVSx2KTt2YXIgSGE9bV4hIUk7aWYobCYmSSE9bnVsbClpZihIYSl5PXRydWU7ZWxzZSB2W1VdPWZhbHNlO2Vsc2UgaWYoSGEpe3AucHVzaChEKTt5PXRydWV9fWlmKEkhPT13KXtsfHwodj1wKTtnPWcucmVwbGFjZShuLm1hdGNoW0hdLCIiKTtpZigheSlyZXR1cm5bXTticmVha319fWlmKGc9PT1xKWlmKHk9PW51bGwpay5lcnJvcihnKTtlbHNlIGJyZWFrO3E9Z31yZXR1cm4gdn07ay5lcnJvcj1mdW5jdGlvbihnKXt0aHJvdyJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiK2c7fTt2YXIgbj1rLnNlbGVjdG9ycz17b3JkZXI6WyJJRCIsIk5BTUUiLCJUQUciXSxtYXRjaDp7SUQ6LyMoKD86W1x3XHUwMGMwLVx1RkZGRi1dfFxcLikrKS8sCkNMQVNTOi9cLigoPzpbXHdcdTAwYzAtXHVGRkZGLV18XFwuKSspLyxOQU1FOi9cW25hbWU9WyciXSooKD86W1x3XHUwMGMwLVx1RkZGRi1dfFxcLikrKVsnIl0qXF0vLEFUVFI6L1xbXHMqKCg/Oltcd1x1MDBjMC1cdUZGRkYtXXxcXC4pKylccyooPzooXFM/PSlccyooWyciXSopKC4qPylcM3wpXHMqXF0vLFRBRzovXigoPzpbXHdcdTAwYzAtXHVGRkZGXCotXXxcXC4pKykvLENISUxEOi86KG9ubHl8bnRofGxhc3R8Zmlyc3QpLWNoaWxkKD86XCgoZXZlbnxvZGR8W1xkbistXSopXCkpPy8sUE9TOi86KG50aHxlcXxndHxsdHxmaXJzdHxsYXN0fGV2ZW58b2RkKSg/OlwoKFxkKilcKSk/KD89W14tXXwkKS8sUFNFVURPOi86KCg/Oltcd1x1MDBjMC1cdUZGRkYtXXxcXC4pKykoPzpcKChbJyJdPykoKD86XChbXlwpXStcKXxbXlwoXCldKikrKVwyXCkpPy99LGxlZnRNYXRjaDp7fSxhdHRyTWFwOnsiY2xhc3MiOiJjbGFzc05hbWUiLCJmb3IiOiJodG1sRm9yIn0sYXR0ckhhbmRsZTp7aHJlZjpmdW5jdGlvbihnKXtyZXR1cm4gZy5nZXRBdHRyaWJ1dGUoImhyZWYiKX19LApyZWxhdGl2ZTp7IisiOmZ1bmN0aW9uKGcsaCl7dmFyIGw9dHlwZW9mIGg9PT0ic3RyaW5nIixtPWwmJiEvXFcvLnRlc3QoaCk7bD1sJiYhbTtpZihtKWg9aC50b0xvd2VyQ2FzZSgpO209MDtmb3IodmFyIHE9Zy5sZW5ndGgscDttPHE7bSsrKWlmKHA9Z1ttXSl7Zm9yKDsocD1wLnByZXZpb3VzU2libGluZykmJnAubm9kZVR5cGUhPT0xOyk7Z1ttXT1sfHxwJiZwLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1oP3B8fGZhbHNlOnA9PT1ofWwmJmsuZmlsdGVyKGgsZyx0cnVlKX0sIj4iOmZ1bmN0aW9uKGcsaCl7dmFyIGw9dHlwZW9mIGg9PT0ic3RyaW5nIjtpZihsJiYhL1xXLy50ZXN0KGgpKXtoPWgudG9Mb3dlckNhc2UoKTtmb3IodmFyIG09MCxxPWcubGVuZ3RoO208cTttKyspe3ZhciBwPWdbbV07aWYocCl7bD1wLnBhcmVudE5vZGU7Z1ttXT1sLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1oP2w6ZmFsc2V9fX1lbHNle209MDtmb3IocT1nLmxlbmd0aDttPHE7bSsrKWlmKHA9Z1ttXSlnW21dPQpsP3AucGFyZW50Tm9kZTpwLnBhcmVudE5vZGU9PT1oO2wmJmsuZmlsdGVyKGgsZyx0cnVlKX19LCIiOmZ1bmN0aW9uKGcsaCxsKXt2YXIgbT1lKysscT1kO2lmKHR5cGVvZiBoPT09InN0cmluZyImJiEvXFcvLnRlc3QoaCkpe3ZhciBwPWg9aC50b0xvd2VyQ2FzZSgpO3E9Yn1xKCJwYXJlbnROb2RlIixoLG0sZyxwLGwpfSwifiI6ZnVuY3Rpb24oZyxoLGwpe3ZhciBtPWUrKyxxPWQ7aWYodHlwZW9mIGg9PT0ic3RyaW5nIiYmIS9cVy8udGVzdChoKSl7dmFyIHA9aD1oLnRvTG93ZXJDYXNlKCk7cT1ifXEoInByZXZpb3VzU2libGluZyIsaCxtLGcscCxsKX19LGZpbmQ6e0lEOmZ1bmN0aW9uKGcsaCxsKXtpZih0eXBlb2YgaC5nZXRFbGVtZW50QnlJZCE9PSJ1bmRlZmluZWQiJiYhbClyZXR1cm4oZz1oLmdldEVsZW1lbnRCeUlkKGdbMV0pKT9bZ106W119LE5BTUU6ZnVuY3Rpb24oZyxoKXtpZih0eXBlb2YgaC5nZXRFbGVtZW50c0J5TmFtZSE9PSJ1bmRlZmluZWQiKXt2YXIgbD1bXTsKaD1oLmdldEVsZW1lbnRzQnlOYW1lKGdbMV0pO2Zvcih2YXIgbT0wLHE9aC5sZW5ndGg7bTxxO20rKyloW21dLmdldEF0dHJpYnV0ZSgibmFtZSIpPT09Z1sxXSYmbC5wdXNoKGhbbV0pO3JldHVybiBsLmxlbmd0aD09PTA/bnVsbDpsfX0sVEFHOmZ1bmN0aW9uKGcsaCl7cmV0dXJuIGguZ2V0RWxlbWVudHNCeVRhZ05hbWUoZ1sxXSl9fSxwcmVGaWx0ZXI6e0NMQVNTOmZ1bmN0aW9uKGcsaCxsLG0scSxwKXtnPSIgIitnWzFdLnJlcGxhY2UoL1xcL2csIiIpKyIgIjtpZihwKXJldHVybiBnO3A9MDtmb3IodmFyIHY7KHY9aFtwXSkhPW51bGw7cCsrKWlmKHYpaWYocV4odi5jbGFzc05hbWUmJigiICIrdi5jbGFzc05hbWUrIiAiKS5yZXBsYWNlKC9bXHRcbl0vZywiICIpLmluZGV4T2YoZyk+PTApKWx8fG0ucHVzaCh2KTtlbHNlIGlmKGwpaFtwXT1mYWxzZTtyZXR1cm4gZmFsc2V9LElEOmZ1bmN0aW9uKGcpe3JldHVybiBnWzFdLnJlcGxhY2UoL1xcL2csIiIpfSxUQUc6ZnVuY3Rpb24oZyl7cmV0dXJuIGdbMV0udG9Mb3dlckNhc2UoKX0sCkNISUxEOmZ1bmN0aW9uKGcpe2lmKGdbMV09PT0ibnRoIil7dmFyIGg9LygtPykoXGQqKW4oKD86XCt8LSk/XGQqKS8uZXhlYyhnWzJdPT09ImV2ZW4iJiYiMm4ifHxnWzJdPT09Im9kZCImJiIybisxInx8IS9cRC8udGVzdChnWzJdKSYmIjBuKyIrZ1syXXx8Z1syXSk7Z1syXT1oWzFdKyhoWzJdfHwxKS0wO2dbM109aFszXS0wfWdbMF09ZSsrO3JldHVybiBnfSxBVFRSOmZ1bmN0aW9uKGcsaCxsLG0scSxwKXtoPWdbMV0ucmVwbGFjZSgvXFwvZywiIik7aWYoIXAmJm4uYXR0ck1hcFtoXSlnWzFdPW4uYXR0ck1hcFtoXTtpZihnWzJdPT09In49IilnWzRdPSIgIitnWzRdKyIgIjtyZXR1cm4gZ30sUFNFVURPOmZ1bmN0aW9uKGcsaCxsLG0scSl7aWYoZ1sxXT09PSJub3QiKWlmKChmLmV4ZWMoZ1szXSl8fCIiKS5sZW5ndGg+MXx8L15cdy8udGVzdChnWzNdKSlnWzNdPWsoZ1szXSxudWxsLG51bGwsaCk7ZWxzZXtnPWsuZmlsdGVyKGdbM10saCxsLHRydWVecSk7bHx8bS5wdXNoLmFwcGx5KG0sCmcpO3JldHVybiBmYWxzZX1lbHNlIGlmKG4ubWF0Y2guUE9TLnRlc3QoZ1swXSl8fG4ubWF0Y2guQ0hJTEQudGVzdChnWzBdKSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZ30sUE9TOmZ1bmN0aW9uKGcpe2cudW5zaGlmdCh0cnVlKTtyZXR1cm4gZ319LGZpbHRlcnM6e2VuYWJsZWQ6ZnVuY3Rpb24oZyl7cmV0dXJuIGcuZGlzYWJsZWQ9PT1mYWxzZSYmZy50eXBlIT09ImhpZGRlbiJ9LGRpc2FibGVkOmZ1bmN0aW9uKGcpe3JldHVybiBnLmRpc2FibGVkPT09dHJ1ZX0sY2hlY2tlZDpmdW5jdGlvbihnKXtyZXR1cm4gZy5jaGVja2VkPT09dHJ1ZX0sc2VsZWN0ZWQ6ZnVuY3Rpb24oZyl7cmV0dXJuIGcuc2VsZWN0ZWQ9PT10cnVlfSxwYXJlbnQ6ZnVuY3Rpb24oZyl7cmV0dXJuISFnLmZpcnN0Q2hpbGR9LGVtcHR5OmZ1bmN0aW9uKGcpe3JldHVybiFnLmZpcnN0Q2hpbGR9LGhhczpmdW5jdGlvbihnLGgsbCl7cmV0dXJuISFrKGxbM10sZykubGVuZ3RofSxoZWFkZXI6ZnVuY3Rpb24oZyl7cmV0dXJuL2hcZC9pLnRlc3QoZy5ub2RlTmFtZSl9LAp0ZXh0OmZ1bmN0aW9uKGcpe3JldHVybiJ0ZXh0Ij09PWcudHlwZX0scmFkaW86ZnVuY3Rpb24oZyl7cmV0dXJuInJhZGlvIj09PWcudHlwZX0sY2hlY2tib3g6ZnVuY3Rpb24oZyl7cmV0dXJuImNoZWNrYm94Ij09PWcudHlwZX0sZmlsZTpmdW5jdGlvbihnKXtyZXR1cm4iZmlsZSI9PT1nLnR5cGV9LHBhc3N3b3JkOmZ1bmN0aW9uKGcpe3JldHVybiJwYXNzd29yZCI9PT1nLnR5cGV9LHN1Ym1pdDpmdW5jdGlvbihnKXtyZXR1cm4ic3VibWl0Ij09PWcudHlwZX0saW1hZ2U6ZnVuY3Rpb24oZyl7cmV0dXJuImltYWdlIj09PWcudHlwZX0scmVzZXQ6ZnVuY3Rpb24oZyl7cmV0dXJuInJlc2V0Ij09PWcudHlwZX0sYnV0dG9uOmZ1bmN0aW9uKGcpe3JldHVybiJidXR0b24iPT09Zy50eXBlfHxnLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT0iYnV0dG9uIn0saW5wdXQ6ZnVuY3Rpb24oZyl7cmV0dXJuL2lucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24vaS50ZXN0KGcubm9kZU5hbWUpfX0sCnNldEZpbHRlcnM6e2ZpcnN0OmZ1bmN0aW9uKGcsaCl7cmV0dXJuIGg9PT0wfSxsYXN0OmZ1bmN0aW9uKGcsaCxsLG0pe3JldHVybiBoPT09bS5sZW5ndGgtMX0sZXZlbjpmdW5jdGlvbihnLGgpe3JldHVybiBoJTI9PT0wfSxvZGQ6ZnVuY3Rpb24oZyxoKXtyZXR1cm4gaCUyPT09MX0sbHQ6ZnVuY3Rpb24oZyxoLGwpe3JldHVybiBoPGxbM10tMH0sZ3Q6ZnVuY3Rpb24oZyxoLGwpe3JldHVybiBoPmxbM10tMH0sbnRoOmZ1bmN0aW9uKGcsaCxsKXtyZXR1cm4gbFszXS0wPT09aH0sZXE6ZnVuY3Rpb24oZyxoLGwpe3JldHVybiBsWzNdLTA9PT1ofX0sZmlsdGVyOntQU0VVRE86ZnVuY3Rpb24oZyxoLGwsbSl7dmFyIHE9aFsxXSxwPW4uZmlsdGVyc1txXTtpZihwKXJldHVybiBwKGcsbCxoLG0pO2Vsc2UgaWYocT09PSJjb250YWlucyIpcmV0dXJuKGcudGV4dENvbnRlbnR8fGcuaW5uZXJUZXh0fHxhKFtnXSl8fCIiKS5pbmRleE9mKGhbM10pPj0wO2Vsc2UgaWYocT09PSJub3QiKXtoPQpoWzNdO2w9MDtmb3IobT1oLmxlbmd0aDtsPG07bCsrKWlmKGhbbF09PT1nKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZX1lbHNlIGsuZXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrcSl9LENISUxEOmZ1bmN0aW9uKGcsaCl7dmFyIGw9aFsxXSxtPWc7c3dpdGNoKGwpe2Nhc2UgIm9ubHkiOmNhc2UgImZpcnN0Ijpmb3IoO209bS5wcmV2aW91c1NpYmxpbmc7KWlmKG0ubm9kZVR5cGU9PT0xKXJldHVybiBmYWxzZTtpZihsPT09ImZpcnN0IilyZXR1cm4gdHJ1ZTttPWc7Y2FzZSAibGFzdCI6Zm9yKDttPW0ubmV4dFNpYmxpbmc7KWlmKG0ubm9kZVR5cGU9PT0xKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZTtjYXNlICJudGgiOmw9aFsyXTt2YXIgcT1oWzNdO2lmKGw9PT0xJiZxPT09MClyZXR1cm4gdHJ1ZTtoPWhbMF07dmFyIHA9Zy5wYXJlbnROb2RlO2lmKHAmJihwLnNpemNhY2hlIT09aHx8IWcubm9kZUluZGV4KSl7dmFyIHY9MDtmb3IobT1wLmZpcnN0Q2hpbGQ7bTttPQptLm5leHRTaWJsaW5nKWlmKG0ubm9kZVR5cGU9PT0xKW0ubm9kZUluZGV4PSsrdjtwLnNpemNhY2hlPWh9Zz1nLm5vZGVJbmRleC1xO3JldHVybiBsPT09MD9nPT09MDpnJWw9PT0wJiZnL2w+PTB9fSxJRDpmdW5jdGlvbihnLGgpe3JldHVybiBnLm5vZGVUeXBlPT09MSYmZy5nZXRBdHRyaWJ1dGUoImlkIik9PT1ofSxUQUc6ZnVuY3Rpb24oZyxoKXtyZXR1cm4gaD09PSIqIiYmZy5ub2RlVHlwZT09PTF8fGcubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWh9LENMQVNTOmZ1bmN0aW9uKGcsaCl7cmV0dXJuKCIgIisoZy5jbGFzc05hbWV8fGcuZ2V0QXR0cmlidXRlKCJjbGFzcyIpKSsiICIpLmluZGV4T2YoaCk+LTF9LEFUVFI6ZnVuY3Rpb24oZyxoKXt2YXIgbD1oWzFdO2c9bi5hdHRySGFuZGxlW2xdP24uYXR0ckhhbmRsZVtsXShnKTpnW2xdIT1udWxsP2dbbF06Zy5nZXRBdHRyaWJ1dGUobCk7bD1nKyIiO3ZhciBtPWhbMl07aD1oWzRdO3JldHVybiBnPT1udWxsP209PT0iIT0iOm09PT0KIj0iP2w9PT1oOm09PT0iKj0iP2wuaW5kZXhPZihoKT49MDptPT09In49Ij8oIiAiK2wrIiAiKS5pbmRleE9mKGgpPj0wOiFoP2wmJmchPT1mYWxzZTptPT09IiE9Ij9sIT09aDptPT09Il49Ij9sLmluZGV4T2YoaCk9PT0wOm09PT0iJD0iP2wuc3Vic3RyKGwubGVuZ3RoLWgubGVuZ3RoKT09PWg6bT09PSJ8PSI/bD09PWh8fGwuc3Vic3RyKDAsaC5sZW5ndGgrMSk9PT1oKyItIjpmYWxzZX0sUE9TOmZ1bmN0aW9uKGcsaCxsLG0pe3ZhciBxPW4uc2V0RmlsdGVyc1toWzJdXTtpZihxKXJldHVybiBxKGcsbCxoLG0pfX19LHI9bi5tYXRjaC5QT1M7Zm9yKHZhciB1IGluIG4ubWF0Y2gpe24ubWF0Y2hbdV09bmV3IFJlZ0V4cChuLm1hdGNoW3VdLnNvdXJjZSsvKD8hW15cW10qXF0pKD8hW15cKF0qXCkpLy5zb3VyY2UpO24ubGVmdE1hdGNoW3VdPW5ldyBSZWdFeHAoLyheKD86LnxccnxcbikqPykvLnNvdXJjZStuLm1hdGNoW3VdLnNvdXJjZS5yZXBsYWNlKC9cXChcZCspL2csZnVuY3Rpb24oZywKaCl7cmV0dXJuIlxcIisoaC0wKzEpfSkpfXZhciB6PWZ1bmN0aW9uKGcsaCl7Zz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChnLDApO2lmKGgpe2gucHVzaC5hcHBseShoLGcpO3JldHVybiBofXJldHVybiBnfTt0cnl7QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwocy5kb2N1bWVudEVsZW1lbnQuY2hpbGROb2RlcywwKX1jYXRjaChDKXt6PWZ1bmN0aW9uKGcsaCl7aD1ofHxbXTtpZihqLmNhbGwoZyk9PT0iW29iamVjdCBBcnJheV0iKUFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGgsZyk7ZWxzZSBpZih0eXBlb2YgZy5sZW5ndGg9PT0ibnVtYmVyIilmb3IodmFyIGw9MCxtPWcubGVuZ3RoO2w8bTtsKyspaC5wdXNoKGdbbF0pO2Vsc2UgZm9yKGw9MDtnW2xdO2wrKyloLnB1c2goZ1tsXSk7cmV0dXJuIGh9fXZhciBCO2lmKHMuZG9jdW1lbnRFbGVtZW50LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKUI9ZnVuY3Rpb24oZyxoKXtpZighZy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbnx8CiFoLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKXtpZihnPT1oKWk9dHJ1ZTtyZXR1cm4gZy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbj8tMToxfWc9Zy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihoKSY0Py0xOmc9PT1oPzA6MTtpZihnPT09MClpPXRydWU7cmV0dXJuIGd9O2Vsc2UgaWYoInNvdXJjZUluZGV4ImluIHMuZG9jdW1lbnRFbGVtZW50KUI9ZnVuY3Rpb24oZyxoKXtpZighZy5zb3VyY2VJbmRleHx8IWguc291cmNlSW5kZXgpe2lmKGc9PWgpaT10cnVlO3JldHVybiBnLnNvdXJjZUluZGV4Py0xOjF9Zz1nLnNvdXJjZUluZGV4LWguc291cmNlSW5kZXg7aWYoZz09PTApaT10cnVlO3JldHVybiBnfTtlbHNlIGlmKHMuY3JlYXRlUmFuZ2UpQj1mdW5jdGlvbihnLGgpe2lmKCFnLm93bmVyRG9jdW1lbnR8fCFoLm93bmVyRG9jdW1lbnQpe2lmKGc9PWgpaT10cnVlO3JldHVybiBnLm93bmVyRG9jdW1lbnQ/LTE6MX12YXIgbD1nLm93bmVyRG9jdW1lbnQuY3JlYXRlUmFuZ2UoKSxtPQpoLm93bmVyRG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtsLnNldFN0YXJ0KGcsMCk7bC5zZXRFbmQoZywwKTttLnNldFN0YXJ0KGgsMCk7bS5zZXRFbmQoaCwwKTtnPWwuY29tcGFyZUJvdW5kYXJ5UG9pbnRzKFJhbmdlLlNUQVJUX1RPX0VORCxtKTtpZihnPT09MClpPXRydWU7cmV0dXJuIGd9OyhmdW5jdGlvbigpe3ZhciBnPXMuY3JlYXRlRWxlbWVudCgiZGl2IiksaD0ic2NyaXB0IisobmV3IERhdGUpLmdldFRpbWUoKTtnLmlubmVySFRNTD0iPGEgbmFtZT0nIitoKyInLz4iO3ZhciBsPXMuZG9jdW1lbnRFbGVtZW50O2wuaW5zZXJ0QmVmb3JlKGcsbC5maXJzdENoaWxkKTtpZihzLmdldEVsZW1lbnRCeUlkKGgpKXtuLmZpbmQuSUQ9ZnVuY3Rpb24obSxxLHApe2lmKHR5cGVvZiBxLmdldEVsZW1lbnRCeUlkIT09InVuZGVmaW5lZCImJiFwKXJldHVybihxPXEuZ2V0RWxlbWVudEJ5SWQobVsxXSkpP3EuaWQ9PT1tWzFdfHx0eXBlb2YgcS5nZXRBdHRyaWJ1dGVOb2RlIT09InVuZGVmaW5lZCImJgpxLmdldEF0dHJpYnV0ZU5vZGUoImlkIikubm9kZVZhbHVlPT09bVsxXT9bcV06dzpbXX07bi5maWx0ZXIuSUQ9ZnVuY3Rpb24obSxxKXt2YXIgcD10eXBlb2YgbS5nZXRBdHRyaWJ1dGVOb2RlIT09InVuZGVmaW5lZCImJm0uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTtyZXR1cm4gbS5ub2RlVHlwZT09PTEmJnAmJnAubm9kZVZhbHVlPT09cX19bC5yZW1vdmVDaGlsZChnKTtsPWc9bnVsbH0pKCk7KGZ1bmN0aW9uKCl7dmFyIGc9cy5jcmVhdGVFbGVtZW50KCJkaXYiKTtnLmFwcGVuZENoaWxkKHMuY3JlYXRlQ29tbWVudCgiIikpO2lmKGcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKS5sZW5ndGg+MCluLmZpbmQuVEFHPWZ1bmN0aW9uKGgsbCl7bD1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKGhbMV0pO2lmKGhbMV09PT0iKiIpe2g9W107Zm9yKHZhciBtPTA7bFttXTttKyspbFttXS5ub2RlVHlwZT09PTEmJmgucHVzaChsW21dKTtsPWh9cmV0dXJuIGx9O2cuaW5uZXJIVE1MPSI8YSBocmVmPScjJz48L2E+IjsKaWYoZy5maXJzdENoaWxkJiZ0eXBlb2YgZy5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSE9PSJ1bmRlZmluZWQiJiZnLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJocmVmIikhPT0iIyIpbi5hdHRySGFuZGxlLmhyZWY9ZnVuY3Rpb24oaCl7cmV0dXJuIGguZ2V0QXR0cmlidXRlKCJocmVmIiwyKX07Zz1udWxsfSkoKTtzLnF1ZXJ5U2VsZWN0b3JBbGwmJmZ1bmN0aW9uKCl7dmFyIGc9ayxoPXMuY3JlYXRlRWxlbWVudCgiZGl2Iik7aC5pbm5lckhUTUw9IjxwIGNsYXNzPSdURVNUJz48L3A+IjtpZighKGgucXVlcnlTZWxlY3RvckFsbCYmaC5xdWVyeVNlbGVjdG9yQWxsKCIuVEVTVCIpLmxlbmd0aD09PTApKXtrPWZ1bmN0aW9uKG0scSxwLHYpe3E9cXx8cztpZighdiYmcS5ub2RlVHlwZT09PTkmJiF4KHEpKXRyeXtyZXR1cm4geihxLnF1ZXJ5U2VsZWN0b3JBbGwobSkscCl9Y2F0Y2godCl7fXJldHVybiBnKG0scSxwLHYpfTtmb3IodmFyIGwgaW4gZylrW2xdPWdbbF07aD1udWxsfX0oKTsKKGZ1bmN0aW9uKCl7dmFyIGc9cy5jcmVhdGVFbGVtZW50KCJkaXYiKTtnLmlubmVySFRNTD0iPGRpdiBjbGFzcz0ndGVzdCBlJz48L2Rpdj48ZGl2IGNsYXNzPSd0ZXN0Jz48L2Rpdj4iO2lmKCEoIWcuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZXx8Zy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlIikubGVuZ3RoPT09MCkpe2cubGFzdENoaWxkLmNsYXNzTmFtZT0iZSI7aWYoZy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlIikubGVuZ3RoIT09MSl7bi5vcmRlci5zcGxpY2UoMSwwLCJDTEFTUyIpO24uZmluZC5DTEFTUz1mdW5jdGlvbihoLGwsbSl7aWYodHlwZW9mIGwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSE9PSJ1bmRlZmluZWQiJiYhbSlyZXR1cm4gbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGhbMV0pfTtnPW51bGx9fX0pKCk7dmFyIEU9cy5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbj9mdW5jdGlvbihnLGgpe3JldHVybiEhKGcuY29tcGFyZURvY3VtZW50UG9zaXRpb24oaCkmMTYpfToKZnVuY3Rpb24oZyxoKXtyZXR1cm4gZyE9PWgmJihnLmNvbnRhaW5zP2cuY29udGFpbnMoaCk6dHJ1ZSl9LHg9ZnVuY3Rpb24oZyl7cmV0dXJuKGc9KGc/Zy5vd25lckRvY3VtZW50fHxnOjApLmRvY3VtZW50RWxlbWVudCk/Zy5ub2RlTmFtZSE9PSJIVE1MIjpmYWxzZX0sZ2E9ZnVuY3Rpb24oZyxoKXt2YXIgbD1bXSxtPSIiLHE7Zm9yKGg9aC5ub2RlVHlwZT9baF06aDtxPW4ubWF0Y2guUFNFVURPLmV4ZWMoZyk7KXttKz1xWzBdO2c9Zy5yZXBsYWNlKG4ubWF0Y2guUFNFVURPLCIiKX1nPW4ucmVsYXRpdmVbZ10/ZysiKiI6ZztxPTA7Zm9yKHZhciBwPWgubGVuZ3RoO3E8cDtxKyspayhnLGhbcV0sbCk7cmV0dXJuIGsuZmlsdGVyKG0sbCl9O2MuZmluZD1rO2MuZXhwcj1rLnNlbGVjdG9ycztjLmV4cHJbIjoiXT1jLmV4cHIuZmlsdGVycztjLnVuaXF1ZT1rLnVuaXF1ZVNvcnQ7Yy50ZXh0PWE7Yy5pc1hNTERvYz14O2MuY29udGFpbnM9RX0pKCk7dmFyIGViPS9VbnRpbCQvLGZiPS9eKD86cGFyZW50c3xwcmV2VW50aWx8cHJldkFsbCkvLApnYj0vLC87Uj1BcnJheS5wcm90b3R5cGUuc2xpY2U7dmFyIElhPWZ1bmN0aW9uKGEsYixkKXtpZihjLmlzRnVuY3Rpb24oYikpcmV0dXJuIGMuZ3JlcChhLGZ1bmN0aW9uKGUsail7cmV0dXJuISFiLmNhbGwoZSxqLGUpPT09ZH0pO2Vsc2UgaWYoYi5ub2RlVHlwZSlyZXR1cm4gYy5ncmVwKGEsZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1iPT09ZH0pO2Vsc2UgaWYodHlwZW9mIGI9PT0ic3RyaW5nIil7dmFyIGY9Yy5ncmVwKGEsZnVuY3Rpb24oZSl7cmV0dXJuIGUubm9kZVR5cGU9PT0xfSk7aWYoVWEudGVzdChiKSlyZXR1cm4gYy5maWx0ZXIoYixmLCFkKTtlbHNlIGI9Yy5maWx0ZXIoYixmKX1yZXR1cm4gYy5ncmVwKGEsZnVuY3Rpb24oZSl7cmV0dXJuIGMuaW5BcnJheShlLGIpPj0wPT09ZH0pfTtjLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5wdXNoU3RhY2soIiIsImZpbmQiLGEpLGQ9MCxmPTAsZT10aGlzLmxlbmd0aDtmPGU7ZisrKXtkPWIubGVuZ3RoOwpjLmZpbmQoYSx0aGlzW2ZdLGIpO2lmKGY+MClmb3IodmFyIGo9ZDtqPGIubGVuZ3RoO2orKylmb3IodmFyIGk9MDtpPGQ7aSsrKWlmKGJbaV09PT1iW2pdKXtiLnNwbGljZShqLS0sMSk7YnJlYWt9fXJldHVybiBifSxoYXM6ZnVuY3Rpb24oYSl7dmFyIGI9YyhhKTtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGQ9MCxmPWIubGVuZ3RoO2Q8ZjtkKyspaWYoYy5jb250YWlucyh0aGlzLGJbZF0pKXJldHVybiB0cnVlfSl9LG5vdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soSWEodGhpcyxhLGZhbHNlKSwibm90IixhKX0sZmlsdGVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhJYSh0aGlzLGEsdHJ1ZSksImZpbHRlciIsYSl9LGlzOmZ1bmN0aW9uKGEpe3JldHVybiEhYSYmYy5maWx0ZXIoYSx0aGlzKS5sZW5ndGg+MH0sY2xvc2VzdDpmdW5jdGlvbihhLGIpe2lmKGMuaXNBcnJheShhKSl7dmFyIGQ9W10sZj10aGlzWzBdLGUsaj0Ke30saTtpZihmJiZhLmxlbmd0aCl7ZT0wO2Zvcih2YXIgbz1hLmxlbmd0aDtlPG87ZSsrKXtpPWFbZV07altpXXx8KGpbaV09Yy5leHByLm1hdGNoLlBPUy50ZXN0KGkpP2MoaSxifHx0aGlzLmNvbnRleHQpOmkpfWZvcig7ZiYmZi5vd25lckRvY3VtZW50JiZmIT09Yjspe2ZvcihpIGluIGope2U9altpXTtpZihlLmpxdWVyeT9lLmluZGV4KGYpPi0xOmMoZikuaXMoZSkpe2QucHVzaCh7c2VsZWN0b3I6aSxlbGVtOmZ9KTtkZWxldGUgaltpXX19Zj1mLnBhcmVudE5vZGV9fXJldHVybiBkfXZhciBrPWMuZXhwci5tYXRjaC5QT1MudGVzdChhKT9jKGEsYnx8dGhpcy5jb250ZXh0KTpudWxsO3JldHVybiB0aGlzLm1hcChmdW5jdGlvbihuLHIpe2Zvcig7ciYmci5vd25lckRvY3VtZW50JiZyIT09Yjspe2lmKGs/ay5pbmRleChyKT4tMTpjKHIpLmlzKGEpKXJldHVybiByO3I9ci5wYXJlbnROb2RlfXJldHVybiBudWxsfSl9LGluZGV4OmZ1bmN0aW9uKGEpe2lmKCFhfHx0eXBlb2YgYT09PQoic3RyaW5nIilyZXR1cm4gYy5pbkFycmF5KHRoaXNbMF0sYT9jKGEpOnRoaXMucGFyZW50KCkuY2hpbGRyZW4oKSk7cmV0dXJuIGMuaW5BcnJheShhLmpxdWVyeT9hWzBdOmEsdGhpcyl9LGFkZDpmdW5jdGlvbihhLGIpe2E9dHlwZW9mIGE9PT0ic3RyaW5nIj9jKGEsYnx8dGhpcy5jb250ZXh0KTpjLm1ha2VBcnJheShhKTtiPWMubWVyZ2UodGhpcy5nZXQoKSxhKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2socWEoYVswXSl8fHFhKGJbMF0pP2I6Yy51bmlxdWUoYikpfSxhbmRTZWxmOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKHRoaXMucHJldk9iamVjdCl9fSk7Yy5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuKGE9YS5wYXJlbnROb2RlKSYmYS5ub2RlVHlwZSE9PTExP2E6bnVsbH0scGFyZW50czpmdW5jdGlvbihhKXtyZXR1cm4gYy5kaXIoYSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBjLmRpcihhLCJwYXJlbnROb2RlIiwKZCl9LG5leHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGMubnRoKGEsMiwibmV4dFNpYmxpbmciKX0scHJldjpmdW5jdGlvbihhKXtyZXR1cm4gYy5udGgoYSwyLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dEFsbDpmdW5jdGlvbihhKXtyZXR1cm4gYy5kaXIoYSwibmV4dFNpYmxpbmciKX0scHJldkFsbDpmdW5jdGlvbihhKXtyZXR1cm4gYy5kaXIoYSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRVbnRpbDpmdW5jdGlvbihhLGIsZCl7cmV0dXJuIGMuZGlyKGEsIm5leHRTaWJsaW5nIixkKX0scHJldlVudGlsOmZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gYy5kaXIoYSwicHJldmlvdXNTaWJsaW5nIixkKX0sc2libGluZ3M6ZnVuY3Rpb24oYSl7cmV0dXJuIGMuc2libGluZyhhLnBhcmVudE5vZGUuZmlyc3RDaGlsZCxhKX0sY2hpbGRyZW46ZnVuY3Rpb24oYSl7cmV0dXJuIGMuc2libGluZyhhLmZpcnN0Q2hpbGQpfSxjb250ZW50czpmdW5jdGlvbihhKXtyZXR1cm4gYy5ub2RlTmFtZShhLCJpZnJhbWUiKT8KYS5jb250ZW50RG9jdW1lbnR8fGEuY29udGVudFdpbmRvdy5kb2N1bWVudDpjLm1ha2VBcnJheShhLmNoaWxkTm9kZXMpfX0sZnVuY3Rpb24oYSxiKXtjLmZuW2FdPWZ1bmN0aW9uKGQsZil7dmFyIGU9Yy5tYXAodGhpcyxiLGQpO2ViLnRlc3QoYSl8fChmPWQpO2lmKGYmJnR5cGVvZiBmPT09InN0cmluZyIpZT1jLmZpbHRlcihmLGUpO2U9dGhpcy5sZW5ndGg+MT9jLnVuaXF1ZShlKTplO2lmKCh0aGlzLmxlbmd0aD4xfHxnYi50ZXN0KGYpKSYmZmIudGVzdChhKSllPWUucmV2ZXJzZSgpO3JldHVybiB0aGlzLnB1c2hTdGFjayhlLGEsUi5jYWxsKGFyZ3VtZW50cykuam9pbigiLCIpKX19KTtjLmV4dGVuZCh7ZmlsdGVyOmZ1bmN0aW9uKGEsYixkKXtpZihkKWE9Ijpub3QoIithKyIpIjtyZXR1cm4gYy5maW5kLm1hdGNoZXMoYSxiKX0sZGlyOmZ1bmN0aW9uKGEsYixkKXt2YXIgZj1bXTtmb3IoYT1hW2JdO2EmJmEubm9kZVR5cGUhPT05JiYoZD09PXd8fGEubm9kZVR5cGUhPT0xfHwhYyhhKS5pcyhkKSk7KXthLm5vZGVUeXBlPT09CjEmJmYucHVzaChhKTthPWFbYl19cmV0dXJuIGZ9LG50aDpmdW5jdGlvbihhLGIsZCl7Yj1ifHwxO2Zvcih2YXIgZj0wO2E7YT1hW2RdKWlmKGEubm9kZVR5cGU9PT0xJiYrK2Y9PT1iKWJyZWFrO3JldHVybiBhfSxzaWJsaW5nOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBkPVtdO2E7YT1hLm5leHRTaWJsaW5nKWEubm9kZVR5cGU9PT0xJiZhIT09YiYmZC5wdXNoKGEpO3JldHVybiBkfX0pO3ZhciBKYT0vIGpRdWVyeVxkKz0iKD86XGQrfG51bGwpIi9nLFY9L15ccysvLEthPS8oPChbXHc6XSspW14+XSo/KVwvPi9nLGhiPS9eKD86YXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkkL2ksTGE9LzwoW1x3Ol0rKS8saWI9Lzx0Ym9keS9pLGpiPS88fCYjP1x3KzsvLHRhPS88c2NyaXB0fDxvYmplY3R8PGVtYmVkfDxvcHRpb258PHN0eWxlL2ksdWE9L2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4pL2ksTWE9ZnVuY3Rpb24oYSxiLGQpe3JldHVybiBoYi50ZXN0KGQpPwphOmIrIj48LyIrZCsiPiJ9LEY9e29wdGlvbjpbMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdLGxlZ2VuZDpbMSwiPGZpZWxkc2V0PiIsIjwvZmllbGRzZXQ+Il0sdGhlYWQ6WzEsIjx0YWJsZT4iLCI8L3RhYmxlPiJdLHRyOlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0ZDpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sY29sOlsyLCI8dGFibGU+PHRib2R5PjwvdGJvZHk+PGNvbGdyb3VwPiIsIjwvY29sZ3JvdXA+PC90YWJsZT4iXSxhcmVhOlsxLCI8bWFwPiIsIjwvbWFwPiJdLF9kZWZhdWx0OlswLCIiLCIiXX07Ri5vcHRncm91cD1GLm9wdGlvbjtGLnRib2R5PUYudGZvb3Q9Ri5jb2xncm91cD1GLmNhcHRpb249Ri50aGVhZDtGLnRoPUYudGQ7aWYoIWMuc3VwcG9ydC5odG1sU2VyaWFsaXplKUYuX2RlZmF1bHQ9WzEsImRpdjxkaXY+IiwiPC9kaXY+Il07Yy5mbi5leHRlbmQoe3RleHQ6ZnVuY3Rpb24oYSl7aWYoYy5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7dmFyIGQ9CmModGhpcyk7ZC50ZXh0KGEuY2FsbCh0aGlzLGIsZC50ZXh0KCkpKX0pO2lmKHR5cGVvZiBhIT09Im9iamVjdCImJmEhPT13KXJldHVybiB0aGlzLmVtcHR5KCkuYXBwZW5kKCh0aGlzWzBdJiZ0aGlzWzBdLm93bmVyRG9jdW1lbnR8fHMpLmNyZWF0ZVRleHROb2RlKGEpKTtyZXR1cm4gYy50ZXh0KHRoaXMpfSx3cmFwQWxsOmZ1bmN0aW9uKGEpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGQpe2ModGhpcykud3JhcEFsbChhLmNhbGwodGhpcyxkKSl9KTtpZih0aGlzWzBdKXt2YXIgYj1jKGEsdGhpc1swXS5vd25lckRvY3VtZW50KS5lcSgwKS5jbG9uZSh0cnVlKTt0aGlzWzBdLnBhcmVudE5vZGUmJmIuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pO2IubWFwKGZ1bmN0aW9uKCl7Zm9yKHZhciBkPXRoaXM7ZC5maXJzdENoaWxkJiZkLmZpcnN0Q2hpbGQubm9kZVR5cGU9PT0xOylkPWQuZmlyc3RDaGlsZDtyZXR1cm4gZH0pLmFwcGVuZCh0aGlzKX1yZXR1cm4gdGhpc30sCndyYXBJbm5lcjpmdW5jdGlvbihhKXtpZihjLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtjKHRoaXMpLndyYXBJbm5lcihhLmNhbGwodGhpcyxiKSl9KTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9Yyh0aGlzKSxkPWIuY29udGVudHMoKTtkLmxlbmd0aD9kLndyYXBBbGwoYSk6Yi5hcHBlbmQoYSl9KX0sd3JhcDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yyh0aGlzKS53cmFwQWxsKGEpfSl9LHVud3JhcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKXtjLm5vZGVOYW1lKHRoaXMsImJvZHkiKXx8Yyh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpfSkuZW5kKCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyx0cnVlLGZ1bmN0aW9uKGEpe3RoaXMubm9kZVR5cGU9PT0xJiZ0aGlzLmFwcGVuZENoaWxkKGEpfSl9LApwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLHRydWUsZnVuY3Rpb24oYSl7dGhpcy5ub2RlVHlwZT09PTEmJnRoaXMuaW5zZXJ0QmVmb3JlKGEsdGhpcy5maXJzdENoaWxkKX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtpZih0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGUpcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZhbHNlLGZ1bmN0aW9uKGIpe3RoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYix0aGlzKX0pO2Vsc2UgaWYoYXJndW1lbnRzLmxlbmd0aCl7dmFyIGE9Yyhhcmd1bWVudHNbMF0pO2EucHVzaC5hcHBseShhLHRoaXMudG9BcnJheSgpKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soYSwiYmVmb3JlIixhcmd1bWVudHMpfX0sYWZ0ZXI6ZnVuY3Rpb24oKXtpZih0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGUpcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLGZhbHNlLGZ1bmN0aW9uKGIpe3RoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYiwKdGhpcy5uZXh0U2libGluZyl9KTtlbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBhPXRoaXMucHVzaFN0YWNrKHRoaXMsImFmdGVyIixhcmd1bWVudHMpO2EucHVzaC5hcHBseShhLGMoYXJndW1lbnRzWzBdKS50b0FycmF5KCkpO3JldHVybiBhfX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBkPTAsZjsoZj10aGlzW2RdKSE9bnVsbDtkKyspaWYoIWF8fGMuZmlsdGVyKGEsW2ZdKS5sZW5ndGgpe2lmKCFiJiZmLm5vZGVUeXBlPT09MSl7Yy5jbGVhbkRhdGEoZi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKTtjLmNsZWFuRGF0YShbZl0pfWYucGFyZW50Tm9kZSYmZi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGYpfXJldHVybiB0aGlzfSxlbXB0eTpmdW5jdGlvbigpe2Zvcih2YXIgYT0wLGI7KGI9dGhpc1thXSkhPW51bGw7YSsrKWZvcihiLm5vZGVUeXBlPT09MSYmYy5jbGVhbkRhdGEoYi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpKTtiLmZpcnN0Q2hpbGQ7KWIucmVtb3ZlQ2hpbGQoYi5maXJzdENoaWxkKTsKcmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWFwKGZ1bmN0aW9uKCl7aWYoIWMuc3VwcG9ydC5ub0Nsb25lRXZlbnQmJiFjLmlzWE1MRG9jKHRoaXMpKXt2YXIgZD10aGlzLm91dGVySFRNTCxmPXRoaXMub3duZXJEb2N1bWVudDtpZighZCl7ZD1mLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2QuYXBwZW5kQ2hpbGQodGhpcy5jbG9uZU5vZGUodHJ1ZSkpO2Q9ZC5pbm5lckhUTUx9cmV0dXJuIGMuY2xlYW4oW2QucmVwbGFjZShKYSwiIikucmVwbGFjZSgvPShbXj0iJz5cc10rXC8pPi9nLCc9IiQxIj4nKS5yZXBsYWNlKFYsIiIpXSxmKVswXX1lbHNlIHJldHVybiB0aGlzLmNsb25lTm9kZSh0cnVlKX0pO2lmKGE9PT10cnVlKXtyYSh0aGlzLGIpO3JhKHRoaXMuZmluZCgiKiIpLGIuZmluZCgiKiIpKX1yZXR1cm4gYn0saHRtbDpmdW5jdGlvbihhKXtpZihhPT09dylyZXR1cm4gdGhpc1swXSYmdGhpc1swXS5ub2RlVHlwZT09PTE/dGhpc1swXS5pbm5lckhUTUwucmVwbGFjZShKYSwKIiIpOm51bGw7ZWxzZSBpZih0eXBlb2YgYT09PSJzdHJpbmciJiYhdGEudGVzdChhKSYmKGMuc3VwcG9ydC5sZWFkaW5nV2hpdGVzcGFjZXx8IVYudGVzdChhKSkmJiFGWyhMYS5leGVjKGEpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7YT1hLnJlcGxhY2UoS2EsTWEpO3RyeXtmb3IodmFyIGI9MCxkPXRoaXMubGVuZ3RoO2I8ZDtiKyspaWYodGhpc1tiXS5ub2RlVHlwZT09PTEpe2MuY2xlYW5EYXRhKHRoaXNbYl0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSk7dGhpc1tiXS5pbm5lckhUTUw9YX19Y2F0Y2goZil7dGhpcy5lbXB0eSgpLmFwcGVuZChhKX19ZWxzZSBjLmlzRnVuY3Rpb24oYSk/dGhpcy5lYWNoKGZ1bmN0aW9uKGUpe3ZhciBqPWModGhpcyksaT1qLmh0bWwoKTtqLmVtcHR5KCkuYXBwZW5kKGZ1bmN0aW9uKCl7cmV0dXJuIGEuY2FsbCh0aGlzLGUsaSl9KX0pOnRoaXMuZW1wdHkoKS5hcHBlbmQoYSk7cmV0dXJuIHRoaXN9LHJlcGxhY2VXaXRoOmZ1bmN0aW9uKGEpe2lmKHRoaXNbMF0mJgp0aGlzWzBdLnBhcmVudE5vZGUpe2lmKGMuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBkPWModGhpcyksZj1kLmh0bWwoKTtkLnJlcGxhY2VXaXRoKGEuY2FsbCh0aGlzLGIsZikpfSk7aWYodHlwZW9mIGEhPT0ic3RyaW5nIilhPWMoYSkuZGV0YWNoKCk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPXRoaXMubmV4dFNpYmxpbmcsZD10aGlzLnBhcmVudE5vZGU7Yyh0aGlzKS5yZW1vdmUoKTtiP2MoYikuYmVmb3JlKGEpOmMoZCkuYXBwZW5kKGEpfSl9ZWxzZSByZXR1cm4gdGhpcy5wdXNoU3RhY2soYyhjLmlzRnVuY3Rpb24oYSk/YSgpOmEpLCJyZXBsYWNlV2l0aCIsYSl9LGRldGFjaDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5yZW1vdmUoYSx0cnVlKX0sZG9tTWFuaXA6ZnVuY3Rpb24oYSxiLGQpe2Z1bmN0aW9uIGYodSl7cmV0dXJuIGMubm9kZU5hbWUodSwidGFibGUiKT91LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdfHwKdS5hcHBlbmRDaGlsZCh1Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGJvZHkiKSk6dX12YXIgZSxqLGk9YVswXSxvPVtdLGs7aWYoIWMuc3VwcG9ydC5jaGVja0Nsb25lJiZhcmd1bWVudHMubGVuZ3RoPT09MyYmdHlwZW9mIGk9PT0ic3RyaW5nIiYmdWEudGVzdChpKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yyh0aGlzKS5kb21NYW5pcChhLGIsZCx0cnVlKX0pO2lmKGMuaXNGdW5jdGlvbihpKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKHUpe3ZhciB6PWModGhpcyk7YVswXT1pLmNhbGwodGhpcyx1LGI/ei5odG1sKCk6dyk7ei5kb21NYW5pcChhLGIsZCl9KTtpZih0aGlzWzBdKXtlPWkmJmkucGFyZW50Tm9kZTtlPWMuc3VwcG9ydC5wYXJlbnROb2RlJiZlJiZlLm5vZGVUeXBlPT09MTEmJmUuY2hpbGROb2Rlcy5sZW5ndGg9PT10aGlzLmxlbmd0aD97ZnJhZ21lbnQ6ZX06c2EoYSx0aGlzLG8pO2s9ZS5mcmFnbWVudDtpZihqPWsuY2hpbGROb2Rlcy5sZW5ndGg9PT0KMT8oaz1rLmZpcnN0Q2hpbGQpOmsuZmlyc3RDaGlsZCl7Yj1iJiZjLm5vZGVOYW1lKGosInRyIik7Zm9yKHZhciBuPTAscj10aGlzLmxlbmd0aDtuPHI7bisrKWQuY2FsbChiP2YodGhpc1tuXSxqKTp0aGlzW25dLG4+MHx8ZS5jYWNoZWFibGV8fHRoaXMubGVuZ3RoPjE/ay5jbG9uZU5vZGUodHJ1ZSk6ayl9by5sZW5ndGgmJmMuZWFjaChvLFFhKX1yZXR1cm4gdGhpc319KTtjLmZyYWdtZW50cz17fTtjLmVhY2goe2FwcGVuZFRvOiJhcHBlbmQiLHByZXBlbmRUbzoicHJlcGVuZCIsaW5zZXJ0QmVmb3JlOiJiZWZvcmUiLGluc2VydEFmdGVyOiJhZnRlciIscmVwbGFjZUFsbDoicmVwbGFjZVdpdGgifSxmdW5jdGlvbihhLGIpe2MuZm5bYV09ZnVuY3Rpb24oZCl7dmFyIGY9W107ZD1jKGQpO3ZhciBlPXRoaXMubGVuZ3RoPT09MSYmdGhpc1swXS5wYXJlbnROb2RlO2lmKGUmJmUubm9kZVR5cGU9PT0xMSYmZS5jaGlsZE5vZGVzLmxlbmd0aD09PTEmJmQubGVuZ3RoPT09MSl7ZFtiXSh0aGlzWzBdKTsKcmV0dXJuIHRoaXN9ZWxzZXtlPTA7Zm9yKHZhciBqPWQubGVuZ3RoO2U8ajtlKyspe3ZhciBpPShlPjA/dGhpcy5jbG9uZSh0cnVlKTp0aGlzKS5nZXQoKTtjLmZuW2JdLmFwcGx5KGMoZFtlXSksaSk7Zj1mLmNvbmNhdChpKX1yZXR1cm4gdGhpcy5wdXNoU3RhY2soZixhLGQuc2VsZWN0b3IpfX19KTtjLmV4dGVuZCh7Y2xlYW46ZnVuY3Rpb24oYSxiLGQsZil7Yj1ifHxzO2lmKHR5cGVvZiBiLmNyZWF0ZUVsZW1lbnQ9PT0idW5kZWZpbmVkIiliPWIub3duZXJEb2N1bWVudHx8YlswXSYmYlswXS5vd25lckRvY3VtZW50fHxzO2Zvcih2YXIgZT1bXSxqPTAsaTsoaT1hW2pdKSE9bnVsbDtqKyspe2lmKHR5cGVvZiBpPT09Im51bWJlciIpaSs9IiI7aWYoaSl7aWYodHlwZW9mIGk9PT0ic3RyaW5nIiYmIWpiLnRlc3QoaSkpaT1iLmNyZWF0ZVRleHROb2RlKGkpO2Vsc2UgaWYodHlwZW9mIGk9PT0ic3RyaW5nIil7aT1pLnJlcGxhY2UoS2EsTWEpO3ZhciBvPShMYS5leGVjKGkpfHxbIiIsCiIiXSlbMV0udG9Mb3dlckNhc2UoKSxrPUZbb118fEYuX2RlZmF1bHQsbj1rWzBdLHI9Yi5jcmVhdGVFbGVtZW50KCJkaXYiKTtmb3Ioci5pbm5lckhUTUw9a1sxXStpK2tbMl07bi0tOylyPXIubGFzdENoaWxkO2lmKCFjLnN1cHBvcnQudGJvZHkpe249aWIudGVzdChpKTtvPW89PT0idGFibGUiJiYhbj9yLmZpcnN0Q2hpbGQmJnIuZmlyc3RDaGlsZC5jaGlsZE5vZGVzOmtbMV09PT0iPHRhYmxlPiImJiFuP3IuY2hpbGROb2RlczpbXTtmb3Ioaz1vLmxlbmd0aC0xO2s+PTA7LS1rKWMubm9kZU5hbWUob1trXSwidGJvZHkiKSYmIW9ba10uY2hpbGROb2Rlcy5sZW5ndGgmJm9ba10ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvW2tdKX0hYy5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlJiZWLnRlc3QoaSkmJnIuaW5zZXJ0QmVmb3JlKGIuY3JlYXRlVGV4dE5vZGUoVi5leGVjKGkpWzBdKSxyLmZpcnN0Q2hpbGQpO2k9ci5jaGlsZE5vZGVzfWlmKGkubm9kZVR5cGUpZS5wdXNoKGkpO2Vsc2UgZT0KYy5tZXJnZShlLGkpfX1pZihkKWZvcihqPTA7ZVtqXTtqKyspaWYoZiYmYy5ub2RlTmFtZShlW2pdLCJzY3JpcHQiKSYmKCFlW2pdLnR5cGV8fGVbal0udHlwZS50b0xvd2VyQ2FzZSgpPT09InRleHQvamF2YXNjcmlwdCIpKWYucHVzaChlW2pdLnBhcmVudE5vZGU/ZVtqXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVbal0pOmVbal0pO2Vsc2V7ZVtqXS5ub2RlVHlwZT09PTEmJmUuc3BsaWNlLmFwcGx5KGUsW2orMSwwXS5jb25jYXQoYy5tYWtlQXJyYXkoZVtqXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgic2NyaXB0IikpKSk7ZC5hcHBlbmRDaGlsZChlW2pdKX1yZXR1cm4gZX0sY2xlYW5EYXRhOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixkLGY9Yy5jYWNoZSxlPWMuZXZlbnQuc3BlY2lhbCxqPWMuc3VwcG9ydC5kZWxldGVFeHBhbmRvLGk9MCxvOyhvPWFbaV0pIT1udWxsO2krKylpZihkPW9bYy5leHBhbmRvXSl7Yj1mW2RdO2lmKGIuZXZlbnRzKWZvcih2YXIgayBpbiBiLmV2ZW50cyllW2tdPwpjLmV2ZW50LnJlbW92ZShvLGspOkNhKG8sayxiLmhhbmRsZSk7aWYoailkZWxldGUgb1tjLmV4cGFuZG9dO2Vsc2Ugby5yZW1vdmVBdHRyaWJ1dGUmJm8ucmVtb3ZlQXR0cmlidXRlKGMuZXhwYW5kbyk7ZGVsZXRlIGZbZF19fX0pO3ZhciBrYj0vei0/aW5kZXh8Zm9udC0/d2VpZ2h0fG9wYWNpdHl8em9vbXxsaW5lLT9oZWlnaHQvaSxOYT0vYWxwaGFcKFteKV0qXCkvLE9hPS9vcGFjaXR5PShbXildKikvLGhhPS9mbG9hdC9pLGlhPS8tKFthLXpdKS9pZyxsYj0vKFtBLVpdKS9nLG1iPS9eLT9cZCsoPzpweCk/JC9pLG5iPS9eLT9cZC8sb2I9e3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdmlzaWJpbGl0eToiaGlkZGVuIixkaXNwbGF5OiJibG9jayJ9LHBiPVsiTGVmdCIsIlJpZ2h0Il0scWI9WyJUb3AiLCJCb3R0b20iXSxyYj1zLmRlZmF1bHRWaWV3JiZzLmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUsUGE9Yy5zdXBwb3J0LmNzc0Zsb2F0PyJjc3NGbG9hdCI6InN0eWxlRmxvYXQiLGphPQpmdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9O2MuZm4uY3NzPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFgodGhpcyxhLGIsdHJ1ZSxmdW5jdGlvbihkLGYsZSl7aWYoZT09PXcpcmV0dXJuIGMuY3VyQ1NTKGQsZik7aWYodHlwZW9mIGU9PT0ibnVtYmVyIiYmIWtiLnRlc3QoZikpZSs9InB4IjtjLnN0eWxlKGQsZixlKX0pfTtjLmV4dGVuZCh7c3R5bGU6ZnVuY3Rpb24oYSxiLGQpe2lmKCFhfHxhLm5vZGVUeXBlPT09M3x8YS5ub2RlVHlwZT09PTgpcmV0dXJuIHc7aWYoKGI9PT0id2lkdGgifHxiPT09ImhlaWdodCIpJiZwYXJzZUZsb2F0KGQpPDApZD13O3ZhciBmPWEuc3R5bGV8fGEsZT1kIT09dztpZighYy5zdXBwb3J0Lm9wYWNpdHkmJmI9PT0ib3BhY2l0eSIpe2lmKGUpe2Yuem9vbT0xO2I9cGFyc2VJbnQoZCwxMCkrIiI9PT0iTmFOIj8iIjoiYWxwaGEob3BhY2l0eT0iK2QqMTAwKyIpIjthPWYuZmlsdGVyfHxjLmN1ckNTUyhhLCJmaWx0ZXIiKXx8IiI7Zi5maWx0ZXI9Ck5hLnRlc3QoYSk/YS5yZXBsYWNlKE5hLGIpOmJ9cmV0dXJuIGYuZmlsdGVyJiZmLmZpbHRlci5pbmRleE9mKCJvcGFjaXR5PSIpPj0wP3BhcnNlRmxvYXQoT2EuZXhlYyhmLmZpbHRlcilbMV0pLzEwMCsiIjoiIn1pZihoYS50ZXN0KGIpKWI9UGE7Yj1iLnJlcGxhY2UoaWEsamEpO2lmKGUpZltiXT1kO3JldHVybiBmW2JdfSxjc3M6ZnVuY3Rpb24oYSxiLGQsZil7aWYoYj09PSJ3aWR0aCJ8fGI9PT0iaGVpZ2h0Iil7dmFyIGUsaj1iPT09IndpZHRoIj9wYjpxYjtmdW5jdGlvbiBpKCl7ZT1iPT09IndpZHRoIj9hLm9mZnNldFdpZHRoOmEub2Zmc2V0SGVpZ2h0O2YhPT0iYm9yZGVyIiYmYy5lYWNoKGosZnVuY3Rpb24oKXtmfHwoZS09cGFyc2VGbG9hdChjLmN1ckNTUyhhLCJwYWRkaW5nIit0aGlzLHRydWUpKXx8MCk7aWYoZj09PSJtYXJnaW4iKWUrPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwibWFyZ2luIit0aGlzLHRydWUpKXx8MDtlbHNlIGUtPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwKImJvcmRlciIrdGhpcysiV2lkdGgiLHRydWUpKXx8MH0pfWEub2Zmc2V0V2lkdGghPT0wP2koKTpjLnN3YXAoYSxvYixpKTtyZXR1cm4gTWF0aC5tYXgoMCxNYXRoLnJvdW5kKGUpKX1yZXR1cm4gYy5jdXJDU1MoYSxiLGQpfSxjdXJDU1M6ZnVuY3Rpb24oYSxiLGQpe3ZhciBmLGU9YS5zdHlsZTtpZighYy5zdXBwb3J0Lm9wYWNpdHkmJmI9PT0ib3BhY2l0eSImJmEuY3VycmVudFN0eWxlKXtmPU9hLnRlc3QoYS5jdXJyZW50U3R5bGUuZmlsdGVyfHwiIik/cGFyc2VGbG9hdChSZWdFeHAuJDEpLzEwMCsiIjoiIjtyZXR1cm4gZj09PSIiPyIxIjpmfWlmKGhhLnRlc3QoYikpYj1QYTtpZighZCYmZSYmZVtiXSlmPWVbYl07ZWxzZSBpZihyYil7aWYoaGEudGVzdChiKSliPSJmbG9hdCI7Yj1iLnJlcGxhY2UobGIsIi0kMSIpLnRvTG93ZXJDYXNlKCk7ZT1hLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7aWYoIWUpcmV0dXJuIG51bGw7aWYoYT1lLmdldENvbXB1dGVkU3R5bGUoYSxudWxsKSlmPQphLmdldFByb3BlcnR5VmFsdWUoYik7aWYoYj09PSJvcGFjaXR5IiYmZj09PSIiKWY9IjEifWVsc2UgaWYoYS5jdXJyZW50U3R5bGUpe2Q9Yi5yZXBsYWNlKGlhLGphKTtmPWEuY3VycmVudFN0eWxlW2JdfHxhLmN1cnJlbnRTdHlsZVtkXTtpZighbWIudGVzdChmKSYmbmIudGVzdChmKSl7Yj1lLmxlZnQ7dmFyIGo9YS5ydW50aW1lU3R5bGUubGVmdDthLnJ1bnRpbWVTdHlsZS5sZWZ0PWEuY3VycmVudFN0eWxlLmxlZnQ7ZS5sZWZ0PWQ9PT0iZm9udFNpemUiPyIxZW0iOmZ8fDA7Zj1lLnBpeGVsTGVmdCsicHgiO2UubGVmdD1iO2EucnVudGltZVN0eWxlLmxlZnQ9an19cmV0dXJuIGZ9LHN3YXA6ZnVuY3Rpb24oYSxiLGQpe3ZhciBmPXt9O2Zvcih2YXIgZSBpbiBiKXtmW2VdPWEuc3R5bGVbZV07YS5zdHlsZVtlXT1iW2VdfWQuY2FsbChhKTtmb3IoZSBpbiBiKWEuc3R5bGVbZV09ZltlXX19KTtpZihjLmV4cHImJmMuZXhwci5maWx0ZXJzKXtjLmV4cHIuZmlsdGVycy5oaWRkZW49ZnVuY3Rpb24oYSl7dmFyIGI9CmEub2Zmc2V0V2lkdGgsZD1hLm9mZnNldEhlaWdodCxmPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJ0ciI7cmV0dXJuIGI9PT0wJiZkPT09MCYmIWY/dHJ1ZTpiPjAmJmQ+MCYmIWY/ZmFsc2U6Yy5jdXJDU1MoYSwiZGlzcGxheSIpPT09Im5vbmUifTtjLmV4cHIuZmlsdGVycy52aXNpYmxlPWZ1bmN0aW9uKGEpe3JldHVybiFjLmV4cHIuZmlsdGVycy5oaWRkZW4oYSl9fXZhciBzYj1KKCksdGI9LzxzY3JpcHQoLnxccykqP1wvc2NyaXB0Pi9naSx1Yj0vc2VsZWN0fHRleHRhcmVhL2ksdmI9L2NvbG9yfGRhdGV8ZGF0ZXRpbWV8ZW1haWx8aGlkZGVufG1vbnRofG51bWJlcnxwYXNzd29yZHxyYW5nZXxzZWFyY2h8dGVsfHRleHR8dGltZXx1cmx8d2Vlay9pLE49Lz1cPygmfCQpLyxrYT0vXD8vLHdiPS8oXD98JilfPS4qPygmfCQpLyx4Yj0vXihcdys6KT9cL1wvKFteXC8/I10rKS8seWI9LyUyMC9nLHpiPWMuZm4ubG9hZDtjLmZuLmV4dGVuZCh7bG9hZDpmdW5jdGlvbihhLGIsZCl7aWYodHlwZW9mIGEhPT0KInN0cmluZyIpcmV0dXJuIHpiLmNhbGwodGhpcyxhKTtlbHNlIGlmKCF0aGlzLmxlbmd0aClyZXR1cm4gdGhpczt2YXIgZj1hLmluZGV4T2YoIiAiKTtpZihmPj0wKXt2YXIgZT1hLnNsaWNlKGYsYS5sZW5ndGgpO2E9YS5zbGljZSgwLGYpfWY9IkdFVCI7aWYoYilpZihjLmlzRnVuY3Rpb24oYikpe2Q9YjtiPW51bGx9ZWxzZSBpZih0eXBlb2YgYj09PSJvYmplY3QiKXtiPWMucGFyYW0oYixjLmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbCk7Zj0iUE9TVCJ9dmFyIGo9dGhpcztjLmFqYXgoe3VybDphLHR5cGU6ZixkYXRhVHlwZToiaHRtbCIsZGF0YTpiLGNvbXBsZXRlOmZ1bmN0aW9uKGksbyl7aWYobz09PSJzdWNjZXNzInx8bz09PSJub3Rtb2RpZmllZCIpai5odG1sKGU/YygiPGRpdiAvPiIpLmFwcGVuZChpLnJlc3BvbnNlVGV4dC5yZXBsYWNlKHRiLCIiKSkuZmluZChlKTppLnJlc3BvbnNlVGV4dCk7ZCYmai5lYWNoKGQsW2kucmVzcG9uc2VUZXh0LG8saV0pfX0pO3JldHVybiB0aGlzfSwKc2VyaWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIGMucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKX0sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbGVtZW50cz9jLm1ha2VBcnJheSh0aGlzLmVsZW1lbnRzKTp0aGlzfSkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZSYmIXRoaXMuZGlzYWJsZWQmJih0aGlzLmNoZWNrZWR8fHViLnRlc3QodGhpcy5ub2RlTmFtZSl8fHZiLnRlc3QodGhpcy50eXBlKSl9KS5tYXAoZnVuY3Rpb24oYSxiKXthPWModGhpcykudmFsKCk7cmV0dXJuIGE9PW51bGw/bnVsbDpjLmlzQXJyYXkoYSk/Yy5tYXAoYSxmdW5jdGlvbihkKXtyZXR1cm57bmFtZTpiLm5hbWUsdmFsdWU6ZH19KTp7bmFtZTpiLm5hbWUsdmFsdWU6YX19KS5nZXQoKX19KTtjLmVhY2goImFqYXhTdGFydCBhamF4U3RvcCBhamF4Q29tcGxldGUgYWpheEVycm9yIGFqYXhTdWNjZXNzIGFqYXhTZW5kIi5zcGxpdCgiICIpLApmdW5jdGlvbihhLGIpe2MuZm5bYl09ZnVuY3Rpb24oZCl7cmV0dXJuIHRoaXMuYmluZChiLGQpfX0pO2MuZXh0ZW5kKHtnZXQ6ZnVuY3Rpb24oYSxiLGQsZil7aWYoYy5pc0Z1bmN0aW9uKGIpKXtmPWZ8fGQ7ZD1iO2I9bnVsbH1yZXR1cm4gYy5hamF4KHt0eXBlOiJHRVQiLHVybDphLGRhdGE6YixzdWNjZXNzOmQsZGF0YVR5cGU6Zn0pfSxnZXRTY3JpcHQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYy5nZXQoYSxudWxsLGIsInNjcmlwdCIpfSxnZXRKU09OOmZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gYy5nZXQoYSxiLGQsImpzb24iKX0scG9zdDpmdW5jdGlvbihhLGIsZCxmKXtpZihjLmlzRnVuY3Rpb24oYikpe2Y9Znx8ZDtkPWI7Yj17fX1yZXR1cm4gYy5hamF4KHt0eXBlOiJQT1NUIix1cmw6YSxkYXRhOmIsc3VjY2VzczpkLGRhdGFUeXBlOmZ9KX0sYWpheFNldHVwOmZ1bmN0aW9uKGEpe2MuZXh0ZW5kKGMuYWpheFNldHRpbmdzLGEpfSxhamF4U2V0dGluZ3M6e3VybDpsb2NhdGlvbi5ocmVmLApnbG9iYWw6dHJ1ZSx0eXBlOiJHRVQiLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLHByb2Nlc3NEYXRhOnRydWUsYXN5bmM6dHJ1ZSx4aHI6QS5YTUxIdHRwUmVxdWVzdCYmKEEubG9jYXRpb24ucHJvdG9jb2whPT0iZmlsZToifHwhQS5BY3RpdmVYT2JqZWN0KT9mdW5jdGlvbigpe3JldHVybiBuZXcgQS5YTUxIdHRwUmVxdWVzdH06ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIG5ldyBBLkFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIil9Y2F0Y2goYSl7fX0sYWNjZXB0czp7eG1sOiJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIixodG1sOiJ0ZXh0L2h0bWwiLHNjcmlwdDoidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0Iixqc29uOiJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQiLHRleHQ6InRleHQvcGxhaW4iLF9kZWZhdWx0OiIqLyoifX0sbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheDpmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7ZS5zdWNjZXNzJiYKZS5zdWNjZXNzLmNhbGwoayxvLGkseCk7ZS5nbG9iYWwmJmYoImFqYXhTdWNjZXNzIixbeCxlXSl9ZnVuY3Rpb24gZCgpe2UuY29tcGxldGUmJmUuY29tcGxldGUuY2FsbChrLHgsaSk7ZS5nbG9iYWwmJmYoImFqYXhDb21wbGV0ZSIsW3gsZV0pO2UuZ2xvYmFsJiYhLS1jLmFjdGl2ZSYmYy5ldmVudC50cmlnZ2VyKCJhamF4U3RvcCIpfWZ1bmN0aW9uIGYocSxwKXsoZS5jb250ZXh0P2MoZS5jb250ZXh0KTpjLmV2ZW50KS50cmlnZ2VyKHEscCl9dmFyIGU9Yy5leHRlbmQodHJ1ZSx7fSxjLmFqYXhTZXR0aW5ncyxhKSxqLGksbyxrPWEmJmEuY29udGV4dHx8ZSxuPWUudHlwZS50b1VwcGVyQ2FzZSgpO2lmKGUuZGF0YSYmZS5wcm9jZXNzRGF0YSYmdHlwZW9mIGUuZGF0YSE9PSJzdHJpbmciKWUuZGF0YT1jLnBhcmFtKGUuZGF0YSxlLnRyYWRpdGlvbmFsKTtpZihlLmRhdGFUeXBlPT09Impzb25wIil7aWYobj09PSJHRVQiKU4udGVzdChlLnVybCl8fChlLnVybCs9KGthLnRlc3QoZS51cmwpPwoiJiI6Ij8iKSsoZS5qc29ucHx8ImNhbGxiYWNrIikrIj0/Iik7ZWxzZSBpZighZS5kYXRhfHwhTi50ZXN0KGUuZGF0YSkpZS5kYXRhPShlLmRhdGE/ZS5kYXRhKyImIjoiIikrKGUuanNvbnB8fCJjYWxsYmFjayIpKyI9PyI7ZS5kYXRhVHlwZT0ianNvbiJ9aWYoZS5kYXRhVHlwZT09PSJqc29uIiYmKGUuZGF0YSYmTi50ZXN0KGUuZGF0YSl8fE4udGVzdChlLnVybCkpKXtqPWUuanNvbnBDYWxsYmFja3x8Impzb25wIitzYisrO2lmKGUuZGF0YSllLmRhdGE9KGUuZGF0YSsiIikucmVwbGFjZShOLCI9IitqKyIkMSIpO2UudXJsPWUudXJsLnJlcGxhY2UoTiwiPSIraisiJDEiKTtlLmRhdGFUeXBlPSJzY3JpcHQiO0Fbal09QVtqXXx8ZnVuY3Rpb24ocSl7bz1xO2IoKTtkKCk7QVtqXT13O3RyeXtkZWxldGUgQVtqXX1jYXRjaChwKXt9eiYmei5yZW1vdmVDaGlsZChDKX19aWYoZS5kYXRhVHlwZT09PSJzY3JpcHQiJiZlLmNhY2hlPT09bnVsbCllLmNhY2hlPWZhbHNlO2lmKGUuY2FjaGU9PT0KZmFsc2UmJm49PT0iR0VUIil7dmFyIHI9SigpLHU9ZS51cmwucmVwbGFjZSh3YiwiJDFfPSIrcisiJDIiKTtlLnVybD11Kyh1PT09ZS51cmw/KGthLnRlc3QoZS51cmwpPyImIjoiPyIpKyJfPSIrcjoiIil9aWYoZS5kYXRhJiZuPT09IkdFVCIpZS51cmwrPShrYS50ZXN0KGUudXJsKT8iJiI6Ij8iKStlLmRhdGE7ZS5nbG9iYWwmJiFjLmFjdGl2ZSsrJiZjLmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpO3I9KHI9eGIuZXhlYyhlLnVybCkpJiYoclsxXSYmclsxXSE9PWxvY2F0aW9uLnByb3RvY29sfHxyWzJdIT09bG9jYXRpb24uaG9zdCk7aWYoZS5kYXRhVHlwZT09PSJzY3JpcHQiJiZuPT09IkdFVCImJnIpe3ZhciB6PXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXXx8cy5kb2N1bWVudEVsZW1lbnQsQz1zLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO0Muc3JjPWUudXJsO2lmKGUuc2NyaXB0Q2hhcnNldClDLmNoYXJzZXQ9ZS5zY3JpcHRDaGFyc2V0O2lmKCFqKXt2YXIgQj0KZmFsc2U7Qy5vbmxvYWQ9Qy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtpZighQiYmKCF0aGlzLnJlYWR5U3RhdGV8fHRoaXMucmVhZHlTdGF0ZT09PSJsb2FkZWQifHx0aGlzLnJlYWR5U3RhdGU9PT0iY29tcGxldGUiKSl7Qj10cnVlO2IoKTtkKCk7Qy5vbmxvYWQ9Qy5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDt6JiZDLnBhcmVudE5vZGUmJnoucmVtb3ZlQ2hpbGQoQyl9fX16Lmluc2VydEJlZm9yZShDLHouZmlyc3RDaGlsZCk7cmV0dXJuIHd9dmFyIEU9ZmFsc2UseD1lLnhocigpO2lmKHgpe2UudXNlcm5hbWU/eC5vcGVuKG4sZS51cmwsZS5hc3luYyxlLnVzZXJuYW1lLGUucGFzc3dvcmQpOngub3BlbihuLGUudXJsLGUuYXN5bmMpO3RyeXtpZihlLmRhdGF8fGEmJmEuY29udGVudFR5cGUpeC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLGUuY29udGVudFR5cGUpO2lmKGUuaWZNb2RpZmllZCl7Yy5sYXN0TW9kaWZpZWRbZS51cmxdJiZ4LnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIiwKYy5sYXN0TW9kaWZpZWRbZS51cmxdKTtjLmV0YWdbZS51cmxdJiZ4LnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0Y2giLGMuZXRhZ1tlLnVybF0pfXJ8fHguc2V0UmVxdWVzdEhlYWRlcigiWC1SZXF1ZXN0ZWQtV2l0aCIsIlhNTEh0dHBSZXF1ZXN0Iik7eC5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLGUuZGF0YVR5cGUmJmUuYWNjZXB0c1tlLmRhdGFUeXBlXT9lLmFjY2VwdHNbZS5kYXRhVHlwZV0rIiwgKi8qIjplLmFjY2VwdHMuX2RlZmF1bHQpfWNhdGNoKGdhKXt9aWYoZS5iZWZvcmVTZW5kJiZlLmJlZm9yZVNlbmQuY2FsbChrLHgsZSk9PT1mYWxzZSl7ZS5nbG9iYWwmJiEtLWMuYWN0aXZlJiZjLmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIik7eC5hYm9ydCgpO3JldHVybiBmYWxzZX1lLmdsb2JhbCYmZigiYWpheFNlbmQiLFt4LGVdKTt2YXIgZz14Lm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbihxKXtpZigheHx8eC5yZWFkeVN0YXRlPT09MHx8cT09PSJhYm9ydCIpe0V8fApkKCk7RT10cnVlO2lmKHgpeC5vbnJlYWR5c3RhdGVjaGFuZ2U9Yy5ub29wfWVsc2UgaWYoIUUmJngmJih4LnJlYWR5U3RhdGU9PT00fHxxPT09InRpbWVvdXQiKSl7RT10cnVlO3gub25yZWFkeXN0YXRlY2hhbmdlPWMubm9vcDtpPXE9PT0idGltZW91dCI/InRpbWVvdXQiOiFjLmh0dHBTdWNjZXNzKHgpPyJlcnJvciI6ZS5pZk1vZGlmaWVkJiZjLmh0dHBOb3RNb2RpZmllZCh4LGUudXJsKT8ibm90bW9kaWZpZWQiOiJzdWNjZXNzIjt2YXIgcDtpZihpPT09InN1Y2Nlc3MiKXRyeXtvPWMuaHR0cERhdGEoeCxlLmRhdGFUeXBlLGUpfWNhdGNoKHYpe2k9InBhcnNlcmVycm9yIjtwPXZ9aWYoaT09PSJzdWNjZXNzInx8aT09PSJub3Rtb2RpZmllZCIpanx8YigpO2Vsc2UgYy5oYW5kbGVFcnJvcihlLHgsaSxwKTtkKCk7cT09PSJ0aW1lb3V0IiYmeC5hYm9ydCgpO2lmKGUuYXN5bmMpeD1udWxsfX07dHJ5e3ZhciBoPXguYWJvcnQ7eC5hYm9ydD1mdW5jdGlvbigpe3gmJmguY2FsbCh4KTsKZygiYWJvcnQiKX19Y2F0Y2gobCl7fWUuYXN5bmMmJmUudGltZW91dD4wJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7eCYmIUUmJmcoInRpbWVvdXQiKX0sZS50aW1lb3V0KTt0cnl7eC5zZW5kKG49PT0iUE9TVCJ8fG49PT0iUFVUInx8bj09PSJERUxFVEUiP2UuZGF0YTpudWxsKX1jYXRjaChtKXtjLmhhbmRsZUVycm9yKGUseCxudWxsLG0pO2QoKX1lLmFzeW5jfHxnKCk7cmV0dXJuIHh9fSxoYW5kbGVFcnJvcjpmdW5jdGlvbihhLGIsZCxmKXtpZihhLmVycm9yKWEuZXJyb3IuY2FsbChhLmNvbnRleHR8fGEsYixkLGYpO2lmKGEuZ2xvYmFsKShhLmNvbnRleHQ/YyhhLmNvbnRleHQpOmMuZXZlbnQpLnRyaWdnZXIoImFqYXhFcnJvciIsW2IsYSxmXSl9LGFjdGl2ZTowLGh0dHBTdWNjZXNzOmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4hYS5zdGF0dXMmJmxvY2F0aW9uLnByb3RvY29sPT09ImZpbGU6Inx8YS5zdGF0dXM+PTIwMCYmYS5zdGF0dXM8MzAwfHxhLnN0YXR1cz09PTMwNHx8YS5zdGF0dXM9PT0KMTIyM3x8YS5zdGF0dXM9PT0wfWNhdGNoKGIpe31yZXR1cm4gZmFsc2V9LGh0dHBOb3RNb2RpZmllZDpmdW5jdGlvbihhLGIpe3ZhciBkPWEuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKSxmPWEuZ2V0UmVzcG9uc2VIZWFkZXIoIkV0YWciKTtpZihkKWMubGFzdE1vZGlmaWVkW2JdPWQ7aWYoZiljLmV0YWdbYl09ZjtyZXR1cm4gYS5zdGF0dXM9PT0zMDR8fGEuc3RhdHVzPT09MH0saHR0cERhdGE6ZnVuY3Rpb24oYSxiLGQpe3ZhciBmPWEuZ2V0UmVzcG9uc2VIZWFkZXIoImNvbnRlbnQtdHlwZSIpfHwiIixlPWI9PT0ieG1sInx8IWImJmYuaW5kZXhPZigieG1sIik+PTA7YT1lP2EucmVzcG9uc2VYTUw6YS5yZXNwb25zZVRleHQ7ZSYmYS5kb2N1bWVudEVsZW1lbnQubm9kZU5hbWU9PT0icGFyc2VyZXJyb3IiJiZjLmVycm9yKCJwYXJzZXJlcnJvciIpO2lmKGQmJmQuZGF0YUZpbHRlcilhPWQuZGF0YUZpbHRlcihhLGIpO2lmKHR5cGVvZiBhPT09InN0cmluZyIpaWYoYj09PQoianNvbiJ8fCFiJiZmLmluZGV4T2YoImpzb24iKT49MClhPWMucGFyc2VKU09OKGEpO2Vsc2UgaWYoYj09PSJzY3JpcHQifHwhYiYmZi5pbmRleE9mKCJqYXZhc2NyaXB0Iik+PTApYy5nbG9iYWxFdmFsKGEpO3JldHVybiBhfSxwYXJhbTpmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGQoaSxvKXtpZihjLmlzQXJyYXkobykpYy5lYWNoKG8sZnVuY3Rpb24oayxuKXtifHwvXFtcXSQvLnRlc3QoaSk/ZihpLG4pOmQoaSsiWyIrKHR5cGVvZiBuPT09Im9iamVjdCJ8fGMuaXNBcnJheShuKT9rOiIiKSsiXSIsbil9KTtlbHNlIWImJm8hPW51bGwmJnR5cGVvZiBvPT09Im9iamVjdCI/Yy5lYWNoKG8sZnVuY3Rpb24oayxuKXtkKGkrIlsiK2srIl0iLG4pfSk6ZihpLG8pfWZ1bmN0aW9uIGYoaSxvKXtvPWMuaXNGdW5jdGlvbihvKT9vKCk6bztlW2UubGVuZ3RoXT1lbmNvZGVVUklDb21wb25lbnQoaSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChvKX12YXIgZT1bXTtpZihiPT09dyliPWMuYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsOwppZihjLmlzQXJyYXkoYSl8fGEuanF1ZXJ5KWMuZWFjaChhLGZ1bmN0aW9uKCl7Zih0aGlzLm5hbWUsdGhpcy52YWx1ZSl9KTtlbHNlIGZvcih2YXIgaiBpbiBhKWQoaixhW2pdKTtyZXR1cm4gZS5qb2luKCImIikucmVwbGFjZSh5YiwiKyIpfX0pO3ZhciBsYT17fSxBYj0vdG9nZ2xlfHNob3d8aGlkZS8sQmI9L14oWystXT0pPyhbXGQrLS5dKykoLiopJC8sVyx2YT1bWyJoZWlnaHQiLCJtYXJnaW5Ub3AiLCJtYXJnaW5Cb3R0b20iLCJwYWRkaW5nVG9wIiwicGFkZGluZ0JvdHRvbSJdLFsid2lkdGgiLCJtYXJnaW5MZWZ0IiwibWFyZ2luUmlnaHQiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCJdLFsib3BhY2l0eSJdXTtjLmZuLmV4dGVuZCh7c2hvdzpmdW5jdGlvbihhLGIpe2lmKGF8fGE9PT0wKXJldHVybiB0aGlzLmFuaW1hdGUoSygic2hvdyIsMyksYSxiKTtlbHNle2E9MDtmb3IoYj10aGlzLmxlbmd0aDthPGI7YSsrKXt2YXIgZD1jLmRhdGEodGhpc1thXSwib2xkZGlzcGxheSIpOwp0aGlzW2FdLnN0eWxlLmRpc3BsYXk9ZHx8IiI7aWYoYy5jc3ModGhpc1thXSwiZGlzcGxheSIpPT09Im5vbmUiKXtkPXRoaXNbYV0ubm9kZU5hbWU7dmFyIGY7aWYobGFbZF0pZj1sYVtkXTtlbHNle3ZhciBlPWMoIjwiK2QrIiAvPiIpLmFwcGVuZFRvKCJib2R5Iik7Zj1lLmNzcygiZGlzcGxheSIpO2lmKGY9PT0ibm9uZSIpZj0iYmxvY2siO2UucmVtb3ZlKCk7bGFbZF09Zn1jLmRhdGEodGhpc1thXSwib2xkZGlzcGxheSIsZil9fWE9MDtmb3IoYj10aGlzLmxlbmd0aDthPGI7YSsrKXRoaXNbYV0uc3R5bGUuZGlzcGxheT1jLmRhdGEodGhpc1thXSwib2xkZGlzcGxheSIpfHwiIjtyZXR1cm4gdGhpc319LGhpZGU6ZnVuY3Rpb24oYSxiKXtpZihhfHxhPT09MClyZXR1cm4gdGhpcy5hbmltYXRlKEsoImhpZGUiLDMpLGEsYik7ZWxzZXthPTA7Zm9yKGI9dGhpcy5sZW5ndGg7YTxiO2ErKyl7dmFyIGQ9Yy5kYXRhKHRoaXNbYV0sIm9sZGRpc3BsYXkiKTshZCYmZCE9PSJub25lIiYmYy5kYXRhKHRoaXNbYV0sCiJvbGRkaXNwbGF5IixjLmNzcyh0aGlzW2FdLCJkaXNwbGF5IikpfWE9MDtmb3IoYj10aGlzLmxlbmd0aDthPGI7YSsrKXRoaXNbYV0uc3R5bGUuZGlzcGxheT0ibm9uZSI7cmV0dXJuIHRoaXN9fSxfdG9nZ2xlOmMuZm4udG9nZ2xlLHRvZ2dsZTpmdW5jdGlvbihhLGIpe3ZhciBkPXR5cGVvZiBhPT09ImJvb2xlYW4iO2lmKGMuaXNGdW5jdGlvbihhKSYmYy5pc0Z1bmN0aW9uKGIpKXRoaXMuX3RvZ2dsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7ZWxzZSBhPT1udWxsfHxkP3RoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBmPWQ/YTpjKHRoaXMpLmlzKCI6aGlkZGVuIik7Yyh0aGlzKVtmPyJzaG93IjoiaGlkZSJdKCl9KTp0aGlzLmFuaW1hdGUoSygidG9nZ2xlIiwzKSxhLGIpO3JldHVybiB0aGlzfSxmYWRlVG86ZnVuY3Rpb24oYSxiLGQpe3JldHVybiB0aGlzLmZpbHRlcigiOmhpZGRlbiIpLmNzcygib3BhY2l0eSIsMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoe29wYWNpdHk6Yn0sYSxkKX0sCmFuaW1hdGU6ZnVuY3Rpb24oYSxiLGQsZil7dmFyIGU9Yy5zcGVlZChiLGQsZik7aWYoYy5pc0VtcHR5T2JqZWN0KGEpKXJldHVybiB0aGlzLmVhY2goZS5jb21wbGV0ZSk7cmV0dXJuIHRoaXNbZS5xdWV1ZT09PWZhbHNlPyJlYWNoIjoicXVldWUiXShmdW5jdGlvbigpe3ZhciBqPWMuZXh0ZW5kKHt9LGUpLGksbz10aGlzLm5vZGVUeXBlPT09MSYmYyh0aGlzKS5pcygiOmhpZGRlbiIpLGs9dGhpcztmb3IoaSBpbiBhKXt2YXIgbj1pLnJlcGxhY2UoaWEsamEpO2lmKGkhPT1uKXthW25dPWFbaV07ZGVsZXRlIGFbaV07aT1ufWlmKGFbaV09PT0iaGlkZSImJm98fGFbaV09PT0ic2hvdyImJiFvKXJldHVybiBqLmNvbXBsZXRlLmNhbGwodGhpcyk7aWYoKGk9PT0iaGVpZ2h0Inx8aT09PSJ3aWR0aCIpJiZ0aGlzLnN0eWxlKXtqLmRpc3BsYXk9Yy5jc3ModGhpcywiZGlzcGxheSIpO2oub3ZlcmZsb3c9dGhpcy5zdHlsZS5vdmVyZmxvd31pZihjLmlzQXJyYXkoYVtpXSkpeyhqLnNwZWNpYWxFYXNpbmc9Cmouc3BlY2lhbEVhc2luZ3x8e30pW2ldPWFbaV1bMV07YVtpXT1hW2ldWzBdfX1pZihqLm92ZXJmbG93IT1udWxsKXRoaXMuc3R5bGUub3ZlcmZsb3c9ImhpZGRlbiI7ai5jdXJBbmltPWMuZXh0ZW5kKHt9LGEpO2MuZWFjaChhLGZ1bmN0aW9uKHIsdSl7dmFyIHo9bmV3IGMuZngoayxqLHIpO2lmKEFiLnRlc3QodSkpelt1PT09InRvZ2dsZSI/bz8ic2hvdyI6ImhpZGUiOnVdKGEpO2Vsc2V7dmFyIEM9QmIuZXhlYyh1KSxCPXouY3VyKHRydWUpfHwwO2lmKEMpe3U9cGFyc2VGbG9hdChDWzJdKTt2YXIgRT1DWzNdfHwicHgiO2lmKEUhPT0icHgiKXtrLnN0eWxlW3JdPSh1fHwxKStFO0I9KHV8fDEpL3ouY3VyKHRydWUpKkI7ay5zdHlsZVtyXT1CK0V9aWYoQ1sxXSl1PShDWzFdPT09Ii09Ij8tMToxKSp1K0I7ei5jdXN0b20oQix1LEUpfWVsc2Ugei5jdXN0b20oQix1LCIiKX19KTtyZXR1cm4gdHJ1ZX0pfSxzdG9wOmZ1bmN0aW9uKGEsYil7dmFyIGQ9Yy50aW1lcnM7YSYmdGhpcy5xdWV1ZShbXSk7CnRoaXMuZWFjaChmdW5jdGlvbigpe2Zvcih2YXIgZj1kLmxlbmd0aC0xO2Y+PTA7Zi0tKWlmKGRbZl0uZWxlbT09PXRoaXMpe2ImJmRbZl0odHJ1ZSk7ZC5zcGxpY2UoZiwxKX19KTtifHx0aGlzLmRlcXVldWUoKTtyZXR1cm4gdGhpc319KTtjLmVhY2goe3NsaWRlRG93bjpLKCJzaG93IiwxKSxzbGlkZVVwOksoImhpZGUiLDEpLHNsaWRlVG9nZ2xlOksoInRvZ2dsZSIsMSksZmFkZUluOntvcGFjaXR5OiJzaG93In0sZmFkZU91dDp7b3BhY2l0eToiaGlkZSJ9fSxmdW5jdGlvbihhLGIpe2MuZm5bYV09ZnVuY3Rpb24oZCxmKXtyZXR1cm4gdGhpcy5hbmltYXRlKGIsZCxmKX19KTtjLmV4dGVuZCh7c3BlZWQ6ZnVuY3Rpb24oYSxiLGQpe3ZhciBmPWEmJnR5cGVvZiBhPT09Im9iamVjdCI/YTp7Y29tcGxldGU6ZHx8IWQmJmJ8fGMuaXNGdW5jdGlvbihhKSYmYSxkdXJhdGlvbjphLGVhc2luZzpkJiZifHxiJiYhYy5pc0Z1bmN0aW9uKGIpJiZifTtmLmR1cmF0aW9uPWMuZngub2ZmPzA6dHlwZW9mIGYuZHVyYXRpb249PT0KIm51bWJlciI/Zi5kdXJhdGlvbjpjLmZ4LnNwZWVkc1tmLmR1cmF0aW9uXXx8Yy5meC5zcGVlZHMuX2RlZmF1bHQ7Zi5vbGQ9Zi5jb21wbGV0ZTtmLmNvbXBsZXRlPWZ1bmN0aW9uKCl7Zi5xdWV1ZSE9PWZhbHNlJiZjKHRoaXMpLmRlcXVldWUoKTtjLmlzRnVuY3Rpb24oZi5vbGQpJiZmLm9sZC5jYWxsKHRoaXMpfTtyZXR1cm4gZn0sZWFzaW5nOntsaW5lYXI6ZnVuY3Rpb24oYSxiLGQsZil7cmV0dXJuIGQrZiphfSxzd2luZzpmdW5jdGlvbihhLGIsZCxmKXtyZXR1cm4oLU1hdGguY29zKGEqTWF0aC5QSSkvMiswLjUpKmYrZH19LHRpbWVyczpbXSxmeDpmdW5jdGlvbihhLGIsZCl7dGhpcy5vcHRpb25zPWI7dGhpcy5lbGVtPWE7dGhpcy5wcm9wPWQ7aWYoIWIub3JpZyliLm9yaWc9e319fSk7Yy5meC5wcm90b3R5cGU9e3VwZGF0ZTpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5zdGVwJiZ0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSx0aGlzLm5vdyx0aGlzKTsoYy5meC5zdGVwW3RoaXMucHJvcF18fApjLmZ4LnN0ZXAuX2RlZmF1bHQpKHRoaXMpO2lmKCh0aGlzLnByb3A9PT0iaGVpZ2h0Inx8dGhpcy5wcm9wPT09IndpZHRoIikmJnRoaXMuZWxlbS5zdHlsZSl0aGlzLmVsZW0uc3R5bGUuZGlzcGxheT0iYmxvY2sifSxjdXI6ZnVuY3Rpb24oYSl7aWYodGhpcy5lbGVtW3RoaXMucHJvcF0hPW51bGwmJighdGhpcy5lbGVtLnN0eWxlfHx0aGlzLmVsZW0uc3R5bGVbdGhpcy5wcm9wXT09bnVsbCkpcmV0dXJuIHRoaXMuZWxlbVt0aGlzLnByb3BdO3JldHVybihhPXBhcnNlRmxvYXQoYy5jc3ModGhpcy5lbGVtLHRoaXMucHJvcCxhKSkpJiZhPi0xMDAwMD9hOnBhcnNlRmxvYXQoYy5jdXJDU1ModGhpcy5lbGVtLHRoaXMucHJvcCkpfHwwfSxjdXN0b206ZnVuY3Rpb24oYSxiLGQpe2Z1bmN0aW9uIGYoail7cmV0dXJuIGUuc3RlcChqKX10aGlzLnN0YXJ0VGltZT1KKCk7dGhpcy5zdGFydD1hO3RoaXMuZW5kPWI7dGhpcy51bml0PWR8fHRoaXMudW5pdHx8InB4Ijt0aGlzLm5vdz10aGlzLnN0YXJ0Owp0aGlzLnBvcz10aGlzLnN0YXRlPTA7dmFyIGU9dGhpcztmLmVsZW09dGhpcy5lbGVtO2lmKGYoKSYmYy50aW1lcnMucHVzaChmKSYmIVcpVz1zZXRJbnRlcnZhbChjLmZ4LnRpY2ssMTMpfSxzaG93OmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLm9yaWdbdGhpcy5wcm9wXT1jLnN0eWxlKHRoaXMuZWxlbSx0aGlzLnByb3ApO3RoaXMub3B0aW9ucy5zaG93PXRydWU7dGhpcy5jdXN0b20odGhpcy5wcm9wPT09IndpZHRoInx8dGhpcy5wcm9wPT09ImhlaWdodCI/MTowLHRoaXMuY3VyKCkpO2ModGhpcy5lbGVtKS5zaG93KCl9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMub3JpZ1t0aGlzLnByb3BdPWMuc3R5bGUodGhpcy5lbGVtLHRoaXMucHJvcCk7dGhpcy5vcHRpb25zLmhpZGU9dHJ1ZTt0aGlzLmN1c3RvbSh0aGlzLmN1cigpLDApfSxzdGVwOmZ1bmN0aW9uKGEpe3ZhciBiPUooKSxkPXRydWU7aWYoYXx8Yj49dGhpcy5vcHRpb25zLmR1cmF0aW9uK3RoaXMuc3RhcnRUaW1lKXt0aGlzLm5vdz0KdGhpcy5lbmQ7dGhpcy5wb3M9dGhpcy5zdGF0ZT0xO3RoaXMudXBkYXRlKCk7dGhpcy5vcHRpb25zLmN1ckFuaW1bdGhpcy5wcm9wXT10cnVlO2Zvcih2YXIgZiBpbiB0aGlzLm9wdGlvbnMuY3VyQW5pbSlpZih0aGlzLm9wdGlvbnMuY3VyQW5pbVtmXSE9PXRydWUpZD1mYWxzZTtpZihkKXtpZih0aGlzLm9wdGlvbnMuZGlzcGxheSE9bnVsbCl7dGhpcy5lbGVtLnN0eWxlLm92ZXJmbG93PXRoaXMub3B0aW9ucy5vdmVyZmxvdzthPWMuZGF0YSh0aGlzLmVsZW0sIm9sZGRpc3BsYXkiKTt0aGlzLmVsZW0uc3R5bGUuZGlzcGxheT1hP2E6dGhpcy5vcHRpb25zLmRpc3BsYXk7aWYoYy5jc3ModGhpcy5lbGVtLCJkaXNwbGF5Iik9PT0ibm9uZSIpdGhpcy5lbGVtLnN0eWxlLmRpc3BsYXk9ImJsb2NrIn10aGlzLm9wdGlvbnMuaGlkZSYmYyh0aGlzLmVsZW0pLmhpZGUoKTtpZih0aGlzLm9wdGlvbnMuaGlkZXx8dGhpcy5vcHRpb25zLnNob3cpZm9yKHZhciBlIGluIHRoaXMub3B0aW9ucy5jdXJBbmltKWMuc3R5bGUodGhpcy5lbGVtLAplLHRoaXMub3B0aW9ucy5vcmlnW2VdKTt0aGlzLm9wdGlvbnMuY29tcGxldGUuY2FsbCh0aGlzLmVsZW0pfXJldHVybiBmYWxzZX1lbHNle2U9Yi10aGlzLnN0YXJ0VGltZTt0aGlzLnN0YXRlPWUvdGhpcy5vcHRpb25zLmR1cmF0aW9uO2E9dGhpcy5vcHRpb25zLmVhc2luZ3x8KGMuZWFzaW5nLnN3aW5nPyJzd2luZyI6ImxpbmVhciIpO3RoaXMucG9zPWMuZWFzaW5nW3RoaXMub3B0aW9ucy5zcGVjaWFsRWFzaW5nJiZ0aGlzLm9wdGlvbnMuc3BlY2lhbEVhc2luZ1t0aGlzLnByb3BdfHxhXSh0aGlzLnN0YXRlLGUsMCwxLHRoaXMub3B0aW9ucy5kdXJhdGlvbik7dGhpcy5ub3c9dGhpcy5zdGFydCsodGhpcy5lbmQtdGhpcy5zdGFydCkqdGhpcy5wb3M7dGhpcy51cGRhdGUoKX1yZXR1cm4gdHJ1ZX19O2MuZXh0ZW5kKGMuZngse3RpY2s6ZnVuY3Rpb24oKXtmb3IodmFyIGE9Yy50aW1lcnMsYj0wO2I8YS5sZW5ndGg7YisrKWFbYl0oKXx8YS5zcGxpY2UoYi0tLDEpO2EubGVuZ3RofHwKYy5meC5zdG9wKCl9LHN0b3A6ZnVuY3Rpb24oKXtjbGVhckludGVydmFsKFcpO1c9bnVsbH0sc3BlZWRzOntzbG93OjYwMCxmYXN0OjIwMCxfZGVmYXVsdDo0MDB9LHN0ZXA6e29wYWNpdHk6ZnVuY3Rpb24oYSl7Yy5zdHlsZShhLmVsZW0sIm9wYWNpdHkiLGEubm93KX0sX2RlZmF1bHQ6ZnVuY3Rpb24oYSl7aWYoYS5lbGVtLnN0eWxlJiZhLmVsZW0uc3R5bGVbYS5wcm9wXSE9bnVsbClhLmVsZW0uc3R5bGVbYS5wcm9wXT0oYS5wcm9wPT09IndpZHRoInx8YS5wcm9wPT09ImhlaWdodCI/TWF0aC5tYXgoMCxhLm5vdyk6YS5ub3cpK2EudW5pdDtlbHNlIGEuZWxlbVthLnByb3BdPWEubm93fX19KTtpZihjLmV4cHImJmMuZXhwci5maWx0ZXJzKWMuZXhwci5maWx0ZXJzLmFuaW1hdGVkPWZ1bmN0aW9uKGEpe3JldHVybiBjLmdyZXAoYy50aW1lcnMsZnVuY3Rpb24oYil7cmV0dXJuIGE9PT1iLmVsZW19KS5sZW5ndGh9O2MuZm4ub2Zmc2V0PSJnZXRCb3VuZGluZ0NsaWVudFJlY3QiaW4gcy5kb2N1bWVudEVsZW1lbnQ/CmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF07aWYoYSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGUpe2Mub2Zmc2V0LnNldE9mZnNldCh0aGlzLGEsZSl9KTtpZighYnx8IWIub3duZXJEb2N1bWVudClyZXR1cm4gbnVsbDtpZihiPT09Yi5vd25lckRvY3VtZW50LmJvZHkpcmV0dXJuIGMub2Zmc2V0LmJvZHlPZmZzZXQoYik7dmFyIGQ9Yi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxmPWIub3duZXJEb2N1bWVudDtiPWYuYm9keTtmPWYuZG9jdW1lbnRFbGVtZW50O3JldHVybnt0b3A6ZC50b3ArKHNlbGYucGFnZVlPZmZzZXR8fGMuc3VwcG9ydC5ib3hNb2RlbCYmZi5zY3JvbGxUb3B8fGIuc2Nyb2xsVG9wKS0oZi5jbGllbnRUb3B8fGIuY2xpZW50VG9wfHwwKSxsZWZ0OmQubGVmdCsoc2VsZi5wYWdlWE9mZnNldHx8Yy5zdXBwb3J0LmJveE1vZGVsJiZmLnNjcm9sbExlZnR8fGIuc2Nyb2xsTGVmdCktKGYuY2xpZW50TGVmdHx8Yi5jbGllbnRMZWZ0fHwwKX19OmZ1bmN0aW9uKGEpe3ZhciBiPQp0aGlzWzBdO2lmKGEpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihyKXtjLm9mZnNldC5zZXRPZmZzZXQodGhpcyxhLHIpfSk7aWYoIWJ8fCFiLm93bmVyRG9jdW1lbnQpcmV0dXJuIG51bGw7aWYoYj09PWIub3duZXJEb2N1bWVudC5ib2R5KXJldHVybiBjLm9mZnNldC5ib2R5T2Zmc2V0KGIpO2Mub2Zmc2V0LmluaXRpYWxpemUoKTt2YXIgZD1iLm9mZnNldFBhcmVudCxmPWIsZT1iLm93bmVyRG9jdW1lbnQsaixpPWUuZG9jdW1lbnRFbGVtZW50LG89ZS5ib2R5O2Y9KGU9ZS5kZWZhdWx0Vmlldyk/ZS5nZXRDb21wdXRlZFN0eWxlKGIsbnVsbCk6Yi5jdXJyZW50U3R5bGU7Zm9yKHZhciBrPWIub2Zmc2V0VG9wLG49Yi5vZmZzZXRMZWZ0OyhiPWIucGFyZW50Tm9kZSkmJmIhPT1vJiZiIT09aTspe2lmKGMub2Zmc2V0LnN1cHBvcnRzRml4ZWRQb3NpdGlvbiYmZi5wb3NpdGlvbj09PSJmaXhlZCIpYnJlYWs7aj1lP2UuZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpOmIuY3VycmVudFN0eWxlOwprLT1iLnNjcm9sbFRvcDtuLT1iLnNjcm9sbExlZnQ7aWYoYj09PWQpe2srPWIub2Zmc2V0VG9wO24rPWIub2Zmc2V0TGVmdDtpZihjLm9mZnNldC5kb2VzTm90QWRkQm9yZGVyJiYhKGMub2Zmc2V0LmRvZXNBZGRCb3JkZXJGb3JUYWJsZUFuZENlbGxzJiYvXnQoYWJsZXxkfGgpJC9pLnRlc3QoYi5ub2RlTmFtZSkpKXtrKz1wYXJzZUZsb2F0KGouYm9yZGVyVG9wV2lkdGgpfHwwO24rPXBhcnNlRmxvYXQoai5ib3JkZXJMZWZ0V2lkdGgpfHwwfWY9ZDtkPWIub2Zmc2V0UGFyZW50fWlmKGMub2Zmc2V0LnN1YnRyYWN0c0JvcmRlckZvck92ZXJmbG93Tm90VmlzaWJsZSYmai5vdmVyZmxvdyE9PSJ2aXNpYmxlIil7ays9cGFyc2VGbG9hdChqLmJvcmRlclRvcFdpZHRoKXx8MDtuKz1wYXJzZUZsb2F0KGouYm9yZGVyTGVmdFdpZHRoKXx8MH1mPWp9aWYoZi5wb3NpdGlvbj09PSJyZWxhdGl2ZSJ8fGYucG9zaXRpb249PT0ic3RhdGljIil7ays9by5vZmZzZXRUb3A7bis9by5vZmZzZXRMZWZ0fWlmKGMub2Zmc2V0LnN1cHBvcnRzRml4ZWRQb3NpdGlvbiYmCmYucG9zaXRpb249PT0iZml4ZWQiKXtrKz1NYXRoLm1heChpLnNjcm9sbFRvcCxvLnNjcm9sbFRvcCk7bis9TWF0aC5tYXgoaS5zY3JvbGxMZWZ0LG8uc2Nyb2xsTGVmdCl9cmV0dXJue3RvcDprLGxlZnQ6bn19O2Mub2Zmc2V0PXtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIGE9cy5ib2R5LGI9cy5jcmVhdGVFbGVtZW50KCJkaXYiKSxkLGYsZSxqPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwibWFyZ2luVG9wIix0cnVlKSl8fDA7Yy5leHRlbmQoYi5zdHlsZSx7cG9zaXRpb246ImFic29sdXRlIix0b3A6MCxsZWZ0OjAsbWFyZ2luOjAsYm9yZGVyOjAsd2lkdGg6IjFweCIsaGVpZ2h0OiIxcHgiLHZpc2liaWxpdHk6ImhpZGRlbiJ9KTtiLmlubmVySFRNTD0iPGRpdiBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO21hcmdpbjowO2JvcmRlcjo1cHggc29saWQgIzAwMDtwYWRkaW5nOjA7d2lkdGg6MXB4O2hlaWdodDoxcHg7Jz48ZGl2PjwvZGl2PjwvZGl2Pjx0YWJsZSBzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO21hcmdpbjowO2JvcmRlcjo1cHggc29saWQgIzAwMDtwYWRkaW5nOjA7d2lkdGg6MXB4O2hlaWdodDoxcHg7JyBjZWxscGFkZGluZz0nMCcgY2VsbHNwYWNpbmc9JzAnPjx0cj48dGQ+PC90ZD48L3RyPjwvdGFibGU+IjsKYS5pbnNlcnRCZWZvcmUoYixhLmZpcnN0Q2hpbGQpO2Q9Yi5maXJzdENoaWxkO2Y9ZC5maXJzdENoaWxkO2U9ZC5uZXh0U2libGluZy5maXJzdENoaWxkLmZpcnN0Q2hpbGQ7dGhpcy5kb2VzTm90QWRkQm9yZGVyPWYub2Zmc2V0VG9wIT09NTt0aGlzLmRvZXNBZGRCb3JkZXJGb3JUYWJsZUFuZENlbGxzPWUub2Zmc2V0VG9wPT09NTtmLnN0eWxlLnBvc2l0aW9uPSJmaXhlZCI7Zi5zdHlsZS50b3A9IjIwcHgiO3RoaXMuc3VwcG9ydHNGaXhlZFBvc2l0aW9uPWYub2Zmc2V0VG9wPT09MjB8fGYub2Zmc2V0VG9wPT09MTU7Zi5zdHlsZS5wb3NpdGlvbj1mLnN0eWxlLnRvcD0iIjtkLnN0eWxlLm92ZXJmbG93PSJoaWRkZW4iO2Quc3R5bGUucG9zaXRpb249InJlbGF0aXZlIjt0aGlzLnN1YnRyYWN0c0JvcmRlckZvck92ZXJmbG93Tm90VmlzaWJsZT1mLm9mZnNldFRvcD09PS01O3RoaXMuZG9lc05vdEluY2x1ZGVNYXJnaW5JbkJvZHlPZmZzZXQ9YS5vZmZzZXRUb3AhPT1qO2EucmVtb3ZlQ2hpbGQoYik7CmMub2Zmc2V0LmluaXRpYWxpemU9Yy5ub29wfSxib2R5T2Zmc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEub2Zmc2V0VG9wLGQ9YS5vZmZzZXRMZWZ0O2Mub2Zmc2V0LmluaXRpYWxpemUoKTtpZihjLm9mZnNldC5kb2VzTm90SW5jbHVkZU1hcmdpbkluQm9keU9mZnNldCl7Yis9cGFyc2VGbG9hdChjLmN1ckNTUyhhLCJtYXJnaW5Ub3AiLHRydWUpKXx8MDtkKz1wYXJzZUZsb2F0KGMuY3VyQ1NTKGEsIm1hcmdpbkxlZnQiLHRydWUpKXx8MH1yZXR1cm57dG9wOmIsbGVmdDpkfX0sc2V0T2Zmc2V0OmZ1bmN0aW9uKGEsYixkKXtpZigvc3RhdGljLy50ZXN0KGMuY3VyQ1NTKGEsInBvc2l0aW9uIikpKWEuc3R5bGUucG9zaXRpb249InJlbGF0aXZlIjt2YXIgZj1jKGEpLGU9Zi5vZmZzZXQoKSxqPXBhcnNlSW50KGMuY3VyQ1NTKGEsInRvcCIsdHJ1ZSksMTApfHwwLGk9cGFyc2VJbnQoYy5jdXJDU1MoYSwibGVmdCIsdHJ1ZSksMTApfHwwO2lmKGMuaXNGdW5jdGlvbihiKSliPWIuY2FsbChhLApkLGUpO2Q9e3RvcDpiLnRvcC1lLnRvcCtqLGxlZnQ6Yi5sZWZ0LWUubGVmdCtpfTsidXNpbmciaW4gYj9iLnVzaW5nLmNhbGwoYSxkKTpmLmNzcyhkKX19O2MuZm4uZXh0ZW5kKHtwb3NpdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzWzBdKXJldHVybiBudWxsO3ZhciBhPXRoaXNbMF0sYj10aGlzLm9mZnNldFBhcmVudCgpLGQ9dGhpcy5vZmZzZXQoKSxmPS9eYm9keXxodG1sJC9pLnRlc3QoYlswXS5ub2RlTmFtZSk/e3RvcDowLGxlZnQ6MH06Yi5vZmZzZXQoKTtkLnRvcC09cGFyc2VGbG9hdChjLmN1ckNTUyhhLCJtYXJnaW5Ub3AiLHRydWUpKXx8MDtkLmxlZnQtPXBhcnNlRmxvYXQoYy5jdXJDU1MoYSwibWFyZ2luTGVmdCIsdHJ1ZSkpfHwwO2YudG9wKz1wYXJzZUZsb2F0KGMuY3VyQ1NTKGJbMF0sImJvcmRlclRvcFdpZHRoIix0cnVlKSl8fDA7Zi5sZWZ0Kz1wYXJzZUZsb2F0KGMuY3VyQ1NTKGJbMF0sImJvcmRlckxlZnRXaWR0aCIsdHJ1ZSkpfHwwO3JldHVybnt0b3A6ZC50b3AtCmYudG9wLGxlZnQ6ZC5sZWZ0LWYubGVmdH19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLm9mZnNldFBhcmVudHx8cy5ib2R5O2EmJiEvXmJvZHl8aHRtbCQvaS50ZXN0KGEubm9kZU5hbWUpJiZjLmNzcyhhLCJwb3NpdGlvbiIpPT09InN0YXRpYyI7KWE9YS5vZmZzZXRQYXJlbnQ7cmV0dXJuIGF9KX19KTtjLmVhY2goWyJMZWZ0IiwiVG9wIl0sZnVuY3Rpb24oYSxiKXt2YXIgZD0ic2Nyb2xsIitiO2MuZm5bZF09ZnVuY3Rpb24oZil7dmFyIGU9dGhpc1swXSxqO2lmKCFlKXJldHVybiBudWxsO2lmKGYhPT13KXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZihqPXdhKHRoaXMpKWouc2Nyb2xsVG8oIWE/ZjpjKGopLnNjcm9sbExlZnQoKSxhP2Y6YyhqKS5zY3JvbGxUb3AoKSk7ZWxzZSB0aGlzW2RdPWZ9KTtlbHNlIHJldHVybihqPXdhKGUpKT8icGFnZVhPZmZzZXQiaW4gaj9qW2E/InBhZ2VZT2Zmc2V0IjoKInBhZ2VYT2Zmc2V0Il06Yy5zdXBwb3J0LmJveE1vZGVsJiZqLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFtkXXx8ai5kb2N1bWVudC5ib2R5W2RdOmVbZF19fSk7Yy5lYWNoKFsiSGVpZ2h0IiwiV2lkdGgiXSxmdW5jdGlvbihhLGIpe3ZhciBkPWIudG9Mb3dlckNhc2UoKTtjLmZuWyJpbm5lciIrYl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1swXT9jLmNzcyh0aGlzWzBdLGQsZmFsc2UsInBhZGRpbmciKTpudWxsfTtjLmZuWyJvdXRlciIrYl09ZnVuY3Rpb24oZil7cmV0dXJuIHRoaXNbMF0/Yy5jc3ModGhpc1swXSxkLGZhbHNlLGY/Im1hcmdpbiI6ImJvcmRlciIpOm51bGx9O2MuZm5bZF09ZnVuY3Rpb24oZil7dmFyIGU9dGhpc1swXTtpZighZSlyZXR1cm4gZj09bnVsbD9udWxsOnRoaXM7aWYoYy5pc0Z1bmN0aW9uKGYpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oail7dmFyIGk9Yyh0aGlzKTtpW2RdKGYuY2FsbCh0aGlzLGosaVtkXSgpKSl9KTtyZXR1cm4ic2Nyb2xsVG8iaW4KZSYmZS5kb2N1bWVudD9lLmRvY3VtZW50LmNvbXBhdE1vZGU9PT0iQ1NTMUNvbXBhdCImJmUuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQiK2JdfHxlLmRvY3VtZW50LmJvZHlbImNsaWVudCIrYl06ZS5ub2RlVHlwZT09PTk/TWF0aC5tYXgoZS5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrYl0sZS5ib2R5WyJzY3JvbGwiK2JdLGUuZG9jdW1lbnRFbGVtZW50WyJzY3JvbGwiK2JdLGUuYm9keVsib2Zmc2V0IitiXSxlLmRvY3VtZW50RWxlbWVudFsib2Zmc2V0IitiXSk6Zj09PXc/Yy5jc3MoZSxkKTp0aGlzLmNzcyhkLHR5cGVvZiBmPT09InN0cmluZyI/ZjpmKyJweCIpfX0pO0EualF1ZXJ5PUEuJD1jfSkod2luZG93KTsK",
	"jquery-ui-custom.js": "LyohCiAqIGpRdWVyeSBVSSAxLjguMQogKgogKiBDb3B5cmlnaHQgKGMpIDIwMTAgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCAoTUlULUxJQ0VOU0UudHh0KQogKiBhbmQgR1BMIChHUEwtTElDRU5TRS50eHQpIGxpY2Vuc2VzLgogKgogKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJCiAqLwpqUXVlcnkudWl8fGZ1bmN0aW9uKGMpe2MudWk9e3ZlcnNpb246IjEuOC4xIixwbHVnaW46e2FkZDpmdW5jdGlvbihhLGIsZCl7YT1jLnVpW2FdLnByb3RvdHlwZTtmb3IodmFyIGUgaW4gZCl7YS5wbHVnaW5zW2VdPWEucGx1Z2luc1tlXXx8W107YS5wbHVnaW5zW2VdLnB1c2goW2IsZFtlXV0pfX0sY2FsbDpmdW5jdGlvbihhLGIsZCl7aWYoKGI9YS5wbHVnaW5zW2JdKSYmYS5lbGVtZW50WzBdLnBhcmVudE5vZGUpZm9yKHZhciBlPTA7ZTxiLmxlbmd0aDtlKyspYS5vcHRpb25zW2JbZV1bMF1dJiZiW2VdWzFdLmFwcGx5KGEuZWxlbWVudCxkKX19LGNvbnRhaW5zOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGRvY3VtZW50LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uP2EuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikmMTY6YSE9PWImJmEuY29udGFpbnMoYil9LGhhc1Njcm9sbDpmdW5jdGlvbihhLGIpe2lmKGMoYSkuY3NzKCJvdmVyZmxvdyIpPT0iaGlkZGVuIilyZXR1cm4gZmFsc2U7CmI9YiYmYj09ImxlZnQiPyJzY3JvbGxMZWZ0Ijoic2Nyb2xsVG9wIjt2YXIgZD1mYWxzZTtpZihhW2JdPjApcmV0dXJuIHRydWU7YVtiXT0xO2Q9YVtiXT4wO2FbYl09MDtyZXR1cm4gZH0saXNPdmVyQXhpczpmdW5jdGlvbihhLGIsZCl7cmV0dXJuIGE+YiYmYTxiK2R9LGlzT3ZlcjpmdW5jdGlvbihhLGIsZCxlLGYsZyl7cmV0dXJuIGMudWkuaXNPdmVyQXhpcyhhLGQsZikmJmMudWkuaXNPdmVyQXhpcyhiLGUsZyl9LGtleUNvZGU6e0FMVDoxOCxCQUNLU1BBQ0U6OCxDQVBTX0xPQ0s6MjAsQ09NTUE6MTg4LENPTlRST0w6MTcsREVMRVRFOjQ2LERPV046NDAsRU5EOjM1LEVOVEVSOjEzLEVTQ0FQRToyNyxIT01FOjM2LElOU0VSVDo0NSxMRUZUOjM3LE5VTVBBRF9BREQ6MTA3LE5VTVBBRF9ERUNJTUFMOjExMCxOVU1QQURfRElWSURFOjExMSxOVU1QQURfRU5URVI6MTA4LE5VTVBBRF9NVUxUSVBMWToxMDYsTlVNUEFEX1NVQlRSQUNUOjEwOSxQQUdFX0RPV046MzQsUEFHRV9VUDozMywKUEVSSU9EOjE5MCxSSUdIVDozOSxTSElGVDoxNixTUEFDRTozMixUQUI6OSxVUDozOH19O2MuZm4uZXh0ZW5kKHtfZm9jdXM6Yy5mbi5mb2N1cyxmb2N1czpmdW5jdGlvbihhLGIpe3JldHVybiB0eXBlb2YgYT09PSJudW1iZXIiP3RoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBkPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2MoZCkuZm9jdXMoKTtiJiZiLmNhbGwoZCl9LGEpfSk6dGhpcy5fZm9jdXMuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlbmFibGVTZWxlY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyKCJ1bnNlbGVjdGFibGUiLCJvZmYiKS5jc3MoIk1velVzZXJTZWxlY3QiLCIiKX0sZGlzYWJsZVNlbGVjdGlvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHIoInVuc2VsZWN0YWJsZSIsIm9uIikuY3NzKCJNb3pVc2VyU2VsZWN0Iiwibm9uZSIpfSxzY3JvbGxQYXJlbnQ6ZnVuY3Rpb24oKXt2YXIgYTthPWMuYnJvd3Nlci5tc2llJiYvKHN0YXRpY3xyZWxhdGl2ZSkvLnRlc3QodGhpcy5jc3MoInBvc2l0aW9uIikpfHwKL2Fic29sdXRlLy50ZXN0KHRoaXMuY3NzKCJwb3NpdGlvbiIpKT90aGlzLnBhcmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4vKHJlbGF0aXZlfGFic29sdXRlfGZpeGVkKS8udGVzdChjLmN1ckNTUyh0aGlzLCJwb3NpdGlvbiIsMSkpJiYvKGF1dG98c2Nyb2xsKS8udGVzdChjLmN1ckNTUyh0aGlzLCJvdmVyZmxvdyIsMSkrYy5jdXJDU1ModGhpcywib3ZlcmZsb3cteSIsMSkrYy5jdXJDU1ModGhpcywib3ZlcmZsb3cteCIsMSkpfSkuZXEoMCk6dGhpcy5wYXJlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuLyhhdXRvfHNjcm9sbCkvLnRlc3QoYy5jdXJDU1ModGhpcywib3ZlcmZsb3ciLDEpK2MuY3VyQ1NTKHRoaXMsIm92ZXJmbG93LXkiLDEpK2MuY3VyQ1NTKHRoaXMsIm92ZXJmbG93LXgiLDEpKX0pLmVxKDApO3JldHVybi9maXhlZC8udGVzdCh0aGlzLmNzcygicG9zaXRpb24iKSl8fCFhLmxlbmd0aD9jKGRvY3VtZW50KTphfSx6SW5kZXg6ZnVuY3Rpb24oYSl7aWYoYSE9PQp1bmRlZmluZWQpcmV0dXJuIHRoaXMuY3NzKCJ6SW5kZXgiLGEpO2lmKHRoaXMubGVuZ3RoKXthPWModGhpc1swXSk7Zm9yKHZhciBiO2EubGVuZ3RoJiZhWzBdIT09ZG9jdW1lbnQ7KXtiPWEuY3NzKCJwb3NpdGlvbiIpO2lmKGI9PSJhYnNvbHV0ZSJ8fGI9PSJyZWxhdGl2ZSJ8fGI9PSJmaXhlZCIpe2I9cGFyc2VJbnQoYS5jc3MoInpJbmRleCIpKTtpZighaXNOYU4oYikmJmIhPTApcmV0dXJuIGJ9YT1hLnBhcmVudCgpfX1yZXR1cm4gMH19KTtjLmV4dGVuZChjLmV4cHJbIjoiXSx7ZGF0YTpmdW5jdGlvbihhLGIsZCl7cmV0dXJuISFjLmRhdGEoYSxkWzNdKX0sZm9jdXNhYmxlOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxkPWMuYXR0cihhLCJ0YWJpbmRleCIpO3JldHVybigvaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QvLnRlc3QoYik/IWEuZGlzYWJsZWQ6ImEiPT1ifHwiYXJlYSI9PWI/YS5ocmVmfHwhaXNOYU4oZCk6IWlzTmFOKGQpKSYmCiFjKGEpWyJhcmVhIj09Yj8icGFyZW50cyI6ImNsb3Nlc3QiXSgiOmhpZGRlbiIpLmxlbmd0aH0sdGFiYmFibGU6ZnVuY3Rpb24oYSl7dmFyIGI9Yy5hdHRyKGEsInRhYmluZGV4Iik7cmV0dXJuKGlzTmFOKGIpfHxiPj0wKSYmYyhhKS5pcygiOmZvY3VzYWJsZSIpfX0pfShqUXVlcnkpOwo7LyohCiAqIGpRdWVyeSBVSSBXaWRnZXQgMS44LjEKICoKICogQ29weXJpZ2h0IChjKSAyMDEwIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KQogKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgKE1JVC1MSUNFTlNFLnR4dCkKICogYW5kIEdQTCAoR1BMLUxJQ0VOU0UudHh0KSBsaWNlbnNlcy4KICoKICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9XaWRnZXQKICovCihmdW5jdGlvbihiKXt2YXIgaj1iLmZuLnJlbW92ZTtiLmZuLnJlbW92ZT1mdW5jdGlvbihhLGMpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZighYylpZighYXx8Yi5maWx0ZXIoYSxbdGhpc10pLmxlbmd0aCliKCIqIix0aGlzKS5hZGQodGhpcykuZWFjaChmdW5jdGlvbigpe2IodGhpcykudHJpZ2dlckhhbmRsZXIoInJlbW92ZSIpfSk7cmV0dXJuIGouY2FsbChiKHRoaXMpLGEsYyl9KX07Yi53aWRnZXQ9ZnVuY3Rpb24oYSxjLGQpe3ZhciBlPWEuc3BsaXQoIi4iKVswXSxmO2E9YS5zcGxpdCgiLiIpWzFdO2Y9ZSsiLSIrYTtpZighZCl7ZD1jO2M9Yi5XaWRnZXR9Yi5leHByWyI6Il1bZl09ZnVuY3Rpb24oaCl7cmV0dXJuISFiLmRhdGEoaCxhKX07YltlXT1iW2VdfHx7fTtiW2VdW2FdPWZ1bmN0aW9uKGgsZyl7YXJndW1lbnRzLmxlbmd0aCYmdGhpcy5fY3JlYXRlV2lkZ2V0KGgsZyl9O2M9bmV3IGM7Yy5vcHRpb25zPWIuZXh0ZW5kKHt9LGMub3B0aW9ucyk7YltlXVthXS5wcm90b3R5cGU9CmIuZXh0ZW5kKHRydWUsYyx7bmFtZXNwYWNlOmUsd2lkZ2V0TmFtZTphLHdpZGdldEV2ZW50UHJlZml4OmJbZV1bYV0ucHJvdG90eXBlLndpZGdldEV2ZW50UHJlZml4fHxhLHdpZGdldEJhc2VDbGFzczpmfSxkKTtiLndpZGdldC5icmlkZ2UoYSxiW2VdW2FdKX07Yi53aWRnZXQuYnJpZGdlPWZ1bmN0aW9uKGEsYyl7Yi5mblthXT1mdW5jdGlvbihkKXt2YXIgZT10eXBlb2YgZD09PSJzdHJpbmciLGY9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLGg9dGhpcztkPSFlJiZmLmxlbmd0aD9iLmV4dGVuZC5hcHBseShudWxsLFt0cnVlLGRdLmNvbmNhdChmKSk6ZDtpZihlJiZkLnN1YnN0cmluZygwLDEpPT09Il8iKXJldHVybiBoO2U/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGc9Yi5kYXRhKHRoaXMsYSksaT1nJiZiLmlzRnVuY3Rpb24oZ1tkXSk/Z1tkXS5hcHBseShnLGYpOmc7aWYoaSE9PWcmJmkhPT11bmRlZmluZWQpe2g9aTtyZXR1cm4gZmFsc2V9fSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGc9CmIuZGF0YSh0aGlzLGEpO2lmKGcpe2QmJmcub3B0aW9uKGQpO2cuX2luaXQoKX1lbHNlIGIuZGF0YSh0aGlzLGEsbmV3IGMoZCx0aGlzKSl9KTtyZXR1cm4gaH19O2IuV2lkZ2V0PWZ1bmN0aW9uKGEsYyl7YXJndW1lbnRzLmxlbmd0aCYmdGhpcy5fY3JlYXRlV2lkZ2V0KGEsYyl9O2IuV2lkZ2V0LnByb3RvdHlwZT17d2lkZ2V0TmFtZToid2lkZ2V0Iix3aWRnZXRFdmVudFByZWZpeDoiIixvcHRpb25zOntkaXNhYmxlZDpmYWxzZX0sX2NyZWF0ZVdpZGdldDpmdW5jdGlvbihhLGMpe3RoaXMuZWxlbWVudD1iKGMpLmRhdGEodGhpcy53aWRnZXROYW1lLHRoaXMpO3RoaXMub3B0aW9ucz1iLmV4dGVuZCh0cnVlLHt9LHRoaXMub3B0aW9ucyxiLm1ldGFkYXRhJiZiLm1ldGFkYXRhLmdldChjKVt0aGlzLndpZGdldE5hbWVdLGEpO3ZhciBkPXRoaXM7dGhpcy5lbGVtZW50LmJpbmQoInJlbW92ZS4iK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbigpe2QuZGVzdHJveSgpfSk7dGhpcy5fY3JlYXRlKCk7CnRoaXMuX2luaXQoKX0sX2NyZWF0ZTpmdW5jdGlvbigpe30sX2luaXQ6ZnVuY3Rpb24oKXt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQudW5iaW5kKCIuIit0aGlzLndpZGdldE5hbWUpLnJlbW92ZURhdGEodGhpcy53aWRnZXROYW1lKTt0aGlzLndpZGdldCgpLnVuYmluZCgiLiIrdGhpcy53aWRnZXROYW1lKS5yZW1vdmVBdHRyKCJhcmlhLWRpc2FibGVkIikucmVtb3ZlQ2xhc3ModGhpcy53aWRnZXRCYXNlQ2xhc3MrIi1kaXNhYmxlZCB1aS1zdGF0ZS1kaXNhYmxlZCIpfSx3aWRnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbGVtZW50fSxvcHRpb246ZnVuY3Rpb24oYSxjKXt2YXIgZD1hLGU9dGhpcztpZihhcmd1bWVudHMubGVuZ3RoPT09MClyZXR1cm4gYi5leHRlbmQoe30sZS5vcHRpb25zKTtpZih0eXBlb2YgYT09PSJzdHJpbmciKXtpZihjPT09dW5kZWZpbmVkKXJldHVybiB0aGlzLm9wdGlvbnNbYV07ZD17fTtkW2FdPWN9Yi5lYWNoKGQsZnVuY3Rpb24oZiwKaCl7ZS5fc2V0T3B0aW9uKGYsaCl9KTtyZXR1cm4gZX0sX3NldE9wdGlvbjpmdW5jdGlvbihhLGMpe3RoaXMub3B0aW9uc1thXT1jO2lmKGE9PT0iZGlzYWJsZWQiKXRoaXMud2lkZ2V0KClbYz8iYWRkQ2xhc3MiOiJyZW1vdmVDbGFzcyJdKHRoaXMud2lkZ2V0QmFzZUNsYXNzKyItZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIixjKTtyZXR1cm4gdGhpc30sZW5hYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NldE9wdGlvbigiZGlzYWJsZWQiLGZhbHNlKX0sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zZXRPcHRpb24oImRpc2FibGVkIix0cnVlKX0sX3RyaWdnZXI6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlPXRoaXMub3B0aW9uc1thXTtjPWIuRXZlbnQoYyk7Yy50eXBlPShhPT09dGhpcy53aWRnZXRFdmVudFByZWZpeD9hOnRoaXMud2lkZ2V0RXZlbnRQcmVmaXgrYSkudG9Mb3dlckNhc2UoKTtkPWR8fHt9O2lmKGMub3JpZ2luYWxFdmVudCl7YT0KYi5ldmVudC5wcm9wcy5sZW5ndGg7Zm9yKHZhciBmO2E7KXtmPWIuZXZlbnQucHJvcHNbLS1hXTtjW2ZdPWMub3JpZ2luYWxFdmVudFtmXX19dGhpcy5lbGVtZW50LnRyaWdnZXIoYyxkKTtyZXR1cm4hKGIuaXNGdW5jdGlvbihlKSYmZS5jYWxsKHRoaXMuZWxlbWVudFswXSxjLGQpPT09ZmFsc2V8fGMuaXNEZWZhdWx0UHJldmVudGVkKCkpfX19KShqUXVlcnkpOwo7LyohCiAqIGpRdWVyeSBVSSBNb3VzZSAxLjguMQogKgogKiBDb3B5cmlnaHQgKGMpIDIwMTAgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCAoTUlULUxJQ0VOU0UudHh0KQogKiBhbmQgR1BMIChHUEwtTElDRU5TRS50eHQpIGxpY2Vuc2VzLgogKgogKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL01vdXNlCiAqCiAqIERlcGVuZHM6CiAqCWpxdWVyeS51aS53aWRnZXQuanMKICovCihmdW5jdGlvbihjKXtjLndpZGdldCgidWkubW91c2UiLHtvcHRpb25zOntjYW5jZWw6IjppbnB1dCxvcHRpb24iLGRpc3RhbmNlOjEsZGVsYXk6MH0sX21vdXNlSW5pdDpmdW5jdGlvbigpe3ZhciBhPXRoaXM7dGhpcy5lbGVtZW50LmJpbmQoIm1vdXNlZG93bi4iK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbihiKXtyZXR1cm4gYS5fbW91c2VEb3duKGIpfSkuYmluZCgiY2xpY2suIit0aGlzLndpZGdldE5hbWUsZnVuY3Rpb24oYil7aWYoYS5fcHJldmVudENsaWNrRXZlbnQpe2EuX3ByZXZlbnRDbGlja0V2ZW50PWZhbHNlO2Iuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7cmV0dXJuIGZhbHNlfX0pO3RoaXMuc3RhcnRlZD1mYWxzZX0sX21vdXNlRGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC51bmJpbmQoIi4iK3RoaXMud2lkZ2V0TmFtZSl9LF9tb3VzZURvd246ZnVuY3Rpb24oYSl7YS5vcmlnaW5hbEV2ZW50PWEub3JpZ2luYWxFdmVudHx8e307aWYoIWEub3JpZ2luYWxFdmVudC5tb3VzZUhhbmRsZWQpe3RoaXMuX21vdXNlU3RhcnRlZCYmCnRoaXMuX21vdXNlVXAoYSk7dGhpcy5fbW91c2VEb3duRXZlbnQ9YTt2YXIgYj10aGlzLGU9YS53aGljaD09MSxmPXR5cGVvZiB0aGlzLm9wdGlvbnMuY2FuY2VsPT0ic3RyaW5nIj9jKGEudGFyZ2V0KS5wYXJlbnRzKCkuYWRkKGEudGFyZ2V0KS5maWx0ZXIodGhpcy5vcHRpb25zLmNhbmNlbCkubGVuZ3RoOmZhbHNlO2lmKCFlfHxmfHwhdGhpcy5fbW91c2VDYXB0dXJlKGEpKXJldHVybiB0cnVlO3RoaXMubW91c2VEZWxheU1ldD0hdGhpcy5vcHRpb25zLmRlbGF5O2lmKCF0aGlzLm1vdXNlRGVsYXlNZXQpdGhpcy5fbW91c2VEZWxheVRpbWVyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtiLm1vdXNlRGVsYXlNZXQ9dHJ1ZX0sdGhpcy5vcHRpb25zLmRlbGF5KTtpZih0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGEpJiZ0aGlzLl9tb3VzZURlbGF5TWV0KGEpKXt0aGlzLl9tb3VzZVN0YXJ0ZWQ9dGhpcy5fbW91c2VTdGFydChhKSE9PWZhbHNlO2lmKCF0aGlzLl9tb3VzZVN0YXJ0ZWQpe2EucHJldmVudERlZmF1bHQoKTsKcmV0dXJuIHRydWV9fXRoaXMuX21vdXNlTW92ZURlbGVnYXRlPWZ1bmN0aW9uKGQpe3JldHVybiBiLl9tb3VzZU1vdmUoZCl9O3RoaXMuX21vdXNlVXBEZWxlZ2F0ZT1mdW5jdGlvbihkKXtyZXR1cm4gYi5fbW91c2VVcChkKX07Yyhkb2N1bWVudCkuYmluZCgibW91c2Vtb3ZlLiIrdGhpcy53aWRnZXROYW1lLHRoaXMuX21vdXNlTW92ZURlbGVnYXRlKS5iaW5kKCJtb3VzZXVwLiIrdGhpcy53aWRnZXROYW1lLHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSk7Yy5icm93c2VyLnNhZmFyaXx8YS5wcmV2ZW50RGVmYXVsdCgpO3JldHVybiBhLm9yaWdpbmFsRXZlbnQubW91c2VIYW5kbGVkPXRydWV9fSxfbW91c2VNb3ZlOmZ1bmN0aW9uKGEpe2lmKGMuYnJvd3Nlci5tc2llJiYhYS5idXR0b24pcmV0dXJuIHRoaXMuX21vdXNlVXAoYSk7aWYodGhpcy5fbW91c2VTdGFydGVkKXt0aGlzLl9tb3VzZURyYWcoYSk7cmV0dXJuIGEucHJldmVudERlZmF1bHQoKX1pZih0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGEpJiYKdGhpcy5fbW91c2VEZWxheU1ldChhKSkodGhpcy5fbW91c2VTdGFydGVkPXRoaXMuX21vdXNlU3RhcnQodGhpcy5fbW91c2VEb3duRXZlbnQsYSkhPT1mYWxzZSk/dGhpcy5fbW91c2VEcmFnKGEpOnRoaXMuX21vdXNlVXAoYSk7cmV0dXJuIXRoaXMuX21vdXNlU3RhcnRlZH0sX21vdXNlVXA6ZnVuY3Rpb24oYSl7Yyhkb2N1bWVudCkudW5iaW5kKCJtb3VzZW1vdmUuIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUpLnVuYmluZCgibW91c2V1cC4iK3RoaXMud2lkZ2V0TmFtZSx0aGlzLl9tb3VzZVVwRGVsZWdhdGUpO2lmKHRoaXMuX21vdXNlU3RhcnRlZCl7dGhpcy5fbW91c2VTdGFydGVkPWZhbHNlO3RoaXMuX3ByZXZlbnRDbGlja0V2ZW50PWEudGFyZ2V0PT10aGlzLl9tb3VzZURvd25FdmVudC50YXJnZXQ7dGhpcy5fbW91c2VTdG9wKGEpfXJldHVybiBmYWxzZX0sX21vdXNlRGlzdGFuY2VNZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIE1hdGgubWF4KE1hdGguYWJzKHRoaXMuX21vdXNlRG93bkV2ZW50LnBhZ2VYLQphLnBhZ2VYKSxNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWS1hLnBhZ2VZKSk+PXRoaXMub3B0aW9ucy5kaXN0YW5jZX0sX21vdXNlRGVsYXlNZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb3VzZURlbGF5TWV0fSxfbW91c2VTdGFydDpmdW5jdGlvbigpe30sX21vdXNlRHJhZzpmdW5jdGlvbigpe30sX21vdXNlU3RvcDpmdW5jdGlvbigpe30sX21vdXNlQ2FwdHVyZTpmdW5jdGlvbigpe3JldHVybiB0cnVlfX0pfSkoalF1ZXJ5KTsKOy8qCiAqIGpRdWVyeSBVSSBEcmFnZ2FibGUgMS44LjEKICoKICogQ29weXJpZ2h0IChjKSAyMDEwIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KQogKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgKE1JVC1MSUNFTlNFLnR4dCkKICogYW5kIEdQTCAoR1BMLUxJQ0VOU0UudHh0KSBsaWNlbnNlcy4KICoKICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9EcmFnZ2FibGVzCiAqCiAqIERlcGVuZHM6CiAqCWpxdWVyeS51aS5jb3JlLmpzCiAqCWpxdWVyeS51aS5tb3VzZS5qcwogKglqcXVlcnkudWkud2lkZ2V0LmpzCiAqLwooZnVuY3Rpb24oZCl7ZC53aWRnZXQoInVpLmRyYWdnYWJsZSIsZC51aS5tb3VzZSx7d2lkZ2V0RXZlbnRQcmVmaXg6ImRyYWciLG9wdGlvbnM6e2FkZENsYXNzZXM6dHJ1ZSxhcHBlbmRUbzoicGFyZW50IixheGlzOmZhbHNlLGNvbm5lY3RUb1NvcnRhYmxlOmZhbHNlLGNvbnRhaW5tZW50OmZhbHNlLGN1cnNvcjoiYXV0byIsY3Vyc29yQXQ6ZmFsc2UsZ3JpZDpmYWxzZSxoYW5kbGU6ZmFsc2UsaGVscGVyOiJvcmlnaW5hbCIsaWZyYW1lRml4OmZhbHNlLG9wYWNpdHk6ZmFsc2UscmVmcmVzaFBvc2l0aW9uczpmYWxzZSxyZXZlcnQ6ZmFsc2UscmV2ZXJ0RHVyYXRpb246NTAwLHNjb3BlOiJkZWZhdWx0IixzY3JvbGw6dHJ1ZSxzY3JvbGxTZW5zaXRpdml0eToyMCxzY3JvbGxTcGVlZDoyMCxzbmFwOmZhbHNlLHNuYXBNb2RlOiJib3RoIixzbmFwVG9sZXJhbmNlOjIwLHN0YWNrOmZhbHNlLHpJbmRleDpmYWxzZX0sX2NyZWF0ZTpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5oZWxwZXI9PQoib3JpZ2luYWwiJiYhL14oPzpyfGF8ZikvLnRlc3QodGhpcy5lbGVtZW50LmNzcygicG9zaXRpb24iKSkpdGhpcy5lbGVtZW50WzBdLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSI7dGhpcy5vcHRpb25zLmFkZENsYXNzZXMmJnRoaXMuZWxlbWVudC5hZGRDbGFzcygidWktZHJhZ2dhYmxlIik7dGhpcy5vcHRpb25zLmRpc2FibGVkJiZ0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoInVpLWRyYWdnYWJsZS1kaXNhYmxlZCIpO3RoaXMuX21vdXNlSW5pdCgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtZW50LmRhdGEoImRyYWdnYWJsZSIpKXt0aGlzLmVsZW1lbnQucmVtb3ZlRGF0YSgiZHJhZ2dhYmxlIikudW5iaW5kKCIuZHJhZ2dhYmxlIikucmVtb3ZlQ2xhc3MoInVpLWRyYWdnYWJsZSB1aS1kcmFnZ2FibGUtZHJhZ2dpbmcgdWktZHJhZ2dhYmxlLWRpc2FibGVkIik7dGhpcy5fbW91c2VEZXN0cm95KCk7cmV0dXJuIHRoaXN9fSxfbW91c2VDYXB0dXJlOmZ1bmN0aW9uKGEpe3ZhciBiPQp0aGlzLm9wdGlvbnM7aWYodGhpcy5oZWxwZXJ8fGIuZGlzYWJsZWR8fGQoYS50YXJnZXQpLmlzKCIudWktcmVzaXphYmxlLWhhbmRsZSIpKXJldHVybiBmYWxzZTt0aGlzLmhhbmRsZT10aGlzLl9nZXRIYW5kbGUoYSk7aWYoIXRoaXMuaGFuZGxlKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZX0sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zO3RoaXMuaGVscGVyPXRoaXMuX2NyZWF0ZUhlbHBlcihhKTt0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7aWYoZC51aS5kZG1hbmFnZXIpZC51aS5kZG1hbmFnZXIuY3VycmVudD10aGlzO3RoaXMuX2NhY2hlTWFyZ2lucygpO3RoaXMuY3NzUG9zaXRpb249dGhpcy5oZWxwZXIuY3NzKCJwb3NpdGlvbiIpO3RoaXMuc2Nyb2xsUGFyZW50PXRoaXMuaGVscGVyLnNjcm9sbFBhcmVudCgpO3RoaXMub2Zmc2V0PXRoaXMucG9zaXRpb25BYnM9dGhpcy5lbGVtZW50Lm9mZnNldCgpO3RoaXMub2Zmc2V0PXt0b3A6dGhpcy5vZmZzZXQudG9wLQp0aGlzLm1hcmdpbnMudG9wLGxlZnQ6dGhpcy5vZmZzZXQubGVmdC10aGlzLm1hcmdpbnMubGVmdH07ZC5leHRlbmQodGhpcy5vZmZzZXQse2NsaWNrOntsZWZ0OmEucGFnZVgtdGhpcy5vZmZzZXQubGVmdCx0b3A6YS5wYWdlWS10aGlzLm9mZnNldC50b3B9LHBhcmVudDp0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSxyZWxhdGl2ZTp0aGlzLl9nZXRSZWxhdGl2ZU9mZnNldCgpfSk7dGhpcy5vcmlnaW5hbFBvc2l0aW9uPXRoaXMucG9zaXRpb249dGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihhKTt0aGlzLm9yaWdpbmFsUGFnZVg9YS5wYWdlWDt0aGlzLm9yaWdpbmFsUGFnZVk9YS5wYWdlWTtiLmN1cnNvckF0JiZ0aGlzLl9hZGp1c3RPZmZzZXRGcm9tSGVscGVyKGIuY3Vyc29yQXQpO2IuY29udGFpbm1lbnQmJnRoaXMuX3NldENvbnRhaW5tZW50KCk7aWYodGhpcy5fdHJpZ2dlcigic3RhcnQiLGEpPT09ZmFsc2Upe3RoaXMuX2NsZWFyKCk7cmV0dXJuIGZhbHNlfXRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTsKZC51aS5kZG1hbmFnZXImJiFiLmRyb3BCZWhhdmlvdXImJmQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKHRoaXMsYSk7dGhpcy5oZWxwZXIuYWRkQ2xhc3MoInVpLWRyYWdnYWJsZS1kcmFnZ2luZyIpO3RoaXMuX21vdXNlRHJhZyhhLHRydWUpO3JldHVybiB0cnVlfSxfbW91c2VEcmFnOmZ1bmN0aW9uKGEsYil7dGhpcy5wb3NpdGlvbj10aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKGEpO3RoaXMucG9zaXRpb25BYnM9dGhpcy5fY29udmVydFBvc2l0aW9uVG8oImFic29sdXRlIik7aWYoIWIpe2I9dGhpcy5fdWlIYXNoKCk7aWYodGhpcy5fdHJpZ2dlcigiZHJhZyIsYSxiKT09PWZhbHNlKXt0aGlzLl9tb3VzZVVwKHt9KTtyZXR1cm4gZmFsc2V9dGhpcy5wb3NpdGlvbj1iLnBvc2l0aW9ufWlmKCF0aGlzLm9wdGlvbnMuYXhpc3x8dGhpcy5vcHRpb25zLmF4aXMhPSJ5Iil0aGlzLmhlbHBlclswXS5zdHlsZS5sZWZ0PXRoaXMucG9zaXRpb24ubGVmdCsicHgiO2lmKCF0aGlzLm9wdGlvbnMuYXhpc3x8CnRoaXMub3B0aW9ucy5heGlzIT0ieCIpdGhpcy5oZWxwZXJbMF0uc3R5bGUudG9wPXRoaXMucG9zaXRpb24udG9wKyJweCI7ZC51aS5kZG1hbmFnZXImJmQudWkuZGRtYW5hZ2VyLmRyYWcodGhpcyxhKTtyZXR1cm4gZmFsc2V9LF9tb3VzZVN0b3A6ZnVuY3Rpb24oYSl7dmFyIGI9ZmFsc2U7aWYoZC51aS5kZG1hbmFnZXImJiF0aGlzLm9wdGlvbnMuZHJvcEJlaGF2aW91ciliPWQudWkuZGRtYW5hZ2VyLmRyb3AodGhpcyxhKTtpZih0aGlzLmRyb3BwZWQpe2I9dGhpcy5kcm9wcGVkO3RoaXMuZHJvcHBlZD1mYWxzZX1pZighdGhpcy5lbGVtZW50WzBdfHwhdGhpcy5lbGVtZW50WzBdLnBhcmVudE5vZGUpcmV0dXJuIGZhbHNlO2lmKHRoaXMub3B0aW9ucy5yZXZlcnQ9PSJpbnZhbGlkIiYmIWJ8fHRoaXMub3B0aW9ucy5yZXZlcnQ9PSJ2YWxpZCImJmJ8fHRoaXMub3B0aW9ucy5yZXZlcnQ9PT10cnVlfHxkLmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLnJldmVydCkmJnRoaXMub3B0aW9ucy5yZXZlcnQuY2FsbCh0aGlzLmVsZW1lbnQsCmIpKXt2YXIgYz10aGlzO2QodGhpcy5oZWxwZXIpLmFuaW1hdGUodGhpcy5vcmlnaW5hbFBvc2l0aW9uLHBhcnNlSW50KHRoaXMub3B0aW9ucy5yZXZlcnREdXJhdGlvbiwxMCksZnVuY3Rpb24oKXtjLl90cmlnZ2VyKCJzdG9wIixhKSE9PWZhbHNlJiZjLl9jbGVhcigpfSl9ZWxzZSB0aGlzLl90cmlnZ2VyKCJzdG9wIixhKSE9PWZhbHNlJiZ0aGlzLl9jbGVhcigpO3JldHVybiBmYWxzZX0sY2FuY2VsOmZ1bmN0aW9uKCl7dGhpcy5oZWxwZXIuaXMoIi51aS1kcmFnZ2FibGUtZHJhZ2dpbmciKT90aGlzLl9tb3VzZVVwKHt9KTp0aGlzLl9jbGVhcigpO3JldHVybiB0aGlzfSxfZ2V0SGFuZGxlOmZ1bmN0aW9uKGEpe3ZhciBiPSF0aGlzLm9wdGlvbnMuaGFuZGxlfHwhZCh0aGlzLm9wdGlvbnMuaGFuZGxlLHRoaXMuZWxlbWVudCkubGVuZ3RoP3RydWU6ZmFsc2U7ZCh0aGlzLm9wdGlvbnMuaGFuZGxlLHRoaXMuZWxlbWVudCkuZmluZCgiKiIpLmFuZFNlbGYoKS5lYWNoKGZ1bmN0aW9uKCl7aWYodGhpcz09CmEudGFyZ2V0KWI9dHJ1ZX0pO3JldHVybiBifSxfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9uczthPWQuaXNGdW5jdGlvbihiLmhlbHBlcik/ZChiLmhlbHBlci5hcHBseSh0aGlzLmVsZW1lbnRbMF0sW2FdKSk6Yi5oZWxwZXI9PSJjbG9uZSI/dGhpcy5lbGVtZW50LmNsb25lKCk6dGhpcy5lbGVtZW50O2EucGFyZW50cygiYm9keSIpLmxlbmd0aHx8YS5hcHBlbmRUbyhiLmFwcGVuZFRvPT0icGFyZW50Ij90aGlzLmVsZW1lbnRbMF0ucGFyZW50Tm9kZTpiLmFwcGVuZFRvKTthWzBdIT10aGlzLmVsZW1lbnRbMF0mJiEvKGZpeGVkfGFic29sdXRlKS8udGVzdChhLmNzcygicG9zaXRpb24iKSkmJmEuY3NzKCJwb3NpdGlvbiIsImFic29sdXRlIik7cmV0dXJuIGF9LF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOmZ1bmN0aW9uKGEpe2lmKHR5cGVvZiBhPT0ic3RyaW5nIilhPWEuc3BsaXQoIiAiKTtpZihkLmlzQXJyYXkoYSkpYT17bGVmdDorYVswXSx0b3A6K2FbMV18fAowfTtpZigibGVmdCJpbiBhKXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ9YS5sZWZ0K3RoaXMubWFyZ2lucy5sZWZ0O2lmKCJyaWdodCJpbiBhKXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ9dGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC1hLnJpZ2h0K3RoaXMubWFyZ2lucy5sZWZ0O2lmKCJ0b3AiaW4gYSl0aGlzLm9mZnNldC5jbGljay50b3A9YS50b3ArdGhpcy5tYXJnaW5zLnRvcDtpZigiYm90dG9tImluIGEpdGhpcy5vZmZzZXQuY2xpY2sudG9wPXRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LWEuYm90dG9tK3RoaXMubWFyZ2lucy50b3B9LF9nZXRQYXJlbnRPZmZzZXQ6ZnVuY3Rpb24oKXt0aGlzLm9mZnNldFBhcmVudD10aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKTt2YXIgYT10aGlzLm9mZnNldFBhcmVudC5vZmZzZXQoKTtpZih0aGlzLmNzc1Bvc2l0aW9uPT0iYWJzb2x1dGUiJiZ0aGlzLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmQudWkuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sCnRoaXMub2Zmc2V0UGFyZW50WzBdKSl7YS5sZWZ0Kz10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCk7YS50b3ArPXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpfWlmKHRoaXMub2Zmc2V0UGFyZW50WzBdPT1kb2N1bWVudC5ib2R5fHx0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lJiZ0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lLnRvTG93ZXJDYXNlKCk9PSJodG1sIiYmZC5icm93c2VyLm1zaWUpYT17dG9wOjAsbGVmdDowfTtyZXR1cm57dG9wOmEudG9wKyhwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoImJvcmRlclRvcFdpZHRoIiksMTApfHwwKSxsZWZ0OmEubGVmdCsocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDApfX0sX2dldFJlbGF0aXZlT2Zmc2V0OmZ1bmN0aW9uKCl7aWYodGhpcy5jc3NQb3NpdGlvbj09InJlbGF0aXZlIil7dmFyIGE9dGhpcy5lbGVtZW50LnBvc2l0aW9uKCk7cmV0dXJue3RvcDphLnRvcC0KKHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcygidG9wIiksMTApfHwwKSt0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSxsZWZ0OmEubGVmdC0ocGFyc2VJbnQodGhpcy5oZWxwZXIuY3NzKCJsZWZ0IiksMTApfHwwKSt0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCl9fWVsc2UgcmV0dXJue3RvcDowLGxlZnQ6MH19LF9jYWNoZU1hcmdpbnM6ZnVuY3Rpb24oKXt0aGlzLm1hcmdpbnM9e2xlZnQ6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcygibWFyZ2luTGVmdCIpLDEwKXx8MCx0b3A6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcygibWFyZ2luVG9wIiksMTApfHwwfX0sX2NhY2hlSGVscGVyUHJvcG9ydGlvbnM6ZnVuY3Rpb24oKXt0aGlzLmhlbHBlclByb3BvcnRpb25zPXt3aWR0aDp0aGlzLmhlbHBlci5vdXRlcldpZHRoKCksaGVpZ2h0OnRoaXMuaGVscGVyLm91dGVySGVpZ2h0KCl9fSxfc2V0Q29udGFpbm1lbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnM7aWYoYS5jb250YWlubWVudD09CiJwYXJlbnQiKWEuY29udGFpbm1lbnQ9dGhpcy5oZWxwZXJbMF0ucGFyZW50Tm9kZTtpZihhLmNvbnRhaW5tZW50PT0iZG9jdW1lbnQifHxhLmNvbnRhaW5tZW50PT0id2luZG93Iil0aGlzLmNvbnRhaW5tZW50PVswLXRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQtdGhpcy5vZmZzZXQucGFyZW50LmxlZnQsMC10aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AtdGhpcy5vZmZzZXQucGFyZW50LnRvcCxkKGEuY29udGFpbm1lbnQ9PSJkb2N1bWVudCI/ZG9jdW1lbnQ6d2luZG93KS53aWR0aCgpLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtdGhpcy5tYXJnaW5zLmxlZnQsKGQoYS5jb250YWlubWVudD09ImRvY3VtZW50Ij9kb2N1bWVudDp3aW5kb3cpLmhlaWdodCgpfHxkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0KS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wXTtpZighL14oZG9jdW1lbnR8d2luZG93fHBhcmVudCkkLy50ZXN0KGEuY29udGFpbm1lbnQpJiYKYS5jb250YWlubWVudC5jb25zdHJ1Y3RvciE9QXJyYXkpe3ZhciBiPWQoYS5jb250YWlubWVudClbMF07aWYoYil7YT1kKGEuY29udGFpbm1lbnQpLm9mZnNldCgpO3ZhciBjPWQoYikuY3NzKCJvdmVyZmxvdyIpIT0iaGlkZGVuIjt0aGlzLmNvbnRhaW5tZW50PVthLmxlZnQrKHBhcnNlSW50KGQoYikuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDApKyhwYXJzZUludChkKGIpLmNzcygicGFkZGluZ0xlZnQiKSwxMCl8fDApLXRoaXMubWFyZ2lucy5sZWZ0LGEudG9wKyhwYXJzZUludChkKGIpLmNzcygiYm9yZGVyVG9wV2lkdGgiKSwxMCl8fDApKyhwYXJzZUludChkKGIpLmNzcygicGFkZGluZ1RvcCIpLDEwKXx8MCktdGhpcy5tYXJnaW5zLnRvcCxhLmxlZnQrKGM/TWF0aC5tYXgoYi5zY3JvbGxXaWR0aCxiLm9mZnNldFdpZHRoKTpiLm9mZnNldFdpZHRoKS0ocGFyc2VJbnQoZChiKS5jc3MoImJvcmRlckxlZnRXaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KGQoYikuY3NzKCJwYWRkaW5nUmlnaHQiKSwKMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLXRoaXMubWFyZ2lucy5sZWZ0LGEudG9wKyhjP01hdGgubWF4KGIuc2Nyb2xsSGVpZ2h0LGIub2Zmc2V0SGVpZ2h0KTpiLm9mZnNldEhlaWdodCktKHBhcnNlSW50KGQoYikuY3NzKCJib3JkZXJUb3BXaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KGQoYikuY3NzKCJwYWRkaW5nQm90dG9tIiksMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wXX19ZWxzZSBpZihhLmNvbnRhaW5tZW50LmNvbnN0cnVjdG9yPT1BcnJheSl0aGlzLmNvbnRhaW5tZW50PWEuY29udGFpbm1lbnR9LF9jb252ZXJ0UG9zaXRpb25UbzpmdW5jdGlvbihhLGIpe2lmKCFiKWI9dGhpcy5wb3NpdGlvbjthPWE9PSJhYnNvbHV0ZSI/MTotMTt2YXIgYz10aGlzLmNzc1Bvc2l0aW9uPT0iYWJzb2x1dGUiJiYhKHRoaXMuc2Nyb2xsUGFyZW50WzBdIT1kb2N1bWVudCYmZC51aS5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSwKdGhpcy5vZmZzZXRQYXJlbnRbMF0pKT90aGlzLm9mZnNldFBhcmVudDp0aGlzLnNjcm9sbFBhcmVudCxmPS8oaHRtbHxib2R5KS9pLnRlc3QoY1swXS50YWdOYW1lKTtyZXR1cm57dG9wOmIudG9wK3RoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCphK3RoaXMub2Zmc2V0LnBhcmVudC50b3AqYS0oZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT0iZml4ZWQiPzA6KHRoaXMuY3NzUG9zaXRpb249PSJmaXhlZCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpOmY/MDpjLnNjcm9sbFRvcCgpKSphKSxsZWZ0OmIubGVmdCt0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0KmErdGhpcy5vZmZzZXQucGFyZW50LmxlZnQqYS0oZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT0iZml4ZWQiPzA6KHRoaXMuY3NzUG9zaXRpb249PSJmaXhlZCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKToKZj8wOmMuc2Nyb2xsTGVmdCgpKSphKX19LF9nZW5lcmF0ZVBvc2l0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPXRoaXMuY3NzUG9zaXRpb249PSJhYnNvbHV0ZSImJiEodGhpcy5zY3JvbGxQYXJlbnRbMF0hPWRvY3VtZW50JiZkLnVpLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLHRoaXMub2Zmc2V0UGFyZW50WzBdKSk/dGhpcy5vZmZzZXRQYXJlbnQ6dGhpcy5zY3JvbGxQYXJlbnQsZj0vKGh0bWx8Ym9keSkvaS50ZXN0KGNbMF0udGFnTmFtZSksZT1hLnBhZ2VYLGc9YS5wYWdlWTtpZih0aGlzLm9yaWdpbmFsUG9zaXRpb24pe2lmKHRoaXMuY29udGFpbm1lbnQpe2lmKGEucGFnZVgtdGhpcy5vZmZzZXQuY2xpY2subGVmdDx0aGlzLmNvbnRhaW5tZW50WzBdKWU9dGhpcy5jb250YWlubWVudFswXSt0aGlzLm9mZnNldC5jbGljay5sZWZ0O2lmKGEucGFnZVktdGhpcy5vZmZzZXQuY2xpY2sudG9wPHRoaXMuY29udGFpbm1lbnRbMV0pZz10aGlzLmNvbnRhaW5tZW50WzFdKwp0aGlzLm9mZnNldC5jbGljay50b3A7aWYoYS5wYWdlWC10aGlzLm9mZnNldC5jbGljay5sZWZ0PnRoaXMuY29udGFpbm1lbnRbMl0pZT10aGlzLmNvbnRhaW5tZW50WzJdK3RoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7aWYoYS5wYWdlWS10aGlzLm9mZnNldC5jbGljay50b3A+dGhpcy5jb250YWlubWVudFszXSlnPXRoaXMuY29udGFpbm1lbnRbM10rdGhpcy5vZmZzZXQuY2xpY2sudG9wfWlmKGIuZ3JpZCl7Zz10aGlzLm9yaWdpbmFsUGFnZVkrTWF0aC5yb3VuZCgoZy10aGlzLm9yaWdpbmFsUGFnZVkpL2IuZ3JpZFsxXSkqYi5ncmlkWzFdO2c9dGhpcy5jb250YWlubWVudD8hKGctdGhpcy5vZmZzZXQuY2xpY2sudG9wPHRoaXMuY29udGFpbm1lbnRbMV18fGctdGhpcy5vZmZzZXQuY2xpY2sudG9wPnRoaXMuY29udGFpbm1lbnRbM10pP2c6IShnLXRoaXMub2Zmc2V0LmNsaWNrLnRvcDx0aGlzLmNvbnRhaW5tZW50WzFdKT9nLWIuZ3JpZFsxXTpnK2IuZ3JpZFsxXTpnO2U9dGhpcy5vcmlnaW5hbFBhZ2VYKwpNYXRoLnJvdW5kKChlLXRoaXMub3JpZ2luYWxQYWdlWCkvYi5ncmlkWzBdKSpiLmdyaWRbMF07ZT10aGlzLmNvbnRhaW5tZW50PyEoZS10aGlzLm9mZnNldC5jbGljay5sZWZ0PHRoaXMuY29udGFpbm1lbnRbMF18fGUtdGhpcy5vZmZzZXQuY2xpY2subGVmdD50aGlzLmNvbnRhaW5tZW50WzJdKT9lOiEoZS10aGlzLm9mZnNldC5jbGljay5sZWZ0PHRoaXMuY29udGFpbm1lbnRbMF0pP2UtYi5ncmlkWzBdOmUrYi5ncmlkWzBdOmV9fXJldHVybnt0b3A6Zy10aGlzLm9mZnNldC5jbGljay50b3AtdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wLXRoaXMub2Zmc2V0LnBhcmVudC50b3ArKGQuYnJvd3Nlci5zYWZhcmkmJmQuYnJvd3Nlci52ZXJzaW9uPDUyNiYmdGhpcy5jc3NQb3NpdGlvbj09ImZpeGVkIj8wOnRoaXMuY3NzUG9zaXRpb249PSJmaXhlZCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpOmY/MDpjLnNjcm9sbFRvcCgpKSxsZWZ0OmUtdGhpcy5vZmZzZXQuY2xpY2subGVmdC0KdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdCsoZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT0iZml4ZWQiPzA6dGhpcy5jc3NQb3NpdGlvbj09ImZpeGVkIj8tdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpOmY/MDpjLnNjcm9sbExlZnQoKSl9fSxfY2xlYXI6ZnVuY3Rpb24oKXt0aGlzLmhlbHBlci5yZW1vdmVDbGFzcygidWktZHJhZ2dhYmxlLWRyYWdnaW5nIik7dGhpcy5oZWxwZXJbMF0hPXRoaXMuZWxlbWVudFswXSYmIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCYmdGhpcy5oZWxwZXIucmVtb3ZlKCk7dGhpcy5oZWxwZXI9bnVsbDt0aGlzLmNhbmNlbEhlbHBlclJlbW92YWw9ZmFsc2V9LF90cmlnZ2VyOmZ1bmN0aW9uKGEsYixjKXtjPWN8fHRoaXMuX3VpSGFzaCgpO2QudWkucGx1Z2luLmNhbGwodGhpcyxhLFtiLGNdKTtpZihhPT0iZHJhZyIpdGhpcy5wb3NpdGlvbkFicz0KdGhpcy5fY29udmVydFBvc2l0aW9uVG8oImFic29sdXRlIik7cmV0dXJuIGQuV2lkZ2V0LnByb3RvdHlwZS5fdHJpZ2dlci5jYWxsKHRoaXMsYSxiLGMpfSxwbHVnaW5zOnt9LF91aUhhc2g6ZnVuY3Rpb24oKXtyZXR1cm57aGVscGVyOnRoaXMuaGVscGVyLHBvc2l0aW9uOnRoaXMucG9zaXRpb24sb3JpZ2luYWxQb3NpdGlvbjp0aGlzLm9yaWdpbmFsUG9zaXRpb24sb2Zmc2V0OnRoaXMucG9zaXRpb25BYnN9fX0pO2QuZXh0ZW5kKGQudWkuZHJhZ2dhYmxlLHt2ZXJzaW9uOiIxLjguMSJ9KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsImNvbm5lY3RUb1NvcnRhYmxlIix7c3RhcnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLGY9Yy5vcHRpb25zLGU9ZC5leHRlbmQoe30sYix7aXRlbTpjLmVsZW1lbnR9KTtjLnNvcnRhYmxlcz1bXTtkKGYuY29ubmVjdFRvU29ydGFibGUpLmVhY2goZnVuY3Rpb24oKXt2YXIgZz1kLmRhdGEodGhpcywic29ydGFibGUiKTsKaWYoZyYmIWcub3B0aW9ucy5kaXNhYmxlZCl7Yy5zb3J0YWJsZXMucHVzaCh7aW5zdGFuY2U6ZyxzaG91bGRSZXZlcnQ6Zy5vcHRpb25zLnJldmVydH0pO2cuX3JlZnJlc2hJdGVtcygpO2cuX3RyaWdnZXIoImFjdGl2YXRlIixhLGUpfX0pfSxzdG9wOmZ1bmN0aW9uKGEsYil7dmFyIGM9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKSxmPWQuZXh0ZW5kKHt9LGIse2l0ZW06Yy5lbGVtZW50fSk7ZC5lYWNoKGMuc29ydGFibGVzLGZ1bmN0aW9uKCl7aWYodGhpcy5pbnN0YW5jZS5pc092ZXIpe3RoaXMuaW5zdGFuY2UuaXNPdmVyPTA7Yy5jYW5jZWxIZWxwZXJSZW1vdmFsPXRydWU7dGhpcy5pbnN0YW5jZS5jYW5jZWxIZWxwZXJSZW1vdmFsPWZhbHNlO2lmKHRoaXMuc2hvdWxkUmV2ZXJ0KXRoaXMuaW5zdGFuY2Uub3B0aW9ucy5yZXZlcnQ9dHJ1ZTt0aGlzLmluc3RhbmNlLl9tb3VzZVN0b3AoYSk7dGhpcy5pbnN0YW5jZS5vcHRpb25zLmhlbHBlcj10aGlzLmluc3RhbmNlLm9wdGlvbnMuX2hlbHBlcjsKYy5vcHRpb25zLmhlbHBlcj09Im9yaWdpbmFsIiYmdGhpcy5pbnN0YW5jZS5jdXJyZW50SXRlbS5jc3Moe3RvcDoiYXV0byIsbGVmdDoiYXV0byJ9KX1lbHNle3RoaXMuaW5zdGFuY2UuY2FuY2VsSGVscGVyUmVtb3ZhbD1mYWxzZTt0aGlzLmluc3RhbmNlLl90cmlnZ2VyKCJkZWFjdGl2YXRlIixhLGYpfX0pfSxkcmFnOmZ1bmN0aW9uKGEsYil7dmFyIGM9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKSxmPXRoaXM7ZC5lYWNoKGMuc29ydGFibGVzLGZ1bmN0aW9uKCl7dGhpcy5pbnN0YW5jZS5wb3NpdGlvbkFicz1jLnBvc2l0aW9uQWJzO3RoaXMuaW5zdGFuY2UuaGVscGVyUHJvcG9ydGlvbnM9Yy5oZWxwZXJQcm9wb3J0aW9uczt0aGlzLmluc3RhbmNlLm9mZnNldC5jbGljaz1jLm9mZnNldC5jbGljaztpZih0aGlzLmluc3RhbmNlLl9pbnRlcnNlY3RzV2l0aCh0aGlzLmluc3RhbmNlLmNvbnRhaW5lckNhY2hlKSl7aWYoIXRoaXMuaW5zdGFuY2UuaXNPdmVyKXt0aGlzLmluc3RhbmNlLmlzT3Zlcj0KMTt0aGlzLmluc3RhbmNlLmN1cnJlbnRJdGVtPWQoZikuY2xvbmUoKS5hcHBlbmRUbyh0aGlzLmluc3RhbmNlLmVsZW1lbnQpLmRhdGEoInNvcnRhYmxlLWl0ZW0iLHRydWUpO3RoaXMuaW5zdGFuY2Uub3B0aW9ucy5faGVscGVyPXRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oZWxwZXI7dGhpcy5pbnN0YW5jZS5vcHRpb25zLmhlbHBlcj1mdW5jdGlvbigpe3JldHVybiBiLmhlbHBlclswXX07YS50YXJnZXQ9dGhpcy5pbnN0YW5jZS5jdXJyZW50SXRlbVswXTt0aGlzLmluc3RhbmNlLl9tb3VzZUNhcHR1cmUoYSx0cnVlKTt0aGlzLmluc3RhbmNlLl9tb3VzZVN0YXJ0KGEsdHJ1ZSx0cnVlKTt0aGlzLmluc3RhbmNlLm9mZnNldC5jbGljay50b3A9Yy5vZmZzZXQuY2xpY2sudG9wO3RoaXMuaW5zdGFuY2Uub2Zmc2V0LmNsaWNrLmxlZnQ9Yy5vZmZzZXQuY2xpY2subGVmdDt0aGlzLmluc3RhbmNlLm9mZnNldC5wYXJlbnQubGVmdC09Yy5vZmZzZXQucGFyZW50LmxlZnQtdGhpcy5pbnN0YW5jZS5vZmZzZXQucGFyZW50LmxlZnQ7CnRoaXMuaW5zdGFuY2Uub2Zmc2V0LnBhcmVudC50b3AtPWMub2Zmc2V0LnBhcmVudC50b3AtdGhpcy5pbnN0YW5jZS5vZmZzZXQucGFyZW50LnRvcDtjLl90cmlnZ2VyKCJ0b1NvcnRhYmxlIixhKTtjLmRyb3BwZWQ9dGhpcy5pbnN0YW5jZS5lbGVtZW50O2MuY3VycmVudEl0ZW09Yy5lbGVtZW50O3RoaXMuaW5zdGFuY2UuZnJvbU91dHNpZGU9Y310aGlzLmluc3RhbmNlLmN1cnJlbnRJdGVtJiZ0aGlzLmluc3RhbmNlLl9tb3VzZURyYWcoYSl9ZWxzZSBpZih0aGlzLmluc3RhbmNlLmlzT3Zlcil7dGhpcy5pbnN0YW5jZS5pc092ZXI9MDt0aGlzLmluc3RhbmNlLmNhbmNlbEhlbHBlclJlbW92YWw9dHJ1ZTt0aGlzLmluc3RhbmNlLm9wdGlvbnMucmV2ZXJ0PWZhbHNlO3RoaXMuaW5zdGFuY2UuX3RyaWdnZXIoIm91dCIsYSx0aGlzLmluc3RhbmNlLl91aUhhc2godGhpcy5pbnN0YW5jZSkpO3RoaXMuaW5zdGFuY2UuX21vdXNlU3RvcChhLHRydWUpO3RoaXMuaW5zdGFuY2Uub3B0aW9ucy5oZWxwZXI9CnRoaXMuaW5zdGFuY2Uub3B0aW9ucy5faGVscGVyO3RoaXMuaW5zdGFuY2UuY3VycmVudEl0ZW0ucmVtb3ZlKCk7dGhpcy5pbnN0YW5jZS5wbGFjZWhvbGRlciYmdGhpcy5pbnN0YW5jZS5wbGFjZWhvbGRlci5yZW1vdmUoKTtjLl90cmlnZ2VyKCJmcm9tU29ydGFibGUiLGEpO2MuZHJvcHBlZD1mYWxzZX19KX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsImN1cnNvciIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCgiYm9keSIpLGI9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKS5vcHRpb25zO2lmKGEuY3NzKCJjdXJzb3IiKSliLl9jdXJzb3I9YS5jc3MoImN1cnNvciIpO2EuY3NzKCJjdXJzb3IiLGIuY3Vyc29yKX0sc3RvcDpmdW5jdGlvbigpe3ZhciBhPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIikub3B0aW9uczthLl9jdXJzb3ImJmQoImJvZHkiKS5jc3MoImN1cnNvciIsYS5fY3Vyc29yKX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsImlmcmFtZUZpeCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9CmQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIikub3B0aW9ucztkKGEuaWZyYW1lRml4PT09dHJ1ZT8iaWZyYW1lIjphLmlmcmFtZUZpeCkuZWFjaChmdW5jdGlvbigpe2QoJzxkaXYgY2xhc3M9InVpLWRyYWdnYWJsZS1pZnJhbWVGaXgiIHN0eWxlPSJiYWNrZ3JvdW5kOiAjZmZmOyI+PC9kaXY+JykuY3NzKHt3aWR0aDp0aGlzLm9mZnNldFdpZHRoKyJweCIsaGVpZ2h0OnRoaXMub2Zmc2V0SGVpZ2h0KyJweCIscG9zaXRpb246ImFic29sdXRlIixvcGFjaXR5OiIwLjAwMSIsekluZGV4OjFFM30pLmNzcyhkKHRoaXMpLm9mZnNldCgpKS5hcHBlbmRUbygiYm9keSIpfSl9LHN0b3A6ZnVuY3Rpb24oKXtkKCJkaXYudWktZHJhZ2dhYmxlLWlmcmFtZUZpeCIpLmVhY2goZnVuY3Rpb24oKXt0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyl9KX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsIm9wYWNpdHkiLHtzdGFydDpmdW5jdGlvbihhLGIpe2E9ZChiLmhlbHBlcik7Yj1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7CmlmKGEuY3NzKCJvcGFjaXR5IikpYi5fb3BhY2l0eT1hLmNzcygib3BhY2l0eSIpO2EuY3NzKCJvcGFjaXR5IixiLm9wYWNpdHkpfSxzdG9wOmZ1bmN0aW9uKGEsYil7YT1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7YS5fb3BhY2l0eSYmZChiLmhlbHBlcikuY3NzKCJvcGFjaXR5IixhLl9vcGFjaXR5KX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsInNjcm9sbCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKTtpZihhLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmEuc2Nyb2xsUGFyZW50WzBdLnRhZ05hbWUhPSJIVE1MIilhLm92ZXJmbG93T2Zmc2V0PWEuc2Nyb2xsUGFyZW50Lm9mZnNldCgpfSxkcmFnOmZ1bmN0aW9uKGEpe3ZhciBiPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIiksYz1iLm9wdGlvbnMsZj1mYWxzZTtpZihiLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmIuc2Nyb2xsUGFyZW50WzBdLnRhZ05hbWUhPQoiSFRNTCIpe2lmKCFjLmF4aXN8fGMuYXhpcyE9IngiKWlmKGIub3ZlcmZsb3dPZmZzZXQudG9wK2Iuc2Nyb2xsUGFyZW50WzBdLm9mZnNldEhlaWdodC1hLnBhZ2VZPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wPWY9Yi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wK2Muc2Nyb2xsU3BlZWQ7ZWxzZSBpZihhLnBhZ2VZLWIub3ZlcmZsb3dPZmZzZXQudG9wPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wPWY9Yi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wLWMuc2Nyb2xsU3BlZWQ7aWYoIWMuYXhpc3x8Yy5heGlzIT0ieSIpaWYoYi5vdmVyZmxvd09mZnNldC5sZWZ0K2Iuc2Nyb2xsUGFyZW50WzBdLm9mZnNldFdpZHRoLWEucGFnZVg8Yy5zY3JvbGxTZW5zaXRpdml0eSliLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0PWY9Yi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdCtjLnNjcm9sbFNwZWVkO2Vsc2UgaWYoYS5wYWdlWC0KYi5vdmVyZmxvd09mZnNldC5sZWZ0PGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdD1mPWIuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQtYy5zY3JvbGxTcGVlZH1lbHNle2lmKCFjLmF4aXN8fGMuYXhpcyE9IngiKWlmKGEucGFnZVktZChkb2N1bWVudCkuc2Nyb2xsVG9wKCk8Yy5zY3JvbGxTZW5zaXRpdml0eSlmPWQoZG9jdW1lbnQpLnNjcm9sbFRvcChkKGRvY3VtZW50KS5zY3JvbGxUb3AoKS1jLnNjcm9sbFNwZWVkKTtlbHNlIGlmKGQod2luZG93KS5oZWlnaHQoKS0oYS5wYWdlWS1kKGRvY3VtZW50KS5zY3JvbGxUb3AoKSk8Yy5zY3JvbGxTZW5zaXRpdml0eSlmPWQoZG9jdW1lbnQpLnNjcm9sbFRvcChkKGRvY3VtZW50KS5zY3JvbGxUb3AoKStjLnNjcm9sbFNwZWVkKTtpZighYy5heGlzfHxjLmF4aXMhPSJ5IilpZihhLnBhZ2VYLWQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKTxjLnNjcm9sbFNlbnNpdGl2aXR5KWY9ZChkb2N1bWVudCkuc2Nyb2xsTGVmdChkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCktCmMuc2Nyb2xsU3BlZWQpO2Vsc2UgaWYoZCh3aW5kb3cpLndpZHRoKCktKGEucGFnZVgtZChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpKTxjLnNjcm9sbFNlbnNpdGl2aXR5KWY9ZChkb2N1bWVudCkuc2Nyb2xsTGVmdChkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkrYy5zY3JvbGxTcGVlZCl9ZiE9PWZhbHNlJiZkLnVpLmRkbWFuYWdlciYmIWMuZHJvcEJlaGF2aW91ciYmZC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoYixhKX19KTtkLnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsInNuYXAiLHtzdGFydDpmdW5jdGlvbigpe3ZhciBhPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIiksYj1hLm9wdGlvbnM7YS5zbmFwRWxlbWVudHM9W107ZChiLnNuYXAuY29uc3RydWN0b3IhPVN0cmluZz9iLnNuYXAuaXRlbXN8fCI6ZGF0YShkcmFnZ2FibGUpIjpiLnNuYXApLmVhY2goZnVuY3Rpb24oKXt2YXIgYz1kKHRoaXMpLGY9Yy5vZmZzZXQoKTt0aGlzIT1hLmVsZW1lbnRbMF0mJmEuc25hcEVsZW1lbnRzLnB1c2goe2l0ZW06dGhpcywKd2lkdGg6Yy5vdXRlcldpZHRoKCksaGVpZ2h0OmMub3V0ZXJIZWlnaHQoKSx0b3A6Zi50b3AsbGVmdDpmLmxlZnR9KX0pfSxkcmFnOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPWQodGhpcykuZGF0YSgiZHJhZ2dhYmxlIiksZj1jLm9wdGlvbnMsZT1mLnNuYXBUb2xlcmFuY2UsZz1iLm9mZnNldC5sZWZ0LG49ZytjLmhlbHBlclByb3BvcnRpb25zLndpZHRoLG09Yi5vZmZzZXQudG9wLG89bStjLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxoPWMuc25hcEVsZW1lbnRzLmxlbmd0aC0xO2g+PTA7aC0tKXt2YXIgaT1jLnNuYXBFbGVtZW50c1toXS5sZWZ0LGs9aStjLnNuYXBFbGVtZW50c1toXS53aWR0aCxqPWMuc25hcEVsZW1lbnRzW2hdLnRvcCxsPWorYy5zbmFwRWxlbWVudHNbaF0uaGVpZ2h0O2lmKGktZTxnJiZnPGsrZSYmai1lPG0mJm08bCtlfHxpLWU8ZyYmZzxrK2UmJmotZTxvJiZvPGwrZXx8aS1lPG4mJm48aytlJiZqLWU8bSYmbTxsK2V8fGktZTxuJiZuPGsrZSYmai1lPG8mJgpvPGwrZSl7aWYoZi5zbmFwTW9kZSE9ImlubmVyIil7dmFyIHA9TWF0aC5hYnMoai1vKTw9ZSxxPU1hdGguYWJzKGwtbSk8PWUscj1NYXRoLmFicyhpLW4pPD1lLHM9TWF0aC5hYnMoay1nKTw9ZTtpZihwKWIucG9zaXRpb24udG9wPWMuX2NvbnZlcnRQb3NpdGlvblRvKCJyZWxhdGl2ZSIse3RvcDpqLWMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LGxlZnQ6MH0pLnRvcC1jLm1hcmdpbnMudG9wO2lmKHEpYi5wb3NpdGlvbi50b3A9Yy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOmwsbGVmdDowfSkudG9wLWMubWFyZ2lucy50b3A7aWYociliLnBvc2l0aW9uLmxlZnQ9Yy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOjAsbGVmdDppLWMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGh9KS5sZWZ0LWMubWFyZ2lucy5sZWZ0O2lmKHMpYi5wb3NpdGlvbi5sZWZ0PWMuX2NvbnZlcnRQb3NpdGlvblRvKCJyZWxhdGl2ZSIse3RvcDowLGxlZnQ6a30pLmxlZnQtYy5tYXJnaW5zLmxlZnR9dmFyIHQ9CnB8fHF8fHJ8fHM7aWYoZi5zbmFwTW9kZSE9Im91dGVyIil7cD1NYXRoLmFicyhqLW0pPD1lO3E9TWF0aC5hYnMobC1vKTw9ZTtyPU1hdGguYWJzKGktZyk8PWU7cz1NYXRoLmFicyhrLW4pPD1lO2lmKHApYi5wb3NpdGlvbi50b3A9Yy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOmosbGVmdDowfSkudG9wLWMubWFyZ2lucy50b3A7aWYocSliLnBvc2l0aW9uLnRvcD1jLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6bC1jLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxsZWZ0OjB9KS50b3AtYy5tYXJnaW5zLnRvcDtpZihyKWIucG9zaXRpb24ubGVmdD1jLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6MCxsZWZ0Oml9KS5sZWZ0LWMubWFyZ2lucy5sZWZ0O2lmKHMpYi5wb3NpdGlvbi5sZWZ0PWMuX2NvbnZlcnRQb3NpdGlvblRvKCJyZWxhdGl2ZSIse3RvcDowLGxlZnQ6ay1jLmhlbHBlclByb3BvcnRpb25zLndpZHRofSkubGVmdC1jLm1hcmdpbnMubGVmdH1pZighYy5zbmFwRWxlbWVudHNbaF0uc25hcHBpbmcmJgoocHx8cXx8cnx8c3x8dCkpYy5vcHRpb25zLnNuYXAuc25hcCYmYy5vcHRpb25zLnNuYXAuc25hcC5jYWxsKGMuZWxlbWVudCxhLGQuZXh0ZW5kKGMuX3VpSGFzaCgpLHtzbmFwSXRlbTpjLnNuYXBFbGVtZW50c1toXS5pdGVtfSkpO2Muc25hcEVsZW1lbnRzW2hdLnNuYXBwaW5nPXB8fHF8fHJ8fHN8fHR9ZWxzZXtjLnNuYXBFbGVtZW50c1toXS5zbmFwcGluZyYmYy5vcHRpb25zLnNuYXAucmVsZWFzZSYmYy5vcHRpb25zLnNuYXAucmVsZWFzZS5jYWxsKGMuZWxlbWVudCxhLGQuZXh0ZW5kKGMuX3VpSGFzaCgpLHtzbmFwSXRlbTpjLnNuYXBFbGVtZW50c1toXS5pdGVtfSkpO2Muc25hcEVsZW1lbnRzW2hdLnNuYXBwaW5nPWZhbHNlfX19fSk7ZC51aS5wbHVnaW4uYWRkKCJkcmFnZ2FibGUiLCJzdGFjayIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKCJkcmFnZ2FibGUiKS5vcHRpb25zO2E9ZC5tYWtlQXJyYXkoZChhLnN0YWNrKSkuc29ydChmdW5jdGlvbihjLGYpe3JldHVybihwYXJzZUludChkKGMpLmNzcygiekluZGV4IiksCjEwKXx8MCktKHBhcnNlSW50KGQoZikuY3NzKCJ6SW5kZXgiKSwxMCl8fDApfSk7aWYoYS5sZW5ndGgpe3ZhciBiPXBhcnNlSW50KGFbMF0uc3R5bGUuekluZGV4KXx8MDtkKGEpLmVhY2goZnVuY3Rpb24oYyl7dGhpcy5zdHlsZS56SW5kZXg9YitjfSk7dGhpc1swXS5zdHlsZS56SW5kZXg9YithLmxlbmd0aH19fSk7ZC51aS5wbHVnaW4uYWRkKCJkcmFnZ2FibGUiLCJ6SW5kZXgiLHtzdGFydDpmdW5jdGlvbihhLGIpe2E9ZChiLmhlbHBlcik7Yj1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7aWYoYS5jc3MoInpJbmRleCIpKWIuX3pJbmRleD1hLmNzcygiekluZGV4Iik7YS5jc3MoInpJbmRleCIsYi56SW5kZXgpfSxzdG9wOmZ1bmN0aW9uKGEsYil7YT1kKHRoaXMpLmRhdGEoImRyYWdnYWJsZSIpLm9wdGlvbnM7YS5fekluZGV4JiZkKGIuaGVscGVyKS5jc3MoInpJbmRleCIsYS5fekluZGV4KX19KX0pKGpRdWVyeSk7CjsvKgogKiBqUXVlcnkgVUkgUmVzaXphYmxlIDEuOC4xCiAqCiAqIENvcHlyaWdodCAoYykgMjAxMCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dCkKICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIChNSVQtTElDRU5TRS50eHQpCiAqIGFuZCBHUEwgKEdQTC1MSUNFTlNFLnR4dCkgbGljZW5zZXMuCiAqCiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvUmVzaXphYmxlcwogKgogKiBEZXBlbmRzOgogKglqcXVlcnkudWkuY29yZS5qcwogKglqcXVlcnkudWkubW91c2UuanMKICoJanF1ZXJ5LnVpLndpZGdldC5qcwogKi8KKGZ1bmN0aW9uKGQpe2Qud2lkZ2V0KCJ1aS5yZXNpemFibGUiLGQudWkubW91c2Use3dpZGdldEV2ZW50UHJlZml4OiJyZXNpemUiLG9wdGlvbnM6e2Fsc29SZXNpemU6ZmFsc2UsYW5pbWF0ZTpmYWxzZSxhbmltYXRlRHVyYXRpb246InNsb3ciLGFuaW1hdGVFYXNpbmc6InN3aW5nIixhc3BlY3RSYXRpbzpmYWxzZSxhdXRvSGlkZTpmYWxzZSxjb250YWlubWVudDpmYWxzZSxnaG9zdDpmYWxzZSxncmlkOmZhbHNlLGhhbmRsZXM6ImUscyxzZSIsaGVscGVyOmZhbHNlLG1heEhlaWdodDpudWxsLG1heFdpZHRoOm51bGwsbWluSGVpZ2h0OjEwLG1pbldpZHRoOjEwLHpJbmRleDoxRTN9LF9jcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLGE9dGhpcy5vcHRpb25zO3RoaXMuZWxlbWVudC5hZGRDbGFzcygidWktcmVzaXphYmxlIik7ZC5leHRlbmQodGhpcyx7X2FzcGVjdFJhdGlvOiEhYS5hc3BlY3RSYXRpbyxhc3BlY3RSYXRpbzphLmFzcGVjdFJhdGlvLG9yaWdpbmFsRWxlbWVudDp0aGlzLmVsZW1lbnQsCl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzOltdLF9oZWxwZXI6YS5oZWxwZXJ8fGEuZ2hvc3R8fGEuYW5pbWF0ZT9hLmhlbHBlcnx8InVpLXJlc2l6YWJsZS1oZWxwZXIiOm51bGx9KTtpZih0aGlzLmVsZW1lbnRbMF0ubm9kZU5hbWUubWF0Y2goL2NhbnZhc3x0ZXh0YXJlYXxpbnB1dHxzZWxlY3R8YnV0dG9ufGltZy9pKSl7L3JlbGF0aXZlLy50ZXN0KHRoaXMuZWxlbWVudC5jc3MoInBvc2l0aW9uIikpJiZkLmJyb3dzZXIub3BlcmEmJnRoaXMuZWxlbWVudC5jc3Moe3Bvc2l0aW9uOiJyZWxhdGl2ZSIsdG9wOiJhdXRvIixsZWZ0OiJhdXRvIn0pO3RoaXMuZWxlbWVudC53cmFwKGQoJzxkaXYgY2xhc3M9InVpLXdyYXBwZXIiIHN0eWxlPSJvdmVyZmxvdzogaGlkZGVuOyI+PC9kaXY+JykuY3NzKHtwb3NpdGlvbjp0aGlzLmVsZW1lbnQuY3NzKCJwb3NpdGlvbiIpLHdpZHRoOnRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksaGVpZ2h0OnRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpLAp0b3A6dGhpcy5lbGVtZW50LmNzcygidG9wIiksbGVmdDp0aGlzLmVsZW1lbnQuY3NzKCJsZWZ0Iil9KSk7dGhpcy5lbGVtZW50PXRoaXMuZWxlbWVudC5wYXJlbnQoKS5kYXRhKCJyZXNpemFibGUiLHRoaXMuZWxlbWVudC5kYXRhKCJyZXNpemFibGUiKSk7dGhpcy5lbGVtZW50SXNXcmFwcGVyPXRydWU7dGhpcy5lbGVtZW50LmNzcyh7bWFyZ2luTGVmdDp0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIm1hcmdpbkxlZnQiKSxtYXJnaW5Ub3A6dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJtYXJnaW5Ub3AiKSxtYXJnaW5SaWdodDp0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIm1hcmdpblJpZ2h0IiksbWFyZ2luQm90dG9tOnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcygibWFyZ2luQm90dG9tIil9KTt0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3Moe21hcmdpbkxlZnQ6MCxtYXJnaW5Ub3A6MCxtYXJnaW5SaWdodDowLG1hcmdpbkJvdHRvbTowfSk7dGhpcy5vcmlnaW5hbFJlc2l6ZVN0eWxlPQp0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoInJlc2l6ZSIpO3RoaXMub3JpZ2luYWxFbGVtZW50LmNzcygicmVzaXplIiwibm9uZSIpO3RoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHMucHVzaCh0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3Moe3Bvc2l0aW9uOiJzdGF0aWMiLHpvb206MSxkaXNwbGF5OiJibG9jayJ9KSk7dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKHttYXJnaW46dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJtYXJnaW4iKX0pO3RoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCl9dGhpcy5oYW5kbGVzPWEuaGFuZGxlc3x8KCFkKCIudWktcmVzaXphYmxlLWhhbmRsZSIsdGhpcy5lbGVtZW50KS5sZW5ndGg/ImUscyxzZSI6e246Ii51aS1yZXNpemFibGUtbiIsZToiLnVpLXJlc2l6YWJsZS1lIixzOiIudWktcmVzaXphYmxlLXMiLHc6Ii51aS1yZXNpemFibGUtdyIsc2U6Ii51aS1yZXNpemFibGUtc2UiLHN3OiIudWktcmVzaXphYmxlLXN3IixuZToiLnVpLXJlc2l6YWJsZS1uZSIsCm53OiIudWktcmVzaXphYmxlLW53In0pO2lmKHRoaXMuaGFuZGxlcy5jb25zdHJ1Y3Rvcj09U3RyaW5nKXtpZih0aGlzLmhhbmRsZXM9PSJhbGwiKXRoaXMuaGFuZGxlcz0ibixlLHMsdyxzZSxzdyxuZSxudyI7dmFyIGM9dGhpcy5oYW5kbGVzLnNwbGl0KCIsIik7dGhpcy5oYW5kbGVzPXt9O2Zvcih2YXIgZT0wO2U8Yy5sZW5ndGg7ZSsrKXt2YXIgZz1kLnRyaW0oY1tlXSksZj1kKCc8ZGl2IGNsYXNzPSJ1aS1yZXNpemFibGUtaGFuZGxlICcrKCJ1aS1yZXNpemFibGUtIitnKSsnIj48L2Rpdj4nKTsvc3d8c2V8bmV8bncvLnRlc3QoZykmJmYuY3NzKHt6SW5kZXg6KythLnpJbmRleH0pOyJzZSI9PWcmJmYuYWRkQ2xhc3MoInVpLWljb24gdWktaWNvbi1ncmlwc21hbGwtZGlhZ29uYWwtc2UiKTt0aGlzLmhhbmRsZXNbZ109Ii51aS1yZXNpemFibGUtIitnO3RoaXMuZWxlbWVudC5hcHBlbmQoZil9fXRoaXMuX3JlbmRlckF4aXM9ZnVuY3Rpb24oaCl7aD1ofHx0aGlzLmVsZW1lbnQ7Zm9yKHZhciBpIGluIHRoaXMuaGFuZGxlcyl7aWYodGhpcy5oYW5kbGVzW2ldLmNvbnN0cnVjdG9yPT0KU3RyaW5nKXRoaXMuaGFuZGxlc1tpXT1kKHRoaXMuaGFuZGxlc1tpXSx0aGlzLmVsZW1lbnQpLnNob3coKTtpZih0aGlzLmVsZW1lbnRJc1dyYXBwZXImJnRoaXMub3JpZ2luYWxFbGVtZW50WzBdLm5vZGVOYW1lLm1hdGNoKC90ZXh0YXJlYXxpbnB1dHxzZWxlY3R8YnV0dG9uL2kpKXt2YXIgaj1kKHRoaXMuaGFuZGxlc1tpXSx0aGlzLmVsZW1lbnQpLGw9MDtsPS9zd3xuZXxud3xzZXxufHMvLnRlc3QoaSk/ai5vdXRlckhlaWdodCgpOmoub3V0ZXJXaWR0aCgpO2o9WyJwYWRkaW5nIiwvbmV8bnd8bi8udGVzdChpKT8iVG9wIjovc2V8c3d8cy8udGVzdChpKT8iQm90dG9tIjovXmUkLy50ZXN0KGkpPyJSaWdodCI6IkxlZnQiXS5qb2luKCIiKTtoLmNzcyhqLGwpO3RoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCl9ZCh0aGlzLmhhbmRsZXNbaV0pfX07dGhpcy5fcmVuZGVyQXhpcyh0aGlzLmVsZW1lbnQpO3RoaXMuX2hhbmRsZXM9ZCgiLnVpLXJlc2l6YWJsZS1oYW5kbGUiLHRoaXMuZWxlbWVudCkuZGlzYWJsZVNlbGVjdGlvbigpOwp0aGlzLl9oYW5kbGVzLm1vdXNlb3ZlcihmdW5jdGlvbigpe2lmKCFiLnJlc2l6aW5nKXtpZih0aGlzLmNsYXNzTmFtZSl2YXIgaD10aGlzLmNsYXNzTmFtZS5tYXRjaCgvdWktcmVzaXphYmxlLShzZXxzd3xuZXxud3xufGV8c3x3KS9pKTtiLmF4aXM9aCYmaFsxXT9oWzFdOiJzZSJ9fSk7aWYoYS5hdXRvSGlkZSl7dGhpcy5faGFuZGxlcy5oaWRlKCk7ZCh0aGlzLmVsZW1lbnQpLmFkZENsYXNzKCJ1aS1yZXNpemFibGUtYXV0b2hpZGUiKS5ob3ZlcihmdW5jdGlvbigpe2QodGhpcykucmVtb3ZlQ2xhc3MoInVpLXJlc2l6YWJsZS1hdXRvaGlkZSIpO2IuX2hhbmRsZXMuc2hvdygpfSxmdW5jdGlvbigpe2lmKCFiLnJlc2l6aW5nKXtkKHRoaXMpLmFkZENsYXNzKCJ1aS1yZXNpemFibGUtYXV0b2hpZGUiKTtiLl9oYW5kbGVzLmhpZGUoKX19KX10aGlzLl9tb3VzZUluaXQoKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuX21vdXNlRGVzdHJveSgpO3ZhciBiPWZ1bmN0aW9uKGMpe2QoYykucmVtb3ZlQ2xhc3MoInVpLXJlc2l6YWJsZSB1aS1yZXNpemFibGUtZGlzYWJsZWQgdWktcmVzaXphYmxlLXJlc2l6aW5nIikucmVtb3ZlRGF0YSgicmVzaXphYmxlIikudW5iaW5kKCIucmVzaXphYmxlIikuZmluZCgiLnVpLXJlc2l6YWJsZS1oYW5kbGUiKS5yZW1vdmUoKX07CmlmKHRoaXMuZWxlbWVudElzV3JhcHBlcil7Yih0aGlzLmVsZW1lbnQpO3ZhciBhPXRoaXMuZWxlbWVudDthLmFmdGVyKHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyh7cG9zaXRpb246YS5jc3MoInBvc2l0aW9uIiksd2lkdGg6YS5vdXRlcldpZHRoKCksaGVpZ2h0OmEub3V0ZXJIZWlnaHQoKSx0b3A6YS5jc3MoInRvcCIpLGxlZnQ6YS5jc3MoImxlZnQiKX0pKS5yZW1vdmUoKX10aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoInJlc2l6ZSIsdGhpcy5vcmlnaW5hbFJlc2l6ZVN0eWxlKTtiKHRoaXMub3JpZ2luYWxFbGVtZW50KTtyZXR1cm4gdGhpc30sX21vdXNlQ2FwdHVyZTpmdW5jdGlvbihiKXt2YXIgYT1mYWxzZTtmb3IodmFyIGMgaW4gdGhpcy5oYW5kbGVzKWlmKGQodGhpcy5oYW5kbGVzW2NdKVswXT09Yi50YXJnZXQpYT10cnVlO3JldHVybiF0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJmF9LF9tb3VzZVN0YXJ0OmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMub3B0aW9ucyxjPXRoaXMuZWxlbWVudC5wb3NpdGlvbigpLAplPXRoaXMuZWxlbWVudDt0aGlzLnJlc2l6aW5nPXRydWU7dGhpcy5kb2N1bWVudFNjcm9sbD17dG9wOmQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpLGxlZnQ6ZChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpfTtpZihlLmlzKCIudWktZHJhZ2dhYmxlIil8fC9hYnNvbHV0ZS8udGVzdChlLmNzcygicG9zaXRpb24iKSkpZS5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdG9wOmMudG9wLGxlZnQ6Yy5sZWZ0fSk7ZC5icm93c2VyLm9wZXJhJiYvcmVsYXRpdmUvLnRlc3QoZS5jc3MoInBvc2l0aW9uIikpJiZlLmNzcyh7cG9zaXRpb246InJlbGF0aXZlIix0b3A6ImF1dG8iLGxlZnQ6ImF1dG8ifSk7dGhpcy5fcmVuZGVyUHJveHkoKTtjPW0odGhpcy5oZWxwZXIuY3NzKCJsZWZ0IikpO3ZhciBnPW0odGhpcy5oZWxwZXIuY3NzKCJ0b3AiKSk7aWYoYS5jb250YWlubWVudCl7Yys9ZChhLmNvbnRhaW5tZW50KS5zY3JvbGxMZWZ0KCl8fDA7Zys9ZChhLmNvbnRhaW5tZW50KS5zY3JvbGxUb3AoKXx8MH10aGlzLm9mZnNldD0KdGhpcy5oZWxwZXIub2Zmc2V0KCk7dGhpcy5wb3NpdGlvbj17bGVmdDpjLHRvcDpnfTt0aGlzLnNpemU9dGhpcy5faGVscGVyP3t3aWR0aDplLm91dGVyV2lkdGgoKSxoZWlnaHQ6ZS5vdXRlckhlaWdodCgpfTp7d2lkdGg6ZS53aWR0aCgpLGhlaWdodDplLmhlaWdodCgpfTt0aGlzLm9yaWdpbmFsU2l6ZT10aGlzLl9oZWxwZXI/e3dpZHRoOmUub3V0ZXJXaWR0aCgpLGhlaWdodDplLm91dGVySGVpZ2h0KCl9Ont3aWR0aDplLndpZHRoKCksaGVpZ2h0OmUuaGVpZ2h0KCl9O3RoaXMub3JpZ2luYWxQb3NpdGlvbj17bGVmdDpjLHRvcDpnfTt0aGlzLnNpemVEaWZmPXt3aWR0aDplLm91dGVyV2lkdGgoKS1lLndpZHRoKCksaGVpZ2h0OmUub3V0ZXJIZWlnaHQoKS1lLmhlaWdodCgpfTt0aGlzLm9yaWdpbmFsTW91c2VQb3NpdGlvbj17bGVmdDpiLnBhZ2VYLHRvcDpiLnBhZ2VZfTt0aGlzLmFzcGVjdFJhdGlvPXR5cGVvZiBhLmFzcGVjdFJhdGlvPT0ibnVtYmVyIj9hLmFzcGVjdFJhdGlvOgp0aGlzLm9yaWdpbmFsU2l6ZS53aWR0aC90aGlzLm9yaWdpbmFsU2l6ZS5oZWlnaHR8fDE7YT1kKCIudWktcmVzaXphYmxlLSIrdGhpcy5heGlzKS5jc3MoImN1cnNvciIpO2QoImJvZHkiKS5jc3MoImN1cnNvciIsYT09ImF1dG8iP3RoaXMuYXhpcysiLXJlc2l6ZSI6YSk7ZS5hZGRDbGFzcygidWktcmVzaXphYmxlLXJlc2l6aW5nIik7dGhpcy5fcHJvcGFnYXRlKCJzdGFydCIsYik7cmV0dXJuIHRydWV9LF9tb3VzZURyYWc6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5oZWxwZXIsYz10aGlzLm9yaWdpbmFsTW91c2VQb3NpdGlvbixlPXRoaXMuX2NoYW5nZVt0aGlzLmF4aXNdO2lmKCFlKXJldHVybiBmYWxzZTtjPWUuYXBwbHkodGhpcyxbYixiLnBhZ2VYLWMubGVmdHx8MCxiLnBhZ2VZLWMudG9wfHwwXSk7aWYodGhpcy5fYXNwZWN0UmF0aW98fGIuc2hpZnRLZXkpYz10aGlzLl91cGRhdGVSYXRpbyhjLGIpO2M9dGhpcy5fcmVzcGVjdFNpemUoYyxiKTt0aGlzLl9wcm9wYWdhdGUoInJlc2l6ZSIsCmIpO2EuY3NzKHt0b3A6dGhpcy5wb3NpdGlvbi50b3ArInB4IixsZWZ0OnRoaXMucG9zaXRpb24ubGVmdCsicHgiLHdpZHRoOnRoaXMuc2l6ZS53aWR0aCsicHgiLGhlaWdodDp0aGlzLnNpemUuaGVpZ2h0KyJweCJ9KTshdGhpcy5faGVscGVyJiZ0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLmxlbmd0aCYmdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemUoKTt0aGlzLl91cGRhdGVDYWNoZShjKTt0aGlzLl90cmlnZ2VyKCJyZXNpemUiLGIsdGhpcy51aSgpKTtyZXR1cm4gZmFsc2V9LF9tb3VzZVN0b3A6ZnVuY3Rpb24oYil7dGhpcy5yZXNpemluZz1mYWxzZTt2YXIgYT10aGlzLm9wdGlvbnMsYz10aGlzO2lmKHRoaXMuX2hlbHBlcil7dmFyIGU9dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cyxnPWUubGVuZ3RoJiYvdGV4dGFyZWEvaS50ZXN0KGVbMF0ubm9kZU5hbWUpO2U9ZyYmZC51aS5oYXNTY3JvbGwoZVswXSwibGVmdCIpPzA6Yy5zaXplRGlmZi5oZWlnaHQ7Cmc9e3dpZHRoOmMuc2l6ZS53aWR0aC0oZz8wOmMuc2l6ZURpZmYud2lkdGgpLGhlaWdodDpjLnNpemUuaGVpZ2h0LWV9O2U9cGFyc2VJbnQoYy5lbGVtZW50LmNzcygibGVmdCIpLDEwKSsoYy5wb3NpdGlvbi5sZWZ0LWMub3JpZ2luYWxQb3NpdGlvbi5sZWZ0KXx8bnVsbDt2YXIgZj1wYXJzZUludChjLmVsZW1lbnQuY3NzKCJ0b3AiKSwxMCkrKGMucG9zaXRpb24udG9wLWMub3JpZ2luYWxQb3NpdGlvbi50b3ApfHxudWxsO2EuYW5pbWF0ZXx8dGhpcy5lbGVtZW50LmNzcyhkLmV4dGVuZChnLHt0b3A6ZixsZWZ0OmV9KSk7Yy5oZWxwZXIuaGVpZ2h0KGMuc2l6ZS5oZWlnaHQpO2MuaGVscGVyLndpZHRoKGMuc2l6ZS53aWR0aCk7dGhpcy5faGVscGVyJiYhYS5hbmltYXRlJiZ0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpfWQoImJvZHkiKS5jc3MoImN1cnNvciIsImF1dG8iKTt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoInVpLXJlc2l6YWJsZS1yZXNpemluZyIpO3RoaXMuX3Byb3BhZ2F0ZSgic3RvcCIsCmIpO3RoaXMuX2hlbHBlciYmdGhpcy5oZWxwZXIucmVtb3ZlKCk7cmV0dXJuIGZhbHNlfSxfdXBkYXRlQ2FjaGU6ZnVuY3Rpb24oYil7dGhpcy5vZmZzZXQ9dGhpcy5oZWxwZXIub2Zmc2V0KCk7aWYoayhiLmxlZnQpKXRoaXMucG9zaXRpb24ubGVmdD1iLmxlZnQ7aWYoayhiLnRvcCkpdGhpcy5wb3NpdGlvbi50b3A9Yi50b3A7aWYoayhiLmhlaWdodCkpdGhpcy5zaXplLmhlaWdodD1iLmhlaWdodDtpZihrKGIud2lkdGgpKXRoaXMuc2l6ZS53aWR0aD1iLndpZHRofSxfdXBkYXRlUmF0aW86ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5wb3NpdGlvbixjPXRoaXMuc2l6ZSxlPXRoaXMuYXhpcztpZihiLmhlaWdodCliLndpZHRoPWMuaGVpZ2h0KnRoaXMuYXNwZWN0UmF0aW87ZWxzZSBpZihiLndpZHRoKWIuaGVpZ2h0PWMud2lkdGgvdGhpcy5hc3BlY3RSYXRpbztpZihlPT0ic3ciKXtiLmxlZnQ9YS5sZWZ0KyhjLndpZHRoLWIud2lkdGgpO2IudG9wPW51bGx9aWYoZT09Im53Iil7Yi50b3A9CmEudG9wKyhjLmhlaWdodC1iLmhlaWdodCk7Yi5sZWZ0PWEubGVmdCsoYy53aWR0aC1iLndpZHRoKX1yZXR1cm4gYn0sX3Jlc3BlY3RTaXplOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMub3B0aW9ucyxjPXRoaXMuYXhpcyxlPWsoYi53aWR0aCkmJmEubWF4V2lkdGgmJmEubWF4V2lkdGg8Yi53aWR0aCxnPWsoYi5oZWlnaHQpJiZhLm1heEhlaWdodCYmYS5tYXhIZWlnaHQ8Yi5oZWlnaHQsZj1rKGIud2lkdGgpJiZhLm1pbldpZHRoJiZhLm1pbldpZHRoPmIud2lkdGgsaD1rKGIuaGVpZ2h0KSYmYS5taW5IZWlnaHQmJmEubWluSGVpZ2h0PmIuaGVpZ2h0O2lmKGYpYi53aWR0aD1hLm1pbldpZHRoO2lmKGgpYi5oZWlnaHQ9YS5taW5IZWlnaHQ7aWYoZSliLndpZHRoPWEubWF4V2lkdGg7aWYoZyliLmhlaWdodD1hLm1heEhlaWdodDt2YXIgaT10aGlzLm9yaWdpbmFsUG9zaXRpb24ubGVmdCt0aGlzLm9yaWdpbmFsU2l6ZS53aWR0aCxqPXRoaXMucG9zaXRpb24udG9wK3RoaXMuc2l6ZS5oZWlnaHQsCmw9L3N3fG53fHcvLnRlc3QoYyk7Yz0vbnd8bmV8bi8udGVzdChjKTtpZihmJiZsKWIubGVmdD1pLWEubWluV2lkdGg7aWYoZSYmbCliLmxlZnQ9aS1hLm1heFdpZHRoO2lmKGgmJmMpYi50b3A9ai1hLm1pbkhlaWdodDtpZihnJiZjKWIudG9wPWotYS5tYXhIZWlnaHQ7aWYoKGE9IWIud2lkdGgmJiFiLmhlaWdodCkmJiFiLmxlZnQmJmIudG9wKWIudG9wPW51bGw7ZWxzZSBpZihhJiYhYi50b3AmJmIubGVmdCliLmxlZnQ9bnVsbDtyZXR1cm4gYn0sX3Byb3BvcnRpb25hbGx5UmVzaXplOmZ1bmN0aW9uKCl7aWYodGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGgpZm9yKHZhciBiPXRoaXMuaGVscGVyfHx0aGlzLmVsZW1lbnQsYT0wO2E8dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGg7YSsrKXt2YXIgYz10aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzW2FdO2lmKCF0aGlzLmJvcmRlckRpZil7dmFyIGU9W2MuY3NzKCJib3JkZXJUb3BXaWR0aCIpLApjLmNzcygiYm9yZGVyUmlnaHRXaWR0aCIpLGMuY3NzKCJib3JkZXJCb3R0b21XaWR0aCIpLGMuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKV0sZz1bYy5jc3MoInBhZGRpbmdUb3AiKSxjLmNzcygicGFkZGluZ1JpZ2h0IiksYy5jc3MoInBhZGRpbmdCb3R0b20iKSxjLmNzcygicGFkZGluZ0xlZnQiKV07dGhpcy5ib3JkZXJEaWY9ZC5tYXAoZSxmdW5jdGlvbihmLGgpe2Y9cGFyc2VJbnQoZiwxMCl8fDA7aD1wYXJzZUludChnW2hdLDEwKXx8MDtyZXR1cm4gZitofSl9ZC5icm93c2VyLm1zaWUmJihkKGIpLmlzKCI6aGlkZGVuIil8fGQoYikucGFyZW50cygiOmhpZGRlbiIpLmxlbmd0aCl8fGMuY3NzKHtoZWlnaHQ6Yi5oZWlnaHQoKS10aGlzLmJvcmRlckRpZlswXS10aGlzLmJvcmRlckRpZlsyXXx8MCx3aWR0aDpiLndpZHRoKCktdGhpcy5ib3JkZXJEaWZbMV0tdGhpcy5ib3JkZXJEaWZbM118fDB9KX19LF9yZW5kZXJQcm94eTpmdW5jdGlvbigpe3ZhciBiPXRoaXMub3B0aW9uczt0aGlzLmVsZW1lbnRPZmZzZXQ9CnRoaXMuZWxlbWVudC5vZmZzZXQoKTtpZih0aGlzLl9oZWxwZXIpe3RoaXMuaGVscGVyPXRoaXMuaGVscGVyfHxkKCc8ZGl2IHN0eWxlPSJvdmVyZmxvdzpoaWRkZW47Ij48L2Rpdj4nKTt2YXIgYT1kLmJyb3dzZXIubXNpZSYmZC5icm93c2VyLnZlcnNpb248NyxjPWE/MTowO2E9YT8yOi0xO3RoaXMuaGVscGVyLmFkZENsYXNzKHRoaXMuX2hlbHBlcikuY3NzKHt3aWR0aDp0aGlzLmVsZW1lbnQub3V0ZXJXaWR0aCgpK2EsaGVpZ2h0OnRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpK2EscG9zaXRpb246ImFic29sdXRlIixsZWZ0OnRoaXMuZWxlbWVudE9mZnNldC5sZWZ0LWMrInB4Iix0b3A6dGhpcy5lbGVtZW50T2Zmc2V0LnRvcC1jKyJweCIsekluZGV4OisrYi56SW5kZXh9KTt0aGlzLmhlbHBlci5hcHBlbmRUbygiYm9keSIpLmRpc2FibGVTZWxlY3Rpb24oKX1lbHNlIHRoaXMuaGVscGVyPXRoaXMuZWxlbWVudH0sX2NoYW5nZTp7ZTpmdW5jdGlvbihiLGEpe3JldHVybnt3aWR0aDp0aGlzLm9yaWdpbmFsU2l6ZS53aWR0aCsKYX19LHc6ZnVuY3Rpb24oYixhKXtyZXR1cm57bGVmdDp0aGlzLm9yaWdpbmFsUG9zaXRpb24ubGVmdCthLHdpZHRoOnRoaXMub3JpZ2luYWxTaXplLndpZHRoLWF9fSxuOmZ1bmN0aW9uKGIsYSxjKXtyZXR1cm57dG9wOnRoaXMub3JpZ2luYWxQb3NpdGlvbi50b3ArYyxoZWlnaHQ6dGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0LWN9fSxzOmZ1bmN0aW9uKGIsYSxjKXtyZXR1cm57aGVpZ2h0OnRoaXMub3JpZ2luYWxTaXplLmhlaWdodCtjfX0sc2U6ZnVuY3Rpb24oYixhLGMpe3JldHVybiBkLmV4dGVuZCh0aGlzLl9jaGFuZ2Uucy5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fY2hhbmdlLmUuYXBwbHkodGhpcyxbYixhLGNdKSl9LHN3OmZ1bmN0aW9uKGIsYSxjKXtyZXR1cm4gZC5leHRlbmQodGhpcy5fY2hhbmdlLnMuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX2NoYW5nZS53LmFwcGx5KHRoaXMsW2IsYSxjXSkpfSxuZTpmdW5jdGlvbihiLGEsYyl7cmV0dXJuIGQuZXh0ZW5kKHRoaXMuX2NoYW5nZS5uLmFwcGx5KHRoaXMsCmFyZ3VtZW50cyksdGhpcy5fY2hhbmdlLmUuYXBwbHkodGhpcyxbYixhLGNdKSl9LG53OmZ1bmN0aW9uKGIsYSxjKXtyZXR1cm4gZC5leHRlbmQodGhpcy5fY2hhbmdlLm4uYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX2NoYW5nZS53LmFwcGx5KHRoaXMsW2IsYSxjXSkpfX0sX3Byb3BhZ2F0ZTpmdW5jdGlvbihiLGEpe2QudWkucGx1Z2luLmNhbGwodGhpcyxiLFthLHRoaXMudWkoKV0pO2IhPSJyZXNpemUiJiZ0aGlzLl90cmlnZ2VyKGIsYSx0aGlzLnVpKCkpfSxwbHVnaW5zOnt9LHVpOmZ1bmN0aW9uKCl7cmV0dXJue29yaWdpbmFsRWxlbWVudDp0aGlzLm9yaWdpbmFsRWxlbWVudCxlbGVtZW50OnRoaXMuZWxlbWVudCxoZWxwZXI6dGhpcy5oZWxwZXIscG9zaXRpb246dGhpcy5wb3NpdGlvbixzaXplOnRoaXMuc2l6ZSxvcmlnaW5hbFNpemU6dGhpcy5vcmlnaW5hbFNpemUsb3JpZ2luYWxQb3NpdGlvbjp0aGlzLm9yaWdpbmFsUG9zaXRpb259fX0pO2QuZXh0ZW5kKGQudWkucmVzaXphYmxlLAp7dmVyc2lvbjoiMS44LjEifSk7ZC51aS5wbHVnaW4uYWRkKCJyZXNpemFibGUiLCJhbHNvUmVzaXplIix7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgYj1kKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLm9wdGlvbnMsYT1mdW5jdGlvbihjKXtkKGMpLmVhY2goZnVuY3Rpb24oKXtkKHRoaXMpLmRhdGEoInJlc2l6YWJsZS1hbHNvcmVzaXplIix7d2lkdGg6cGFyc2VJbnQoZCh0aGlzKS53aWR0aCgpLDEwKSxoZWlnaHQ6cGFyc2VJbnQoZCh0aGlzKS5oZWlnaHQoKSwxMCksbGVmdDpwYXJzZUludChkKHRoaXMpLmNzcygibGVmdCIpLDEwKSx0b3A6cGFyc2VJbnQoZCh0aGlzKS5jc3MoInRvcCIpLDEwKX0pfSl9O2lmKHR5cGVvZiBiLmFsc29SZXNpemU9PSJvYmplY3QiJiYhYi5hbHNvUmVzaXplLnBhcmVudE5vZGUpaWYoYi5hbHNvUmVzaXplLmxlbmd0aCl7Yi5hbHNvUmVzaXplPWIuYWxzb1Jlc2l6ZVswXTthKGIuYWxzb1Jlc2l6ZSl9ZWxzZSBkLmVhY2goYi5hbHNvUmVzaXplLGZ1bmN0aW9uKGMpe2EoYyl9KTsKZWxzZSBhKGIuYWxzb1Jlc2l6ZSl9LHJlc2l6ZTpmdW5jdGlvbigpe3ZhciBiPWQodGhpcykuZGF0YSgicmVzaXphYmxlIiksYT1iLm9wdGlvbnMsYz1iLm9yaWdpbmFsU2l6ZSxlPWIub3JpZ2luYWxQb3NpdGlvbixnPXtoZWlnaHQ6Yi5zaXplLmhlaWdodC1jLmhlaWdodHx8MCx3aWR0aDpiLnNpemUud2lkdGgtYy53aWR0aHx8MCx0b3A6Yi5wb3NpdGlvbi50b3AtZS50b3B8fDAsbGVmdDpiLnBvc2l0aW9uLmxlZnQtZS5sZWZ0fHwwfSxmPWZ1bmN0aW9uKGgsaSl7ZChoKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGo9ZCh0aGlzKSxsPWQodGhpcykuZGF0YSgicmVzaXphYmxlLWFsc29yZXNpemUiKSxwPXt9O2QuZWFjaCgoaSYmaS5sZW5ndGg/aTpbIndpZHRoIiwiaGVpZ2h0IiwidG9wIiwibGVmdCJdKXx8WyJ3aWR0aCIsImhlaWdodCIsInRvcCIsImxlZnQiXSxmdW5jdGlvbihuLG8pe2lmKChuPShsW29dfHwwKSsoZ1tvXXx8MCkpJiZuPj0wKXBbb109bnx8bnVsbH0pO2lmKC9yZWxhdGl2ZS8udGVzdChqLmNzcygicG9zaXRpb24iKSkmJgpkLmJyb3dzZXIub3BlcmEpe2IuX3JldmVydFRvUmVsYXRpdmVQb3NpdGlvbj10cnVlO2ouY3NzKHtwb3NpdGlvbjoiYWJzb2x1dGUiLHRvcDoiYXV0byIsbGVmdDoiYXV0byJ9KX1qLmNzcyhwKX0pfTt0eXBlb2YgYS5hbHNvUmVzaXplPT0ib2JqZWN0IiYmIWEuYWxzb1Jlc2l6ZS5ub2RlVHlwZT9kLmVhY2goYS5hbHNvUmVzaXplLGZ1bmN0aW9uKGgsaSl7ZihoLGkpfSk6ZihhLmFsc29SZXNpemUpfSxzdG9wOmZ1bmN0aW9uKCl7dmFyIGI9ZCh0aGlzKS5kYXRhKCJyZXNpemFibGUiKTtpZihiLl9yZXZlcnRUb1JlbGF0aXZlUG9zaXRpb24mJmQuYnJvd3Nlci5vcGVyYSl7Yi5fcmV2ZXJ0VG9SZWxhdGl2ZVBvc2l0aW9uPWZhbHNlO2VsLmNzcyh7cG9zaXRpb246InJlbGF0aXZlIn0pfWQodGhpcykucmVtb3ZlRGF0YSgicmVzaXphYmxlLWFsc29yZXNpemUtc3RhcnQiKX19KTtkLnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImFuaW1hdGUiLHtzdG9wOmZ1bmN0aW9uKGIpe3ZhciBhPQpkKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGM9YS5vcHRpb25zLGU9YS5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cyxnPWUubGVuZ3RoJiYvdGV4dGFyZWEvaS50ZXN0KGVbMF0ubm9kZU5hbWUpLGY9ZyYmZC51aS5oYXNTY3JvbGwoZVswXSwibGVmdCIpPzA6YS5zaXplRGlmZi5oZWlnaHQ7Zz17d2lkdGg6YS5zaXplLndpZHRoLShnPzA6YS5zaXplRGlmZi53aWR0aCksaGVpZ2h0OmEuc2l6ZS5oZWlnaHQtZn07Zj1wYXJzZUludChhLmVsZW1lbnQuY3NzKCJsZWZ0IiksMTApKyhhLnBvc2l0aW9uLmxlZnQtYS5vcmlnaW5hbFBvc2l0aW9uLmxlZnQpfHxudWxsO3ZhciBoPXBhcnNlSW50KGEuZWxlbWVudC5jc3MoInRvcCIpLDEwKSsoYS5wb3NpdGlvbi50b3AtYS5vcmlnaW5hbFBvc2l0aW9uLnRvcCl8fG51bGw7YS5lbGVtZW50LmFuaW1hdGUoZC5leHRlbmQoZyxoJiZmP3t0b3A6aCxsZWZ0OmZ9Ont9KSx7ZHVyYXRpb246Yy5hbmltYXRlRHVyYXRpb24sZWFzaW5nOmMuYW5pbWF0ZUVhc2luZywKc3RlcDpmdW5jdGlvbigpe3ZhciBpPXt3aWR0aDpwYXJzZUludChhLmVsZW1lbnQuY3NzKCJ3aWR0aCIpLDEwKSxoZWlnaHQ6cGFyc2VJbnQoYS5lbGVtZW50LmNzcygiaGVpZ2h0IiksMTApLHRvcDpwYXJzZUludChhLmVsZW1lbnQuY3NzKCJ0b3AiKSwxMCksbGVmdDpwYXJzZUludChhLmVsZW1lbnQuY3NzKCJsZWZ0IiksMTApfTtlJiZlLmxlbmd0aCYmZChlWzBdKS5jc3Moe3dpZHRoOmkud2lkdGgsaGVpZ2h0OmkuaGVpZ2h0fSk7YS5fdXBkYXRlQ2FjaGUoaSk7YS5fcHJvcGFnYXRlKCJyZXNpemUiLGIpfX0pfX0pO2QudWkucGx1Z2luLmFkZCgicmVzaXphYmxlIiwiY29udGFpbm1lbnQiLHtzdGFydDpmdW5jdGlvbigpe3ZhciBiPWQodGhpcykuZGF0YSgicmVzaXphYmxlIiksYT1iLmVsZW1lbnQsYz1iLm9wdGlvbnMuY29udGFpbm1lbnQ7aWYoYT1jIGluc3RhbmNlb2YgZD9jLmdldCgwKTovcGFyZW50Ly50ZXN0KGMpP2EucGFyZW50KCkuZ2V0KDApOmMpe2IuY29udGFpbmVyRWxlbWVudD0KZChhKTtpZigvZG9jdW1lbnQvLnRlc3QoYyl8fGM9PWRvY3VtZW50KXtiLmNvbnRhaW5lck9mZnNldD17bGVmdDowLHRvcDowfTtiLmNvbnRhaW5lclBvc2l0aW9uPXtsZWZ0OjAsdG9wOjB9O2IucGFyZW50RGF0YT17ZWxlbWVudDpkKGRvY3VtZW50KSxsZWZ0OjAsdG9wOjAsd2lkdGg6ZChkb2N1bWVudCkud2lkdGgoKSxoZWlnaHQ6ZChkb2N1bWVudCkuaGVpZ2h0KCl8fGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHR9fWVsc2V7dmFyIGU9ZChhKSxnPVtdO2QoWyJUb3AiLCJSaWdodCIsIkxlZnQiLCJCb3R0b20iXSkuZWFjaChmdW5jdGlvbihpLGope2dbaV09bShlLmNzcygicGFkZGluZyIraikpfSk7Yi5jb250YWluZXJPZmZzZXQ9ZS5vZmZzZXQoKTtiLmNvbnRhaW5lclBvc2l0aW9uPWUucG9zaXRpb24oKTtiLmNvbnRhaW5lclNpemU9e2hlaWdodDplLmlubmVySGVpZ2h0KCktZ1szXSx3aWR0aDplLmlubmVyV2lkdGgoKS1nWzFdfTtjPWIuY29udGFpbmVyT2Zmc2V0Owp2YXIgZj1iLmNvbnRhaW5lclNpemUuaGVpZ2h0LGg9Yi5jb250YWluZXJTaXplLndpZHRoO2g9ZC51aS5oYXNTY3JvbGwoYSwibGVmdCIpP2Euc2Nyb2xsV2lkdGg6aDtmPWQudWkuaGFzU2Nyb2xsKGEpP2Euc2Nyb2xsSGVpZ2h0OmY7Yi5wYXJlbnREYXRhPXtlbGVtZW50OmEsbGVmdDpjLmxlZnQsdG9wOmMudG9wLHdpZHRoOmgsaGVpZ2h0OmZ9fX19LHJlc2l6ZTpmdW5jdGlvbihiKXt2YXIgYT1kKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGM9YS5vcHRpb25zLGU9YS5jb250YWluZXJPZmZzZXQsZz1hLnBvc2l0aW9uO2I9YS5fYXNwZWN0UmF0aW98fGIuc2hpZnRLZXk7dmFyIGY9e3RvcDowLGxlZnQ6MH0saD1hLmNvbnRhaW5lckVsZW1lbnQ7aWYoaFswXSE9ZG9jdW1lbnQmJi9zdGF0aWMvLnRlc3QoaC5jc3MoInBvc2l0aW9uIikpKWY9ZTtpZihnLmxlZnQ8KGEuX2hlbHBlcj9lLmxlZnQ6MCkpe2Euc2l6ZS53aWR0aCs9YS5faGVscGVyP2EucG9zaXRpb24ubGVmdC1lLmxlZnQ6CmEucG9zaXRpb24ubGVmdC1mLmxlZnQ7aWYoYilhLnNpemUuaGVpZ2h0PWEuc2l6ZS53aWR0aC9jLmFzcGVjdFJhdGlvO2EucG9zaXRpb24ubGVmdD1jLmhlbHBlcj9lLmxlZnQ6MH1pZihnLnRvcDwoYS5faGVscGVyP2UudG9wOjApKXthLnNpemUuaGVpZ2h0Kz1hLl9oZWxwZXI/YS5wb3NpdGlvbi50b3AtZS50b3A6YS5wb3NpdGlvbi50b3A7aWYoYilhLnNpemUud2lkdGg9YS5zaXplLmhlaWdodCpjLmFzcGVjdFJhdGlvO2EucG9zaXRpb24udG9wPWEuX2hlbHBlcj9lLnRvcDowfWEub2Zmc2V0LmxlZnQ9YS5wYXJlbnREYXRhLmxlZnQrYS5wb3NpdGlvbi5sZWZ0O2Eub2Zmc2V0LnRvcD1hLnBhcmVudERhdGEudG9wK2EucG9zaXRpb24udG9wO2M9TWF0aC5hYnMoKGEuX2hlbHBlcj9hLm9mZnNldC5sZWZ0LWYubGVmdDphLm9mZnNldC5sZWZ0LWYubGVmdCkrYS5zaXplRGlmZi53aWR0aCk7ZT1NYXRoLmFicygoYS5faGVscGVyP2Eub2Zmc2V0LnRvcC1mLnRvcDphLm9mZnNldC50b3AtCmUudG9wKSthLnNpemVEaWZmLmhlaWdodCk7Zz1hLmNvbnRhaW5lckVsZW1lbnQuZ2V0KDApPT1hLmVsZW1lbnQucGFyZW50KCkuZ2V0KDApO2Y9L3JlbGF0aXZlfGFic29sdXRlLy50ZXN0KGEuY29udGFpbmVyRWxlbWVudC5jc3MoInBvc2l0aW9uIikpO2lmKGcmJmYpYy09YS5wYXJlbnREYXRhLmxlZnQ7aWYoYythLnNpemUud2lkdGg+PWEucGFyZW50RGF0YS53aWR0aCl7YS5zaXplLndpZHRoPWEucGFyZW50RGF0YS53aWR0aC1jO2lmKGIpYS5zaXplLmhlaWdodD1hLnNpemUud2lkdGgvYS5hc3BlY3RSYXRpb31pZihlK2Euc2l6ZS5oZWlnaHQ+PWEucGFyZW50RGF0YS5oZWlnaHQpe2Euc2l6ZS5oZWlnaHQ9YS5wYXJlbnREYXRhLmhlaWdodC1lO2lmKGIpYS5zaXplLndpZHRoPWEuc2l6ZS5oZWlnaHQqYS5hc3BlY3RSYXRpb319LHN0b3A6ZnVuY3Rpb24oKXt2YXIgYj1kKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGE9Yi5vcHRpb25zLGM9Yi5jb250YWluZXJPZmZzZXQsZT1iLmNvbnRhaW5lclBvc2l0aW9uLApnPWIuY29udGFpbmVyRWxlbWVudCxmPWQoYi5oZWxwZXIpLGg9Zi5vZmZzZXQoKSxpPWYub3V0ZXJXaWR0aCgpLWIuc2l6ZURpZmYud2lkdGg7Zj1mLm91dGVySGVpZ2h0KCktYi5zaXplRGlmZi5oZWlnaHQ7Yi5faGVscGVyJiYhYS5hbmltYXRlJiYvcmVsYXRpdmUvLnRlc3QoZy5jc3MoInBvc2l0aW9uIikpJiZkKHRoaXMpLmNzcyh7bGVmdDpoLmxlZnQtZS5sZWZ0LWMubGVmdCx3aWR0aDppLGhlaWdodDpmfSk7Yi5faGVscGVyJiYhYS5hbmltYXRlJiYvc3RhdGljLy50ZXN0KGcuY3NzKCJwb3NpdGlvbiIpKSYmZCh0aGlzKS5jc3Moe2xlZnQ6aC5sZWZ0LWUubGVmdC1jLmxlZnQsd2lkdGg6aSxoZWlnaHQ6Zn0pfX0pO2QudWkucGx1Z2luLmFkZCgicmVzaXphYmxlIiwiZ2hvc3QiLHtzdGFydDpmdW5jdGlvbigpe3ZhciBiPWQodGhpcykuZGF0YSgicmVzaXphYmxlIiksYT1iLm9wdGlvbnMsYz1iLnNpemU7Yi5naG9zdD1iLm9yaWdpbmFsRWxlbWVudC5jbG9uZSgpO2IuZ2hvc3QuY3NzKHtvcGFjaXR5OjAuMjUsCmRpc3BsYXk6ImJsb2NrIixwb3NpdGlvbjoicmVsYXRpdmUiLGhlaWdodDpjLmhlaWdodCx3aWR0aDpjLndpZHRoLG1hcmdpbjowLGxlZnQ6MCx0b3A6MH0pLmFkZENsYXNzKCJ1aS1yZXNpemFibGUtZ2hvc3QiKS5hZGRDbGFzcyh0eXBlb2YgYS5naG9zdD09InN0cmluZyI/YS5naG9zdDoiIik7Yi5naG9zdC5hcHBlbmRUbyhiLmhlbHBlcil9LHJlc2l6ZTpmdW5jdGlvbigpe3ZhciBiPWQodGhpcykuZGF0YSgicmVzaXphYmxlIik7Yi5naG9zdCYmYi5naG9zdC5jc3Moe3Bvc2l0aW9uOiJyZWxhdGl2ZSIsaGVpZ2h0OmIuc2l6ZS5oZWlnaHQsd2lkdGg6Yi5zaXplLndpZHRofSl9LHN0b3A6ZnVuY3Rpb24oKXt2YXIgYj1kKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpO2IuZ2hvc3QmJmIuaGVscGVyJiZiLmhlbHBlci5nZXQoMCkucmVtb3ZlQ2hpbGQoYi5naG9zdC5nZXQoMCkpfX0pO2QudWkucGx1Z2luLmFkZCgicmVzaXphYmxlIiwiZ3JpZCIse3Jlc2l6ZTpmdW5jdGlvbigpe3ZhciBiPQpkKHRoaXMpLmRhdGEoInJlc2l6YWJsZSIpLGE9Yi5vcHRpb25zLGM9Yi5zaXplLGU9Yi5vcmlnaW5hbFNpemUsZz1iLm9yaWdpbmFsUG9zaXRpb24sZj1iLmF4aXM7YS5ncmlkPXR5cGVvZiBhLmdyaWQ9PSJudW1iZXIiP1thLmdyaWQsYS5ncmlkXTphLmdyaWQ7dmFyIGg9TWF0aC5yb3VuZCgoYy53aWR0aC1lLndpZHRoKS8oYS5ncmlkWzBdfHwxKSkqKGEuZ3JpZFswXXx8MSk7YT1NYXRoLnJvdW5kKChjLmhlaWdodC1lLmhlaWdodCkvKGEuZ3JpZFsxXXx8MSkpKihhLmdyaWRbMV18fDEpO2lmKC9eKHNlfHN8ZSkkLy50ZXN0KGYpKXtiLnNpemUud2lkdGg9ZS53aWR0aCtoO2Iuc2l6ZS5oZWlnaHQ9ZS5oZWlnaHQrYX1lbHNlIGlmKC9eKG5lKSQvLnRlc3QoZikpe2Iuc2l6ZS53aWR0aD1lLndpZHRoK2g7Yi5zaXplLmhlaWdodD1lLmhlaWdodCthO2IucG9zaXRpb24udG9wPWcudG9wLWF9ZWxzZXtpZigvXihzdykkLy50ZXN0KGYpKXtiLnNpemUud2lkdGg9ZS53aWR0aCtoO2Iuc2l6ZS5oZWlnaHQ9CmUuaGVpZ2h0K2F9ZWxzZXtiLnNpemUud2lkdGg9ZS53aWR0aCtoO2Iuc2l6ZS5oZWlnaHQ9ZS5oZWlnaHQrYTtiLnBvc2l0aW9uLnRvcD1nLnRvcC1hfWIucG9zaXRpb24ubGVmdD1nLmxlZnQtaH19fSk7dmFyIG09ZnVuY3Rpb24oYil7cmV0dXJuIHBhcnNlSW50KGIsMTApfHwwfSxrPWZ1bmN0aW9uKGIpe3JldHVybiFpc05hTihwYXJzZUludChiLDEwKSl9fSkoalF1ZXJ5KTsKOw==",
	"cint.js": "JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7CiAgICAkKCcjY2FsZW5kYXInKS5mdWxsQ2FsZW5kYXIoewogICAgICBmaXJzdERheTogMSwgLy8gc3RhcnQgd2l0aCBtb25kYXkKCSAgZWRpdGFibGU6IGZhbHNlLAoJICBldmVudHM6ICIvY2FsZXZlbnRzP3RsPSIrdGxuYW1lLAoJICBoZWFkZXI6IHsKCWxlZnQ6ICdwcmV2LG5leHQgdG9kYXknLAoJICAgIGNlbnRlcjogJ3RpdGxlJywKCSAgICByaWdodDogJ21vbnRoLGJhc2ljV2VlaycKCX0KICAgICAgfSkKICAgICAgfSk7CgpmdW5jdGlvbiBhZGRfZW50cnkodGFza2xpc3QpIHsKICAgIHZhciBuZXRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3ZW50cnknKS52YWx1ZTsKICAgIHZhciBjYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsZW5kYXInKTsKCiAgICB2YXIgcmVxID0gWE1MSHR0cFJlcXVlc3QoKQogICAgcmVxLm9wZW4oIkdFVCIsICJxYWRkP3RsPSIgKyBlc2NhcGUodGFza2xpc3QpICsgIiZ0ZXh0PSIgKyBlc2NhcGUobmV0ZXh0KSwgdHJ1ZSk7CiAgICByZXEub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHJlcS5yZWFkeVN0YXRlID09IDQpIHsKICAgICAgICAgICAgaWYgKHJlcS5yZXNwb25zZVRleHQubWF0Y2goL15hZGRlZDogLykpIHsKCSAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKQogICAgICAgICAgICB9IGVsc2UgewoJICAgICAgYWxlcnQoIkFERCBGQUlMRUQ6ICIgKyByZXEucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICB9CiAgICB9OwogICAgcmVxLnNlbmQobnVsbCk7CiAgICByZXR1cm4gZmFsc2U7Cn0K",
	"cal.css": "LmFsdDEsIC5mYy1hZ2VuZGEgLmFsdDEsIC5mYy1ldmVudC10aW1lLCAuYWx0MSBhIHsKICAgIGJhY2tncm91bmQtY29sb3I6IG1hcm9vbjsKICAgIGJvcmRlci1jb2xvcjogbWFyb29uOwp9CgouYWx0MiwgLmZjLWFnZW5kYSAuYWx0MiwgLmZjLWV2ZW50LXRpbWUsIC5hbHQyIGEgewogICAgYmFja2dyb3VuZC1jb2xvcjogbmF2eTsKICAgIGJvcmRlci1jb2xvcjogbmF2eTsKfQoKLmFsdDMsIC5mYy1hZ2VuZGEgLmFsdDMsIC5mYy1ldmVudC10aW1lLCAuYWx0MyBhIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGdyZWVuOwogICAgYm9yZGVyLWNvbG9yOiBncmVlbjsKfQoKLmFsdDQsIC5mYy1hZ2VuZGEgLmFsdDQsIC5mYy1ldmVudC10aW1lLCAuYWx0NCBhIHsKICAgIGJhY2tncm91bmQtY29sb3I6IGZ1Y2hzaWE7CiAgICBib3JkZXItY29sb3I6IGZ1Y2hzaWE7Cn0KCi5hbHQ1LCAuZmMtYWdlbmRhIC5hbHQ1LCAuZmMtZXZlbnQtdGltZSwgLmFsdDUgYSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBwdXJwbGU7CiAgICBib3JkZXItY29sb3I6IHB1cnBsZTsKfQo=",
}

